System.register(["calcite-components","jimu-core","jimu-core/emotion","jimu-for-builder","jimu-for-builder/service","jimu-layouts/layout-runtime","jimu-theme","jimu-ui","jimu-ui/advanced/resource-selector","jimu-ui/advanced/setting-components"],function(e,t){var n={},s={},i={},a={},o={},r={},l={},c={},d={},u={};return{setters:[function(e){n.CalciteInputTimeZone=e.CalciteInputTimeZone},function(e){s.ContainerType=e.ContainerType,s.DialogMode=e.DialogMode,s.EConsentMode=e.EConsentMode,s.LayoutItemType=e.LayoutItemType,s.LayoutParentType=e.LayoutParentType,s.PageType=e.PageType,s.React=e.React,s.ReactRedux=e.ReactRedux,s.SessionManager=e.SessionManager,s.TimezoneConfig=e.TimezoneConfig,s.UrlGeneralConfig=e.UrlGeneralConfig,s.WidgetType=e.WidgetType,s.appActions=e.appActions,s.classNames=e.classNames,s.createSelector=e.createSelector,s.css=e.css,s.dataSourceUtils=e.dataSourceUtils,s.dateUtils=e.dateUtils,s.defaultMessages=e.defaultMessages,s.focusElementInKeyboardMode=e.focusElementInKeyboardMode,s.getAppStore=e.getAppStore,s.hooks=e.hooks,s.i18n=e.i18n,s.loadArcGISJSAPIModule=e.loadArcGISJSAPIModule,s.lodash=e.lodash,s.moduleLoader=e.moduleLoader,s.portalUrlUtils=e.portalUrlUtils,s.portalUtils=e.portalUtils,s.urlManagerUtils=e.urlManagerUtils,s.useIntl=e.useIntl,s.uuidv1=e.uuidv1},function(e){i.Fragment=e.Fragment,i.jsx=e.jsx,i.jsxs=e.jsxs},function(e){a.ToBuilderMessage=e.ToBuilderMessage,a.UrlConfigManager=e.UrlConfigManager,a.appStateHistoryActions=e.appStateHistoryActions,a.builderAppSync=e.builderAppSync,a.getAppConfigAction=e.getAppConfigAction,a.helpUtils=e.helpUtils},function(e){o.appServices=e.appServices},function(){},function(e){l.styled=e.styled,l.useTheme=e.useTheme,l.withTheme=e.withTheme},function(e){c.AdvancedSelect=e.AdvancedSelect,c.Alert=e.Alert,c.AlertPopup=e.AlertPopup,c.Button=e.Button,c.Checkbox=e.Checkbox,c.CollapsablePanel=e.CollapsablePanel,c.Collapse=e.Collapse,c.Label=e.Label,c.Loading=e.Loading,c.Modal=e.Modal,c.ModalBody=e.ModalBody,c.ModalFooter=e.ModalFooter,c.ModalHeader=e.ModalHeader,c.Popper=e.Popper,c.Radio=e.Radio,c.Switch=e.Switch,c.Tab=e.Tab,c.Tabs=e.Tabs,c.TagInput=e.TagInput,c.TextArea=e.TextArea,c.TextInput=e.TextInput,c.Tooltip=e.Tooltip,c.defaultMessages=e.defaultMessages},function(e){d.IconPicker=e.IconPicker},function(e){u.RadioGroup=e.RadioGroup,u.SettingRow=e.SettingRow,u.SettingSection=e.SettingSection,u.SidePopper=e.SidePopper}],execute:function(){e((()=>{var e={655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},1496:e=>{"use strict";e.exports=r},1795:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 8A6 6 0 1 1 2 8a6 6 0 0 1 12 0m1 0A7 7 0 1 1 1 8a7 7 0 0 1 14 0M5.172 5.879a.5.5 0 0 1 .707-.707L8 7.292l2.121-2.12a.5.5 0 1 1 .707.707L8.708 8l2.12 2.121a.5.5 0 1 1-.707.707L8 8.708l-2.121 2.12a.5.5 0 1 1-.707-.707L7.292 8z" clip-rule="evenodd"></path></svg>'},1888:e=>{"use strict";e.exports=l},2046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},2943:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.54.54 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.54.54 0 0 1-.738 0" clip-rule="evenodd"></path></svg>'},3303:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},3662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},4108:e=>{"use strict";e.exports=a},4321:e=>{"use strict";e.exports=c},4702:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.39 3.425 5.553.588a2.006 2.006 0 0 0-2.837 0L.588 2.716a2.006 2.006 0 0 0 0 2.837L3.425 8.39a2.006 2.006 0 0 0 2.837 0l.71-.709 1.347 1.347-.71.71a2.006 2.006 0 0 0 0 2.837l2.838 2.837a2.006 2.006 0 0 0 2.837 0l2.128-2.128a2.006 2.006 0 0 0 0-2.837L12.575 7.61a2.006 2.006 0 0 0-2.837 0l-.71.709-1.347-1.347.71-.71a2.006 2.006 0 0 0 0-2.837M6.972 6.262l.709-.709a1.003 1.003 0 0 0 0-1.419L4.844 1.297a1.003 1.003 0 0 0-1.419 0L1.297 3.425a1.003 1.003 0 0 0 0 1.419L4.134 7.68a1.003 1.003 0 0 0 1.419 0l.71-.71-.894-.892a.501.501 0 0 1 .71-.71zm2.056 3.476.6.599a.502.502 0 0 0 .709-.71l-.6-.599.71-.709a1.003 1.003 0 0 1 1.419 0l2.837 2.837a1.003 1.003 0 0 1 0 1.419l-2.128 2.128a1.003 1.003 0 0 1-1.419 0L8.32 11.866a1.003 1.003 0 0 1 0-1.419z" clip-rule="evenodd"></path></svg>'},5075:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1 7.5c0-.291.231-.527.516-.527h11.508L9.527 3.4a.535.535 0 0 1 0-.746.51.51 0 0 1 .73 0L15 7.5l-4.743 4.846a.51.51 0 0 1-.73 0 .535.535 0 0 1 0-.746l3.497-3.573H1.516A.52.52 0 0 1 1 7.5"></path></svg>'},5508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},5809:e=>{"use strict";e.exports=d},6300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M15 7.5a.52.52 0 0 1-.516.527H2.976L6.473 11.6a.535.535 0 0 1 0 .746.51.51 0 0 1-.73 0L1 7.5l4.743-4.846a.51.51 0 0 1 .73 0 .535.535 0 0 1 0 .746L2.976 6.973h11.508c.285 0 .516.236.516.527"></path></svg>'},7386:e=>{"use strict";e.exports=i},8547:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7.5 0A3.5 3.5 0 0 1 11 3.5V6h1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1V3.5A3.5 3.5 0 0 1 7.5 0M5 6h5V3.5a2.5 2.5 0 0 0-2.336-2.495L7.5 1a2.5 2.5 0 0 0-2.495 2.336L5 3.5zm6 1H3v8h9V7zm-3.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3" clip-rule="evenodd"></path></svg>'},8996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},9037:e=>{"use strict";e.exports=n},9244:e=>{"use strict";e.exports=s},9298:e=>{"use strict";e.exports=u},9524:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7.5 1.5a.5.5 0 0 1 1 0v2.8a.5.5 0 0 1-1 0zm6.028.874a.5.5 0 0 1 .062.705l-1.414 1.685a.5.5 0 1 1-.766-.643l1.414-1.685a.5.5 0 0 1 .704-.062m-10.352.062a.5.5 0 1 0-.766.643l1.414 1.685a.5.5 0 0 0 .766-.643zM6.244 10.6H5.43zM.961 9.8h4.88c.211 0 .359.19.359.4q0 .207.045.4a1.8 1.8 0 0 0 3.51 0h.814a2.6 2.6 0 0 1-5.139 0H.8v3.6h14.4v-3.6H9.755q.045-.194.045-.4c0-.21.148-.4.358-.4h4.881l-2.267-3.4H3.228zm11.81-4.2a.8.8 0 0 1 .666.356l2.429 3.642a.8.8 0 0 1 .134.444V14.2a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1-.8-.8v-4.158a.8.8 0 0 1 .134-.444l2.429-3.642a.8.8 0 0 1 .665-.356z" clip-rule="evenodd"></path></svg>'},9860:e=>{"use strict";e.exports=o}},t={};function p(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,p),i.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var n in t)p.o(t,n)&&!p.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.p="";var h={};return p.p=window.jimuConfig.baseUrl,(()=>{"use strict";p.r(h),p.d(h,{__set_webpack_public_path__:()=>Lt,default:()=>Bt});var e=p(7386),t=p(9244),n=p(4321);const s={experienceSettings:"Experience settings",templateSettings:"Template settings",favicon:"Favicon",timezone:"Time zone",deviceTimezone:"Device time zone",specificTimezone:"Specific time zone",dataTimezone:"Data time zone",dataTimezoneTimelineWarning:"Be aware that using data time zone affects all date fields and limits the functionality of the Timeline widget.",learnMoreForTimezoneSetting:"Learn more about time zone settings.",timezoneDesc:"Changing the time zone of the experience will affect how the date and time data are displayed. Options include:",deviceTimezoneDesc:"Displays date and time using the local device time zone.",specificTimezoneDesc:"Displays date and time using a designated time zone.",dataTimezoneDesc:"Displays date and time based on the time zone defined for a stand-alone layer or the web map, respectively, with no adjustments made.",stateUrlParameters:"State & URL parameters",manageUrlStatus:"Manage URL parameters",appStateConfig:"Experience state",appStateTips:"Display a banner that allows users to restore the state of the page, view, window, map viewpoint, and layer visibility, resuming where they left off when reopening the experience. The experience state is stored in the browser cache and works only when cached data is available.",allowRestoreState:"Allow to restore state upon reopening the experience",dataSelection:"Data selection",zoomToSelection:"Zoom to selected features",manageUrlStatusTips:"Select the URL parameters you want to include in the URL when interacting with the experience. The experience URL will synchronize with user interactions automatically, and can be shared with other users to restore the previous content of display using the URL parameters.",privacy:"Privacy",security:"Security",privacyAndSecurity:"Privacy and security",skipSingInPrompt:"Skip sign-in prompt for secured resources",skipCredentialBanner:"Skip credential banner",skipSingInPromptInfo:"Stops automatic sign-in popups for unshared resources. The app loads only what's accessible to the user, and sign-in can still be done through the credential banner if available.",skipCredentialBannerInfo:"Disables the credential banner, which lists inaccessible content and offers sign-in option.",visibilityRestriction:"Page visibility restriction",visibilityRestrictionInfo:"Limit who can view specific pages by setting rules based on user roles or groups.",addRestrictionRule:"Add restriction",pagesWithRestrictions:"Pages with restrictions",restrictionTitle:"{pageNames} are limited to {roleNames} roles, {groupNames} groups",restrictionTitleWithRoles:"{pageNames} are limited to {roleNames} roles",restrictionTitleWithGroups:"{pageNames} are limited to {groupNames} groups",restrictionRule:"Restriction",selectorDisplay:"{count} selected",homePageWarning:"Page {pageName} is set as the homepage, serving as the entry point of the app. Please confirm that you truly want to apply restrictions to it.",whoCanViewPages:"Who can view the selected pages",limitedTo:"Limited to",limitedToRole:"Roles",limitedToGroup:"Groups",limitedToPage:"Pages",selectPages:"Select pages",selectRoles:"Select roles",selectGroups:"Select groups",googleAnalytics:"Google Analytics (GA4)",measurementId:"Measurement ID",invalidMeasurementMsg:"Formatting must match",consentRefreshSetting:"Consent refresh settings",refreshPeriodically:"Refresh consent periodically",thirdPartyExplain:"The cookie banner only controls first-party cookies and does not apply to third-party cookies from other domains.",days:"days",consentMode:"Consent mode",consentRequired:"Consent required",consentOptional:"Consent optional",renewUserConsents:"Renew consent",renewNow:"Renew now",renewModalTitle:"Are you sure you want to renew user consent?",renewModalDesc:"The cookie banner will reappear for users who have previously consented and ask them to give their consent again.",lastTimeRenewed:"Last time renewed",noAvailableWidgets:"No available widgets. Please add widgets that support URL parameters.",translationAssistant:"Translation Assistant",languages:"Languages",selectLanguages:"Select languages to be translated",configTranslatedText:"Configure translated text",translation:"Translation",translating:"Translating...",aboutAssistant:"About the Translation Assistant",assistantDescription:"ArcGIS Experience Builder uses machine translation to automatically translate your app texts into multiple languages. Machine translation is not intended to replace human translators. Esri and its authorized distributors make no warranty (whether expressed or implied) as to the accuracy, completeness, and reliability of machine translations.",replaceExistingTranslations:"Replace existing translations",replaceExistingTranslationsDesc:"When checked, all translations will be replaced for the selected languages. When unchecked, automatic translations will be added for blank items only.",supportedLanguagesTips:"Translation assistant currently only supports the above languages.",windowCheckboxText:"Checkbox text",windowButtonText:"Button text"};var i=p(9298),a=p(1888),o=p(4108),r=p(3303),l=p.n(r),c=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const d=n=>{const s=window.SVG,{className:i}=n,a=c(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:l()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))},u=t.React.memo(i=>{const a=t.hooks.useTranslation(n.defaultMessages,s),r=(e,t,n)=>o.UrlConfigManager.getInstance().isWidgetParamEnable(e,t,n),l=a("settings");return(0,e.jsx)(t.React.Fragment,{children:i.urlParamsWidgetsInManifest&&i.widgetsInfoInGroup.widgetsInfo.map((s,a)=>{var o,c,u;const p=s.id,h=s.label,g=null===(u=null===(c=null===(o=i.urlParamsWidgetsInManifest[p])||void 0===o?void 0:o.manifest)||void 0===c?void 0:c.urlParameters)||void 0===u?void 0:u.length,m=g&&1===g,f=((e,n)=>{var s,a;let o=!1;if(n){const t=null===(a=null===(s=i.urlParamsWidgetsInManifest[e])||void 0===s?void 0:s.manifest)||void 0===a?void 0:a.urlParameters[0].name;o=r(e,t,n)}else o=t.urlManagerUtils.isWidgetEnable(e);return o})(p,m);return(0,e.jsxs)("div",{className:"detail-setting d-flex justify-content-between align-items-center my-2 ",children:[(0,e.jsx)(n.Label,{className:"widget-label",children:h}),(0,e.jsxs)("div",{className:"d-flex justify-content-end align-items-center",children:[!m&&(0,e.jsx)(n.Button,{size:"sm",icon:!0,type:"tertiary",className:"mr-2",onClick:e=>{i.handWidgetSettingClick(p,e,f)},title:l,"aria-label":l,children:(0,e.jsx)(d,{size:"m"})}),(0,e.jsx)(n.Switch,{checked:f,onChange:e=>{i.handEnableChange(p,e,m)}})]})]},a)})},i.idx)});class g extends t.React.PureComponent{constructor(e){super(e),this.handleChange=e=>{const t=(null==e?void 0:e.target.value)||"";this.setState({searchText:t},()=>{const{onSearchTextChange:e}=this.props;e&&e(t)})},this.handleSubmit=e=>{const{onSubmit:t}=this.props;t&&t(e)},this.onKeyUp=e=>{e&&e.target&&"Enter"===e.key&&this.handleSubmit(e.target.value)},this.handleClear=e=>{this.setState({searchText:""}),e.stopPropagation()},this.getStyle=()=>t.css`
      position: relative;
      .toc-search-input {
        .search-close-icon {
          padding: 0.125rem;
        }
      }
    `,this.state={searchText:e.searchText||""}}componentDidUpdate(e){if(this.props.searchText!==e.searchText&&this.props.searchText!==this.state.searchText){const{searchText:e}=this.props;this.setState({searchText:e})}}render(){const{placeholder:t,className:s,inputRef:i,onFocus:a,onBlur:o}=this.props,{searchText:r}=this.state;return(0,e.jsx)("div",{css:this.getStyle(),className:s,children:(0,e.jsx)(n.TextInput,{className:"toc-search-input",ref:i,"aria-label":t,placeholder:t,allowClear:!0,onChange:this.handleChange,onBlur:o,onFocus:a,value:r,onKeyDown:e=>{this.onKeyUp(e)}})})}}function m(r){const l=(0,a.useTheme)(),c=t.hooks.useTranslation(n.defaultMessages,s),d=t.ReactRedux.useSelector(e=>{var t,n;const s=[],i=null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets;return Object.keys(null!=i?i:{}).forEach(e=>{s.push(e)}),s.join(",")},t.ReactRedux.shallowEqual),u=t.ReactRedux.useSelector(e=>{var t,n;const s=null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.pageStructure;return o.UrlConfigManager.getInstance().getFlatPageInfos(s)},t.ReactRedux.shallowEqual),p=t.ReactRedux.useSelector(e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.browserSizeMode}),[h,m]=t.React.useState(""),f=t.React.useRef(null),{onSearch:v}=r,w=t.React.useRef([]),b=t.React.useRef([]),x=t.React.useRef([]);t.React.useEffect(()=>{const e=o.UrlConfigManager.getInstance().getWidgetsInPages(p,h),n=o.UrlConfigManager.getInstance().getWidgetsInHeaderFooter(p,h),s=o.UrlConfigManager.getInstance().getWidgetsInDialogs(p,h);(!t.lodash.isDeepEqual(e,w.current)||!t.lodash.isDeepEqual(n,b.current)||!t.lodash.isDeepEqual(s,x.current))&&r.active&&v(e,n,s),w.current=e,b.current=n,x.current=s},[h,p,d,u,r.active,v]);const y=c("SearchLabel");return(0,e.jsx)(i.SettingSection,{className:"px-0 pb-0 url-params-search mb-3",css:(e=>t.css`
      &.url-params-search {
        border: 0;

        .outline-title {
          user-select: none;
          color: ${e.ref.palette.neutral[1e3]};
          font-weight: ${e.ref.typeface.fontWeightBold};
        }
      }
    `)(l),children:(0,e.jsx)(g,{theme:l,placeholder:y,searchText:h,onSearchTextChange:e=>{m(e)},inputRef:e=>{f.current=e}})})}var f=p(2943),v=p.n(f),w=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const b=n=>{const s=window.SVG,{className:i}=n,a=w(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:v()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var x=p(655),y=p.n(x),S=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const j=n=>{const s=window.SVG,{className:i}=n,a=S(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:y()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var I=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};function T(i){const a=t.hooks.useTranslation(n.defaultMessages,s),{label:o,children:r,isDefaultOpen:l,className:c}=i,d=I(i,["label","children","isDefaultOpen","className"]),[u,p]=t.React.useState(null==l||l),h=a(u?"collapse":"expand");return(0,e.jsxs)("div",{className:i.className,children:[(0,e.jsxs)(n.Label,{children:[(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"collapsable-item-icon",disableRipple:!0,title:h,"aria-label":h,"aria-expanded":u,onClick:e=>{setTimeout(()=>{p(!u)},80)},children:u?(0,e.jsx)(j,{size:"s"}):(0,e.jsx)(b,{size:"s"})}),o]}),(0,e.jsx)(n.Collapse,Object.assign({isOpen:u},d,{children:r}))]})}const R=e=>t.css`
  .jimu-widget-setting--section-header .title2, .jimu-widget-setting--section-header .text-truncate, .section-header .jimu-widget-setting--row-label, .section-header-label>label:first-of-type {
    color: var(--ref-palette-neutral-1100) !important;
    font-size: 14px !important;
    font-weight: 600 !important;
  }

  .scroll-content {
    height: calc(100% - 60px);
    overflow-y: auto;
  }

  &.url-setting {
    .back-btn-text {
      color: var(--ref-palette-neutral-1100);
      font-size: 16px;
      font-weight: 500;
    }

    .widgets-title-warper {
      border-bottom: none;
    }
    .widgets-warper {
      padding-top: 0;
      padding-left: 0;
      padding-right: 0;
      overflow: auto;

      .nav-item .nav-link {
        padding: 0.25rem;
      }
    }

    /* First level collapsable */
    .collapsable-wrapper {
      .title {
        padding:0 !important;
        font-size: unset;
      }
    }

    /* Second level collapsable */
    .collapsable-item-section {
      margin-top: 4px;

      .collapsable-item-icon {
        padding: 0;
        margin-right: 2px;
      }

      .form-label {
        margin-top: 8px;
        margin-bottom: 0;
      }

      .collapse-header {
        padding-top: 6px;
      }
    }

    .form-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--ref-palette-neutral-1000);
      padding: 0 !important;
    }

    .jimu-widget-setting--section {
      /* section-title */
      .jimu-widget-setting--section-header{
        .setting-row-text-level-1 {
          color: var(--ref-palette-neutral-1000)!important;
          font-size: 14px !important;
          font-weight: 600 !important;
        }
      }
      .jimu-widget-setting--row {
        .outline-title {
          color: var(--ref-palette-neutral-1000)!important;
          font-size: 14px !important;
          font-weight: 600 !important;
        }
      }
    }

    /* Tabs */
    .jimu-tabs {
      margin-top: 0;

      .tab-pane { /* for 508 focus */
        padding-left: 2px;
        padding-right: 2px;
      }
    }
    .nav-item {
      &:last-of-type{
        margin-right: 0;
      }
      .nav-link{
        padding: 0.5rem 0.25rem;
      }
    }

    .detail-setting {
      min-height: 26px;
      margin-left: 20px;

      .widget-label {
        font-weight: unset;
      }
    }

    /* empty icon */
    .empty-placeholder {
      .empty-placeholder-text, .empty-placeholder-icon{
        display: table;
        margin: 0 auto;
      }
      .empty-placeholder-text{
        color: var(--ref-palette-neutral-900);
        font-size: ${e.sys.typography.label1.fontSize};
        margin-top: ${e.sys.spacing[4]};
        text-align: center;
      }

      .empty-placeholder-icon{
        color: var(--sys-color-action-disabled-text);
      }
    }
  }
`;var C=p(6300),k=p.n(C),E=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const O=n=>{const s=window.SVG,{className:i}=n,a=E(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:k()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var N=p(5508),A=p.n(N),P=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const M=n=>{const s=window.SVG,{className:i}=n,a=P(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:A()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var _=p(9524),U=p.n(_),D=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const z=n=>{const s=window.SVG,{className:i}=n,a=D(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:U()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))},B=t.React.memo(()=>{const a=t.hooks.useTranslation(s),r=t.ReactRedux.useSelector(e=>{var t,n,s;return!!(null===(s=null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.appStateConfig)||void 0===s?void 0:s.allowRestoreState)}),l=t.React.useCallback((e,t)=>{(0,o.getAppConfigAction)().updateAppStateConfig({allowRestoreState:t}).exec()},[]);return(0,e.jsx)(i.SettingSection,{title:a("appStateConfig"),children:(0,e.jsxs)(i.SettingRow,{flow:"no-wrap",children:[(0,e.jsx)(n.Label,{for:"allowRestoreState",children:a("allowRestoreState")}),(0,e.jsx)(n.Tooltip,{placement:"right",title:a("appStateTips"),children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"flex-shrink-0 p-0 mx-3",disableHoverEffect:!0,disableRipple:!0,onClick:e=>{e.stopPropagation()},children:(0,e.jsx)(M,{})})}),(0,e.jsx)(n.Switch,{id:"allowRestoreState",checked:r,onChange:l})]})})});var L;function F(r){var l,c,d;const p=t.hooks.useTranslation(n.defaultMessages,s),h=(0,a.useTheme)(),g=o.UrlConfigManager.getInstance().getWidgetsUseUrlParamsInManifest();t.ReactRedux.useSelector(e=>{var t,n;return null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.urlParams});const f=e=>o.UrlConfigManager.getInstance().isGeneralUrlConfigEnable(e),v=(e,t,n)=>{var s,i;const a=t.target.checked;if(n){const t=null===(i=null===(s=g[e])||void 0===s?void 0:s.manifest)||void 0===i?void 0:i.urlParameters[0].name;o.UrlConfigManager.getInstance().updateWidgetParamEnable(e,t,a)}else o.UrlConfigManager.getInstance().updateWidgetEnable(e,a)},w=(e,t,n)=>o.UrlConfigManager.getInstance().isWidgetParamEnable(e,t,n),[b,x]=t.React.useState([]),[y,S]=t.React.useState([]),[j,I]=t.React.useState([]),C=(e,t,n)=>{x(e),S(t),I(n)},k=e=>null==y?void 0:y.filter(t=>t.mode===e),E=e=>{const t=k(e).some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0});return t},N=()=>b,A=()=>{const e=N().some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0});return e},P=e=>null==j?void 0:j.filter(t=>t.dialogInfo.mode===e),_=e=>{const t=P(e).some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0});return t},U=t.React.useRef(null),[D,F]=t.React.useState(null),G=(e,t,n)=>{U.current=t.target,F({widgetId:e,isEnable:n})},H=!!D,[W,$]=t.React.useState(L.Page),q=b.some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0})||y.some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0})||j.some(e=>{var t;return(null===(t=e.widgetsInfo)||void 0===t?void 0:t.length)>0}),V=()=>(0,e.jsxs)("div",{className:"empty-placeholder w-100 p-4",children:[(0,e.jsx)("div",{className:"empty-placeholder-icon",children:(0,e.jsx)(z,{size:48})}),(0,e.jsx)("div",{className:"empty-placeholder-text",children:p("noAvailableWidgets")})]}),K=p("data"),J=p("dataSelection"),X=p("zoomToSelection"),Z=p("widgets"),Q=p("manageUrlStatusTips"),Y=p("variableHeader"),ee=p("variableBody"),te=p("variableFooter"),ne=p("fixedWindows"),se=p("anchoredWindows"),ie=(0,e.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,e.jsx)("div",{className:"text-truncate",title:p("manageUrlStatus"),children:p("manageUrlStatus")}),(0,e.jsx)(n.Tooltip,{placement:"right",title:Q,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,children:(0,e.jsx)(M,{})})})]});return(0,e.jsxs)("div",{className:"url-setting widget-builder-themes d-flex flex-column bg-light-300 w-100 h-100",css:R(h),children:[(0,e.jsx)(i.SettingSection,{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between header-title",children:(0,e.jsxs)("div",{className:"text-truncate text-left d-flex align-items-center back-btn-text",children:[(0,e.jsx)(n.Button,{onClick:r.onBack,size:"sm",icon:!0,type:"tertiary",className:"mr-2 jimu-outline-inside","aria-label":p("back"),children:(0,e.jsx)(O,{size:"m",autoFlip:!0})}),(0,e.jsx)("div",{className:"text-truncate",title:p("stateUrlParameters"),children:p("stateUrlParameters")})]})}),(0,e.jsxs)("div",{className:"scroll-content",children:[(0,e.jsx)(B,{}),(0,e.jsxs)(i.SettingSection,{title:ie,children:[(0,e.jsxs)(i.SettingRow,{flow:"wrap",tag:"div",label:K,className:"section-header-label",bottomLine:!0,role:"group",children:[(0,e.jsx)(i.SettingRow,{className:"w-100 d-flex justify-content-between",tag:"label",label:J,children:(0,e.jsx)(n.Switch,{checked:f(t.UrlGeneralConfig.DataSelection),onChange:e=>{((e,t)=>{const n=t.target.checked;o.UrlConfigManager.getInstance().updateGeneralUrlConfigEnable(e,n)})(t.UrlGeneralConfig.DataSelection,e)}})}),f(t.UrlGeneralConfig.DataSelection)&&(0,e.jsx)(i.SettingRow,{children:(0,e.jsxs)(n.Label,{children:[(0,e.jsx)(n.Checkbox,{className:"mr-2",checked:o.UrlConfigManager.getInstance().isZoomToSelectionEnable(),onChange:(e,t)=>{o.UrlConfigManager.getInstance().updateZoomToSelectionEnable(t)}}),(0,e.jsx)("span",{className:"checkbox-label",children:X})]})})]}),(0,e.jsx)(i.SettingRow,{flow:"wrap",label:Z,"aria-label":Z,className:"widgets-warper section-header",role:"group",children:(0,e.jsxs)(n.Tabs,{type:"pills",className:"w-100 ",value:W,onChange:e=>{$(e)},children:[(0,e.jsxs)(n.Tab,{id:"page",title:p("page"),className:"w-50 ",children:[(0,e.jsx)(m,{active:W===L.Page,onSearch:C}),!q&&V(),q&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(i.SettingSection,{className:"px-0 mx-1 pt-1",children:(0,e.jsx)(n.CollapsablePanel,{label:Y,"aria-label":Y,role:"group",className:"collapsable-wrapper px-0",defaultIsOpen:E("Header"),disabled:!E("Header"),children:E("Header")&&k("Header").map((n,s)=>(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(u,{widgetsInfoInGroup:n,urlParamsWidgetsInManifest:g,idx:s,handWidgetSettingClick:G,handEnableChange:v})},s))},Y)}),(0,e.jsx)(i.SettingSection,{className:"px-0 mx-1",children:(0,e.jsx)(n.CollapsablePanel,{label:ee,"aria-label":ee,role:"group",className:"collapsable-wrapper px-0",defaultIsOpen:A(),disabled:!A(),children:A()&&N().map(t=>{var n;const s=t.pageInfo.id,i=t.pageInfo.label;return(null===(n=t.widgetsInfo)||void 0===n?void 0:n.length)>0?(0,e.jsx)(T,{label:i,"aria-label":i,className:"collapsable-item-section",children:(0,e.jsx)(u,{widgetsInfoInGroup:t,urlParamsWidgetsInManifest:g,idx:s,handWidgetSettingClick:G,handEnableChange:v})},s):null})},ee)}),(0,e.jsx)(i.SettingSection,{className:"px-0 mx-1",children:(0,e.jsx)(n.CollapsablePanel,{label:te,"aria-label":te,role:"group",className:"collapsable-wrapper px-0",defaultIsOpen:E("Footer"),disabled:!E("Footer"),children:E("Footer")&&k("Footer").map((n,s)=>(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(u,{widgetsInfoInGroup:n,urlParamsWidgetsInManifest:g,idx:s,handWidgetSettingClick:G,handEnableChange:v})},s))},te)})]})]}),(0,e.jsxs)(n.Tab,{id:"dialog",title:p("dialog"),className:"w-50 ",children:[(0,e.jsx)(m,{active:W===L.Dialog,onSearch:C}),!q&&V(),q&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(i.SettingSection,{className:"px-0 mx-1 pt-1",children:(0,e.jsx)(n.CollapsablePanel,{label:ne,"aria-label":ne,role:"group",className:"collapsable-wrapper px-0",defaultIsOpen:_(t.DialogMode.Fixed),disabled:!_(t.DialogMode.Fixed),children:_(t.DialogMode.Fixed)&&P(t.DialogMode.Fixed).map(t=>{var n;const s=t.dialogInfo.id,i=t.dialogInfo.label;return(null===(n=t.widgetsInfo)||void 0===n?void 0:n.length)>0?(0,e.jsx)(T,{label:i,"aria-label":i,className:"collapsable-item-section",children:(0,e.jsx)(u,{widgetsInfoInGroup:t,urlParamsWidgetsInManifest:g,idx:s,handWidgetSettingClick:G,handEnableChange:v})},s):null})},ne)}),(0,e.jsx)(i.SettingSection,{className:"px-0 mx-1",children:(0,e.jsx)(n.CollapsablePanel,{label:se,"aria-label":se,role:"group",className:"collapsable-wrapper px-0",defaultIsOpen:_(t.DialogMode.Anchored),disabled:!_(t.DialogMode.Anchored),children:_(t.DialogMode.Anchored)&&P(t.DialogMode.Anchored).map(t=>{var n;const s=t.dialogInfo.id,i=t.dialogInfo.label;return(null===(n=t.widgetsInfo)||void 0===n?void 0:n.length)>0?(0,e.jsx)(T,{label:i,"aria-label":i,className:"collapsable-item-section",children:(0,e.jsx)(u,{widgetsInfoInGroup:t,urlParamsWidgetsInManifest:g,idx:s,handWidgetSettingClick:G,handEnableChange:v})},s):null})},se)})]})]})]})})]})]}),H&&(0,e.jsx)(n.Popper,{open:H,toggle:e=>{(0,t.focusElementInKeyboardMode)(U.current),U.current=null,F(null)},reference:U,placement:"bottom",arrowOptions:!0,children:null===(d=null===(c=null===(l=g[D.widgetId])||void 0===l?void 0:l.manifest)||void 0===c?void 0:c.urlParameters)||void 0===d?void 0:d.map(t=>(0,e.jsxs)(i.SettingRow,{tag:"label",label:t.label,className:"m-4",children:[t.tooltip&&(0,e.jsx)(n.Tooltip,{placement:"right",title:t.tooltip,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,children:(0,e.jsx)(M,{})})}),(0,e.jsx)(n.Switch,{checked:w(D.widgetId,t.name),onChange:e=>{((e,t)=>{const n=!w(e,t);o.UrlConfigManager.getInstance().updateWidgetParamEnable(e,t,n)})(D.widgetId,t.name)},className:"ml-2",disabled:!D.isEnable})]},t.name))})]})}!function(e){e.Page="page",e.Dialog="dialog"}(L||(L={}));var G;p(1496);!function(e){e[e.BringForward=0]="BringForward",e[e.SendBackward=1]="SendBackward",e[e.BringToFront=2]="BringToFront",e[e.SendToBack=3]="SendToBack"}(G||(G={}));var H,W;function $(e,n,s){var i,a,o,r,l,c,d,u,p,h;const{layoutId:g}=e,m=n.layouts[g];switch(null===(i=null==m?void 0:m.parent)||void 0===i?void 0:i.type){case t.LayoutParentType.View:{const e=n.views[m.parent.id],t=n.sections[e.parent];return 1===(null===(o=null===(a=null==t?void 0:t.parent)||void 0===a?void 0:a[s])||void 0===o?void 0:o.length)?t.parent[s][0]:(null===(l=null===(r=null==t?void 0:t.parent)||void 0===r?void 0:r[s])||void 0===l?void 0:l.length)>1?$(t.parent[s][0],n,s):null}case t.LayoutParentType.Widget:{const e=n.widgets[m.parent.id];return 1===(null===(d=null===(c=null==e?void 0:e.parent)||void 0===c?void 0:c[s])||void 0===d?void 0:d.length)?e.parent[s][0]:(null===(p=null===(u=null==e?void 0:e.parent)||void 0===u?void 0:u[s])||void 0===p?void 0:p.length)>1?$(e.parent[s][0],n,s):null}case t.LayoutParentType.Screen:{const e=n.screens[m.parent.id];return null===(h=n.screenGroups[e.parent].parent)||void 0===h?void 0:h[s]}default:return null}}function q(e,n,s){var i;let a=e.layouts[n];for(;(null==a?void 0:a.parent)&&[t.LayoutParentType.Screen,t.LayoutParentType.View,t.LayoutParentType.Widget].includes(a.parent.type);){const t=$({layoutId:n},e,s);n=null==t?void 0:t.layoutId,a=e.layouts[n]}switch(null===(i=null==a?void 0:a.parent)||void 0===i?void 0:i.type){case t.LayoutParentType.Dialog:return{type:t.ContainerType.Dialog,id:a.parent.id};case t.LayoutParentType.Page:return{type:t.ContainerType.Page,id:a.parent.id};case t.LayoutParentType.Header:return{type:t.ContainerType.Header,id:"header"};case t.LayoutParentType.Footer:return{type:t.ContainerType.Footer,id:"footer"};default:return null}}!function(e){e.Auto="auto",e[e.Normal=0]="Normal",e[e.BoundaryDropArea=10]="BoundaryDropArea",e[e.DragMoveTip=20]="DragMoveTip",e[e.HandlerTools=30]="HandlerTools",e[e.DraggingItem=40]="DraggingItem"}(H||(H={})),function(e){e.Auto="AUTO",e.Stretch="STRETCH",e.Custom="CUSTOM"}(W||(W={}));(0,t.createSelector)([e=>e.appConfig.mainSizeMode,e=>e.browserSizeMode,(e,n)=>{var s,i,a,o,r;let l;if(e.browserSizeMode===e.appConfig.mainSizeMode)l=!0;else{let o;(null===(s=n.layouts)||void 0===s?void 0:s[e.browserSizeMode])?o=e.browserSizeMode:(null===(i=n.layouts)||void 0===i?void 0:i[e.appConfig.mainSizeMode])&&(o=e.appConfig.mainSizeMode);const r=null===(a=n.layouts)||void 0===a?void 0:a[o],c=q(e.appConfig,r,o);if((null==c?void 0:c.type)===t.ContainerType.Header)l=null!=e.appConfig.header.layout[e.browserSizeMode];else if((null==c?void 0:c.type)===t.ContainerType.Footer)l=null!=e.appConfig.footer.layout[e.browserSizeMode];else if((null==c?void 0:c.type)===t.ContainerType.Dialog){l=null!=e.appConfig.dialogs[c.id].layout[e.browserSizeMode]}else if((null==c?void 0:c.type)===t.ContainerType.Page){l=null!=e.appConfig.pages[c.id].layout[e.browserSizeMode]}}if(l&&(null===(o=n.layouts)||void 0===o?void 0:o[e.browserSizeMode])){const t=n.layouts[e.browserSizeMode];return e.appConfig.layouts[t]}const c=null===(r=n.layouts)||void 0===r?void 0:r[e.appConfig.mainSizeMode];return e.appConfig.layouts[c]}],(e,t,n)=>({mainSizeMode:e,browserSizeMode:t,layout:n})),(0,t.createSelector)([(e,t)=>{var n,s,i;const{layoutId:a,layoutItemId:o}=t;return null===(i=null===(s=null===(n=e.appConfig.layouts)||void 0===n?void 0:n[a])||void 0===s?void 0:s.content)||void 0===i?void 0:i[o]},(e,n)=>{var s,i,a,o,r,l;const{layoutId:c,layoutItemId:d}=n,u=null===(a=null===(i=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[c])||void 0===i?void 0:i.content)||void 0===a?void 0:a[d];if((null==u?void 0:u.type)===t.LayoutItemType.Widget&&u.widgetId){const t=e.appConfig.widgets[u.widgetId];return null!==(l=null===(r=null===(o=null==t?void 0:t.manifest)||void 0===o?void 0:o.properties)||void 0===r?void 0:r.watchViewportVisibility)&&void 0!==l&&l}return!1},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.selection},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.animationPreview},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.hoverPreview},(e,t)=>t.layoutId],(e,t,n,s,i,a)=>{var o;if(!e)return{layoutItem:null,selected:!1};let r=!1;const l=null!==(o=e.isPending)&&void 0!==o&&o;n&&(r=n.layoutId===a&&n.layoutItemId===e.id);const c={selected:r,watchViewportVisibility:t,layoutItem:l?null:e,autoScroll:r?n.autoScroll:void 0};if(r&&(null==s?void 0:s.layoutInfo)){const{layoutId:t,layoutItemId:n}=s.layoutInfo;c.animationPreview=t===a&&n===e.id,c.playMode=c.animationPreview?s.playMode:null,c.previewId=c.animationPreview?s.id:null}else if(r&&(null==i?void 0:i.layoutInfo)){const{layoutId:t,layoutItemId:n}=i.layoutInfo;c.hoverPreview=t===a&&n===e.id,c.previewId=c.hoverPreview?i.id:null}return c}),(0,t.createSelector)([(e,n)=>{var s,i,a;const{layoutId:o,layoutItemId:r}=n,l=null===(a=null===(i=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[o])||void 0===i?void 0:i.content)||void 0===a?void 0:a[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&l.widgetId)return e.appConfig.widgets[l.widgetId]},(e,n)=>{var s,i,a,o;const{layoutId:r,layoutItemId:l}=n,c=null===(a=null===(i=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[r])||void 0===i?void 0:i.content)||void 0===a?void 0:a[l];if((null==c?void 0:c.type)===t.LayoutItemType.Widget&&!c.widgetId)return null===(o=c.setting)||void 0===o?void 0:o.placeholderStyle},(e,n)=>{var s,i,a;const{layoutId:o,layoutItemId:r}=n,l=null===(a=null===(i=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[o])||void 0===i?void 0:i.content)||void 0===a?void 0:a[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&l.widgetId)return e.widgetsRuntimeInfo[l.widgetId]},(e,n)=>{var s,i,a;const{layoutId:o,layoutItemId:r}=n,l=null===(a=null===(i=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[o])||void 0===i?void 0:i.content)||void 0===a?void 0:a[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&!l.widgetId)return e.widgetsState[l.widgetId]},(e,n)=>{var s,i;const{layoutId:a}=n,o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[a];if((null===(i=o.parent)||void 0===i?void 0:i.type)===t.LayoutParentType.Widget){const t=o.parent.id,n=e.appConfig.widgets[t];return/widgets\/common\/controller\/?/.test(n.uri)}return!1}],(e,n,s,i,a)=>{var o,r,l,c,d,u,p,h,g,m,f,v,w,b,x,y,S,j,I;const T=null===(r=null===(o=null==e?void 0:e.manifest)||void 0===o?void 0:o.properties)||void 0===r?void 0:r.supportInlineEditing;return{hasEmbeddedLayout:(null===(c=null===(l=null==e?void 0:e.manifest)||void 0===l?void 0:l.properties)||void 0===c?void 0:c.hasEmbeddedLayout)&&Object.keys(null!==(d=e.layouts)&&void 0!==d?d:{}).length>0,supportInlineEditing:T,supportRepeat:null===(p=null===(u=null==e?void 0:e.manifest)||void 0===u?void 0:u.properties)||void 0===p?void 0:p.supportRepeat,isClassLoaded:null!==(h=null==s?void 0:s.isClassLoaded)&&void 0!==h&&h,isInlineEditing:T&&(null==s?void 0:s.isInlineEditing),isInController:a,useDragHandler:null!==(f=null===(m=null===(g=null==e?void 0:e.manifest)||void 0===g?void 0:g.properties)||void 0===m?void 0:m.useDragHandler)&&void 0!==f&&f,widgetStyle:null!=e?e.style:n,canCrossLayoutBoundary:null===(w=null===(v=null==e?void 0:e.manifest)||void 0===v?void 0:v.properties)||void 0===w?void 0:w.canCrossLayoutBoundary,hasExtension:(null===(x=null===(b=null==e?void 0:e.manifest)||void 0===b?void 0:b.extensions)||void 0===x?void 0:x.length)>0,needHiddenState:null!==(j=null===(S=null===(y=null==e?void 0:e.manifest)||void 0===y?void 0:y.properties)||void 0===S?void 0:S.needHiddenState)&&void 0!==j&&j,widgetJson:e,widgetId:null==e?void 0:e.id,isFunctionalWidget:(null===(I=null==e?void 0:e.manifest)||void 0===I?void 0:I.widgetType)!==t.WidgetType.Layout,widgetState:i}});var V;!function(e){e.GENERAL="GENERAL"}(V||(V={}));function K(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;function J(e){return Object.keys(e).some(t=>{let n=e[t];if(!n)return!1;n&&n.toParam&&(n=n.toParam());switch(n.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function X(e){const t={};return Object.keys(e).forEach(n=>{var s,i;let a=e[n];if(a&&a.toParam&&(a=a.toParam()),!a&&0!==a&&"boolean"!=typeof a&&"string"!=typeof a)return;let o;switch(a.constructor.name){case"Array":const e=null===(i=null===(s=a[0])||void 0===s?void 0:s.constructor)||void 0===i?void 0:i.name;o="Array"===e?a:"Object"===e?JSON.stringify(a):a.join(",");break;case"Object":o=JSON.stringify(a);break;case"Date":o=a.valueOf();break;case"Function":o=null;break;case"Boolean":o=a+"";break;default:o=a}(o||0===o||"string"==typeof o||Array.isArray(o))&&(t[n]=o)}),t}function Z(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map(t=>Z(e,t)).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function Q(e){const t=X(e);return Object.keys(t).map(e=>Z(e,t[e])).join("&")}const Y=globalThis.FormData;globalThis.File,globalThis.Blob;class ee extends Error{constructor(e,t,n,s,i){super(e);const a=new.target.prototype;Object.setPrototypeOf(this,a),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=n,this.url=s,this.options=i}}const te={noCorsDomains:[],crossOriginNoCorsDomains:{},pendingNoCorsRequests:{}},ne="ARCGIS_REST_JS_NO_CORS";globalThis[ne]||(globalThis[ne]=Object.assign({},te));const se=globalThis[ne];function ie(e){const t=new URL(e).origin;-1===se.noCorsDomains.indexOf(t)&&se.noCorsDomains.push(t)}function ae(e){let t=!1;if(se.noCorsDomains.length){const n=new URL(e).origin.toLowerCase();t=se.noCorsDomains.some(e=>n.includes(e))}return t}const oe="@esri/arcgis-rest-js";class re extends ee{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",n,s,i){super(e,t,n,s,i),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const a=new.target.prototype;Object.setPrototypeOf(this,a)}retry(e,t=1){let n=0;const s=(i,a)=>{n+=1,e(this.url,this.options).then(e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return le(this.url,t)}).then(e=>{i(e)}).catch(e=>{"ArcGISAuthError"===e.name&&n<t?s(i,a):e.name===this.name&&e.message===this.message&&n>=t?a(this):a(e)})};return new Promise((e,t)=>{s(e,t)})}}function le(e,t){const n=globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}},s=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},n),t),{params:Object.assign(Object.assign({},n.params),t.params),headers:Object.assign(Object.assign({},n.headers),t.headers)}),{httpMethod:i,rawResponse:a}=s,o=Object.assign({f:"json"},s.params);let r=null;const l={method:i,signal:s.signal,credentials:s.credentials||"same-origin"};let c;if(ae(e)&&(l.credentials="include"),s.headers&&s.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include"),"string"==typeof s.authentication){const e=s.authentication;c={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},s.authentication.startsWith("AAPK")||s.authentication.startsWith("AAPT")||s.authentication.startsWith("AATK")||s.authentication.startsWith("AAST")||s.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||(d="Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information.",console&&console.warn&&console.warn.apply(console,[d]),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else c=s.authentication;var d;const u=e;let p=!1;"undefined"!=typeof window&&(p=function(e,t){var n;if((t||window)&&e){const s=null===(n=(t=t||window).location)||void 0===n?void 0:n.origin;return e.startsWith(s)}return!1}(e));const h=!p&&function(e){let t=!1;if(ae(e)){const n=new URL(e).origin.toLowerCase(),s=se.crossOriginNoCorsDomains[n]||0;Date.now()-36e5>s&&(t=!0)}return t}(e);s.headers&&s.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include");let g=Promise.resolve();return h&&(l.credentials="include",g=function(e){const t=new URL(e);e=t.origin+t.pathname,t.search.includes("f=json")&&(e+="?f=json");const n=t.origin;return se.pendingNoCorsRequests[n]||(se.pendingNoCorsRequests[n]=fetch(e,{mode:"no-cors",credentials:"include",cache:"no-store"}).then(e=>{-1===se.noCorsDomains.indexOf(n)&&se.noCorsDomains.push(n),se.crossOriginNoCorsDomains[n.toLowerCase()]=Date.now(),delete se.pendingNoCorsRequests[n]}).catch(e=>(delete se.pendingNoCorsRequests[n],Promise.reject(new Error(`no-cors request to ${n} failed`))))),se.pendingNoCorsRequests[n]}(e)),g.then(()=>c?c.getToken(e).catch(t=>(t.url=e,t.options=s,r=t,Promise.resolve(""))):Promise.resolve("")).then(t=>{t.length&&(o.token=t),c&&c.getDomainCredentials&&(l.credentials=c.getDomainCredentials(e));const n={};if("GET"===l.method){o.token&&s.hideToken&&"undefined"==typeof window&&(n["X-Esri-Authorization"]=`Bearer ${o.token}`,delete o.token);const i=""===Q(o)?e:e+"?"+Q(o);s.maxUrlLength&&i.length>s.maxUrlLength||!s.maxUrlLength&&i.length>2e3||o.token&&s.hideToken?(l.method="POST",t.length&&s.hideToken&&(o.token=t,delete n["X-Esri-Authorization"])):e=i}const i=new RegExp("/items/.+/updateResources").test(e);return"POST"===l.method&&(l.body=function(e,t){const n=J(e)||t,s=X(e);if(n){const e=new Y;return Object.keys(s).forEach(t=>{if("undefined"!=typeof Blob&&s[t]instanceof Blob){const n=s.fileName||s[t].name||t;e.append(t,s[t],n)}else e.append(t,s[t])}),e}return Q(e)}(o,i)),l.headers=Object.assign(Object.assign({},n),s.headers),("undefined"==typeof window||window&&void 0===window.document)&&!l.headers.referer&&(l.headers.referer=oe),J(o)||i||(l.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,l):Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.Request}).then(({fetch:t})=>t(e,l))}).then(t=>{if(!t.ok)return t.json().then(n=>{const{status:i,statusText:a}=t,{message:o,details:r}=n.error,l=`${o}. ${r?r.join(" "):""}`.trim();throw new ee(l,`HTTP ${i} ${a}`,n,e,s)}).catch(n=>{if("ArcGISRequestError"===n.name)throw n;const{status:i,statusText:a}=t;throw new ee(a,`HTTP ${i}`,t,e,s)});if(a)return t;switch(o.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}}).then(t=>{if("json"!==o.f&&"geojson"!==o.f||a)return t;{const n=function(e,t,n,s,i){if(e.code>=400){const{message:n,code:i}=e;throw new ee(n,i,e,t,s)}if(e.error){const{message:n,code:a,messageCode:o}=e.error,r=o||a||"UNKNOWN_ERROR_CODE";if(498===a||499===a)throw i||new re(n,r,e,t,s);throw new ee(n,r,e,t,s)}if("failed"===e.status||"failure"===e.status){let n,i="UNKNOWN_ERROR_CODE";try{n=JSON.parse(e.statusMessage).message,i=JSON.parse(e.statusMessage).code}catch(t){n=e.statusMessage||e.message}throw new ee(n,i,e,t,s)}return e}(t,u,0,s,r);if(t&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(e)&&Array.isArray(t.authorizedCrossOriginNoCorsDomains)&&t.authorizedCrossOriginNoCorsDomains.forEach(e=>{e=e.toLowerCase(),/^https?:\/\//.test(e)?ie(e):(ie("http://"+e),ie("https://"+e))}),r){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];s.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},r=null}return n}})}function ce(e,t={params:{f:"json"}}){const{request:n}=t,s=K(t,["request"]);return n?n(e,s):le(e,s).catch(e=>e instanceof re&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry(()=>t.authentication.refreshCredentials(),1):Promise.reject(e))}var de,ue;!function(e){e.TOKEN_REFRESH_FAILED="TOKEN_REFRESH_FAILED",e.GENERATE_TOKEN_FOR_SERVER_FAILED="GENERATE_TOKEN_FOR_SERVER_FAILED",e.REFRESH_TOKEN_EXCHANGE_FAILED="REFRESH_TOKEN_EXCHANGE_FAILED",e.NOT_FEDERATED="NOT_FEDERATED",e.UNKNOWN_ERROR_CODE="UNKNOWN_ERROR_CODE"}(de||(de={}));class pe extends Error{constructor(e="UNKNOWN_ERROR",t=de.UNKNOWN_ERROR_CODE,n,s,i){super(e);const a=new.target.prototype;Object.setPrototypeOf(this,a),this.name="ArcGISTokenRequestError",this.message=`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=n,this.url=s,this.options=i}}class he extends Error{constructor(){super("The user has denied your authorization request.");const e=new.target.prototype;Object.setPrototypeOf(this,e),this.name="ArcGISAccessDeniedError"}}Error;function ge(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}!function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError",e.ArcGISAccessDeniedError="ArcGISAccessDeniedError",e.ArcGISTokenRequestError="ArcGISTokenRequestError"}(ue||(ue={}));const me=3e5;function fe(e,t){const n=t;return n.rawResponse=!1,ce(e,n).then(e=>{if("token"in e&&"expires"in e)return{token:e.token,username:t.params.username,expires:new Date(e.expires)};const n={token:e.access_token,username:e.username,expires:new Date(Date.now()+1e3*e.expires_in-me),ssl:!0===e.ssl};return e.refresh_token&&(n.refreshToken=e.refresh_token),e.refresh_token_expires_in&&(n.refreshTokenExpires=new Date(Date.now()+1e3*e.refresh_token_expires_in-me)),n})}class ve{constructor(e){this.portal=e.portal?ge(e.portal):"https://www.arcgis.com/sharing/rest",this._username=e.username}get username(){return this._username?this._username:this._user&&this._user.username?this._user.username:void 0}getUsername(){return this.username?Promise.resolve(this.username):this.getUser().then(e=>e.username)}getUser(e){if(this._pendingUserRequest)return this._pendingUserRequest;if(this._user)return Promise.resolve(this._user);{const t=`${this.portal}/community/self`,n=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingUserRequest=ce(t,n).then(e=>(this._user=e,this._pendingUserRequest=null,e)),this._pendingUserRequest}}clearCachedUserInfo(){this._user=null}}function we(e){return!e||e.length<=0?{}:e.replace(/^#/,"").replace(/^\?/,"").split("&").reduce((e,t)=>{const{key:n,value:s}=function(e){const[t,n]=e.split("=");return{key:decodeURIComponent(t),value:decodeURIComponent(n)}}(t);return e[n]=s,e},{})}const be=/^https?:\/\/(\S+)\.arcgis\.com.+/;function xe(e){return be.test(e)}function ye(e){if(!be.test(e))return null;const t=e.match(be)[1].split(".").pop();return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}function Se(e,t){const n=ge(function(e){if(!be.test(e))return e;switch(ye(e)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}(t)).replace(/https?:\/\//,""),s=ge(e).replace(/https?:\/\//,"");return new RegExp(s,"i").test(n)}function je(e,t=window){return!t&&window&&(t=window),t.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Ie(e){!e&&window&&(e=window);return je(e.crypto.getRandomValues(new Uint8Array(32)))}function Te(e,t,n){return"string"!=typeof t&&t?JSON.stringify(Object.assign({id:e},t)):JSON.stringify({id:e,originalUrl:n})}class Re extends ve{constructor(e){if(super(e),this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?ge(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.server=e.server,this.referer=e.referer,this.state=e.state,this.federatedServers={},this.trustedDomains=[],e.server){const t=this.getServerRootUrl(e.server);this.federatedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}get token(){return this._token}get tokenExpires(){return this._tokenExpires}get refreshToken(){return this._refreshToken}get refreshTokenExpires(){return this._refreshTokenExpires}get canRefresh(){return!(!this.username||!this.password)||!!(this.clientId&&this.refreshToken&&this.redirectUri)}static beginOAuth2(e,t){!t&&window&&(t=window);const{portal:n,provider:s,clientId:i,expiration:a,redirectUri:o,popup:r,popupWindowFeatures:l,locale:c,params:d,style:u,pkce:p,state:h}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:!0,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",locale:"",style:"",pkce:!0},e),g=function(e,t){return"string"==typeof e?e:"object"==typeof e?e.id:Ie(t)}(h,t),m=`ARCGIS_REST_JS_AUTH_STATE_${i}`;t.localStorage.setItem(m,g);let f=`${ge(n)}/oauth2/authorize`;const v={client_id:i,response_type:p?"code":"token",expiration:a,redirect_uri:o,state:Te(g,h,t.location.href),locale:c,style:u};let w;if("arcgis"!==s&&(f=`${ge(n)}/oauth2/social/authorize`,v.socialLoginProviderName=s,v.autoAccountCreateForSocial=!0),p){const e=Ie(t),n=`ARCGIS_REST_JS_CODE_VERIFIER_${i}`;t.localStorage.setItem(n,e),w=function(e,t=window){if(!t&&window&&(t=window),e&&t.isSecureContext&&t.crypto&&t.crypto.subtle){const n=(new t.TextEncoder).encode(e);return t.crypto.subtle.digest("SHA-256",n).then(e=>je(new Uint8Array(e),t))}return Promise.resolve(null)}(e,t).then(function(t){v.code_challenge_method=t?"S256":"plain",v.code_challenge=t||e})}else w=Promise.resolve();return w.then(()=>(f=`${f}?${Q(v)}`,d&&(f=`${f}&${Q(d)}`),r?new Promise((e,s)=>{t.addEventListener(`arcgis-rest-js-popup-auth-${i}`,t=>{if("access_denied"===t.detail.error){const e=new he;return s(e),e}if(t.detail.errorMessage){const e=new re(t.detail.errorMessage,t.detail.error);return s(e),e}e(new Re({clientId:i,portal:n,ssl:t.detail.ssl,token:t.detail.token,tokenExpires:t.detail.expires,username:t.detail.username,refreshToken:t.detail.refreshToken,refreshTokenExpires:t.detail.refreshTokenExpires,redirectUri:o,state:t.detail.state}))},{once:!0}),t.open(f,"oauth-window",l),t.dispatchEvent(new CustomEvent("arcgis-rest-js-popup-auth-start"))}):void(t.location.href=f)))}static completeOAuth2(e,t){!t&&window&&(t=window);const{portal:n,clientId:s,popup:i,pkce:a,redirectUri:o}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",popup:!0,pkce:!0},e),r=`ARCGIS_REST_JS_AUTH_STATE_${s}`,l=t.localStorage.getItem(r),c=we(a?t.location.search.replace(/^\?/,""):t.location.hash.replace(/^#/,"")),d=c&&c.state?JSON.parse(c.state):void 0;function u(e,n,a){return t.localStorage.removeItem(r),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:{error:n,errorMessage:e}})),void t.close()):(a&&t.history.replaceState(t.history.state,"",a),"access_denied"===n?Promise.reject(new he):Promise.reject(new re(e,n)))}function p(e,a){return t.localStorage.removeItem(r),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:Object.assign(Object.assign({},e),{state:a})})),void t.close()):(a.originalUrl&&t.history.replaceState(t.history.state,"",a.originalUrl),new Re({clientId:s,portal:n,ssl:e.ssl,token:e.token,tokenExpires:e.expires,username:e.username,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:o||location.href.replace(location.search,""),state:a}))}if(!l||!d)return u("No authentication state was found, call `ArcGISIdentityManager.beginOAuth2(...)` to start the authentication process.","no-auth-state");if(d.id!==l)return u("Saved client state did not match server sent state.","mismatched-auth-state");if(c.error){const e=c.error;return u(c.error_description||"Unknown error",e,d.originalUrl)}if(a&&c.code){const e=ge(`${n}/oauth2/token/`),i=`ARCGIS_REST_JS_CODE_VERIFIER_${s}`,a=t.localStorage.getItem(i);return t.localStorage.removeItem(i),fe(e,{httpMethod:"POST",params:{client_id:s,code_verifier:a,grant_type:"authorization_code",redirect_uri:o||location.href.replace(location.search,""),code:c.code}}).then(e=>p(Object.assign(Object.assign({},e),d),d)).catch(e=>u(e.originalMessage,e.code,d.originalUrl))}return!a&&c.access_token?Promise.resolve(p(Object.assign({token:c.access_token,expires:new Date(Date.now()+1e3*parseInt(c.expires_in,10)),ssl:"true"===c.ssl,username:c.username},d),d)):u("Unknown error","oauth-error",d.originalUrl)}static fromParent(e,t){let n;return!t&&window&&(t=window),new Promise((s,i)=>{n=e=>{if(e.source===t.parent&&e.data)try{return s(Re.parentMessageHandler(e))}catch(e){return i(e)}},t.addEventListener("message",n,!1),t.parent.postMessage({type:"arcgis:auth:requestCredential"},e)}).then(e=>(t.removeEventListener("message",n,!1),e))}static authorize(e,t){const{portal:n,clientId:s,expiration:i,redirectUri:a,state:o}=Object.assign({portal:"https://arcgis.com/sharing/rest",expiration:20160},e),r={client_id:s,expiration:i,response_type:"code",redirect_uri:a};o&&(r.state=o);const l=`${n}/oauth2/authorize?${Q(r)}`;t.writeHead(301,{Location:l}),t.end()}static exchangeAuthorizationCode(e,t){const{portal:n,clientId:s,redirectUri:i}=Object.assign({portal:"https://www.arcgis.com/sharing/rest"},e);return fe(`${n}/oauth2/token`,{params:{grant_type:"authorization_code",client_id:s,redirect_uri:i,code:t}}).then(e=>new Re({clientId:s,portal:n,ssl:e.ssl,redirectUri:i,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,token:e.token,tokenExpires:e.expires,username:e.username})).catch(e=>{throw new pe(e.message,de.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}static deserialize(e){const t=JSON.parse(e);return new Re({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:t.refreshTokenExpires?new Date(t.refreshTokenExpires):void 0,username:t.username,password:t.password,token:t.token,tokenExpires:t.tokenExpires?new Date(t.tokenExpires):void 0,portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,server:t.server})}static fromCredential(e,t){const n=void 0===e.ssl||e.ssl,s=e.expires||Date.now()+72e5;return t.hasServer?new Re({server:e.server,ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(s)}):new Re({portal:ge(e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest"),ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(s)})}static parentMessageHandler(e){if("arcgis:auth:credential"===e.data.type){const t=e.data.credential;return function(e){return"string"==typeof e.userId||"number"==typeof e.expires}(t)?Re.fromCredential(t,{hasPortal:!0,hasServer:!1,server:t.server}):new Re(t)}if("arcgis:auth:error"===e.data.type){const t=new Error(e.data.error.message);throw t.name=e.data.error.name,t}throw new Error("Unknown message type.")}static destroy(e){return function(e){const t=`${ge(e.portal||"https://www.arcgis.com/sharing/rest")}/oauth2/revokeToken/`,n=e.token,s=e.clientId;delete e.portal,delete e.clientId,delete e.token;const i=Object.assign(Object.assign({},e),{httpMethod:"POST",params:{client_id:s,auth_token:n}});return ce(t,i).then(e=>{if(!e.success)throw new ee("Unable to revoke token",500,e,t,i);return e})}({clientId:e.clientId,portal:e.portal,token:e.refreshToken||e.token})}static fromToken(e){const t=new Re(e);return t.getUser().then(()=>t)}static signIn(e){const t=new Re(e);return t.getUser().then(()=>t)}toCredential(){return{expires:this.tokenExpires.getTime(),server:this.server||this.portal,ssl:this.ssl,token:this.token,userId:this.username}}getPortal(e){if(this._pendingPortalRequest)return this._pendingPortalRequest;if(this._portalInfo)return Promise.resolve(this._portalInfo);{const t=`${this.portal}/portals/self`,n=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingPortalRequest=ce(t,n).then(e=>(this._portalInfo=e,this._pendingPortalRequest=null,e)),this._pendingPortalRequest}}getToken(e,t){return function(e,t){const n=xe(e),s=xe(t),i=ye(e),a=ye(t);return!(!n||!s||i!==a)}(this.portal,e)||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)}validateAppAccess(e){return this.getToken(this.portal).then(t=>function(e,t,n="https://www.arcgis.com/sharing/rest"){return ce(`${n}/oauth2/validateAppAccess`,{method:"POST",params:{f:"json",client_id:t,token:e}})}(t,e))}toJSON(){return{type:"ArcGISIdentityManager",clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires||void 0,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires||void 0,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,server:this.server}}serialize(){return JSON.stringify(this)}enablePostMessageAuth(e,t){!t&&window&&(t=window),this._hostHandler=this.createPostMessageHandler(e),t.addEventListener("message",this._hostHandler,!1)}disablePostMessageAuth(e){!e&&window&&(e=window),e.removeEventListener("message",this._hostHandler,!1)}refreshCredentials(e){return this.clearCachedUserInfo(),this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new pe("Unable to refresh token. No refresh token or password present.",de.TOKEN_REFRESH_FAILED))}getServerRootUrl(e){const[t]=ge(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/),[n,s,i]=t.match(/(https?:\/\/)(.+)/),[a,...o]=i.split("/");return`${s}${a.toLowerCase()}/${o.join("/")}`}getDomainCredentials(e){return this.trustedDomains&&this.trustedDomains.length?(e=e.toLowerCase(),this.trustedDomains.some(t=>e.startsWith(t.toLowerCase()))?"include":"same-origin"):"same-origin"}signOut(){return Re.destroy(this)}createPostMessageHandler(e){return t=>{const n=e.indexOf(t.origin)>-1,s="arcgis:auth:requestCredential"===t.data.type,i=this.tokenExpires.getTime()>Date.now();if(n&&s){let e={};if(i){const t=this.toCredential();t.server=t.server.replace("/sharing/rest",""),e={type:"arcgis:auth:credential",credential:t}}else e={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Token was expired, and not returned to the child application"}};t.source.postMessage(e,t.origin)}}}getTokenForServer(e,t){const n=this.getServerRootUrl(e),s=this.federatedServers[n];return s&&s.expires&&s.expires.getTime()>Date.now()?Promise.resolve(s.token):(this._pendingTokenRequests[n]||(this._pendingTokenRequests[n]=this.fetchAuthorizedDomains().then(()=>ce(`${n}/rest/info`,{credentials:this.getDomainCredentials(e)}).then(s=>{if(s.owningSystemUrl){if(Se(s.owningSystemUrl,this.portal))return ce(`${s.owningSystemUrl}/sharing/rest/info`,t);throw new pe(`${e} is not federated with ${this.portal}.`,de.NOT_FEDERATED)}if(s.authInfo&&void 0!==this.federatedServers[n])return Promise.resolve({authInfo:s.authInfo});throw new pe(`${e} is not federated with any portal and is not explicitly trusted.`,de.NOT_FEDERATED)}).then(e=>this.token&&this.tokenExpires.getTime()<Date.now()?this.server?this.refreshCredentials().then(()=>({token:this.token,expires:this.tokenExpires})):this.refreshCredentials().then(()=>this.generateTokenForServer(e.authInfo.tokenServicesUrl,n)):this.generateTokenForServer(e.authInfo.tokenServicesUrl,n)).then(e=>(this.federatedServers[n]=e,delete this._pendingTokenRequests[n],e.token)))),this._pendingTokenRequests[n])}generateTokenForServer(e,t){return ce(e,{params:{token:this.token,serverUrl:t,expiration:this.tokenDuration}}).then(e=>({token:e.token,expires:new Date(e.expires-3e5)})).catch(e=>{throw new pe(e.message,de.GENERATE_TOKEN_FOR_SERVER_FAILED,e.response,e.url,e.options)})}getFreshToken(e){return this.token&&!this.tokenExpires||this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshCredentials(e).then(()=>(this._pendingTokenRequests[this.portal]=null,this.token))),this._pendingTokenRequests[this.portal])}refreshWithUsernameAndPassword(e){const t={username:this.username,password:this.password,expiration:this.tokenDuration,client:"referer",referer:this.referer?this.referer:"undefined"!=typeof window&&void 0!==window.document&&window.location&&window.location.origin?window.location.origin:oe};return(this.server?ce(`${this.getServerRootUrl(this.server)}/rest/info`).then(n=>ce(n.authInfo.tokenServicesUrl,Object.assign({params:t},e))):ce(`${this.portal}/generateToken`,Object.assign({params:t},e))).then(e=>(this.updateToken(e.token,new Date(e.expires)),this)).catch(e=>{throw new pe(e.message,de.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}refreshWithRefreshToken(e){if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()-864e5<Date.now())return this.exchangeRefreshToken(e);const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e);return fe(`${this.portal}/oauth2/token`,t).then(e=>this.updateToken(e.token,e.expires)).catch(e=>{throw new pe(e.message,de.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}updateToken(e,t){return this._token=e,this._tokenExpires=t,this}exchangeRefreshToken(e){const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e);return fe(`${this.portal}/oauth2/token`,t).then(e=>(this._token=e.token,this._tokenExpires=e.expires,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this)).catch(e=>{throw new pe(e.message,de.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}fetchAuthorizedDomains(){return this.server||!this.portal?Promise.resolve(this):this.getPortal().then(e=>(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length&&(this.trustedDomains=e.authorizedCrossOriginDomains.filter(e=>!e.startsWith("http://")).map(e=>e.startsWith("https://")?e:`https://${e}`)),this))}}function Ce(e){return console.log("DEPRECATED:, 'UserSession' is deprecated. Use 'ArcGISIdentityManager' instead."),new Re(e)}var ke;Ce.beginOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.beginOAuth2' is deprecated. Use 'ArcGISIdentityManager.beginOAuth2' instead."),Re.beginOAuth2(...e)},Ce.completeOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.completeOAuth2()' is deprecated. Use 'ArcGISIdentityManager.completeOAuth2()' instead."),e.length<=1&&console.warn("WARNING:, 'UserSession.completeOAuth2()' is now async and returns a promise the resolves to an instance of `ArcGISIdentityManager`."),Re.completeOAuth2(...e)},Ce.fromParent=function(...e){return console.warn("DEPRECATED:, 'UserSession.fromParent' is deprecated. Use 'ArcGISIdentityManager.fromParent' instead."),Re.fromParent(...e)},Ce.authorize=function(...e){return console.warn("DEPRECATED:, 'UserSession.authorize' is deprecated. Use 'ArcGISIdentityManager.authorize' instead."),Re.authorize(...e)},Ce.exchangeAuthorizationCode=function(...e){return console.warn("DEPRECATED:, 'UserSession.exchangeAuthorizationCode' is deprecated. Use 'ArcGISIdentityManager.exchangeAuthorizationCode' instead."),Re.exchangeAuthorizationCode(...e)},Ce.fromCredential=function(...e){return console.log("DEPRECATED:, 'UserSession.fromCredential' is deprecated. Use 'ArcGISIdentityManager.fromCredential' instead."),console.warn("WARNING:, 'UserSession.fromCredential' now requires a `ServerInfo` object from the JS API as a second parameter."),Re.fromCredential(...e)},Ce.deserialize=function(...e){return console.log("DEPRECATED:, 'UserSession.deserialize' is deprecated. Use 'ArcGISIdentityManager.deserialize' instead."),Re.deserialize(...e)},function(e){e.Success="Succeeded",e.Failed="Failed",e.Waiting="Waiting",e.Cancelled="Cancelled",e.Cancelling="Cancelling",e.New="New",e.Executing="Executing",e.Submitted="Submitted",e.Failure="Failure",e.TimedOut="TimedOut",e.Error="Error",e.Status="Etatus",e.Unknown="Unknown"}(ke||(ke={}));var Ee=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,r)}l((s=s.apply(e,t||[])).next())})};function Oe(e,t){var n;let s=(0,o.getAppConfigAction)().appConfig;s.attributes||(s=s.set("attributes",{}));const i=null===(n=s.attributes)||void 0===n?void 0:n.set(e,t);(0,o.getAppConfigAction)().editAttributes(i).exec()}function Ne(e,t){var n,s;let i=(0,o.getAppConfigAction)().appConfig;i.analytics||(i=i.set("analytics",{}));let a=null;a="string"==typeof e?null===(n=i.analytics)||void 0===n?void 0:n.set(e,t):null===(s=i.analytics)||void 0===s?void 0:s.setIn(e,t),(0,o.getAppConfigAction)().updateAnalyticsConfig(a).exec()}function Ae(e,t){var n,s;let i=(0,o.getAppConfigAction)().appConfig;i.cookieBanner||(i=i.set("cookieBanner",{}));let a=null;a="string"==typeof e?null===(n=i.cookieBanner)||void 0===n?void 0:n.set(e,t):null===(s=i.cookieBanner)||void 0===s?void 0:s.setIn(e,t),(0,o.getAppConfigAction)().updateCookieBannerConfig(a).exec()}function Pe(e,n=!1){var s;o.builderAppSync.publishAppInfoChangeToApp(e);const i={appConfig:null===(s=(0,t.getAppStore)().getState().appStateInBuilder)||void 0===s?void 0:s.appConfig,appInfo:e};n?(0,t.getAppStore)().dispatch(o.appStateHistoryActions.InBuilderReplaceLastAppConfigInHistory(i)):(0,t.getAppStore)().dispatch(o.appStateHistoryActions.InBuilderPutAppConfigIntoHistory(i))}const Me={};const _e={};var Ue=p(9037);const De=t.css`
  padding-top: var(--sys-spacing-4);
  border-top: 1px solid var(--ref-palette-neutral-500);
  .jimu-calcite-timezone {
    --calcite-combobox-input-background-color: var(--sys-color-action-input-field);
    --calcite-combobox-input-border-color: var(--sys-color-action-input-field);
  }
`;function ze(s){const{translate:r,timezone:l={type:t.TimezoneConfig.Device}}=s,c=(0,a.useTheme)(),[d,u]=t.React.useState(null),[p,h]=t.React.useState(l.type===t.TimezoneConfig.Specific?l.value:Be());t.React.useEffect(()=>{var e;null===(e=null===o.helpUtils||void 0===o.helpUtils?void 0:o.helpUtils.getBuildAppsHelpLink("general-settings"))||void 0===e||e.then(e=>{e&&u(e)})},[]),t.React.useEffect(()=>{l.type===t.TimezoneConfig.Specific&&h(l.value)},[l]);const g=e=>{const n=e.target.value,s={type:n};n===t.TimezoneConfig.Specific&&(s.value=p),Oe("timezone",s)};return(0,e.jsxs)("div",{css:De,className:"timezone-setting mt-4",role:"group","aria-label":r("timezone"),children:[(0,e.jsx)(i.SettingRow,{label:(0,e.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,e.jsx)("div",{children:r("timezone")}),(0,e.jsx)(n.Tooltip,{showArrow:!0,placement:"right",id:"app-timezone-desc",describeChild:!0,enterDelay:0,"aria-live":"off",title:(0,e.jsxs)("div",{css:t.css`
          width: 386px;
          padding: 0.75rem;
          font-size: 12px;
          line-height: 150%;
          font-style: normal;
          border: 1px solid ${c.sys.color.divider.tertiary};
          border-radius: 2px;
          box-shadow: ${c.sys.shadow.shadow2};
          .name {
            margin-top: 1rem;
            font-weight: 600;
          }
          .desc {
            font-weight: 400;
          }
        `,children:[(0,e.jsx)("div",{className:"desc",children:r("timezoneDesc")}),(0,e.jsx)("div",{className:"name",children:r("deviceTimezone")}),(0,e.jsx)("div",{className:"desc",children:r("deviceTimezoneDesc")}),(0,e.jsx)("div",{className:"name",children:r("specificTimezone")}),(0,e.jsx)("div",{className:"desc",children:r("specificTimezoneDesc")}),(0,e.jsx)("div",{className:"name",children:r("dataTimezone")}),(0,e.jsx)("div",{className:"desc",children:r("dataTimezoneDesc")})]}),children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,"aria-label":r("additionalInformation"),"aria-describedby":"app-timezone-desc",children:(0,e.jsx)(M,{})})})]}),flow:"wrap"}),(0,e.jsx)(i.SettingRow,{className:"mt-3",children:(0,e.jsxs)(n.Label,{className:"mr-4 d-flex align-items-center",children:[(0,e.jsx)(n.Radio,{className:"mr-2",name:"timezone-type",value:t.TimezoneConfig.Device,checked:l.type===t.TimezoneConfig.Device,onChange:g}),r("deviceTimezone")]})}),(0,e.jsx)(i.SettingRow,{children:(0,e.jsxs)(n.Label,{className:"mr-4 d-flex align-items-center",children:[(0,e.jsx)(n.Radio,{className:"mr-2",name:"timezone-type",value:t.TimezoneConfig.Specific,checked:l.type===t.TimezoneConfig.Specific,onChange:g}),r("specificTimezone")]})}),l.type===t.TimezoneConfig.Specific&&(0,e.jsx)(i.SettingRow,{children:(0,e.jsx)(Ue.CalciteInputTimeZone,{scale:"s",className:"jimu-calcite-timezone w-100",value:p,mode:"region",overlayPositioning:"fixed",onCalciteInputTimeZoneChange:e=>{const n=e.target.value;Oe("timezone",{type:t.TimezoneConfig.Specific,value:n})}})}),(0,e.jsx)(i.SettingRow,{children:(0,e.jsxs)(n.Label,{className:"mr-4 d-flex align-items-center",children:[(0,e.jsx)(n.Radio,{className:"mr-2",name:"timezone-type",value:t.TimezoneConfig.Data,checked:l.type===t.TimezoneConfig.Data,onChange:g}),r("dataTimezone")]})}),l.type===t.TimezoneConfig.Data&&(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(i.SettingRow,{className:"w-100 d-flex justify-content-between",children:(0,e.jsx)(n.Alert,{form:"basic",type:"warning",withIcon:!0,children:(0,e.jsxs)("div",{children:[r("dataTimezoneTimelineWarning")+" ",(0,e.jsx)("a",{target:"_blank",href:d,rel:"noopener noreferrer",children:r("learnMoreForTimezoneSetting")})]})})})})]})}const Be=()=>(new Intl.DateTimeFormat).resolvedOptions().timeZone;var Le=p(4702),Fe=p.n(Le),Ge=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const He=n=>{const s=window.SVG,{className:i}=n,a=Ge(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:Fe()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var We=p(5075),$e=p.n(We),qe=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const Ve=n=>{const s=window.SVG,{className:i}=n,a=qe(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:$e()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var Ke=p(3662),Je=p.n(Ke),Xe=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const Ze=n=>{const s=window.SVG,{className:i}=n,a=Xe(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:Je()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var Qe=p(1795),Ye=p.n(Qe),et=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const tt=n=>{const s=window.SVG,{className:i}=n,a=et(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:Ye()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var nt=p(2046),st=p.n(nt),it=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const at=n=>{const s=window.SVG,{className:i}=n,a=it(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:st()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))},ot=e=>t.css`
    .second-header {
      margin-bottom: 8px;
    }
    .selector-dropdown {
      margin-bottom: 5px;
    }
    .list-item{
      margin-top: 0px;
      label {
        max-width: 100% !important;
        color: ${e.sys.color.surface.paperHint};
      }
    }
    .label-row > label {
      max-width: 100% !important;
    }
    .add-rule-button {
      position: absolute;
      bottom: 0;
      width: 226px !important;
      margin: 16px;
    }
  `,rt=a=>{var o;const{pageIds:r,onSelectPageIds:l}=a,{useMemo:c,useCallback:d,useState:u,useEffect:p}=t.React,h=t.hooks.useTranslation(n.defaultMessages,s),g=(0,t.getAppStore)().getState().appStateInBuilder.appConfig,[m,f]=u([]),v=c(()=>{var e,t;return(null===(t=null===(e=null==g?void 0:g.permission)||void 0===e?void 0:e.restrictions)||void 0===t?void 0:t.asMutable({deep:!0}))||[]},[null===(o=null==g?void 0:g.permission)||void 0===o?void 0:o.restrictions]),w=c(()=>{const e=null==g?void 0:g.pages,n=e&&Object.keys(e).filter(n=>e[n].type===t.PageType.Normal).sort((t,n)=>{var s;return null===(s=e[t].label)||void 0===s?void 0:s.localeCompare(e[n].label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})});let s=[];return n&&(s=s.concat(n.map(t=>({id:t,name:e[t].label,isDefault:e[t].isDefault})))),s},[g]),b=c(()=>w.find(e=>e.isDefault),[w]),x=c(()=>m.some(e=>e===b.id),[m,b]);p(()=>{(null==r?void 0:r.length)>0&&f((null==r?void 0:r.filter(e=>w.find(t=>t.id===e)))||[])},[w,r]);const y=d(e=>{const t=(null==e?void 0:e.map(e=>e.value))||[];f(t),l(t)},[l]),S=d(e=>{let t=[];v.forEach(e=>{t=t.concat(e.pageIds)});const n=t.some(t=>t===e);return!r.some(t=>t===e)&&n},[v,r]);return(0,e.jsxs)("div",{children:[(0,e.jsx)(i.SettingRow,{className:"second-header",tag:"label",label:h("limitedToPage")}),(0,e.jsx)(n.AdvancedSelect,{className:"selector-dropdown","aria-label":h("selectPages"),isMultiple:!0,hideBottomTools:!0,size:"sm",hideSearchInput:!0,onChange:y,selectedValues:w.filter(e=>m.some(t=>t===e.id)).map(e=>({value:e.id,label:e.name})),staticValues:w.map(e=>({value:e.id,label:e.name,disabled:S(e.id)}))}),w.map(t=>(null==m?void 0:m.find(e=>e===t.id))&&(0,e.jsx)(i.SettingRow,{className:"list-item",tag:"div",label:t.name,children:(0,e.jsx)(n.Button,{className:"delete-list-item-button d-none",type:"tertiary",size:"sm",icon:!1,children:(0,e.jsx)(tt,{className:"mx-0"})})},t.id)),x&&(0,e.jsx)(n.Alert,{tabIndex:0,className:"w-100 mt-2",open:!0,text:h("homePageWarning",{pageName:b.name}),type:"warning"})]})},lt=a=>{var o;const{roleIds:r,onSelectRoleIds:l}=a,{useCallback:c,useState:d,useEffect:u}=t.React,p=t.hooks.useTranslation(n.defaultMessages,s),[h,g]=d(["org_admin"]),[m,f]=d([]),v=null===(o=(0,t.getAppStore)().getState())||void 0===o?void 0:o.portalUrl,w=c(e=>{const t=(null==e?void 0:e.map(e=>e.value))||[];g(t),l(t)},[l]);return u(()=>{(function(e){return Ee(this,void 0,void 0,function*(){e=t.portalUrlUtils.getStandardPortalUrl(e);const n=t.SessionManager.getInstance().getSessionByUrl(e),s=(yield t.portalUtils.getPortalSelf(e)).id,i=t.i18n.getIntl(),a=[{id:"org_admin",name:i.formatMessage({id:"administrator",defaultMessage:t.defaultMessages.administrator})},{id:"org_publisher",name:i.formatMessage({id:"publisher",defaultMessage:t.defaultMessages.publisher})},{id:"org_user",name:i.formatMessage({id:"user",defaultMessage:t.defaultMessages.user})}];return Me[e]||(Me[e]=ce(`${t.portalUrlUtils.getPortalRestUrl(e)}/portals/${s}/roles`,{authentication:n,httpMethod:"GET",params:{f:"json",num:100}}).then(e=>a.concat((null==e?void 0:e.roles)||[])).catch(e=>(console.warn("get portal roles failed"),Promise.resolve([])))),Me[e]})})(v).then(e=>{f(e.sort((e,t)=>e.name.localeCompare(t.name)).map(e=>({id:e.id,name:e.name}))),(null==r?void 0:r.length)>0&&g((null==r?void 0:r.filter(t=>e.find(e=>e.id===t)))||[])})},[v,r]),(0,e.jsxs)("div",{children:[(0,e.jsx)(i.SettingRow,{className:"second-header",tag:"label",label:p("limitedToRole")}),(0,e.jsx)(n.AdvancedSelect,{className:"selector-dropdown","aria-label":p("selectRoles"),isMultiple:!0,hideBottomTools:!0,onChange:w,selectedValues:m.filter(e=>h.some(t=>t===e.id)).map(e=>({value:e.id,label:e.name})),size:"sm",staticValues:m.map(e=>({value:e.id,label:e.name,disabled:"org_admin"===e.id}))}),h.map(t=>{const s=m.find(e=>(null==e?void 0:e.id)===t);return(0,e.jsx)(i.SettingRow,{className:"list-item",tag:"div",label:null==s?void 0:s.name,truncateLabel:!0,children:(0,e.jsx)(n.Button,{className:"delete-list-item-button d-none",type:"tertiary",size:"sm",icon:!1,children:(0,e.jsx)(tt,{className:"mx-0"})})},t)})]})},ct=a=>{var o;const{groupIds:r,onSelectGroupIds:l}=a,{useCallback:c,useState:d,useEffect:u}=t.React,[p,h]=d([]),[g,m]=d([]),f=t.hooks.useTranslation(n.defaultMessages,s),v=null===(o=(0,t.getAppStore)().getState())||void 0===o?void 0:o.portalUrl,w=c(e=>{const t=(null==e?void 0:e.map(e=>e.value))||[];h(t),l(t)},[l]);return u(()=>{(function(e){e=t.portalUrlUtils.getStandardPortalUrl(e);const n=t.SessionManager.getInstance().getSessionByUrl(e);return _e[e]||(_e[e]=ce(`${t.portalUrlUtils.getPortalRestUrl(e)}/community/groups`,{authentication:n,httpMethod:"GET",params:{f:"json",num:"1000",start:1,sortField:"title",sortOrder:"asc",searchUserAccess:"groupMember"}}).then(e=>(null==e?void 0:e.results)||[]).catch(e=>(console.warn("get portal groups failed"),Promise.resolve([])))),_e[e]})(v).then(e=>{m(e.map(e=>({id:e.id,name:e.title}))),(null==r?void 0:r.length)>0&&h((null==r?void 0:r.filter(t=>e.find(e=>e.id===t)))||[])})},[v,r]),(0,e.jsxs)("div",{children:[(0,e.jsx)(i.SettingRow,{className:"second-header mt-6",tag:"label",label:f("limitedToGroup")}),(0,e.jsx)(n.AdvancedSelect,{className:"selector-dropdown","aria-label":f("selectGroups"),isMultiple:!0,hideBottomTools:!0,onChange:w,selectedValues:g.filter(e=>p.some(t=>t===e.id)).map(e=>({value:e.id,label:e.name})),size:"sm",staticValues:g.map(e=>({value:e.id,label:e.name}))}),p.map(t=>{const s=g.find(e=>(null==e?void 0:e.id)===t);return(0,e.jsx)(i.SettingRow,{className:"list-item",tag:"div",label:null==s?void 0:s.name,truncateLabel:!0,children:(0,e.jsx)(n.Button,{className:"delete-list-item-button d-none",type:"tertiary",size:"sm",icon:!1,children:(0,e.jsx)(tt,{className:"mx-0"})})},t)})]})},dt=a=>{const{restriction:r,onClose:l,theme:c,trigger:d}=a,{useState:u,useCallback:p,useMemo:h}=t.React,[g,m]=u((null==r?void 0:r.pageIds)||[]),[f,v]=u((null==r?void 0:r.roleIds)||["org_admin"]),[w,b]=u((null==r?void 0:r.groupIds)||[]),x=t.hooks.useTranslation(n.defaultMessages,s),y=p(e=>{m(e)},[]),S=p(e=>{v(e)},[]),j=p(e=>{b(e)},[]),I=p(()=>{var e,n,s,i;const a=(0,t.getAppStore)().getState().appStateInBuilder,c=(null===(n=null===(e=null==a?void 0:a.appConfig)||void 0===e?void 0:e.getIn(["permission","restrictions"]))||void 0===n?void 0:n.asMutable({deep:!0}))||[],d=null===(s=a.portalSelf)||void 0===s?void 0:s.id,u=f,p=w;let h;(null==r?void 0:r.id)?h=c.map(e=>e.id===r.id?{id:e.id,orgId:e.orgId,pageIds:g,roleIds:u,groupIds:p}:e):(c.push({id:(0,t.uuidv1)(),orgId:d,pageIds:g,roleIds:u,groupIds:p}),h=c);const m=null===(i=null==a?void 0:a.appConfig)||void 0===i?void 0:i.setIn(["permission","restrictions"],h);o.builderAppSync.publishAppConfigChangeToApp(m),l()},[r,g,f,w,l]),T=h(()=>{const e=f.length>0||w.length>0;return g.length>0&&e},[g,f,w]);return(0,e.jsxs)(i.SidePopper,{css:ot(c),position:"left",title:x("restrictionRule"),isOpen:!0,toggle:l,trigger:d,backToFocusNode:null,children:[(0,e.jsx)(i.SettingSection,{className:"pt-0",children:(0,e.jsx)(rt,{pageIds:(null==r?void 0:r.pageIds)||[],onSelectPageIds:y})}),(0,e.jsxs)(i.SettingSection,{children:[(0,e.jsx)(i.SettingRow,{className:"label-row mb-4",tag:"div",label:x("whoCanViewPages"),truncateLabel:!0}),(0,e.jsx)(lt,{roleIds:(null==r?void 0:r.roleIds)||[],onSelectRoleIds:S}),(0,e.jsx)(ct,{groupIds:(null==r?void 0:r.groupIds)||[],onSelectGroupIds:j})]}),(0,e.jsx)(n.Button,{className:"add-rule-button w-100 mt-2",type:"primary",size:"default",icon:!1,disabled:!T,onClick:I,children:x("ok")})]})};function ut(s){const{restriction:a,onEdit:o,onDelete:r}=s,{useCallback:l,useMemo:c}=t.React,d=t.React.useRef(null),u=l(()=>{o(a,d)},[a,o,d]),p=(0,t.getAppStore)().getState().appStateInBuilder,h=null==p?void 0:p.appConfig,g=l(e=>{r(a),e.stopPropagation()},[a,r]),m=c(()=>{var e;let t="";const n=Object.entries((null==h?void 0:h.pages)||{}).map(e=>{const t=e[1];return{id:t.id,name:t.label}});return null===(e=a.pageIds)||void 0===e||e.forEach(e=>{const s=n.find(t=>e===t.id);s&&(t=t.concat(`${s.name}, `))}),t=t.slice(0,t.length-2),t},[a,null==h?void 0:h.pages]);return(0,e.jsx)("div",{className:"mt-4",onClick:u,children:(0,e.jsxs)(i.SettingRow,{className:"restriction-item",tag:"div",label:m,ref:d,children:[(0,e.jsx)(n.Button,{className:"edit-button",type:"tertiary",size:"sm",icon:!1,onClick:u,children:(0,e.jsx)(at,{className:"mx-0"})}),(0,e.jsx)(n.Button,{className:"delete-button",type:"tertiary",size:"sm",icon:!1,onClick:g,children:(0,e.jsx)(tt,{className:"mx-0"})})]},a.id)})}const pt=(0,a.withTheme)(function(a){const{useState:r,useCallback:l,useMemo:c,useRef:d,useEffect:u}=t.React,[p,h]=r(!1),[g,m]=r(null),f=t.hooks.useTranslation(n.defaultMessages,s),v=(0,t.getAppStore)().getState().appStateInBuilder,w=null==v?void 0:v.appConfig,b=c(()=>{var e;return(null===(e=null==w?void 0:w.getIn(["permission","restrictions"]))||void 0===e?void 0:e.asMutable({deep:!0}))||[]},[w]),x=d(null),[y,S]=r(null);u(()=>{h(!1)},[b]);const j=c(()=>{var e;const t=v.user,n=window.jimuConfig.isDevEdition?v.appInfo.portalUrl===v.portalUrl:v.appInfo.orgId===t.orgId,s="org_admin"===t.role&&(null===(e=t.privileges)||void 0===e?void 0:e.includes("portal:admin:updateItems")),i=v.appInfo.owner===t.username;return n&&(s||i)},[v]),I=l(()=>{S(null),h(!1)},[]),T=l(()=>{m(null),S(x),h(!0)},[]),R=l((e,t)=>{m(e),S(t),h(!0)},[]),C=l(e=>{const t=b.filter(t=>t.id!==e.id&&t),n=null==w?void 0:w.setIn(["permission","restrictions"],t);o.builderAppSync.publishAppConfigChangeToApp(n),m(null),h(!1)},[b,w]);return j?(0,e.jsxs)("div",{css:(k=a.theme,t.css`
    .restriction-item {
      background: ${k.sys.color.action.default};
      label {
        color: ${k.sys.color.action.text};
        padding: 0 8px;
        max-width: 148px !important;
      }
      button {
        color: ${k.sys.color.action.text};
      }
    }
  `),className:"h-100 w-100",children:[(0,e.jsx)(i.SettingRow,{role:"group",className:"setting-row-label mt-4",tag:"label","aria-label":f("visibilityRestriction"),children:(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:f("visibilityRestriction")}),(0,e.jsx)(n.Tooltip,{title:f("visibilityRestrictionInfo"),placement:"bottom","aria-live":"off",describeChild:!0,id:"skip-credential-desc",enterDelay:0,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,"aria-label":f("additionalInformation"),"aria-describedby":"skip-credential-desc",children:(0,e.jsx)(M,{})})})]})}),(0,e.jsx)(i.SettingRow,{children:(0,e.jsxs)(n.Button,{icon:!0,type:"default",size:"default",className:"w-100",onClick:T,ref:x,children:[(0,e.jsx)(Ze,{className:"mx-1"}),f("addRestrictionRule")]})}),b.map(t=>(0,e.jsx)(ut,{restriction:t,onEdit:R,onDelete:C},t.id)),p&&"appSetting"===a.currentNavViewId&&(0,e.jsx)(dt,{restriction:g,theme:a.theme,onClose:I,trigger:y.current})]}):(0,e.jsx)("div",{});var k});var ht=p(8996),gt=p.n(ht),mt=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const ft=n=>{const s=window.SVG,{className:i}=n,a=mt(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:gt()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))},vt=a.styled.h5`
  padding: 1rem;
`,wt=(0,a.styled)(n.ModalBody)`
  padding: 0 3rem 1rem 3rem!important;
`,bt=(0,a.styled)(n.ModalFooter)`
  button {
    min-width: 75px!important;
  }
`,xt=(0,a.styled)(n.Modal)`
  .modal-content {
    border: 0px;
  }
`,yt=(0,a.styled)(i.RadioGroup)`
  margin-bottom: 0px!important;
  label:last-child {
    margin-bottom: 0;
  }
`;const St=(e,n)=>{let s,i;if(s=window.jimuConfig.isBuilder?(0,t.getAppStore)().getState().appStateInBuilder.appConfig.attributes.timezone:(0,t.getAppStore)().getState().appConfig.attributes.timezone,(null==s?void 0:s.type)===t.TimezoneConfig.Specific){const e=t.dataSourceUtils.getTimeZoneOffsetByName(s.value);i=n-t.dataSourceUtils.getLocalTimeOffset()+e}else i=n;return t.dateUtils.formatDateValueByEsriFormat(i,t.dateUtils.DATE_TIME_DEFAULT_ESRI_FORMAT,e)},jt=(0,a.withTheme)(function(a){var r,l,c,d,u;const{onBack:p}=a,h=t.ReactRedux.useSelector(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.analytics}),g=t.ReactRedux.useSelector(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.cookieBanner}),m=t.ReactRedux.useSelector(e=>{var t,n,s;return null===(s=null===(n=null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.sectionNavInfos)||void 0===n?void 0:n["opts-section"])||void 0===s?void 0:s.currentViewId}),[f,v]=t.React.useState((null==h?void 0:h.enable)||!1),[w,b]=t.React.useState((null===(r=null==h?void 0:h.google)||void 0===r?void 0:r.measurementId)||""),[x,y]=t.React.useState((null==g?void 0:g.enable)||!1),[S,j]=t.React.useState((null==g?void 0:g.refreshPeriodically)||!1),[I,T]=t.React.useState((null==g?void 0:g.consentMode)||t.EConsentMode.Optional),[R,C]=t.React.useState((null==g?void 0:g.refreshPeriod)||180),[k,E]=t.React.useState(!1),N=t.hooks.useTranslation(n.defaultMessages,s),A=(0,t.useIntl)(),P=t.React.useCallback(e=>/^(G|UA|YT|MO)-[a-zA-Z0-9-]+$/.test(e)?{valid:!0}:{valid:!1,msg:N("invalidMeasurementMsg")+" G-XXXXXXXXXX"},[N]),_=t.React.useCallback(()=>{E(!1)},[]);t.React.useEffect(()=>{o.builderAppSync.publishChangeSelectionToApp(null)},[]),t.React.useEffect(()=>{const e="appSetting"===m&&x;o.builderAppSync.publishOpenCookieBannerByPrivacyPanelToApp(e),(0,t.getAppStore)().dispatch(t.appActions.OpenCookieBannerSetting(e))},[m,x]);const U=t.React.useCallback(()=>{o.builderAppSync.publishOpenCookieBannerByPrivacyPanelToApp(!1),(0,t.getAppStore)().dispatch(t.appActions.OpenCookieBannerSetting(!1)),p()},[p]),D=t.React.useCallback(e=>{const n=!x;y(n),Ae("enable",n),(0,t.getAppStore)().dispatch(t.appActions.OpenCookieBannerSetting(n)),n?Ae("uid",(0,t.uuidv1)()):(0,o.getAppConfigAction)().appConfig.cookieBanner&&(0,o.getAppConfigAction)().removeCookieBannerConfig().exec()},[x]),z=t.React.useCallback(e=>{var n;const s=(0,t.getAppStore)().getState().appStateInBuilder,i=null===(n=null==s?void 0:s.appConfig)||void 0===n?void 0:n.setIn(["permission","blockSignInPrompt"],e.target.checked);o.builderAppSync.publishAppConfigChangeToApp(i)},[]),B=t.React.useCallback(e=>{var n;const s=(0,t.getAppStore)().getState().appStateInBuilder,i=null===(n=null==s?void 0:s.appConfig)||void 0===n?void 0:n.setIn(["permission","blockPermissionBanner"],e.target.checked);o.builderAppSync.publishAppConfigChangeToApp(i)},[]);t.React.useEffect(()=>{window._builderPubsub.subscribe(`to_builder.${o.ToBuilderMessage.CloseBannerInLiveView}`,e=>{U()})},[U]);const L=t.React.useId(),F=t.React.useId();return(0,e.jsxs)("div",{css:(G=a.theme,t.css`
    overflow-y: auto;
    .header-title {
      padding: 1rem;
      font-size: 1rem;
      font-weight: 600;
      color: var(--ref-palette-neutral-1000);
      border-bottom: 1px solid rgb(106, 106, 106);
    }
    .selector-button {
      height: 2.5rem;
      line-height: 2.5rem;
      padding: 0;
      border: 1px dashed #828282;
      border-radius: 0.125rem;
      cursor: pointer;
      color: #00d8ed;
      font-size: 0.875rem;
      -webkit-text-decoration: none;
      text-decoration: none;
      background-color: transparent;
    }
    .setting-row-label{
      font-size: 0.8125rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: ${G.ref.palette.neutral[900]};
    }
  `),className:"h-100 w-100",children:[(0,e.jsx)("div",{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between header-title",children:(0,e.jsxs)("div",{className:"text-truncate text-left",children:[(0,e.jsx)(n.Button,{onClick:U,size:"sm",icon:!0,type:"tertiary",className:"mr-2 jimu-outline-inside","aria-label":N("back"),children:(0,e.jsx)(O,{size:"m",autoFlip:!0})}),N("privacyAndSecurity")]})}),(0,e.jsxs)(i.SettingSection,{className:"border-bottom-0 pb-0",title:N("privacy"),children:[(0,e.jsx)(i.SettingRow,{role:"group",className:"mb-2",tag:"label",label:N("googleAnalytics"),"aria-label":N("googleAnalytics"),children:(0,e.jsx)(n.Switch,{checked:f,onChange:e=>{v(e.target.checked),Ne("enable",e.target.checked),Ae("uid",(0,t.uuidv1)())}})}),f&&(0,e.jsx)(i.SettingRow,{label:N("measurementId"),"aria-label":N("measurementId"),flow:"wrap",role:"group",children:(0,e.jsx)(n.TextInput,{className:"w-100",defaultValue:w,checkValidityOnAccept:P,onAcceptValue:e=>{b(e),Ne(["google","measurementId"],e)},"aria-label":N("measurementId")})})]}),(0,e.jsxs)(i.SettingSection,{className:"mb-2",children:[(0,e.jsx)("div",{onClick:D,children:(0,e.jsxs)(i.SettingRow,{className:"setting-row-label d-flex justify-content-between","aria-label":N("cookieBanner"),role:"group",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:N("cookieBanner")}),(0,e.jsx)(n.Tooltip,{title:N("thirdPartyExplain"),placement:"bottom","aria-live":"off",describeChild:!0,id:"cookie-third-party-desc",enterDelay:0,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,"aria-label":N("additionalInformation"),"aria-describedby":"cookie-third-party-desc",children:(0,e.jsx)(M,{})})})]}),(0,e.jsx)(n.Switch,{"aria-label":N("cookieBanner"),checked:x,onChange:D})]})}),x&&(0,e.jsxs)(e.Fragment,{children:[f&&(0,e.jsx)(i.SettingRow,{label:N("consentMode"),"aria-label":N("consentMode"),flow:"wrap",role:"radiogroup",children:(0,e.jsx)(yt,{className:"pb-0",value:I,options:[{value:t.EConsentMode.Required,content:N("consentRequired")},{value:t.EConsentMode.Optional,content:N("consentOptional")}],onChange:e=>{T(e),Ae("consentMode",e)}})}),(0,e.jsx)(i.SettingRow,{label:N("consentRefreshSetting"),"aria-label":N("consentRefreshSetting"),flow:"wrap",role:"group",children:(0,e.jsxs)(n.Label,{className:"d-flex justify-content-between",children:[(0,e.jsx)(n.Checkbox,{checked:S,onChange:e=>{j(e.target.checked),Ae("refreshPeriodically",e.target.checked)}}),(0,e.jsx)("span",{className:"ml-2",children:N("refreshPeriodically")})]})}),S&&(0,e.jsx)(n.TextInput,{className:"w-100 mt-4 mb-2",value:R,suffix:(0,e.jsx)("span",{children:N("days")}),onChange:e=>{C(e.target.value)},onAcceptValue:e=>{const t=Math.abs(parseInt(e));C(isNaN(t)?180:t),Ae("refreshPeriod",t)}}),(0,e.jsx)(i.SettingRow,{className:"mt-0",label:N("renewUserConsents"),"aria-label":N("renewUserConsents"),flow:"wrap",role:"group",children:(0,e.jsx)(n.Button,{className:"w-100",size:"sm",type:"primary","aria-describedby":"refresh-time-desc",onClick:()=>{E(!0)},children:N("renewNow")})}),(null==g?void 0:g.renewTime)&&(0,e.jsx)("div",{className:"mt-2",id:"refresh-time-desc",children:`${N("lastTimeRenewed")}: ${St(A,g.renewTime)}`}),(0,e.jsxs)(xt,{centered:!0,isOpen:k,toggle:_,children:[(0,e.jsxs)(vt,{className:"renew-modal-header",children:[(0,e.jsx)(ft,{size:24,className:"mr-2",color:"var(--sys-color-warning-main)"}),(0,e.jsx)("span",{children:N("renewModalTitle")})]}),(0,e.jsx)(wt,{className:"renew-modal-body",children:(0,e.jsx)("span",{children:N("renewModalDesc")})}),(0,e.jsxs)(bt,{children:[(0,e.jsx)(n.Button,{type:"primary",size:"sm",onClick:()=>{Ae("renewTime",(new Date).getTime()),_()},children:N("ok")}),(0,e.jsx)(n.Button,{size:"sm",onClick:_,children:N("cancel")})]})]})]})]}),(0,e.jsxs)(i.SettingSection,{className:"mb-4",title:N("security"),children:[(0,e.jsxs)(i.SettingRow,{role:"group",className:"mb-2 setting-row-label d-flex justify-content-between",tag:"label","aria-label":N("skipSingInPrompt"),children:[(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)("label",{htmlFor:L,children:N("skipSingInPrompt")}),(0,e.jsx)(n.Tooltip,{title:N("skipSingInPromptInfo"),placement:"bottom","aria-live":"off",describeChild:!0,id:"skip-signin-desc",enterDelay:0,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"mr-4",disableHoverEffect:!0,disableRipple:!0,"aria-label":N("additionalInformation"),"aria-describedby":"skip-signin-desc",children:(0,e.jsx)(M,{})})})]}),(0,e.jsx)(n.Switch,{id:L,checked:null===(c=null===(l=(0,t.getAppStore)().getState().appStateInBuilder)||void 0===l?void 0:l.appConfig.permission)||void 0===c?void 0:c.blockSignInPrompt,onChange:z,"aria-label":N("skipSingInPrompt")})]}),(0,e.jsxs)(i.SettingRow,{role:"group",className:"mb-2 setting-row-label d-flex justify-content-between",tag:"label","aria-label":N("skipCredentialBanner"),children:[(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)("label",{htmlFor:F,children:N("skipCredentialBanner")}),(0,e.jsx)(n.Tooltip,{title:N("skipCredentialBannerInfo"),placement:"bottom","aria-live":"off",describeChild:!0,id:"skip-credential-desc",enterDelay:0,children:(0,e.jsx)(n.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",disableHoverEffect:!0,disableRipple:!0,"aria-label":N("additionalInformation"),"aria-describedby":"skip-credential-desc",children:(0,e.jsx)(M,{})})})]}),(0,e.jsx)(n.Switch,{id:F,checked:null===(u=null===(d=(0,t.getAppStore)().getState().appStateInBuilder)||void 0===d?void 0:d.appConfig.permission)||void 0===u?void 0:u.blockPermissionBanner,onChange:B,"aria-label":N("skipCredentialBanner")})]}),!window.isExpressBuilder&&(0,e.jsx)(pt,{theme:a.theme,currentNavViewId:m})]})]});var G});var It;function Tt(s){const{appItem:a,translate:o}=s,[r,l]=t.React.useState("");t.React.useEffect(()=>{const e=(null==a?void 0:a.snippet)||"";r!==e&&l(e)},[null==a?void 0:a.snippet]);const c=t.hooks.useEventCallback(e=>{if((a.snippet||"")===e)return;Pe(a.set("snippet",e).set("clearEmptyFields",""===e).asMutable({deep:!0}))});return(0,e.jsx)(i.SettingRow,{label:o("summaryField"),flow:"wrap",role:"group","aria-label":o("summaryField"),children:(0,e.jsx)(n.TextArea,{placeholder:o("summaryPlaceholder"),value:r,onChange:e=>{l(e.target.value)},height:80,onAcceptValue:c})})}!function(e){e.Experience="Web Experience",e.Template="Web Experience Template"}(It||(It={}));const Rt=t.css`
  .thumbnail-button {
    position: relative;
    cursor: pointer;
    .thumbnail-input {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      font-size: 0;
    }
  }
  .thumbnail-image {
    aspect-ratio: 200 / 133;
    background-size: 100% 100%;
    background-position: center center;
    background-repeat: no-repeat;
  }
`;function Ct(s){const{appItem:a,stateReady:o,folderUrl:r,portalUrl:l,translate:c}=s,[d,u]=t.React.useState(!1),[p,h]=t.React.useState(null),g=t.hooks.useEventCallback(()=>{u(!d)}),m=t.hooks.useEventCallback(e=>{var t;const n=null===(t=e.target)||void 0===t?void 0:t.files;if(!n||!n[0])return;if(n[0].size>10485760)return h(c("fileSizeTips",{maxSize:"10M"})),void u(!0);if(!n[0].type.startsWith("image/"))return h(c("imageTypeError")),void u(!0);const s=n[0].type,i=s.split(".")[s.split(".").length-1],o=new File([n[0]],`thumbnail${(new Date).getTime()}${i}`,{type:"image/png"}),r=window.URL.createObjectURL(o);Pe(a.set("thumbnailurl",r).asMutable({deep:!0})),e.target.value=null}),f=t.React.useMemo(()=>r+"./dist/runtime/assets/defaultthumb.png",[r]);t.React.useEffect(()=>{var e;if((null===(e=(0,t.getAppStore)().getState().appRuntimeInfo)||void 0===e?void 0:e.saveThumbnailUrl)&&a&&!(null==a?void 0:a.thumbnailurl)&&!(null==a?void 0:a.thumbnail)){Pe(a.set("thumbnailurl",f).asMutable({deep:!0}),!0)}},[null==a?void 0:a.thumbnailurl,null==a?void 0:a.thumbnail,f]),t.React.useEffect(()=>{const e=null==a?void 0:a.thumbnail;if(!e||!o)return;const n=null==a?void 0:a.id,s=t.SessionManager.getInstance().getSessionByUrl(l),i=s&&(null==s?void 0:s.token)?"?token="+s.token:"";let r="";r=window.jimuConfig.isDevEdition?`${window.location.origin}${window.jimuConfig.mountPath}apps/${n}/${e}`:`${l}/sharing/rest/content/items/${n}/info/${e}${i}`,fetch(r).then(e=>e.blob()).then(n=>{const s=e.split(".")[e.split(".").length-1],i=new File([n],`thumbnail${(new Date).getTime()}${s}`,{type:`image/${s}`}),o=window.URL.createObjectURL(i);Pe(a.set("thumbnailurl",o).asMutable({deep:!0}),!0),(0,t.getAppStore)().dispatch(t.appActions.saveThumbnailUrl(o))})},[null==a?void 0:a.id,null==a?void 0:a.thumbnail,l,o]);const v=t.React.useMemo(()=>{let e=f;return(null==a?void 0:a.thumbnailurl)&&(e=a.thumbnailurl),e},[f,null==a?void 0:a.thumbnailurl]),w=t.React.useMemo(()=>({backgroundImage:"url("+v+")"}),[v]);return(0,e.jsxs)("div",{role:"group",className:"thumbnail-setting mt-4 mb-4",css:Rt,"aria-label":c("thumbnail"),children:[(0,e.jsxs)(i.SettingRow,{label:c("thumbnail"),children:[(0,e.jsxs)(n.Button,{tag:"div",size:"sm",title:c("browse"),className:"thumbnail-button jimu-interactive-node",children:[c("browse"),(0,e.jsx)("input",{type:"file",accept:"image/*",className:"thumbnail-input","aria-label":c("browse"),onChange:m})]}),(0,e.jsx)(n.AlertPopup,{isOpen:d,hideCancel:!0,toggle:g,children:(0,e.jsxs)("div",{className:"align-middle pt-2",children:[(0,e.jsx)(ft,{className:"mr-2 align-middle",size:24,color:"var(--sys-color-warning-main)"}),(0,e.jsx)("span",{className:"align-middle",children:p})]})})]}),(0,e.jsx)(i.SettingRow,{children:(0,e.jsx)("div",{className:"thumbnail-image w-100",style:w})})]})}var kt=p(5809);function Et(n){const{favicon:s,translate:a}=n,[o,r]=t.React.useState((null==s?void 0:s.asMutable({deep:!0}))||null),l=t.React.useMemo(()=>({color:!0}),[]);t.React.useEffect(()=>{const e=(null==s?void 0:s.asMutable({deep:!0}))||null;o!==e&&r(e)},[s]);const c=t.hooks.useEventCallback(e=>{Oe("favicon",null==e?void 0:e.asMutable({deep:!0}))});return(0,e.jsx)(i.SettingRow,{role:"group",label:a("favicon"),"aria-label":a("favicon"),children:(0,e.jsx)(kt.IconPicker,{previewOptions:l,configurableOption:"color",setButtonUseColor:!1,className:"flex-none",icon:o,onChange:c})})}var Ot=p(8547),Nt=p.n(Ot),At=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};const Pt=n=>{const s=window.SVG,{className:i}=n,a=At(n,["className"]),o=(0,t.classNames)("jimu-icon jimu-icon-component",i);return s?(0,e.jsx)(s,Object.assign({className:o,src:Nt()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var Mt=p(9860);function _t(s){const{appItem:a,translate:o}=s,r=t.React.useMemo(()=>{var e;return(null===(e=null==a?void 0:a.tags)||void 0===e?void 0:e.asMutable())||[]},[null==a?void 0:a.tags]),[l,c]=t.React.useState([]);t.React.useEffect(()=>{(()=>{if(window.jimuConfig.isDevEdition)return;const e=(0,t.getAppStore)().getState().user.username;Mt.appServices.getUserTags(e).then(e=>{var t;const n=null===(t=null==e?void 0:e.tags)||void 0===t?void 0:t.map(e=>e.tag);c((null==n?void 0:n.filter(e=>e))||[])})})()},[]);const d=t.hooks.useEventCallback(e=>{if(e.length===r.length&&e.every((e,t)=>e===r[t]))return;Pe(a.set("tags",e).asMutable({deep:!0}))});return(0,e.jsx)(i.SettingRow,{label:o("tags"),flow:"wrap",children:(0,e.jsx)(n.TagInput,{values:r,suggestions:l,onChange:d,name:o("tagsLowerCase"),maxListHeight:80,"aria-label":o("tags")})})}var Ut=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,r)}l((s=s.apply(e,t||[])).next())})};const Dt=(0,a.styled)(n.Modal)`
  max-width: 768px !important;
`;function zt(s){const{appItem:a,translate:o}=s,r=t.ReactRedux.useSelector(e=>t.portalUtils.shouldShowClassificationConfig(e)),[l,c]=t.React.useState(null),[u,p]=t.React.useState(!0),[h,g]=t.React.useState(null),[m,f]=t.React.useState(),[v,w]=t.React.useState(!1),b=()=>{w(!1)},x=t.React.useRef(null),[y,S]=t.React.useState(!1);return(0,e.jsxs)(t.React.Fragment,{children:[r&&(0,e.jsx)(i.SettingRow,{className:"mt-4 justify-content-between",label:o("classification"),"aria-label":o("classification"),flow:"no-wrap",children:(0,e.jsx)(n.Button,{"aria-label":o("edit"),icon:!0,onClick:()=>{var e;w(!0),f(null===(e=a.classification)||void 0===e?void 0:e.asMutable({deep:!0})),l||(0,t.loadArcGISJSAPIModule)("esri/kernel").then(e=>{e&&t.moduleLoader.loadModule("jimu-ui/advanced/portal-components").then(c)}).catch(e=>{console.error("loadArcGISJSAPIModule error",e)})},type:"tertiary",size:"sm",className:"p-0 b-0",children:(0,e.jsx)(d,{})})}),(null==l?void 0:l.ClassificationConfigModalContent)&&(0,e.jsxs)(Dt,{isOpen:v,centered:!0,onClosed:b,returnFocusAfterClose:!0,"aria-label":o("classification"),children:[(0,e.jsx)(n.ModalHeader,{toggle:b,children:o("classification")}),(0,e.jsxs)(n.ModalBody,{className:"pb-0",children:[(0,e.jsx)(l.ClassificationConfigModalContent,{values:m,showHeader:!1,portalItemId:a.id,onChange:(e,t)=>{p(e),g(t)},ref:x}),y&&(0,e.jsx)(n.Loading,{})]}),(0,e.jsxs)(n.ModalFooter,{children:[(0,e.jsx)(n.Button,{onClick:()=>Ut(this,void 0,void 0,function*(){if((null==l?void 0:l.ClassificationConfigModalContent)&&!a.classification){S(!0),yield x.current.validateForm(),S(!1);if(!x.current.valid)return}Pe(a.set("classification",h).asMutable({deep:!0})),b()}),type:"primary",disabled:!u,children:o("ok")}),(0,e.jsx)(n.Button,{onClick:b,children:o("cancel")})]})]})]})}function Bt(a){const{portalUrl:o,context:r}=a,l=r.folderUrl,[c,d]=t.React.useState(0),u=t.hooks.useEventCallback(()=>{d(0)}),p=t.css`
    .title {
      padding: 18px 16px 2px 16px !important;
      font-size: 1rem;
      font-weight: 500;
      color: var(--ref-palette-neutral-1000);
    }
  `,h=t.ReactRedux.useSelector(e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appInfo}),g=t.ReactRedux.useSelector(e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig}),m=t.ReactRedux.useSelector(e=>null==g?void 0:g.attributes),f=window.isExpressBuilder,v=t.hooks.useTranslation(n.defaultMessages,s),w=(null==h?void 0:h.type)===It.Template?"templateSettings":"experienceSettings";return g&&h&&(0,e.jsxs)("div",{css:p,className:"jimu-widget widget-app-setting setting-pane bg-default",role:"group","aria-label":v(w),children:[(0,e.jsxs)("div",{className:(0,t.classNames)("w-100","h-100","overflow-auto",{"d-none":0!==c}),children:[(0,e.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-0 title",children:(0,e.jsx)("div",{className:"text-truncate",children:v(w)})}),(0,e.jsxs)(i.SettingSection,{children:[(0,e.jsx)(Et,{favicon:null==m?void 0:m.favicon,translate:v}),(0,e.jsx)(Ct,{appItem:h,stateReady:!!m,portalUrl:o,folderUrl:l,translate:v}),(0,e.jsx)(Tt,{appItem:h,translate:v}),!window.jimuConfig.isDevEdition&&(0,e.jsx)(_t,{appItem:h,translate:v}),(0,e.jsx)(zt,{appItem:h,translate:v}),!f&&g&&(0,e.jsx)(ze,{timezone:null==m?void 0:m.timezone,translate:v})]}),(0,e.jsxs)(i.SettingSection,{children:[(0,e.jsx)(i.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(He,{className:"mr-2"}),v("stateUrlParameters")]}),(0,e.jsx)(n.Button,{type:"tertiary",size:"sm",icon:!0,onClick:()=>{d(1)},"aria-label":v("stateUrlParameters"),"aria-haspopup":!0,children:(0,e.jsx)(Ve,{autoFlip:!0})})]})}),(0,e.jsx)(i.SettingRow,{"aria-label":v("privacyAndSecurity"),children:(0,e.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(Pt,{className:"mr-2"}),v("privacyAndSecurity")]}),(0,e.jsx)(n.Button,{type:"tertiary",size:"sm",icon:!0,onClick:()=>{d(2)},"aria-label":v("privacy"),"aria-haspopup":!0,children:(0,e.jsx)(Ve,{autoFlip:!0})})]})})]})]}),1===c&&(0,e.jsx)(F,{onBack:u}),2===c&&(0,e.jsx)(jt,{onBack:u})]})}function Lt(e){p.p=e}})(),h})())}}});