System.register(["jimu-core","jimu-core/emotion","jimu-for-builder","jimu-for-builder/templates","jimu-layouts/layout-builder","jimu-layouts/layout-runtime","jimu-theme","jimu-ui","jimu-ui/advanced/builder-components","jimu-ui/advanced/resource-selector","jimu-ui/advanced/setting-components","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker","jimu-ui/basic/list-tree"],function(e,t){var i={},s={},o={},n={},a={},r={},l={},c={},d={},p={},g={},h={},u={},m={};return{setters:[function(e){i.APP_FRAME_NAME_IN_BUILDER=e.APP_FRAME_NAME_IN_BUILDER,i.AnimationPlayMode=e.AnimationPlayMode,i.AnimationType=e.AnimationType,i.AppMode=e.AppMode,i.BrowserSizeMode=e.BrowserSizeMode,i.CONSTANTS=e.CONSTANTS,i.ContainerType=e.ContainerType,i.DataActionManager=e.DataActionManager,i.DataSourceManager=e.DataSourceManager,i.DialogInteractionType=e.DialogInteractionType,i.DialogMode=e.DialogMode,i.ECookieBannerLayout=e.ECookieBannerLayout,i.ErrorBoundary=e.ErrorBoundary,i.FixedPosition=e.FixedPosition,i.Immutable=e.Immutable,i.LayoutItemType=e.LayoutItemType,i.LayoutParentType=e.LayoutParentType,i.LayoutType=e.LayoutType,i.LinkType=e.LinkType,i.OpenTypes=e.OpenTypes,i.PageMode=e.PageMode,i.PagePart=e.PagePart,i.PageType=e.PageType,i.React=e.React,i.ReactRedux=e.ReactRedux,i.WidgetType=e.WidgetType,i.appActions=e.appActions,i.classNames=e.classNames,i.createSelector=e.createSelector,i.css=e.css,i.defaultMessages=e.defaultMessages,i.focusElementInKeyboardMode=e.focusElementInKeyboardMode,i.getAppStore=e.getAppStore,i.getMessageTypeLabel=e.getMessageTypeLabel,i.getNextAnimationId=e.getNextAnimationId,i.getWidgetIdsInRootContainers=e.getWidgetIdsInRootContainers,i.hooks=e.hooks,i.i18n=e.i18n,i.injectIntl=e.injectIntl,i.isKeyboardMode=e.isKeyboardMode,i.lodash=e.lodash,i.moduleLoader=e.moduleLoader,i.polished=e.polished,i.urlUtils=e.urlUtils,i.utils=e.utils},function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){o.AppDataActionManager=e.AppDataActionManager,o.AppMessageManager=e.AppMessageManager,o.WidgetSettingManager=e.WidgetSettingManager,o.appConfigUtils=e.appConfigUtils,o.builderAppSync=e.builderAppSync,o.getAppConfigAction=e.getAppConfigAction,o.helpUtils=e.helpUtils,o.utils=e.utils},function(e){n.getScreenTemplates=e.getScreenTemplates},function(e){a.AccordionLayoutItemSetting=e.AccordionLayoutItemSetting,a.ColumnLayoutItemSetting=e.ColumnLayoutItemSetting,a.FixedLayoutItemSetting=e.FixedLayoutItemSetting,a.FlexRowLayoutItemSetting=e.FlexRowLayoutItemSetting,a.FlowLayoutItemSetting=e.FlowLayoutItemSetting,a.FlowLayoutSetting=e.FlowLayoutSetting,a.GridLayoutItemSetting=e.GridLayoutItemSetting,a.GridLayoutSetting=e.GridLayoutSetting,a.RowLayoutItemSetting=e.RowLayoutItemSetting,a.getLabelOfGridTab=e.getLabelOfGridTab},function(e){r.DEFAULT_AUTOPLAY_INTERVAL=e.DEFAULT_AUTOPLAY_INTERVAL,r.defaultMessages=e.defaultMessages,r.searchUtils=e.searchUtils,r.utils=e.utils},function(e){l.colorUtils=e.colorUtils,l.getTheme=e.getTheme,l.getTheme2=e.getTheme2,l.styled=e.styled,l.withTheme=e.withTheme},function(e){c.AdvancedSelect=e.AdvancedSelect,c.Button=e.Button,c.ButtonGroup=e.ButtonGroup,c.Checkbox=e.Checkbox,c.CollapsableCheckbox=e.CollapsableCheckbox,c.CollapsablePanel=e.CollapsablePanel,c.CollapsableRadio=e.CollapsableRadio,c.Collapse=e.Collapse,c.DEFAULT_FIXED_POSITION_SIZE_JSON=e.DEFAULT_FIXED_POSITION_SIZE_JSON,c.DistanceUnits=e.DistanceUnits,c.Dropdown=e.Dropdown,c.DropdownButton=e.DropdownButton,c.DropdownItem=e.DropdownItem,c.DropdownMenu=e.DropdownMenu,c.FillType=e.FillType,c.Icon=e.Icon,c.Label=e.Label,c.Link=e.Link,c.Loading=e.Loading,c.LoadingType=e.LoadingType,c.MultiSelect=e.MultiSelect,c.MultiSelectItem=e.MultiSelectItem,c.NumericInput=e.NumericInput,c.PanelHeader=e.PanelHeader,c.Radio=e.Radio,c.Select=e.Select,c.Slider=e.Slider,c.Switch=e.Switch,c.Tab=e.Tab,c.Tabs=e.Tabs,c.TextArea=e.TextArea,c.TextInput=e.TextInput,c.Tooltip=e.Tooltip,c.defaultMessages=e.defaultMessages,c.hooks=e.hooks,c.utils=e.utils},function(e){d.ChangeSectionViewActionSetting=e.ChangeSectionViewActionSetting,d.FilterDataRecordActionSetting=e.FilterDataRecordActionSetting,d.SelectDataRecordActionSetting=e.SelectDataRecordActionSetting,d.messageActionUtils=e.messageActionUtils},function(e){p.IconPicker=e.IconPicker},function(e){g.DirectionSelector=e.DirectionSelector,g.LinkSelectorSidePopper=e.LinkSelectorSidePopper,g.SettingCollapse=e.SettingCollapse,g.SettingRow=e.SettingRow,g.SettingSection=e.SettingSection,g.SidePopper=e.SidePopper,g.TemplateSelector=e.TemplateSelector},function(e){h.AnimationSettingComponent=e.AnimationSettingComponent,h.BackgroundSetting=e.BackgroundSetting,h.ColorContrastWarning=e.ColorContrastWarning,h.FixedPositionSize=e.FixedPositionSize,h.InputUnit=e.InputUnit,h.Padding=e.Padding,h.ThemeBackgroundSection=e.ThemeBackgroundSection,h.ThemeBorderSection=e.ThemeBorderSection,h.ThemeBoxShadowSection=e.ThemeBoxShadowSection},function(e){u.ThemeColorPicker=e.ThemeColorPicker},function(e){m.List=e.List,m.TreeItemActionType=e.TreeItemActionType}],execute:function(){e((()=>{var e={92:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNCIgeT0iMTAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},778:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.829 2.535a.909.909 0 0 0-1.657 0L2.291 13.356a.456.456 0 0 0 .831.377L4.818 10h6.365l1.696 3.733a.456.456 0 0 0 .831-.377zM5.272 9 8 3l2.729 6z" clip-rule="evenodd"></path></svg>'},1027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},1408:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M13.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1M15.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1M18 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M17 10.5a.5.5 0 0 0-.5-.5h-13a.5.5 0 0 0 0 1h13a.5.5 0 0 0 .5-.5M17 14.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-.993.883L1 2v2h18V2a1 1 0 0 0-.883-.993zm1 4H1v13a1 1 0 0 0 .883.993L2 19h16a1 1 0 0 0 .993-.883L19 18z" clip-rule="evenodd"></path></svg>'},1496:e=>{"use strict";e.exports=r},1888:e=>{"use strict";e.exports=l},2046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},2113:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjEwN3B4IiBoZWlnaHQ9IjY4cHgiIHZpZXdCb3g9IjAgMCAxMDcgNjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2MS4xICg4OTY1MCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+DQogICAgPHRpdGxlPkN1c3RvbTwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zODcuMDAwMDAwLCAtMzA4LjAwMDAwMCkiPg0KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzg2LjAwMDAwMCwgMzA3LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjNTI1MjUyIiB4PSIyOCIgeT0iMTQiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0MCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjMjgyODI4IiB4PSI4NyIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjY4Ij48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgIDxsaW5lIHgxPSI4NyIgeTE9IjAiIHgyPSI4NyIgeTI9IjY4IiBzdHJva2U9IiM1MjUyNTIiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiIHN0cm9rZS1kYXNoYXJyYXk9IjQsNCI+PC9saW5lPg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjMjgyODI4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjgiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMCIgeDI9IjIwIiB5Mj0iNjgiIHN0cm9rZT0iIzUyNTI1MiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIgc3Ryb2tlLWRhc2hhcnJheT0iNCw0Ij48L2xpbmU+DQogICAgICAgICAgICAgICAgICAgIDxyZWN0IGZpbGw9IiM2QTZBNkEiIHg9IjEwMSIgeT0iMyIgd2lkdGg9IjMiIGhlaWdodD0iNDAiIHJ4PSIxLjUiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},2384:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABQCAYAAAD83pAbAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHXSURBVHgB7d2xisJAFIXhu4uChS8gaGEh2Pr+D2ErWFgo+AIWgsIuN7CwsK7J7J3Jeib/V8stcsw4noTEDAAAAADQp7e2D6zX6w9Db3a73dNM3g1SCEwMgYkhMDEEJobAxIwsYDab2Wq1stEoNGYwrterHQ4HO5/P9lehM2y5XBJWgslk0nzBI0KBEVa6+/1uEaHA9vt9c5qjGw/Ll8SI0Cnia3FkPUY6doliCEwMgYkhMDEEJoamo0c0HWJoOgTRdAih6RggdoliCEwMgYkhMDEEJoamo0c0HWJoOgTRdAih6RggdoliCEwMgYkhMDEEJoamo0WOdiInmo4WOdqJnGg6Ooi2EznRdLTI0U7kRNMhhl2iGAITQ2BiCEwMgYkhMDEEJobAxFTTLY3HY5vP500h7f1fCm9rvAA4nU52u93+ZX5XVTxC1g/mZrOx6XRqEZfLxbbb7Y+DWnr+d4N4hKx/86MH0/kMn9X3/BRVBObLVMlZpeenqCKw1N+U1Fml56eoIrCcl3gezSo9P0UVgeW8xPNoVun5KaoI7Hg8NjuwKJ/hs/qen6KaN0P47QqLxSL0P8kP5m+3A5Se/6VtW8+rPF4Mr/KoDIGJITAxBAYAAAAAwBOfNFL4K95cNL0AAAAASUVORK5CYII="},2491:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 13.5a.5.5 0 0 0 1 0v-6l3.459 3.953a.5.5 0 0 0 .752-.658L3.766 8H13.5a.5.5 0 0 0 0-1H3.766l2.445-2.794a.5.5 0 1 0-.752-.659L2 7.5v-6a.5.5 0 0 0-1 0z" clip-rule="evenodd"></path></svg>'},2606:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M1.25 2.5h17.5v11.25H1.25zM0 2.5c0-.69.56-1.25 1.25-1.25h17.5c.69 0 1.25.56 1.25 1.25v11.25c0 .69-.56 1.25-1.25 1.25H1.25C.56 15 0 14.44 0 13.75zm3.75 16.25h2.5V17.5h-2.5zm7.5 0h-2.5V17.5h2.5zm2.5 0h2.5V17.5h-2.5z" clip-rule="evenodd"></path></svg>'},2838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},3303:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},3387:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 8.002a.5.5 0 0 1-1 0V1H1v12.003h3.5a.5.5 0 1 1 0 1H1a1 1 0 0 1-1-1V1A1 1 0 0 1 .044.706.498.498 0 0 1 .5 0H11a1 1 0 0 1 1 1zm2.218 1.486a.5.5 0 0 0-.708 0l-5.657 5.658a.5.5 0 0 0 .708.707l5.657-5.658a.5.5 0 0 0 0-.707M11 9.928c.376 0 .794.041 1.23.141l-.871.871a5 5 0 0 0-.359-.012c-1 0-2.731.297-3.83 2 .313.486.677.857 1.062 1.14l-.676.676A6.1 6.1 0 0 1 6 12.928c1.333-2.334 3.5-3 5-3m0 5c-.219 0-.472-.014-.746-.054l-.824.825a5.6 5.6 0 0 0 1.57.23c1.5 0 3.667-.667 5-3a6 6 0 0 0-1.804-1.998l-.684.684c.478.299.936.721 1.319 1.313-1.1 1.704-2.831 2-3.831 2M2.5 3.502A.5.5 0 0 1 3 3h6a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z" clip-rule="evenodd"></path></svg>'},3593:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1.5 1a.5.5 0 0 0 0 1h6L3.547 5.459a.5.5 0 1 0 .658.752L7 3.766V13.5a.5.5 0 0 0 1 0V3.766l2.794 2.445a.5.5 0 1 0 .659-.752L7.5 2h6a.5.5 0 0 0 0-1z" clip-rule="evenodd"></path></svg>'},3662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},4108:e=>{"use strict";e.exports=o},4142:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABQCAYAAAD83pAbAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHCSURBVHgB7duxisJAFIXhu4uCha2FoIWFYOv7v4O2goWFgi9gEUhglxsIbLUmd7KZnM3/1V4DOZNMclAzAAAAAAAAAAAAAAAiPt594HA4fBkGc7lcfs3k0yCFwMQQmBgCE0NgYghMDIGJITAxBCZmZkHr9dr2+73NZuGvGFxRFHa73ez5fJqq8Nne7XZSYbnFYlEvsj4Cm8/nttls6oXr3/uOLxY/7uPxsLIsLSp8xtXCalRVZak8rOPxaMvlsvWMh+qLfLVa2fl8DocW3sOu12u9apR4WH5LTOVXVpewfvI5n48KXyZ+eSvvBSn8Npg6H104PCUGtNmz/mqewAJSt4KUeQILSN0KUuYJLOB+v9vr9bIIn/P5KM1n88z8afN0Otl2u+38HuZhpbxa0HQENa8IfbwmdBG+JSo3HcrCgU256ciJpkMMTYcYnhKD5Nr6KZNs66csZ1tPYAF9tPVRBBaQs62Xbzpy/E7Dj5ly0rO09WNpOnK0F5Jt/ZiajqHbi5xtvXzTkaO9aNp6P27bc9Dcun0uZYHxD8yR4R+Y/wyBiSEwMQQmhsDEEJgYAhNDYGIIDAAAAAAAAAAAAACASfgGhL/ln9+em+EAAAAASUVORK5CYII="},4189:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjEwN3B4IiBoZWlnaHQ9IjY4cHgiIHZpZXdCb3g9IjAgMCAxMDcgNjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2MS4xICg4OTY1MCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+DQogICAgPHRpdGxlPkF1dG88L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxnIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTA2LjAwMDAwMCwgLTMwOC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwNS4wMDAwMDAsIDMwNy4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjAwMDAwMCwgMS4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwNyIgaGVpZ2h0PSI2OCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjNTI1MjUyIiB4PSI2IiB5PSIxNCIgd2lkdGg9IjkwIiBoZWlnaHQ9IjQwIj48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgIDxyZWN0IGZpbGw9IiM2QTZBNkEiIHg9IjEwMSIgeT0iMyIgd2lkdGg9IjMiIGhlaWdodD0iNDAiIHJ4PSIxLjUiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},4321:e=>{"use strict";e.exports=c},4337:e=>{"use strict";e.exports=u},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},5356:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 2h4v4H2zM1 7V1h6v6zm1 3h4v4H2zm-1 5V9h6v6zM14 2h-4v4h4zM9 1v6h6V1zm2.5 14v-2.5H9v-1h2.5V9h1v2.5H15v1h-2.5V15z" clip-rule="evenodd"></path></svg>'},5508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},5549:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6 5H2v6h4zM1 4v8h6V4zM14 5h-4v6h4zM9 4v8h6V4z" clip-rule="evenodd"></path></svg>'},5562:e=>{"use strict";e.exports=h},5809:e=>{"use strict";e.exports=p},5879:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H8.5v1.5H12a.5.5 0 0 1 0 1H4a.5.5 0 0 1 0-1h3.5V12H3a2 2 0 0 1-2-2zm2-1h10a1 1 0 0 1 1 1v5.5H2V3a1 1 0 0 1 1-1M2 9.5v.5a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-.5z" clip-rule="evenodd"></path></svg>'},6055:e=>{"use strict";e.exports=a},6300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M15 7.5a.52.52 0 0 1-.516.527H2.976L6.473 11.6a.535.535 0 0 1 0 .746.51.51 0 0 1-.73 0L1 7.5l4.743-4.846a.51.51 0 0 1 .73 0 .535.535 0 0 1 0 .746L2.976 6.973h11.508c.285 0 .516.236.516.527"></path></svg>'},6371:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#fff" d="M2.5 6.4h15v1.2h-15zM11.25 8.8H2.5V10h8.75zM6.25 12.4c0-.663.56-1.2 1.25-1.2H10c.69 0 1.25.537 1.25 1.2s-.56 1.2-1.25 1.2H7.5c-.69 0-1.25-.537-1.25-1.2M13.75 11.2c-.69 0-1.25.537-1.25 1.2s.56 1.2 1.25 1.2h2.5c.69 0 1.25-.537 1.25-1.2s-.56-1.2-1.25-1.2z"></path><path fill="#fff" fill-rule="evenodd" d="M0 4v12h20V4zm18.75 1.2H1.25v9.6h17.5z" clip-rule="evenodd"></path></svg>'},6420:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6.973 11.484c0 .285.236.516.527.516a.52.52 0 0 0 .527-.516V1.976L10.6 4.473c.206.202.54.202.746 0a.51.51 0 0 0 0-.73L7.5 0 3.654 3.743a.51.51 0 0 0 0 .73c.206.202.54.202.746 0l2.573-2.497zM1 8v7h13V8h1v8H0V8z" clip-rule="evenodd"></path></svg>'},6490:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8M13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97"></path><path fill="#000" d="M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828z"></path></svg>'},6499:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m6.036 12.157 8.01-8.01a.5.5 0 1 1 .707.707l-8.01 8.01a1 1 0 0 1-1.415 0L1.146 8.682a.5.5 0 1 1 .708-.707z"></path></svg>'},6542:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MSIgeT0iMTYiIHdpZHRoPSIxMyIgaGVpZ2h0PSI2IiByeD0iMiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTQiIHk9IjEwIiB3aWR0aD0iMzMiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPC9zdmc+DQo="},6739:e=>{"use strict";e.exports=d},6745:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0m1 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-7.676 2.228H7.34c-.213-1.138.621-2.13 1.375-3.025C9.28 6.532 9.8 5.914 9.8 5.328 9.8 4.5 9.2 3.9 7.976 3.9c-.816 0-1.572.36-2.268 1.092l-.648-.6C5.852 3.552 6.788 3 8.096 3c1.692 0 2.772.864 2.772 2.244 0 .864-.652 1.628-1.3 2.387-.71.831-1.413 1.655-1.244 2.597m.3 2.172c0 .48-.348.792-.768.792-.432 0-.78-.312-.78-.792s.348-.804.78-.804c.42 0 .768.324.768.804" clip-rule="evenodd"></path></svg>'},6884:e=>{"use strict";e.exports=n},7386:e=>{"use strict";e.exports=s},7408:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m2 1 12 7-12 7zm9.983 6.999L3 2.723v10.553z" clip-rule="evenodd"></path></svg>'},7528:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 2h12v4H2zM1 7V1h14v6zm1 3h12v4H2zm-1 5V9h14v6z" clip-rule="evenodd"></path></svg>'},7781:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.086 1.586A2 2 0 0 1 4.5 1h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V3a2 2 0 0 1 .586-1.414M4.5 2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zM6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5" clip-rule="evenodd"></path></svg>'},8081:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.5 14a.5.5 0 0 0 0-1h-6l3.953-3.459a.5.5 0 0 0-.658-.752L8 11.234V1.5a.5.5 0 0 0-1 0v9.734L4.206 8.789a.5.5 0 0 0-.659.752L7.5 13h-6a.5.5 0 0 0 0 1z" clip-rule="evenodd"></path></svg>'},8485:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M2.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1M4.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1M7 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M3 10.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5M3 14.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-.993.883L1 2v2h18V2a1 1 0 0 0-.883-.993zm1 4H1v13a1 1 0 0 0 .883.993L2 19h16a1 1 0 0 0 .993-.883L19 18z" clip-rule="evenodd"></path></svg>'},8640:e=>{"use strict";e.exports=m},8710:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7.5 0a.5.5 0 0 0-.5.5v14a.5.5 0 0 0 1 0V.5a.5.5 0 0 0-.5-.5M0 7.5c0 .291.231.527.516.527h3.508L2.527 9.6a.535.535 0 0 0 0 .746.51.51 0 0 0 .73 0L6 7.5 3.257 4.654a.51.51 0 0 0-.73 0 .535.535 0 0 0 0 .746l1.497 1.573H.516A.52.52 0 0 0 0 7.5m15 0a.52.52 0 0 1-.516.527h-3.508L12.473 9.6a.535.535 0 0 1 0 .746.51.51 0 0 1-.73 0L9 7.5l2.743-2.846a.51.51 0 0 1 .73 0 .535.535 0 0 1 0 .746l-1.497 1.573h3.508c.285 0 .516.236.516.527" clip-rule="evenodd"></path></svg>'},8739:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.974 2.078c.311-.36.75-.578 1.226-.578h3.6c.476 0 .915.219 1.226.578a2 2 0 0 1 .474 1.307v9.23a2 2 0 0 1-.474 1.307c-.311.36-.75.578-1.226.578H6.2c-.476 0-.915-.219-1.226-.578a2 2 0 0 1-.474-1.307v-9.23a2 2 0 0 1 .474-1.307M6.2 2.5a.63.63 0 0 0-.47.233 1 1 0 0 0-.23.652v9.23a1 1 0 0 0 .23.652c.138.16.31.233.47.233h3.6c.16 0 .332-.073.47-.233a1 1 0 0 0 .23-.652v-9.23a1 1 0 0 0-.23-.652.63.63 0 0 0-.47-.233zm.3 9.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1H7a.5.5 0 0 1-.5-.5" clip-rule="evenodd"></path></svg>'},9119:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MSIgeT0iOSIgd2lkdGg9IjEzIiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNCIgeT0iMTAiIHdpZHRoPSIzMyIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},9244:e=>{"use strict";e.exports=i},9298:e=>{"use strict";e.exports=g},9566:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 1.5a.5.5 0 0 0-1 0v6L9.541 3.547a.5.5 0 1 0-.752.658L11.234 7H1.5a.5.5 0 0 0 0 1h9.734l-2.445 2.794a.5.5 0 1 0 .752.659L13 7.5v6a.5.5 0 0 0 1 0z" clip-rule="evenodd"></path></svg>'}},t={};function f(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,f),o.exports}f.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return f.d(t,{a:t}),t},f.d=(e,t)=>{for(var i in t)f.o(t,i)&&!f.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.p="";var v={};return f.p=window.jimuConfig.baseUrl,(()=>{"use strict";f.r(v),f.d(v,{__set_webpack_public_path__:()=>po,default:()=>co});var e=f(7386),t=f(9244),i=f(4108),s=f(4321),o=f(5508),n=f.n(o),a=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const r=i=>{const s=window.SVG,{className:o}=i,r=a(i,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:l,src:n()},r)):(0,e.jsx)("svg",Object.assign({className:l},r))};var l=f(1496),c=f(9298);class d extends t.React.PureComponent{constructor(e){super(e),this.disableSkipTo=()=>{const{widgetId:e,browserSizeMode:s,currentPageId:o}=this.props,n=(0,i.getAppConfigAction)().appConfig;return!(0,t.getWidgetIdsInRootContainers)(n,s,o,l.searchUtils.getContentsInLayout).includes(e)},this.formatMessage=e=>this.props.formatMessage(e),this.onNameChanged=e=>{this.setState({label:e.target.value})},this.onNameBlur=e=>{this.props.onA11ySettingChange("a11yLabel",e.trim())},this.updateSkipToValue=()=>{this.props.onA11ySettingChange("addToA11ySkip",!this.props.addToSkip)},this.state={label:e.label||""}}componentDidUpdate(e,t){e.label!==this.props.label&&this.setState({label:this.props.label||""})}render(){const i=this.disableSkipTo(),{theme:o,addToSkip:n=!1}=this.props;return(0,e.jsx)(c.SettingSection,{className:(0,t.classNames)("a11y-setting-section",this.props.className),css:t.css`border-top: 1px solid ${o.sys.color.divider.secondary};`,children:(0,e.jsxs)(s.CollapsablePanel,{type:"default",wrapperClassName:"mt-4",level:1,defaultIsOpen:!0,role:"group",label:this.formatMessage("a11ySettings"),"aria-label":this.formatMessage("a11ySettings"),children:[(0,e.jsx)(c.SettingRow,{label:(0,e.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,e.jsx)("div",{children:this.formatMessage("a11yLabel")}),(0,e.jsx)(s.Tooltip,{showArrow:!0,placement:"right",describeChild:!0,enterDelay:0,"aria-live":"off",title:this.formatMessage("a11yLabelTip"),children:(0,e.jsx)(s.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0",css:t.css`width: 22px;`,disableHoverEffect:!0,disableRipple:!0,"aria-label":this.formatMessage("additionalInformation"),children:(0,e.jsx)(r,{})})})]}),flow:"wrap"}),(0,e.jsx)(c.SettingRow,{className:"mt-2",children:(0,e.jsx)(s.TextArea,{"aria-label":this.formatMessage("a11yLabel"),className:"w-100",height:60,spellCheck:!1,value:this.state.label,onChange:this.onNameChanged,onAcceptValue:this.onNameBlur})}),(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)(s.Label,{check:!0,centric:!0,children:[(0,e.jsx)(s.Checkbox,{style:{cursor:"pointer"},className:"mr-2",checked:!i&&!!n,disabled:this.disableSkipTo(),onChange:this.updateSkipToValue}),this.formatMessage("a11yEnableSkipTo")]})})]})})}}const p=t.ReactRedux.connect((e,t)=>{var i,s,o;return{browserSizeMode:null===(i=e.appStateInBuilder)||void 0===i?void 0:i.browserSizeMode,currentPageId:null===(o=null===(s=e.appStateInBuilder)||void 0===s?void 0:s.appRuntimeInfo)||void 0===o?void 0:o.currentPageId}})(d);class g extends t.React.PureComponent{constructor(){super(...arguments),this.formatMessage=e=>this.props.formatMessage(e),this.onSettingChange=(e,t)=>{const s=(0,i.getAppConfigAction)();if(s.appConfig)return s.editWidget(e,t).exec()},this.onA11ySettingChange=(e,t)=>{const i=this.props.widgetJson.set(e,t);this.onSettingChange(i.asMutable({deep:!0}))},this.renderWidgetSetting=o=>{const{theme:n,widgetJson:a,widgetsSettingRuntimeInfo:r,enableA11yForWidgetSettings:l}=this.props,c=r[o]&&r[o].isClassLoaded?i.WidgetSettingManager.getInstance().getWidgetSettingClass(o):null;return c&&a.config?(0,e.jsxs)(t.ErrorBoundary,{children:[(0,e.jsx)(c,{widgetId:o,onSettingChange:this.onSettingChange},o),l&&(0,e.jsx)(p,{theme:n,widgetId:o,label:a.a11yLabel,addToSkip:a.addToA11ySkip,onA11ySettingChange:this.onA11ySettingChange,formatMessage:this.formatMessage})]}):(0,e.jsx)(s.Loading,{type:s.LoadingType.Secondary})}}componentDidUpdate(){this.loadWidgetSettingClass()}componentDidMount(){this.loadWidgetSettingClass()}loadWidgetSettingClass(){const{widgetId:e}=this.props;e&&!i.WidgetSettingManager.getInstance().getWidgetSettingClass(e)&&i.WidgetSettingManager.getInstance().loadWidgetSettingClass(e)}render(){if(!this.props.widgetJson)return(0,e.jsx)(s.Loading,{type:s.LoadingType.Secondary});const{widgetId:i,enableA11yForWidgetSettings:o}=this.props;return(0,e.jsx)("div",{className:"setting-container",css:t.css`
        .jimu-widget-setting {
          height: ${o?"auto !important":"100%"};
        }
      `,children:i?this.renderWidgetSetting(i):(0,e.jsxs)("div",{children:["\xa0\xa0",this.formatMessage("noWidget")]})})}}const h=t.ReactRedux.connect((e,t)=>{var i,s,o,n;return{enableA11yForWidgetSettings:null!==(n=null===(o=null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.attributes)||void 0===o?void 0:o.enableA11yForWidgetSettings)&&void 0!==n&&n,widgetJson:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.widgets[t.widgetId]}})(g);var u=f(778),m=f.n(u),w=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const x=i=>{const s=window.SVG,{className:o}=i,n=w(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:m()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var y=f(1888),b=f(4337),I=f(5562);const S={width:110};class C extends t.React.PureComponent{constructor(e){super(e),this.isOpen=()=>{const{pagePart:e,pageId:t}=this.props,i=this.getAppConfig();return"body"===e||!!(i&&i.pages[t]&&i[e]&&i.pages[t][e])},this.formatMessage=e=>this.props.formatMessage(e),this.onSwitchChange=()=>{const{pageId:e,pagePart:s}=this.props,o=this.getAppConfig(),n=o.pages[e],a=o[s],r=(0,i.getAppConfigAction)();a||("header"===s?r.initHeaderLayout().editHeaderProperty(`height.${t.BrowserSizeMode.Large}`,75):r.initFooterLayout().editFooterProperty(`height.${t.BrowserSizeMode.Large}`,75));const l=n.set(s,!n[s]);r.editPageProperty(e,s,!n[s]).exec(),"body"===s||l[s]||i.builderAppSync.publishActivePagePartChangeToApp(t.PagePart.Body),this.setState({isOpen:l[s]})},this.onHeightChange=e=>{const t=s.utils.stringOfLinearUnit(e),{pagePart:o,browserSizeMode:n}=this.props;"header"===o?(0,i.getAppConfigAction)().editHeaderProperty(`height.${n}`,t).exec():(0,i.getAppConfigAction)().editFooterProperty(`height.${n}`,t).exec()},this.onStickHeaderChange=e=>{(0,i.getAppConfigAction)().editHeaderProperty("sticky",e.target.checked).exec()},this.onBackgroundColorChange=e=>{const{pageId:t,pagePart:s,theme:o}=this.props,n=y.colorUtils.getReadableThemeColor(e,o);"body"===s?(0,i.getAppConfigAction)().editPageProperty(t,"bodyBackgroundColor",e).editPageProperty(t,"bodyTextColor",n).exec():"header"===s?(0,i.getAppConfigAction)().editHeaderProperty("backgroundColor",e).editHeaderProperty("textColor",n).exec():(0,i.getAppConfigAction)().editFooterProperty("backgroundColor",e).editFooterProperty("textColor",n).exec()},this.onTextColorChange=e=>{const{pageId:t,pagePart:s}=this.props;"body"===s?(0,i.getAppConfigAction)().editPageProperty(t,"bodyTextColor",e).exec():"header"===s?(0,i.getAppConfigAction)().editHeaderProperty("textColor",e).exec():(0,i.getAppConfigAction)().editFooterProperty("textColor",e).exec()},this.state={isOpen:this.isOpen()}}getAppConfig(){return(0,t.getAppStore)().getState().appStateInBuilder&&(0,t.getAppStore)().getState().appStateInBuilder.appConfig||{pages:{empty:{}}}}componentDidUpdate(e){if(this.props.pageId!==e.pageId){const{pageJson:e,pagePart:t}=this.props;this.setState({isOpen:"body"===t||e&&e[t]})}}render(){var i,o,n,a,r,l,d;const p={body:this.formatMessage("body"),header:this.formatMessage("header"),footer:this.formatMessage("footer")},{pageId:g,pagePart:h,browserSizeMode:u,theme:m,header:f}=this.props,v=this.getAppConfig(),w=v.pages[g];let y,C;"body"===h?(y=w.bodyBackgroundColor,C=w.bodyTextColor):(y=null===(i=v[h])||void 0===i?void 0:i.backgroundColor,C=null===(o=v[h])||void 0===o?void 0:o.textColor);const j=this.formatMessage("backgroundColor"),A=this.formatMessage("foregroundColor"),T=(0,e.jsxs)(s.Label,{className:"setting-title d-flex justify-content-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:p[this.props.pagePart]})}),(0,e.jsx)("div",{className:"d-flex align-items-center",children:"body"===h?null:(0,e.jsx)(s.Switch,{checked:this.isOpen(),onChange:this.onSwitchChange,"aria-label":p[this.props.pagePart]})})]}),M=v.mainSizeMode,N=null===(a=null===(n=v[h])||void 0===n?void 0:n.height)||void 0===a?void 0:a[u],k=null===(l=null===(r=v[h])||void 0===r?void 0:r.height)||void 0===l?void 0:l[M],O=s.utils.stringOfLinearUnit(null!==(d=null!=N?N:k)&&void 0!==d?d:75);return(0,e.jsx)(c.SettingSection,{title:T,role:"group","aria-label":p[this.props.pagePart],children:(0,e.jsxs)(s.Collapse,{isOpen:this.state.isOpen,children:["body"===h?null:(0,e.jsx)(c.SettingRow,{label:this.formatMessage("dynamicHeight"),children:(0,e.jsx)(I.InputUnit,{value:O,min:0,onChange:this.onHeightChange,style:S,"aria-label":this.formatMessage("dynamicHeight")})}),(0,e.jsxs)(c.SettingRow,{"aria-label":this.formatMessage("dsFill"),label:this.formatMessage("dsFill"),children:[(0,e.jsx)(I.ColorContrastWarning,{backgroundColor:y,foregroundColor:C,theme:m}),(0,e.jsx)(b.ThemeColorPicker,{title:j,"aria-label":j,specificTheme:m,value:y,onChange:this.onBackgroundColorChange}),(0,e.jsx)(b.ThemeColorPicker,{title:A,"aria-label":A,className:"ml-1",type:"with-icon",icon:(0,e.jsx)(x,{size:"s"}),specificTheme:m,value:C,onChange:this.onTextColorChange})]}),"header"===h&&w.mode===t.PageMode.AutoScroll&&(0,e.jsx)(c.SettingRow,{flow:"wrap",children:(0,e.jsxs)(s.Label,{centric:!0,children:[(0,e.jsx)(s.Checkbox,{className:"mr-2",checked:Boolean(null==f?void 0:f.sticky),onChange:this.onStickHeaderChange}),this.formatMessage("keepFixedOnScroll")]})})]})})}}var j=f(6055);const A={};class T extends t.React.PureComponent{constructor(e){super(e),this.onMaxWidthChange=e=>{const t=this.props.pageJson;(0,i.getAppConfigAction)().editPageProperty(t.id,"maxWidth",e).exec()},this.formatMessage=e=>this.props.formatMessage(e),this.setPageWidthModeAuto=()=>{let e=this.props.pageJson;e=e.without("maxWidth"),(0,i.getAppConfigAction)().editPageProperty(e.id,"maxWidth",void 0).exec()},this.setPageWidthModeFixed=()=>{const e=this.props.pageJson;(0,i.getAppConfigAction)().editPageProperty(e.id,"maxWidth",1024).exec()},this.openWithDialogChanged=e=>{const t=this.props.pageJson;(0,i.getAppConfigAction)().editPageProperty(t.id,"autoOpenDialogId",e.target.value).exec()},this.onEffectSettingChange=(e,s)=>{const{pageJson:o}=this.props;(0,i.getAppConfigAction)().editPageProperty(o.id,"oneByOneEffect",s).exec(),(null==s?void 0:s.type)!==t.AnimationType.None&&i.builderAppSync.publishAnimationPreviewToApp({pageId:o.id,playMode:e,id:(0,t.getNextAnimationId)()})},this.previewAnimation=e=>{const{pageJson:s}=this.props;s.oneByOneEffect&&s.oneByOneEffect.type!==t.AnimationType.None&&i.builderAppSync.publishAnimationPreviewToApp({pageId:s.id,playMode:e,id:(0,t.getNextAnimationId)()})},this.state={isSetImageUrl:!1,currentImgUrlInput:""},this.fileInput=t.React.createRef()}getAppConfig(){return(0,t.getAppStore)().getState().appStateInBuilder&&(0,t.getAppStore)().getState().appStateInBuilder.appConfig||{pages:{empty:{}}}}layoutSetting(){var i;const{pageId:s,appTheme:o}=this.props,n=this.getAppConfig(),a=n.pages[s];if(a&&a.layout){const s=l.searchUtils.findLayoutId(a.layout,null===(i=(0,t.getAppStore)().getState().appStateInBuilder)||void 0===i?void 0:i.browserSizeMode,n.mainSizeMode),r=n.layouts[s];if((null==r?void 0:r.type)===t.LayoutType.FlowLayout)return(0,e.jsx)(j.FlowLayoutSetting,{layoutId:s,formatMessage:this.props.formatMessage});if((null==r?void 0:r.type)===t.LayoutType.GridLayout)return(0,e.jsx)(j.GridLayoutSetting,{layouts:a.layout,appTheme:o,formatMessage:this.props.formatMessage})}}getDialogList(){const e=[{value:"",index:-1,label:this.formatMessage("none")}],i=this.props.dialogs;return i&&(Object.keys(i).forEach(s=>{i[s].isSplash||i[s].mode!==t.DialogMode.Fixed||e.push({value:s,index:i[s].index,label:i[s].label})}),e.sort((e,t)=>e.index-t.index)),e}getStyle(){const{theme:e}=this.props;return t.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    .setting-row-label{
      line-height: 30px;
      font-size: 0.8125rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: ${e.ref.palette.neutral[900]};
    }
    .content-width-item {
      width: calc(50% - 4px);
      .img-container {
        width: auto;
        height: auto;
        cursor: pointer;
        outline: 1px solid ${e.ref.palette.neutral[700]};
        background-color: ${e.ref.palette.white} !important;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 8px;
        &.active {
          outline: 2px solid ${e.sys.color.primary.light};
        }
      }
      span {
        overflow: hidden;
        text-overflow: ellipsis;
        width: 100%;
      }
    }

    `}render(){const{pageMode:i,maxWidth:o,pageJson:n,pageId:a,appTheme:l,browserSizeMode:d,header:p,footer:g,dispatch:h}=this.props;if(!n)return null;const u=n.autoOpenDialogId||"",m=n.oneByOneEffect,v=n.maxWidth>0?0:1,w=window.isExpressBuilder;return(0,e.jsxs)("div",{className:"setting-pane widget-builder-page-setting",css:this.getStyle(),children:[!w&&(0,e.jsxs)(c.SettingSection,{children:[(0,e.jsxs)("div",{className:"setting-row-label d-flex justify-content-between",children:[(0,e.jsx)("span",{children:this.formatMessage("openWithWindow")}),(0,e.jsx)(s.Tooltip,{title:this.formatMessage("openWithWindowTip"),placement:"bottom",children:(0,e.jsx)(s.Button,{icon:!0,type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"d-inline jimu-outline-inside",children:(0,e.jsx)(r,{})})})]}),(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(s.Select,{size:"sm",value:u,onChange:this.openWithDialogChanged,"aria-label":this.formatMessage("openWithWindow"),children:this.getDialogList().map((t,i)=>(0,e.jsx)("option",{value:t.value,selected:t.value===u,children:t.label},i))})})]}),i===t.PageMode.AutoScroll&&(0,e.jsxs)(c.SettingSection,{title:this.formatMessage("contentWidth"),children:[(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex w-100 justify-content-between",role:"radiogroup","aria-label":this.formatMessage("contentWidth"),children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-center content-width-item",children:[(0,e.jsx)(s.Button,{icon:!0,role:"radio",type:"tertiary",className:"img-container p-0 "+(0===v?"active":""),"aria-label":this.formatMessage("dsCustom"),"aria-checked":0===v,onClick:this.setPageWidthModeFixed,children:(0,e.jsx)(s.Icon,{autoFlip:!0,width:0===v?105:107,height:0===v?66:68,icon:f(2113)})}),(0,e.jsx)("span",{title:this.formatMessage("dsCustom"),className:"text-center",children:this.formatMessage("dsCustom")})]}),(0,e.jsxs)("div",{className:"d-flex flex-column align-items-center content-width-item",children:[(0,e.jsx)(s.Button,{icon:!0,role:"radio",type:"tertiary",className:"img-container p-0 "+(1===v?"active":""),"aria-label":this.formatMessage("dsAuto"),"aria-checked":1===v,onClick:this.setPageWidthModeAuto,children:(0,e.jsx)(s.Icon,{autoFlip:!0,width:1===v?105:107,height:1===v?66:68,icon:f(4189)})}),(0,e.jsx)("span",{title:this.formatMessage("dsAuto"),className:"text-center",children:this.formatMessage("dsAuto")})]})]})}),0===v&&(0,e.jsx)(c.SettingRow,{label:this.formatMessage("maxWidth"),children:(0,e.jsx)(s.NumericInput,{"aria-label":this.formatMessage("maxWidth"),className:"setting-input-select",min:300,onChange:this.onMaxWidthChange,value:isNaN(o)?"":o,style:{width:"110px"}})})]}),(0,e.jsx)(c.SettingSection,{role:"group","aria-label":this.formatMessage("animation"),title:this.formatMessage("animation"),children:(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(I.AnimationSettingComponent,{contentId:n.id,oneByOneSetting:m,onSettingChange:this.onEffectSettingChange,previewEnabled:!0,supportAsOne:!1,supportOneByOne:!0,isRoot:!0,onPreviewClicked:this.previewAnimation,formatMessage:this.formatMessage})})}),(0,e.jsx)(C,{formatMessage:this.formatMessage,emptyLayout:A,dispatch:h,pageId:a,pagePart:"body",pageJson:n,theme:l,browserSizeMode:d}),(p||!w)&&(0,e.jsx)(C,{formatMessage:this.formatMessage,emptyLayout:A,dispatch:h,pageId:a,pagePart:"header",pageJson:n,header:p,theme:l,browserSizeMode:d}),(g||!w)&&(0,e.jsx)(C,{formatMessage:this.formatMessage,emptyLayout:A,dispatch:h,pageJson:n,pageId:a,pagePart:"footer",footer:g,theme:l,browserSizeMode:d}),this.layoutSetting()]})}}const M=t.ReactRedux.connect((e,t)=>{var i,s,o,n,a,r,l,c;return{pageJson:null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.pages[t.pageId],dialogs:null===(n=null===(o=e.appStateInBuilder)||void 0===o?void 0:o.appConfig)||void 0===n?void 0:n.dialogs,header:null===(r=null===(a=e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===r?void 0:r.header,footer:null===(c=null===(l=e.appStateInBuilder)||void 0===l?void 0:l.appConfig)||void 0===c?void 0:c.footer}})(T);var N=f(5879),k=f.n(N),O=f(7781),P=f.n(O),R=f(8739),D=f.n(R),L=f(92),E=f.n(L),B=f(9119),z=f.n(B),U=f(6542),_=f.n(U);class W extends t.React.PureComponent{constructor(o){var n,a;super(o),this.getDefaultText=(e=this.props.dialogJson.confirmBeforeClose)=>{let t="";return this.props.dialogJson.interactionType&&(t=this.formatMessage(e?"dialogConfirmationDefaultText":"dialogPreventDisplayAgainDefaultText")),t},this.formatMessage=e=>this.props.formatMessage(e),this.onTextChanged=e=>{this.setState({text:e.target.value})},this.onButtonTextChanged=e=>{this.setState({buttonText:e.target.value})},this.onTextBLur=e=>{const t=this.defaultText;this.textBlur("text",e,t)},this.onButtonTextBLur=e=>{const t=this.formatMessage("ok");this.textBlur("buttonText",e,t)},this.textBlur=(e,t,i)=>{if(i===(t=t.trim())&&(t=""),this.interactionStyles[e]!==t&&this.updateInteractionStyles(e,t),""===t){const t={};t[e]=i,this.setState(t)}},this.updateDialogMask=e=>{e=e||this.defaultOverlayColor,this.editDialogProperty("overlayColor",e)},this.getDialogBackground=()=>{var e;const{dialogJson:t}=this.props;return(null===(e=t.dialogBackground)||void 0===e?void 0:e.color)===this.defaultBackgroundColor?t.dialogBackground.set("color",""):t.dialogBackground},this.getDialogTextColor=()=>{const{dialogJson:e}=this.props;return e.textColor===this.defaultTextColor?"":e.textColor},this.updateDialogQuickBackground=e=>{var t,i;const{dialogJson:s}=this.props;(null===(t=s.dialogBackground)||void 0===t?void 0:t.image)&&(e.image=null===(i=s.dialogBackground)||void 0===i?void 0:i.image),this.editDialogProperty("dialogBackground",e)},this.updateDialogBackground=e=>{const{color:t,image:i,fillType:s}=this.props.dialogJson.dialogBackground;s!==e.fillType?this.editDialogProperty("dialogBackground",Object.assign({},e,{fillType:e.fillType,color:t})):i!==e.image?this.editDialogProperty("dialogBackground",Object.assign({},e,{image:e.image,color:t})):""===e.color?this.editDialogProperty("dialogBackground",Object.assign({},e,{color:this.defaultBackgroundColor})):this.editDialogProperty("dialogBackground",e)},this.updateDialogForeground=e=>{this.editDialogProperty("textColor",e)},this.updateDialogColor=(e,t)=>{let s=e;""===e.color&&(s=Object.assign({},e,{color:this.defaultBackgroundColor})),(0,i.getAppConfigAction)().editDialogProperty(this.props.dialogId,"dialogBackground",s).editDialogProperty(this.props.dialogId,"textColor",t).exec()},this.updateBorder=e=>{const t=this.props.dialogJson.without("borderTop","borderRight","borderBottom","borderLeft").set("border",e);this.editDialog(t)},this.updateBorderSide=(e,t)=>{const i=s.utils.capitalizeFirstLetter(e),o=this.props.dialogJson.without("border").set("border"+i,t);this.editDialog(o)},this.updateBorderRadius=e=>{this.editDialogProperty("borderRadius",e)},this.updateShadow=e=>{this.editDialogProperty("boxShadow",e)},this.onEffectSettingChange=(e,s)=>{const{dialogJson:o}=this.props,n=e===t.AnimationPlayMode.OneByOne?"oneByOneEffect":"effect";(0,i.getAppConfigAction)().editDialogProperty(o.id,n,s).exec(),i.builderAppSync.publishAnimationPreviewToApp({dialogId:o.id,playMode:e,id:(0,t.getNextAnimationId)()})},this.previewAnimation=e=>{const{dialogJson:s}=this.props;(s.effect||s.oneByOneEffect)&&i.builderAppSync.publishAnimationPreviewToApp({dialogId:s.id,playMode:e,id:(0,t.getNextAnimationId)()})},this.getBrowserIcons=i=>{if(window.isExpressBuilder)return null;const o=!this.props.dialogJson.layout[t.BrowserSizeMode.Medium],n=!this.props.dialogJson.layout[t.BrowserSizeMode.Small],a=this.props.browserSizeMode===t.BrowserSizeMode.Large||!this.props.dialogJson.layout[this.props.browserSizeMode],r=this.props.browserSizeMode===t.BrowserSizeMode.Large&&o||this.props.browserSizeMode===t.BrowserSizeMode.Medium||this.props.browserSizeMode===t.BrowserSizeMode.Small&&o&&n,l=this.props.browserSizeMode===t.BrowserSizeMode.Large&&n||this.props.browserSizeMode===t.BrowserSizeMode.Medium&&o&&n||this.props.browserSizeMode===t.BrowserSizeMode.Small,c=this.props.theme.ref.palette.neutral[800],d=this.props.formatMessage("appliedToLargeScreen"),p=this.props.formatMessage("appliedToMediumScreen"),g=this.props.formatMessage("appliedToSmallScreen");return(0,e.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[a&&(0,e.jsx)(s.Tooltip,{title:d,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:i,icon:k(),color:c,className:"border-0"})})}),r&&(0,e.jsx)(s.Tooltip,{title:p,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:i,icon:P(),color:c,className:"border-0"})})}),l&&(0,e.jsx)(s.Tooltip,{title:g,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:i,icon:D(),color:c,className:"border-0"})})})]})},this.getConfirmationDOMs=i=>(0,e.jsxs)("div",{className:"confirmation-container mt-4",children:[(0,e.jsx)(c.SettingRow,{className:"confirmation-item",label:this.formatMessage("checkboxText")}),(0,e.jsx)("div",{className:"confirmation-item",children:(0,e.jsx)(s.TextArea,{className:"w-100",height:60,spellCheck:!1,placeholder:this.formatMessage("confirmationRequiredText"),value:this.state.text,"aria-label":this.formatMessage("checkboxText"),onChange:this.onTextChanged,onAcceptValue:this.onTextBLur})}),(0,e.jsx)(c.SettingRow,{label:this.formatMessage("fontSize"),children:(0,e.jsx)(I.InputUnit,{style:{width:"80px"},units:[s.DistanceUnits.PIXEL,s.DistanceUnits.REM],value:this.getFontSize("textSize"),"aria-label":this.formatMessage("fontSize"),onChange:e=>{this.updateCheckboxTextSize("textSize",e.distance+e.unit)}})}),i.interactionType!==t.DialogInteractionType.NoButton&&(0,e.jsxs)("div",{children:[(0,e.jsx)(c.SettingRow,{className:"confirmation-item",label:this.formatMessage("checkboxButtonText")}),(0,e.jsx)(c.SettingRow,{className:"confirmation-item",children:(0,e.jsx)(s.TextInput,{type:"text",size:"sm",className:"w-100",spellCheck:!1,placeholder:this.formatMessage("confirmationRequiredText"),value:this.state.buttonText,"aria-label":this.formatMessage("checkboxButtonText"),onChange:this.onButtonTextChanged,onAcceptValue:this.onButtonTextBLur})}),(0,e.jsx)(c.SettingRow,{label:this.formatMessage("fontSize"),children:(0,e.jsx)(I.InputUnit,{style:{width:"80px"},units:[s.DistanceUnits.PIXEL,s.DistanceUnits.REM],value:this.getFontSize("buttonTextSize"),"aria-label":this.formatMessage("fontSize"),onChange:e=>{this.updateCheckboxTextSize("buttonTextSize",e.distance+e.unit)}})})]})]}),this.defaultText=this.getDefaultText(),this.defaultBackgroundColor=o.isClassicTheme?"var(--light)":"var(--sys-color-surface-overlay)",this.defaultOverlayColor=o.isClassicTheme?"var(--dark-900)":"#000000",this.defaultTextColor="var(--sys-color-surface-overlay-text)",this.state={interactionPanel:o.dialogJson.confirmBeforeClose?"confirmation":"prevent",text:(null===(n=this.interactionStyles)||void 0===n?void 0:n.text)||this.defaultText,buttonText:(null===(a=this.interactionStyles)||void 0===a?void 0:a.buttonText)||this.formatMessage("ok")},this.isRTL=(0,t.getAppStore)().getState().appContext.isRTL}componentDidUpdate(e){var t,i,s,o,n,a;const{dialogJson:r}=this.props;r.interactionStyles&&((null===(t=r.interactionStyles)||void 0===t?void 0:t.text)===(null===(i=e.dialogJson.interactionStyles)||void 0===i?void 0:i.text)&&(null===(s=r.interactionStyles)||void 0===s?void 0:s.buttonText)===(null===(o=e.dialogJson.interactionStyles)||void 0===o?void 0:o.buttonText)||(this.defaultText=this.getDefaultText(),this.setState({text:(null===(n=this.interactionStyles)||void 0===n?void 0:n.text)||this.defaultText,buttonText:(null===(a=this.interactionStyles)||void 0===a?void 0:a.buttonText)||this.formatMessage("ok")})),r.confirmBeforeClose!==e.dialogJson.confirmBeforeClose&&this.setState({interactionPanel:r.confirmBeforeClose?"confirmation":"prevent"}))}getDialogBrowserSizeMode(){return this.props.dialogJson.layout[this.props.browserSizeMode]?this.props.browserSizeMode:t.BrowserSizeMode.Large}defaultInteractionStyles(){return{text:"",textSize:"13px",buttonText:"",buttonTextSize:"16px"}}getAppConfig(){return(0,t.getAppStore)().getState().appStateInBuilder&&(0,t.getAppStore)().getState().appStateInBuilder.appConfig||{dialogs:{empty:{}}}}editDialogProperty(e,t){(0,i.getAppConfigAction)().editDialogProperty(this.props.dialogId,e,t).exec()}editDialog(e){(0,i.getAppConfigAction)().editDialog(e).exec()}getPixelFromPercentage(e){return e*parseFloat(e.split("%")[0])/100}getPixelValue(e="0px",t){return e.includes(s.DistanceUnits.PIXEL)?parseFloat(e.split("px")[0]):t*parseFloat(e.split("%")[0])/100}getPixelSizeFromFixedToAnchored(e,i){const s=e.sizeMode[i];let o,n,a=t.utils.findViewportSize(this.getAppConfig(),this.props.browserSizeMode);return 0===a.width&&(a=t.CONSTANTS.SCREEN_RESOLUTIONS[i][1]),o="CUSTOM"===s.widthMode?this.getPixelValue(s.width,a.width):a.width-this.getPixelValue(s.left,a.width)-this.getPixelValue(s.right,a.width),n="CUSTOM"===s.heightMode?this.getPixelValue(s.height,a.height):a.height-this.getPixelValue(s.top,a.height)-this.getPixelValue(s.bottom,a.height),{width:o,height:n}}setDialogMode(e){let i=this.props.dialogJson;if(e===i.mode)return;const s=this.getDialogBrowserSizeMode();if(e===t.DialogMode.Anchored){const{width:e,height:t}=this.getPixelSizeFromFixedToAnchored(i,s);i=i.setIn(["sizeMode",s],{width:e+"px",height:t+"px"}).set("overlayColor",null)}else{const e=i.sizeMode[s];i=i.setIn(["sizeMode",s],{position:t.FixedPosition.MiddleCenter,widthMode:"CUSTOM",heightMode:"CUSTOM",width:e.width,height:e.height}).set("overlayColor",this.defaultOverlayColor)}i=i.set("mode",e).set("interactionType",null).set("interactionStyles",null).set("confirmBeforeClose",!0).set("alwaysShowConfirmation",!1).set("blockPage",!0),this.editDialog(i)}handlePositionSizeChangeForFixed(e){const t=this.getDialogBrowserSizeMode(),i=this.props.dialogJson.setIn(["sizeMode",t],e);this.editDialog(i)}handleSizeChangeForAnchored(e,t){const i=this.getDialogBrowserSizeMode(),s=this.props.dialogJson.setIn(["sizeMode",i,e],t.distance.toFixed(2)+t.unit);this.editDialog(s)}getDialogSizeForAnchored(e){const t=this.props.dialogJson.sizeMode[this.getDialogBrowserSizeMode()][e];if(!t)return null;const i=t.indexOf(s.DistanceUnits.PIXEL)>=0?s.DistanceUnits.PIXEL:s.DistanceUnits.PERCENTAGE;return{distance:t.split(i)[0],unit:i}}getFontSize(e){const t=this.interactionStyles[e],i=t.indexOf(s.DistanceUnits.PIXEL)>=0?s.DistanceUnits.PIXEL:s.DistanceUnits.REM;return{distance:t.split(i)[0],unit:i}}setBlockPage(e){let t=this.props.dialogJson;t=t.set("blockPage",e).set("overlayColor",e?this.defaultOverlayColor:null).set("closeWhenClickOverlay",!1),this.editDialog(t)}setInteraction(e){let i=this.props.dialogJson;i=i.set("interactionType",e?t.DialogInteractionType.NoButton:null).set("interactionStyles",e?this.defaultInteractionStyles():null).set("confirmBeforeClose",!0).set("alwaysShowConfirmation",!1),this.editDialog(i),this.setState({interactionPanel:e?"confirmation":""})}changeInteractionType(e){let t=this.props.dialogJson;e!==t.interactionType&&(t=t.set("interactionType",e),this.editDialog(t))}setConfirmationType(e){this.defaultText=this.getDefaultText(e),""===this.props.dialogJson.interactionStyles.text&&this.setState({text:this.defaultText});let t=this.props.dialogJson;t=t.set("confirmBeforeClose",e).set("alwaysShowConfirmation",!e),this.editDialog(t),this.setState({interactionPanel:e?"confirmation":"prevent"})}updateInteractionStyles(e,t){this.editDialogProperty("interactionStyles",this.interactionStyles.set(e,t))}updateCheckboxTextSize(e,t){this.interactionStyles[e]!==t&&this.updateInteractionStyles(e,t)}getStyle(){return t.css`
      .mode-radio {
        cursor: pointer;
        &.mode-label-disabled {
          cursor: inherit;
        }
      }
      .mode-label {
        margin-left: 0.5rem;
        cursor: pointer;
        &.mode-label-disabled {
          cursor: inherit;
          color: var(--ref-palette-neutral-800);
        }
      }
      .confirmation-container {
        .confirmation-item{
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
      }

      .size-setting {
        width: 100%;
        .size-container {
          height: 26px;
          display: flex;
          justify-content: space-between;
          .unit-container {
            display: flex;
            align-items: center;
            width: calc(50% - 10px);

            .size-label{
              color: var(--ref-palette-neutral-900);
              align-items: center;
              margin-bottom: 0;
            }
            .size-input {
              margin-left: 6px;
            }
          }
        }
      }

      .interaction-container {
        .interaction-type-container {
          display: flex;
          justify-content: space-between;
          .jimu-btn {
            padding: 0;
            background-color: var(--ref-palette-neutral-300);
            border: 2px solid transparent;
            &.active{
              border: 2px solid var(--sys-color-primary-main);
            }
          }
        }
      }

    `}render(){const{dialogJson:o}=this.props,n=o.isSplash||i.utils.getPageListByDialogId(this.getAppConfig().pages,o.id).length>0;if(!o.id)return null;const a=o.mode===t.DialogMode.Anchored?[s.DistanceUnits.PIXEL]:[s.DistanceUnits.PIXEL,s.DistanceUnits.PERCENTAGE];this.interactionStyles=o.interactionStyles?o.interactionStyles:this.defaultInteractionStyles();const r=o.sizeMode[this.getDialogBrowserSizeMode()],l=this.formatMessage(o.mode===t.DialogMode.Fixed?"positionAndSize":"size"),d=window.isExpressBuilder;return(0,e.jsxs)("div",{className:"setting-pane widget-builder-page-setting",css:this.getStyle(),children:[!d&&(0,e.jsxs)(c.SettingSection,{role:"group",title:this.formatMessage("mode"),"aria-label":this.formatMessage("mode"),children:[(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center",children:(0,e.jsx)(s.Tooltip,{placement:"bottom",title:this.formatMessage("fixedModeTip"),children:(0,e.jsxs)("div",{className:"align-items-center d-flex",children:[(0,e.jsx)(s.Radio,{className:"mode-radio",onChange:()=>{this.setDialogMode(t.DialogMode.Fixed)},name:"dialogMode",checked:o.mode===t.DialogMode.Fixed}),(0,e.jsx)("label",{className:"mode-label",onClick:()=>{this.setDialogMode(t.DialogMode.Fixed)},children:this.formatMessage("fixedMode")})]})})})}),(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center",children:(0,e.jsx)(s.Tooltip,{placement:"bottom",title:n?this.formatMessage(o.isSplash?"splashDlgWarning":"pageDlgWarning"):this.formatMessage("anchoredModeTip"),children:(0,e.jsxs)("div",{className:"align-items-center d-flex",children:[(0,e.jsx)(s.Radio,{className:(0,t.classNames)("mode-radio",n?"mode-radio-disabled":""),onChange:()=>{this.setDialogMode(t.DialogMode.Anchored)},name:"dialogMode",checked:o.mode===t.DialogMode.Anchored,disabled:n}),(0,e.jsx)("label",{className:(0,t.classNames)("mode-label",n?"mode-label-disabled":""),onClick:()=>{!n&&this.setDialogMode(t.DialogMode.Anchored)},children:this.formatMessage("anchoredMode")})]})})})})]}),(d||!this.props.lockLayout)&&(0,e.jsxs)(c.SettingSection,{role:"group","aria-label":l,children:[(0,e.jsxs)("div",{className:"d-flex mb-4",children:[(0,e.jsx)("h6",{className:"flex-lg-grow-1 mb-0 text-truncate title2 hint-paper",children:l}),this.getBrowserIcons(12)]}),o.mode===t.DialogMode.Fixed?(0,e.jsx)(I.FixedPositionSize,{fixedPositionSizeJson:r,onChange:e=>{this.handlePositionSizeChangeForFixed(e)}}):(0,e.jsx)("div",{className:"size-setting",children:(0,e.jsxs)("div",{className:"size-container",children:[(0,e.jsxs)("div",{className:"unit-container",role:"group",children:[(0,e.jsx)(s.Tooltip,{placement:"bottom",title:this.formatMessage("width"),children:(0,e.jsx)("label",{className:"size-label",children:"W"})}),(0,e.jsx)(I.InputUnit,{className:"size-input",units:a,value:this.getDialogSizeForAnchored("width"),"aria-label":this.formatMessage("width"),min:0,onChange:e=>{this.handleSizeChangeForAnchored("width",e)}})]}),(0,e.jsxs)("div",{className:"unit-container",children:[(0,e.jsx)(s.Tooltip,{placement:"bottom",title:this.formatMessage("height"),children:(0,e.jsx)("label",{className:"size-label",children:"H"})}),(0,e.jsx)(I.InputUnit,{className:"size-input",units:a,value:this.getDialogSizeForAnchored("height"),"aria-label":this.formatMessage("height"),min:0,onChange:e=>{this.handleSizeChangeForAnchored("height",e)}})]})]})})]}),o.mode===t.DialogMode.Fixed&&(0,e.jsx)(c.SettingSection,{title:(0,e.jsxs)("label",{className:"d-flex w-100 align-items-center justify-content-between mb-0",children:[(0,e.jsx)("div",{className:"text-truncate title2 hint-paper",children:this.formatMessage("blockPage")}),(0,e.jsx)(s.Switch,{"aria-label":this.formatMessage("blockPage"),checked:o.blockPage,onChange:(e,t)=>{this.setBlockPage(t)}})]}),children:o.blockPage&&(0,e.jsx)(c.SettingRow,{label:this.formatMessage("maskColor"),children:(0,e.jsx)(b.ThemeColorPicker,{specificTheme:this.props.appTheme,value:o.overlayColor,"aria-label":this.formatMessage("maskColor"),onChange:this.updateDialogMask})})}),(0,e.jsxs)(c.SettingSection,{role:"group",title:this.formatMessage("closeOptions"),"aria-label":this.formatMessage("closeOptions"),children:[(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)(s.Label,{check:!0,centric:!0,children:[(0,e.jsx)(s.Checkbox,{style:{cursor:"pointer"},className:"mr-2",checked:!!o.closeWhenClickOverlay,disabled:o.mode===t.DialogMode.Fixed&&!o.blockPage,onChange:()=>{this.editDialogProperty("closeWhenClickOverlay",!o.closeWhenClickOverlay)}}),this.formatMessage("clickOutside")]})}),o.mode===t.DialogMode.Fixed&&(0,e.jsxs)("div",{className:"mt-4",children:[(0,e.jsx)(c.SettingRow,{tag:"label",label:this.formatMessage("interaction"),children:(0,e.jsx)(s.Switch,{checked:!!o.interactionType,onChange:(e,t)=>{this.setInteraction(t)}})}),o.interactionType&&(0,e.jsxs)("div",{className:"interaction-container mt-4",children:[(0,e.jsx)(c.SettingRow,{className:"confirmation-item",label:this.formatMessage("style")}),(0,e.jsxs)("div",{className:"interaction-type-container mt-4 mb-4",role:"radiogroup","aria-label":this.formatMessage("style"),children:[(0,e.jsx)(s.Tooltip,{title:this.formatMessage("interactionStyle1"),placement:"bottom",children:(0,e.jsx)(s.Button,{role:"radio",icon:!0,size:"sm",type:"tertiary","aria-checked":o.interactionType===t.DialogInteractionType.NoButton,onClick:()=>{this.changeInteractionType(t.DialogInteractionType.NoButton)},active:o.interactionType===t.DialogInteractionType.NoButton,children:(0,e.jsx)(s.Icon,{width:65,height:26,icon:E(),flip:this.isRTL?"horizontal":null})})}),(0,e.jsx)(s.Tooltip,{title:this.formatMessage("interactionStyle2"),placement:"bottom",children:(0,e.jsx)(s.Button,{role:"radio",icon:!0,size:"sm",type:"tertiary","aria-checked":o.interactionType===t.DialogInteractionType.ButtonInline,onClick:()=>{this.changeInteractionType(t.DialogInteractionType.ButtonInline)},active:o.interactionType===t.DialogInteractionType.ButtonInline,children:(0,e.jsx)(s.Icon,{width:65,height:26,icon:z(),flip:this.isRTL?"horizontal":null})})}),(0,e.jsx)(s.Tooltip,{title:this.formatMessage("interactionStyle3"),placement:"bottom",children:(0,e.jsx)(s.Button,{role:"radio",icon:!0,size:"sm",type:"tertiary","aria-checked":o.interactionType===t.DialogInteractionType.ButtonBlock,onClick:()=>{this.changeInteractionType(t.DialogInteractionType.ButtonBlock)},active:o.interactionType===t.DialogInteractionType.ButtonBlock,children:(0,e.jsx)(s.Icon,{width:65,height:26,icon:_(),flip:this.isRTL?"horizontal":null})})})]}),(0,e.jsxs)("div",{className:"p-0 m-0",role:"group","aria-label":this.formatMessage("type"),children:[(0,e.jsx)(c.SettingRow,{className:"confirmation-item",label:this.formatMessage("type")}),(0,e.jsxs)("div",{role:"radiogroup",className:"mt-2",children:[(0,e.jsx)(s.CollapsableRadio,{name:"collapsable-confirmation-radio",label:this.formatMessage("confirmation"),role:"group","aria-label":this.formatMessage("confirmation"),wrapLabel:!0,disableActionForUnchecked:!0,checked:o.confirmBeforeClose,isOpen:"confirmation"===this.state.interactionPanel,onRequestOpen:()=>{this.setState({interactionPanel:"confirmation"})},onRequestClose:()=>{this.setState({interactionPanel:""})},onCheckedChange:()=>{this.setConfirmationType(!0)},children:(0,e.jsxs)("div",{className:"pl-1 pr-1 mb-2",children:[this.getConfirmationDOMs(o),(0,e.jsx)(c.SettingRow,{className:"mt-2 mb-4",children:(0,e.jsxs)(s.Label,{check:!0,centric:!0,children:[(0,e.jsx)(s.Checkbox,{style:{cursor:"pointer"},className:"mr-2",checked:o.alwaysShowConfirmation,onChange:()=>{this.editDialogProperty("alwaysShowConfirmation",!o.alwaysShowConfirmation)}}),this.formatMessage("alwaysShow")]})})]})}),(0,e.jsx)(s.CollapsableRadio,{name:"collapsable-confirmation-radio",label:this.formatMessage("preventDisplayAgain"),role:"group","aria-label":this.formatMessage("preventDisplayAgain"),wrapLabel:!0,disableActionForUnchecked:!0,checked:!o.confirmBeforeClose,isOpen:"prevent"===this.state.interactionPanel,onRequestOpen:()=>{this.setState({interactionPanel:"prevent"})},onRequestClose:()=>{this.setState({interactionPanel:""})},onCheckedChange:()=>{this.setConfirmationType(!1)},children:(0,e.jsx)("div",{className:"pl-1 pr-1 mb-2",children:this.getConfirmationDOMs(o)})})]})]})]})]})]}),(0,e.jsx)(c.SettingSection,{role:"group",title:this.formatMessage("animation"),"aria-label":this.formatMessage("animation"),children:(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(I.AnimationSettingComponent,{contentId:o.id,effectSetting:o.effect,oneByOneSetting:o.oneByOneEffect,onSettingChange:this.onEffectSettingChange,previewEnabled:!0,supportAsOne:!0,supportOneByOne:!0,onPreviewClicked:this.previewAnimation,formatMessage:this.formatMessage})})}),(0,e.jsx)(I.ThemeBackgroundSection,{background:this.getDialogBackground(),onChange:this.updateDialogBackground,hasForeground:!0,foreground:this.getDialogTextColor(),onForegroundChange:this.updateDialogForeground,onBothChange:this.updateDialogColor}),(0,e.jsx)(I.ThemeBorderSection,{border:o.border,borderTop:o.borderTop,borderLeft:o.borderLeft,borderRight:o.borderRight,borderBottom:o.borderBottom,borderRadius:o.borderRadius,onBorderChange:this.updateBorder,onBorderSideChange:this.updateBorderSide,onBorderRadiusChange:this.updateBorderRadius}),(0,e.jsx)(I.ThemeBoxShadowSection,{value:o.boxShadow,onChange:this.updateShadow})]})}}const F=t.ReactRedux.connect((e,t)=>{var i,s,o;return{lockLayout:null===(o=null===(s=null===(i=null==e?void 0:e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.forBuilderAttributes)||void 0===o?void 0:o.lockLayout,dialogJson:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dialogs[t.dialogId]||{}}})(function(t){const i=s.hooks.useClassicTheme();return(0,e.jsx)(W,Object.assign({},t,{isClassicTheme:i}))});var H=f(2838),V=f.n(H),G=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const $=i=>{const s=window.SVG,{className:o}=i,n=G(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:V()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var J=f(6499),Z=f.n(J),K=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const q=i=>{const s=window.SVG,{className:o}=i,n=K(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Z()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Q=f(6490),X=f.n(Q),Y=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const ee=i=>{const s=window.SVG,{className:o}=i,n=Y(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:X()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},te={value:"",openType:t.OpenTypes.NewWindow,linkType:t.LinkType.WebAddress};class ie extends t.React.PureComponent{constructor(e){super(e),this.linkSettingTrigger=t.React.createRef(),this.getCurrentPageName=e=>{const{appConfig:t,pageId:i}=e;return t.pages[i].label||""},this.openBrowseImage=()=>{const e=this.fileInput.current.files;if(!e||!e[0])return;const t=new FileReader;t.readAsDataURL(e[0]),t.onload=e=>{const t=e.target;this.changeIcon(t.result)}},this.setImageUrl=()=>{const{currentImgUrlInput:e}=this.state;""!==e&&(this.setState({isSetImageUrl:!1}),this.changeIcon(e))},this.getPageType=e=>{const{pages:t}=this.props.appConfig;for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.settingLinkConfirm=e=>{this.setState({isShowLinkSetting:!1}),(e.value||""===e.value)&&this.setState({currentUrl:e.value}),this.changeUrl(e.value,e.openType)},this.changeUrl=(e,t)=>{(0,i.getAppConfigAction)().editPageProperty(this.props.pageId,"linkUrl",e||"#").editPageProperty(this.props.pageId,"openTarget",t).exec(),te.value=e,te.openType=t},this.changeIcon=e=>{(0,i.getAppConfigAction)().editPageProperty(this.props.pageId,"icon",e).exec()},this.formatMessage=e=>this.props.formatMessage(e),this.state={isSetImageUrl:!1,currentImgUrlInput:"",isShowLinkSetting:!1,currentUrl:this.props.currentUrl||""},this.fileInput=t.React.createRef()}resetLinkParam(){te.value="",te.openType=t.OpenTypes.NewWindow;const e=this.props.appConfig.pages[this.props.pageId];e&&e.linkUrl&&"#"!==e.linkUrl&&(te.value=e.linkUrl),e&&e.openTarget&&(te.openType=e.openTarget)}getStyle(e){return t.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    `}render(){var i;const{isSetImageUrl:o,currentImgUrlInput:n,isShowLinkSetting:a}=this.state;return this.resetLinkParam(),(0,e.jsxs)("div",{className:"setting-pane widget-builder-page-setting widget-setting-image",children:[(0,e.jsxs)(c.SettingSection,{children:[o&&(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex flex-row justify-content-around border w-100 align-items-center",children:[(0,e.jsx)(s.TextInput,{className:"border-0 w-100",value:n,placeholder:`${this.formatMessage("urlIsHere")}...`,onChange:e=>{this.setState({currentImgUrlInput:e.target.value})},onPressEnter:this.setImageUrl}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:this.setImageUrl,children:(0,e.jsx)(q,{className:"float-right"})}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:()=>{this.setState({isSetImageUrl:!1})},children:(0,e.jsx)($,{className:"float-right"})})]})}),(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)(s.Button,{className:"w-100 text-default set-link-btn",onClick:()=>{this.setState({isShowLinkSetting:!a})},ref:this.linkSettingTrigger,children:[(0,e.jsx)(ee,{className:"mr-4"}),"Set link"]})})]}),a&&(0,e.jsx)(c.LinkSelectorSidePopper,{isOpen:a,isLinkPageSetting:!0,linkParam:(0,t.Immutable)(te),onSettingCancel:()=>{this.setState({isShowLinkSetting:!1})},onSettingConfirm:this.settingLinkConfirm,trigger:null===(i=this.linkSettingTrigger)||void 0===i?void 0:i.current})]})}}ie.mapExtraStateProps=e=>({pageId:e.appRuntimeInfo.currentPageId});const se=(0,y.withTheme)(ie);class oe extends t.React.PureComponent{constructor(e){super(e),this.getCurrentPageName=e=>{const{appConfig:t,pageId:i}=e;return t.pages[i].label||""},this.openBrowseImage=()=>{const e=this.fileInput.current.files;if(!e||!e[0])return;const t=new FileReader;t.readAsDataURL(e[0]),t.onload=e=>{const t=e.target;this.changeIcon(t.result)}},this.setImageUrl=()=>{const{currentImgUrlInput:e}=this.state;""!==e&&(this.setState({isSetImageUrl:!1}),this.changeIcon(e))},this.formatMessage=e=>this.props.formatMessage(e),this.getPageType=e=>{const{pages:t}=this.props.appConfig;for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.changeIcon=e=>{(0,i.getAppConfigAction)().editPageProperty(this.props.pageId,"icon",e).exec()},this.state={isSetImageUrl:!1,currentImgUrlInput:""},this.fileInput=t.React.createRef()}getStyle(){return t.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    `}render(){const{isSetImageUrl:t,currentImgUrlInput:i}=this.state;return(0,e.jsx)("div",{className:"setting-pane widget-builder-page-setting widget-setting-image",children:(0,e.jsxs)(c.SettingSection,{children:[(0,e.jsx)(s.TextInput,{placeholder:this.formatMessage("noSettingOptions"),disabled:!0,style:{border:0,background:"transparent",userSelect:"none"}}),t&&(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex flex-row justify-content-around border w-100 align-items-center",children:[(0,e.jsx)(s.TextInput,{className:"border-0 w-100",value:i,placeholder:`${this.formatMessage("urlIsHere")}...`,onChange:e=>{this.setState({currentImgUrlInput:e.target.value})},onPressEnter:this.setImageUrl}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:this.setImageUrl,children:(0,e.jsx)(q,{className:"float-right"})}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:()=>{this.setState({isSetImageUrl:!1})},children:(0,e.jsx)($,{className:"float-right"})})]})})]})})}}oe.mapExtraStateProps=e=>({pageId:e.appRuntimeInfo.currentPageId});const ne=oe;var ae=f(8640),re=f(4651),le=f.n(re),ce=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const de=i=>{const s=window.SVG,{className:o}=i,n=ce(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:le()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var pe=f(2606),ge=f.n(pe),he=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const ue=i=>{const s=window.SVG,{className:o}=i,n=he(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:ge()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};class me extends t.React.PureComponent{constructor(e){super(e),this.formatMessage=e=>this.props.formatMessage(e),this._enableEditing=e=>{e.stopPropagation(),this.setState({isEditingLabel:!0})},this._handleLabelInputBlur=e=>{const t=e.target.value,{valid:i}=this._checkLabel(t);i?this.setState({isEditingLabel:!1}):this.setState({isEditingLabel:!1,currentLabel:this.props.view.label})},this._handleLabelInputEnter=e=>{if("Enter"===e.key){const e=this.inputRef.value,{valid:t}=this._checkLabel(e);t&&this.setState({isEditingLabel:!1})}},this._onLabelChange=e=>{this.setState({currentLabel:e.target.value})},this._onLabelUpdate=e=>{if(e&&e.trim().length>0){const{view:t}=this.props;(0,i.getAppConfigAction)().editViewProperty(t.id,"label",e).exec()}else this.setState({currentLabel:this.props.view.label})},this._checkLabel=e=>{if(e.includes(","))return{valid:!1,msg:this.props.formatMessage("noCommaInLabel")};const{view:t}=this.props,s=(0,i.getAppConfigAction)().appConfig;return i.appConfigUtils.isLabelDuplicated(s,"view",t.id,e)?{valid:!1,msg:this.props.formatMessage("duplicatedLabel")}:{valid:!0}},this.toggleDropDown=e=>{null==e||e.stopPropagation(),this.setState({isDropDownOpen:!this.state.isDropDownOpen})},this.state={currentLabel:this.props.view.label,isEditingLabel:!1,isDropDownOpen:!1},this.dropDownItems=[(0,t.Immutable)({label:this.formatMessage("rename"),event:this._enableEditing.bind(this),visible:!0,a11yFocusBack:!1}),(0,t.Immutable)({label:this.formatMessage("duplicate"),event:this._duplicateView.bind(this),visible:!0}),(0,t.Immutable)({label:this.formatMessage("sectionDelete"),event:this._removeView.bind(this),visible:!0})],this.readonlyDropDownItems=[this.dropDownItems[0]],this.dropDownItemsWithoutDelete=[this.dropDownItems[0],this.dropDownItems[1]]}componentDidUpdate(e,t){!t.isEditingLabel&&this.state.isEditingLabel&&this._focusInput(),e.view.label!==this.props.view.label&&this.setState({currentLabel:this.props.view.label})}_removeView(){const{view:e,sectionId:t,selected:s}=this.props,o=(0,i.getAppConfigAction)().appConfig.sections[t].views;if(s){const s=o.indexOf(e.id);let n;n=s>0?o[s-1]:o[1],i.builderAppSync.publishSectionNavInfoToApp(t,{currentViewId:n,useProgress:!1})}(0,i.getAppConfigAction)().removeView(e.id,t).exec()}_duplicateView(){if(!this.props.view)return;const e=(0,i.getAppConfigAction)(),s=e.duplicateView(this.props.view.id,this.props.sectionId,!0);e.exec(),t.lodash.defer(()=>{this.props.onSelect(s.id)})}_focusInput(){this.inputRef&&(this.inputRef.select(),(0,t.focusElementInKeyboardMode)(this.inputRef,!0))}_getStyle(){return t.css`
    padding: 2px;
    cursor: pointer;
    position: relative;
    .drop-down {
      text-align:right;
      .popover{
        .popover-inner {
          box-shadow: 0 0 0;
        }
      }
    }
    .view-item-drag:hover {
      cursor: pointer !important;
    }
    .label-con {
      max-width: 9rem;
    }
    .label-input {
      max-width: 9rem;
    }
    .view-item-drag {
      z-index: 1;
      background-color: transparent;
      box-shadow: none;
    }
    `}render(){const{editable:i,view:o}=this.props,{isEditingLabel:n,currentLabel:a}=this.state,r=i?this.props.canRemove?this.dropDownItems:this.dropDownItemsWithoutDelete:this.readonlyDropDownItems;return(0,e.jsx)("div",{css:this._getStyle(),className:"d-flex justify-content-between flex-grow-1","data-testid":"viewItem",children:(0,e.jsxs)("div",{className:"w-100 view-item-drag d-flex justify-content-start",children:[(0,e.jsx)("div",{className:"align-items-center d-flex",css:t.css`width: 22px;`,children:o.icon?(0,e.jsx)(s.Icon,{icon:o.icon.svg}):(0,e.jsx)(ue,{})}),(0,e.jsxs)("div",{className:"d-flex align-items-center",children:[!n&&(0,e.jsx)("div",{title:a,className:"label-con text-truncate",onDoubleClick:this._enableEditing,children:a}),n&&(0,e.jsx)("div",{children:(0,e.jsx)(s.TextInput,{title:a,className:"label-input",type:"text",value:a,ref:e=>{this.inputRef=e},checkValidityOnChange:this._checkLabel,checkValidityOnAccept:this._checkLabel,onChange:this._onLabelChange,onAcceptValue:this._onLabelUpdate,onBlur:this._handleLabelInputBlur,onPressEnter:this._handleLabelInputEnter})})]}),(0,e.jsx)("div",{className:"drop-down d-flex toc-item-icon ml-auto",children:(0,e.jsx)("div",{title:this.formatMessage("options"),children:(0,e.jsxs)(s.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:this.toggleDropDown,isOpen:this.state.isDropDownOpen,children:[(0,e.jsx)(s.DropdownButton,{arrow:!1,icon:!0,onClick:this.toggleDropDown,type:"tertiary",children:(0,e.jsx)(de,{size:"s"})}),(0,e.jsx)(s.DropdownMenu,{children:r.map((t,i)=>(0,e.jsx)(s.DropdownItem,{onClick:t.event,a11yFocusBack:t.a11yFocusBack,children:t.label},i))})]})})})]})})}}var fe=f(5809);class ve extends t.React.PureComponent{constructor(){super(...arguments),this.getEchoBackground=()=>{const{view:e}=this.props,t=e.backgroundPosition?e.backgroundPosition.toUpperCase():"";let i;e.backgroundIMage&&(i="object"==typeof e.backgroundIMage?e.backgroundIMage:{});const o=t?s.FillType[t]:s.FillType.FIT;return{color:e.backgroundColor,fillType:o,image:i}},this.onBackgroundStyleChange=e=>{this.setState({config:e});const t=e.image?e.image:{},{view:s}=this.props,o=(0,i.getAppConfigAction)();if(o.editViewProperty(s.id,"backgroundPosition",e.fillType).editViewProperty(s.id,"backgroundColor",e.color?e.color:null).editViewProperty(s.id,"backgroundIMage",t),s.backgroundColor!==e.color){const t=y.colorUtils.getReadableThemeColor(e.color,(0,y.getTheme2)());o.editViewProperty(s.id,"textColor",t)}o.exec()},this.onForegroundChange=e=>{const{view:t}=this.props;(0,i.getAppConfigAction)().editViewProperty(t.id,"textColor",e).exec()},this.onIconChange=e=>{const{view:t}=this.props;(0,i.getAppConfigAction)().editViewProperty(t.id,"icon",e).exec()},this.onLazyLoadChange=e=>{const{view:t}=this.props;(0,i.getAppConfigAction)().editViewProperty(t.id,"lazyLoad",e.target.checked).exec()}}render(){var t,i;const{view:o}=this.props;if(!o)return null;const n=[{svg:ge(),properties:{filename:this.props.formatMessage("view")}}];return(0,e.jsxs)("div",{role:"group","aria-label":o.label,children:[(0,e.jsx)(c.SettingSection,{children:(0,e.jsx)(c.SettingRow,{role:"group",label:this.props.formatMessage("icon"),"aria-label":this.props.formatMessage("icon"),children:(0,e.jsx)(fe.IconPicker,{previewOptions:{color:!0},configurableOption:"none",className:"flex-none",icon:null!==(t=o.icon)&&void 0!==t?t:n[0],onChange:this.onIconChange,customIcons:n,setButtonUseColor:!1,hideRemove:!0})})}),(0,e.jsx)(c.SettingSection,{title:this.props.formatMessage("background"),children:(0,e.jsx)(c.SettingRow,{role:"group","aria-label":this.props.formatMessage("background"),className:"background-setting-con",flow:"wrap",children:(0,e.jsx)(I.BackgroundSetting,{background:this.getEchoBackground(),onChange:this.onBackgroundStyleChange,hasForeground:!0,foreground:o.textColor,onForegroundChange:this.onForegroundChange})})}),(0,e.jsx)(c.SettingSection,{children:(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex align-items-center w-100",children:[(0,e.jsxs)("label",{children:[(0,e.jsx)(s.Checkbox,{checked:null!==(i=o.lazyLoad)&&void 0!==i&&i,onChange:this.onLazyLoadChange}),(0,e.jsx)("span",{className:"ml-2",children:this.props.formatMessage("lazyLoading")})]}),(0,e.jsx)(s.Tooltip,{placement:"bottom",showArrow:!0,title:this.props.formatMessage("lazyLoadingTip"),children:(0,e.jsx)(s.Button,{className:"ml-auto",size:"sm",type:"tertiary",icon:!0,children:(0,e.jsx)(r,{})})})]})})})]})}}var we=f(2491),xe=f.n(we),ye=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const be=i=>{const s=window.SVG,{className:o}=i,n=ye(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:xe()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Ie=f(3593),Se=f.n(Ie),Ce=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const je=i=>{const s=window.SVG,{className:o}=i,n=Ce(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Se()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Ae=f(9566),Te=f.n(Ae),Me=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Ne=i=>{const s=window.SVG,{className:o}=i,n=Me(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Te()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var ke=f(8081),Oe=f.n(ke),Pe=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Re=i=>{const s=window.SVG,{className:o}=i,n=Pe(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Oe()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};class De extends t.React.PureComponent{constructor(){super(...arguments),this.snapLeft=()=>{this.props.onDirectionChange("l")},this.snapRight=()=>{this.props.onDirectionChange("r")},this.snapTop=()=>{this.props.onDirectionChange("t")},this.snapBottom=()=>{this.props.onDirectionChange("b")}}render(){const{direction:t,formatMessage:i}=this.props;return(0,e.jsxs)(s.ButtonGroup,{variant:"contained",color:"default",size:"sm",children:[(0,e.jsx)(s.Tooltip,{placement:"bottom",title:l.utils.isRTL()?i("right"):i("left"),children:(0,e.jsx)(s.Button,{icon:!0,active:"l"===t,"aria-pressed":"l"===t,onClick:this.snapLeft,children:(0,e.jsx)(be,{size:"s",autoFlip:!0})})}),(0,e.jsx)(s.Tooltip,{placement:"bottom",title:i("top"),children:(0,e.jsx)(s.Button,{icon:!0,active:"t"===t,"aria-pressed":"t"===t,onClick:this.snapTop,children:(0,e.jsx)(je,{size:"s"})})}),(0,e.jsx)(s.Tooltip,{placement:"bottom",title:l.utils.isRTL()?i("left"):i("right"),children:(0,e.jsx)(s.Button,{icon:!0,active:"r"===t,"aria-pressed":"r"===t,onClick:this.snapRight,children:(0,e.jsx)(Ne,{size:"s",autoFlip:!0})})}),(0,e.jsx)(s.Tooltip,{placement:"bottom",title:i("bottom"),children:(0,e.jsx)(s.Button,{icon:!0,active:"b"===t,"aria-pressed":"b"===t,onClick:this.snapBottom,children:(0,e.jsx)(Re,{size:"s"})})})]})}}var Le=f(3662),Ee=f.n(Le),Be=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const ze=i=>{const s=window.SVG,{className:o}=i,n=Be(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Ee()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},Ue=[s.DistanceUnits.PIXEL];class _e extends t.React.PureComponent{constructor(e){super(e),this._addView=()=>{const{section:e}=this.props,s=(0,i.getAppConfigAction)(),o=s.addView(e.id);s.exec(),t.lodash.defer(()=>{this._selectView(o)})},this._duplicateView=()=>{const{activeViewId:e,sectionId:s}=this.props,o=(0,i.getAppConfigAction)(),n=o.duplicateView(e,s,!0);o.exec(),t.lodash.defer(()=>{this._selectView(n.id)})},this._showViewList=()=>{this.setState({isShowViewList:!0})},this._hideViewList=()=>{this.setState({isShowViewList:!1})},this._selectView=(e,t=!1)=>{const{section:s,activeViewId:o}=this.props;o!==e&&i.builderAppSync.publishSectionNavInfoToApp(s.id,{previousViewId:this.props.activeViewId,currentViewId:e,useProgress:!1}),t&&this.setState({showViewSetting:!0})},this.getStyle=()=>t.css`
      .toc-dropzone {
        margin-top: 0.5rem;
      }
      .toc-dropzone .jimu-widget-setting--row.row{
        margin-top: 0;
      }
      .jimu-widget-setting--row-label{
        color:${this.props.theme.ref.palette.neutral[1e3]};
      }
    `,this.hideViewSetting=()=>{this.setState({showViewSetting:!1})},this.onAutoPlayChanged=e=>{const{section:t}=this.props;(0,i.getAppConfigAction)().editSectionProperty(t.id,"autoPlay",e.target.checked).exec()},this.onLoopChanged=e=>{const{section:t}=this.props;(0,i.getAppConfigAction)().editSectionProperty(t.id,"loop",e.target.checked).exec()},this.onIntervalChanged=e=>{const t=+e;if(t>=1){const{section:e}=this.props;(0,i.getAppConfigAction)().editSectionProperty(e.id,"interval",t).exec()}},this.updateNav=(e,t,s)=>{const{section:o}=this.props;(0,i.getAppConfigAction)().editSectionProperty(o.id,`${e}.${t}`,s).exec()},this.onA11ySettingChange=(e,t)=>{const{section:s}=this.props;return(0,i.getAppConfigAction)().editSectionProperty(s.id,e,t).exec()},this.viewListRef=t.React.createRef(),this.popperRef=t.React.createRef(),this.state={showViewSetting:!1,isShowViewList:!0}}render(){var o,n,a,r,d,g,h,u,m,f,v,w,x,y,b,S,C,j,A,T,M,N;const{section:k,views:O,theme:P,dispatch:R,activeViewId:D,editable:L,enableA11yForWidgetSettings:E,formatMessage:B}=this.props,{showViewSetting:z}=this.state;if(!k)return null;const U=t.css`
      cursor: pointer;
      margin-top: ${t.polished.rem(-8)};

      .toggle-view {
        transform: ${this.state.isShowViewList?null:"rotate(180deg)"};
      }
    `,_=O.find(e=>e.id===D),W=null!==(n=null===(o=k.dotsNav)||void 0===o?void 0:o.position)&&void 0!==n?n:"b";return(0,e.jsx)("div",{className:"flexbox-layout-setting h-100",css:this.getStyle(),children:(0,e.jsxs)("div",{className:"h-100 w-100",children:[(0,e.jsxs)(c.SettingCollapse,{css:t.css`border-bottom: 1px solid var(--ref-palette-neutral-700)`,label:B("views"),className:"p-4",isOpen:this.state.isShowViewList,onRequestOpen:this._showViewList,onRequestClose:this._hideViewList,children:[(0,e.jsx)(c.SettingRow,{className:"mt-4",children:(0,e.jsxs)(s.Button,{ref:this.popperRef,css:U,className:"w-100",type:"primary",onClick:this._addView,title:B("newView"),children:[(0,e.jsx)(ze,{className:"mr-0"}),(0,e.jsx)("span",{className:"ml-2",children:B("newView")})]})}),(0,e.jsx)("div",{ref:this.viewListRef,className:"toc-dropzone",children:(0,e.jsx)(ae.List,{size:"sm",className:"selected-fields-list",itemsJson:Array.from(O).map((e,t)=>({itemStateDetailContent:e,itemStateChecked:D===e.id,itemKey:`${t}`})),dndEnabled:!0,onUpdateItem:(e,t)=>{const{itemJsons:s}=t.props,[,o]=s,n=o.map(e=>e.itemStateDetailContent);e.updateType===ae.TreeItemActionType.HandleDidDrop&&(0,i.getAppConfigAction)().editSectionProperty(k.id,"views",n.map(e=>e.id)).exec(),this._selectView(D)},onClickItemBody:(e,t)=>{const{itemJsons:i}=t.props,s=i[0].itemStateDetailContent;this._selectView(s.id,!0)},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:ae.TreeItemActionType.RenderOverrideItem,children:[{name:ae.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemBody,children:[{name:ae.TreeItemActionType.RenderOverrideItemDragHandle},{name:ae.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(t,i)=>{const{itemJsons:s}=i.props,o=s[0],n=o.itemStateDetailContent,a=+o.itemKey;return(0,e.jsx)(me,{index:a,canRemove:O.length>1,formatMessage:B,isLastItem:a===O.length-1,dispatch:R,sectionId:k.id,theme:P,view:n,isFirstItem:0===a,onSelect:e=>{this._selectView(e,!0)},selected:D===n.id,editable:L})}})})]}),(0,e.jsxs)(c.SettingSection,{role:"group","aria-label":B("tools"),title:B("tools"),children:[(0,e.jsx)(c.SettingRow,{tag:"label",label:B("arrows"),children:(0,e.jsx)(s.Switch,{checked:null!==(r=null===(a=k.arrowsNav)||void 0===a?void 0:a.visible)&&void 0!==r&&r,onChange:()=>{var e,t;this.updateNav("arrowsNav","visible",!(null!==(t=null===(e=k.arrowsNav)||void 0===e?void 0:e.visible)&&void 0!==t&&t))}})}),(null===(d=k.arrowsNav)||void 0===d?void 0:d.visible)&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(c.SettingRow,{role:"group",label:B("direction"),"aria-label":B("direction"),children:(0,e.jsx)(c.DirectionSelector,{size:"sm",vertical:"v"===k.arrowsNav.direction,onChange:e=>{this.updateNav("arrowsNav","direction",e?"v":"h")}})}),(0,e.jsxs)(c.SettingRow,{role:"group",label:B("size"),"aria-label":B("size"),flow:"wrap",children:[(0,e.jsx)(s.Slider,{min:5,max:100,step:1,value:null!==(g=k.arrowsNav.size)&&void 0!==g?g:20,css:t.css`width: 50%`,"aria-label":B("size"),onChange:e=>{this.updateNav("arrowsNav","size",e.target.value)}}),(0,e.jsx)(I.InputUnit,{min:5,max:100,units:Ue,onChange:e=>{this.updateNav("arrowsNav","size",e.distance)},value:`${null!==(h=k.arrowsNav.size)&&void 0!==h?h:20}px`,css:t.css`width: 40%; margin-left: auto;`})]}),(0,e.jsxs)(c.SettingRow,{role:"group",label:B("offset"),"aria-label":B("offset"),flow:"wrap",children:[(0,e.jsx)(s.Slider,{min:-100,max:100,step:1,value:null!==(u=k.arrowsNav.offset)&&void 0!==u?u:8,css:t.css`width: 50%`,"aria-label":B("offset"),onChange:e=>{this.updateNav("arrowsNav","offset",e.target.value)}}),(0,e.jsx)(I.InputUnit,{min:-100,max:100,units:Ue,value:`${null!==(m=k.arrowsNav.offset)&&void 0!==m?m:8}px`,onChange:e=>{this.updateNav("arrowsNav","offset",e.distance)},css:t.css`width: 40%; margin-left: auto;`})]})]}),(0,e.jsx)(c.SettingRow,{tag:"label",label:B("dots"),children:(0,e.jsx)(s.Switch,{checked:null!==(v=null===(f=k.dotsNav)||void 0===f?void 0:f.visible)&&void 0!==v&&v,onChange:()=>{var e,t;this.updateNav("dotsNav","visible",!(null!==(t=null===(e=k.dotsNav)||void 0===e?void 0:e.visible)&&void 0!==t&&t))}})}),(null===(w=k.dotsNav)||void 0===w?void 0:w.visible)&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(c.SettingRow,{role:"group",label:B("position"),"aria-label":B("position"),children:(0,e.jsx)(De,{direction:W,formatMessage:B,onDirectionChange:e=>{this.updateNav("dotsNav","position",e)}})}),(0,e.jsxs)(c.SettingRow,{role:"group",label:B("size"),"aria-label":B("size"),flow:"wrap",children:[(0,e.jsx)(s.Slider,{min:5,max:30,step:1,value:null!==(x=k.dotsNav.size)&&void 0!==x?x:8,css:t.css`width: 50%`,"aria-label":B("size"),onChange:e=>{this.updateNav("dotsNav","size",e.target.value)}}),(0,e.jsx)(I.InputUnit,{min:5,max:30,units:Ue,value:`${null!==(y=k.dotsNav.size)&&void 0!==y?y:8}px`,onChange:e=>{this.updateNav("dotsNav","size",e.distance)},css:t.css`width: 40%; margin-left: auto;`})]}),(0,e.jsxs)(c.SettingRow,{role:"group",label:B("offset"),"aria-label":B("offset"),flow:"wrap",children:[(0,e.jsx)(s.Slider,{min:-100,max:100,step:1,value:null!==(b=k.dotsNav.offset)&&void 0!==b?b:50,css:t.css`width: 50%`,"aria-label":B("offset"),onChange:e=>{this.updateNav("dotsNav","offset",e.target.value)}}),(0,e.jsx)(I.InputUnit,{min:-100,max:100,units:Ue,value:`${null!==(S=k.dotsNav.offset)&&void 0!==S?S:50}px`,onChange:e=>{this.updateNav("dotsNav","offset",e.distance)},css:t.css`width: 40%; margin-left: auto;`})]}),(0,e.jsxs)(c.SettingRow,{role:"group",label:B("spacing"),"aria-label":B("spacing"),flow:"wrap",children:[(0,e.jsx)(s.Slider,{min:0,max:30,step:1,value:null!==(C=k.dotsNav.spacing)&&void 0!==C?C:10,css:t.css`width: 50%`,"aria-label":B("spacing"),onChange:e=>{this.updateNav("dotsNav","spacing",e.target.value)}}),(0,e.jsx)(I.InputUnit,{min:0,max:30,units:Ue,value:`${null!==(j=k.dotsNav.spacing)&&void 0!==j?j:10}px`,onChange:e=>{this.updateNav("dotsNav","spacing",e.distance)},css:t.css`width: 40%; margin-left: auto;`})]})]})]}),(0,e.jsxs)(c.SettingSection,{role:"group",children:[(0,e.jsx)(c.SettingRow,{tag:"label",label:B("autoPlay"),children:(0,e.jsx)(s.Switch,{checked:null!==(A=k.autoPlay)&&void 0!==A&&A,onChange:this.onAutoPlayChanged})}),k.autoPlay&&(0,e.jsx)(c.SettingRow,{label:B("interval"),children:(0,e.jsx)(s.NumericInput,{size:"sm",css:t.css`width: 4rem`,value:null!==(T=k.interval)&&void 0!==T?T:l.DEFAULT_AUTOPLAY_INTERVAL,min:1,max:3600,"aria-label":B("interval"),onAcceptValue:this.onIntervalChanged})}),k.autoPlay&&(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)(s.Label,{check:!0,children:[(0,e.jsx)(s.Checkbox,{checked:null===(M=k.loop)||void 0===M||M,onChange:this.onLoopChanged,className:"mr-2"}),B("loop")]})})]}),E&&(0,e.jsx)(p,{theme:P,widgetId:k.id,label:k.a11yLabel,addToSkip:k.addToA11ySkip,onA11ySettingChange:this.onA11ySettingChange,formatMessage:B}),(0,e.jsx)(c.SidePopper,{isOpen:z,position:"right",toggle:this.hideViewSetting,trigger:null===(N=this.viewListRef)||void 0===N?void 0:N.current,title:null==_?void 0:_.label,backToFocusNode:this.popperRef.current,children:(0,e.jsx)(ve,{formatMessage:B,appTheme:this.props.appTheme,view:_})})]})})}}const We=t.ReactRedux.connect((e,i)=>{var s,o,n,a,r,l,c,d,p,g;const{sectionId:h}=i,{appConfig:u}=e.appStateInBuilder,m=u.sections[h];if(!m)return null;const f=m.views.map(e=>u.views[e]),v=null===(n=null===(o=null===(s=e.appStateInBuilder)||void 0===s?void 0:s.appRuntimeInfo)||void 0===o?void 0:o.sectionNavInfos)||void 0===n?void 0:n[m.id],w=null!==(a=null==v?void 0:v.currentViewId)&&void 0!==a?a:m.views[0],x=null!==(d=null===(c=null===(l=null===(r=e.appStateInBuilder)||void 0===r?void 0:r.appConfig)||void 0===l?void 0:l.forBuilderAttributes)||void 0===c?void 0:c.lockLayout)&&void 0!==d&&d,y=null===(g=null===(p=e.appStateInBuilder)||void 0===p?void 0:p.appRuntimeInfo)||void 0===g?void 0:g.appMode;return{section:m,views:f,activeViewId:w,browserSizeMode:e.appStateInBuilder&&e.appStateInBuilder.browserSizeMode,editable:y===t.AppMode.Design&&!x}})(_e);var Fe=f(6884);class He extends t.React.PureComponent{constructor(e){super(e),this.formatMessage=e=>this.props.formatMessage(e),this._enableEditing=e=>{e.stopPropagation(),this.setState({isEditingLabel:!0})},this._disableEditing=()=>{this._onLabelUpdate(this.inputRef.value),this.setState({isEditingLabel:!1})},this._handleInputEnter=e=>{"Enter"===e.key&&this.setState({isEditingLabel:!1})},this._onLabelUpdate=e=>{const{screen:t}=this.props;e&&`${e}`.trim().length>0?(0,i.getAppConfigAction)().editScreenProperty(t.id,"label",e).exec():this.inputRef.value=t.label},this._onLabelChange=e=>{this.setState({currentLabel:e.target.value})},this.toggleDropDown=e=>{null==e||e.stopPropagation(),this.setState({isDropDownOpen:!this.state.isDropDownOpen})},this.state={isEditingLabel:!1,currentLabel:this.props.screen.label,isDropDownOpen:!1},this.dropDownItems=[(0,t.Immutable)({label:this.formatMessage("rename"),event:this._enableEditing.bind(this),visible:!0,a11yFocusBack:!1}),(0,t.Immutable)({label:this.formatMessage("duplicate"),event:this._duplicateView.bind(this),visible:!0}),(0,t.Immutable)({label:this.formatMessage("sectionDelete"),event:this._removeScreen.bind(this),visible:!0})],this.readonlyDropDownItems=[this.dropDownItems[0]],this.dropDownItemsWithoutDelete=[this.dropDownItems[0],this.dropDownItems[1]]}componentDidUpdate(e,t){!t.isEditingLabel&&this.state.isEditingLabel&&this._focusInput(),e.screen.label!==this.props.screen.label&&this.setState({currentLabel:this.props.screen.label})}_removeScreen(e){e.stopPropagation();const{index:t}=this.props;this.props.onRemove(t)}_duplicateView(){const{index:e}=this.props;this.props.onDuplicate(e)}_focusInput(){this.inputRef&&(this.inputRef.select(),(0,t.focusElementInKeyboardMode)(this.inputRef,!0))}_getStyle(){const{theme:e}=this.props;return t.css`
      padding: 2px 2px 2px 10px;
      cursor: pointer;
      position: relative;
      height: ${t.polished.rem(32)};

      .drop-down {
        text-align: right;
        .popover {
          .popover-inner {
            box-shadow: 0 0 0;
          }
        }
      }
      .drag-icon {
        visibility: hidden;
        color: ${e.ref.palette.neutral[1e3]};
        cursor: move;
      }
      .screen-item-drag:hover {
        cursor: pointer !important;
      }
      .label-con {
        max-width: 9rem;
      }
      .label-input {
        max-width: 9rem;
      }
      .screen-item-drag {
        z-index: 1;
        background-color: transparent;
        box-shadow: none;
      }
    `}render(){const{index:i,browserSizeMode:o,editable:n}=this.props,{label:a}=this.props.screen,{isEditingLabel:r}=this.state,l=!n||o!==t.BrowserSizeMode.Large?this.readonlyDropDownItems:this.props.canRemove?this.dropDownItems:this.dropDownItemsWithoutDelete;return(0,e.jsx)("div",{css:this._getStyle(),className:"d-flex justify-content-between flex-grow-1","data-testid":"screenItem",children:(0,e.jsxs)("div",{className:"w-100 screen-item-drag d-flex justify-content-between","data-index":i,children:[(0,e.jsxs)("div",{className:"d-flex align-items-center",children:[!r&&(0,e.jsx)("div",{title:a,className:"label-con text-truncate",onDoubleClick:this._enableEditing,children:a}),r&&(0,e.jsx)("div",{children:(0,e.jsx)(s.TextInput,{title:a,className:"label-input",type:"text",value:this.state.currentLabel,ref:e=>{this.inputRef=e},onChange:this._onLabelChange,onAcceptValue:this._disableEditing,onPressEnter:this._handleInputEnter})})]}),(0,e.jsx)("div",{className:"drop-down d-flex toc-item-icon",children:(0,e.jsx)("div",{title:this.formatMessage("options"),css:t.css`
              & > div {
                height: 100%;
              }
            `,children:(0,e.jsxs)(s.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:this.toggleDropDown,isOpen:this.state.isDropDownOpen,children:[(0,e.jsx)(s.DropdownButton,{arrow:!1,icon:!0,onClick:this.toggleDropDown,type:"tertiary",children:(0,e.jsx)(de,{size:"s"})}),(0,e.jsx)(s.DropdownMenu,{children:l.map((t,i)=>(0,e.jsx)(s.DropdownItem,{onClick:t.event,a11yFocusBack:t.a11yFocusBack,children:t.label},i))})]})})})]})})}}const Ve=t.ReactRedux.connect((e,t)=>{const{screenId:i}=t,{appConfig:s}=e.appStateInBuilder;return{screen:s.screens[i]}})(He);var Ge=f(8710),$e=f.n(Ge),Je=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Ze=i=>{const s=window.SVG,{className:o}=i,n=Je(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:$e()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},Ke=[s.DistanceUnits.PIXEL,s.DistanceUnits.PERCENTAGE];class qe extends t.React.PureComponent{constructor(e){super(e),this.onMainBackgroundChange=e=>{var t;const{screen:s}=this.props,o=(0,i.getAppConfigAction)();if(o.editScreenProperty(s.id,"main.background",e),(null===(t=s.main.background)||void 0===t?void 0:t.color)!==e.color){const t=y.colorUtils.getReadableThemeColor(e.color,(0,y.getTheme2)());o.editScreenProperty(s.id,"main.textColor",t)}o.exec()},this.onMainForegroundChange=e=>{const{screen:t}=this.props;(0,i.getAppConfigAction)().editScreenProperty(t.id,"main.textColor",e).exec()},this.onSideBackgroundChange=e=>{var t;const{screen:s}=this.props,o=(0,i.getAppConfigAction)();if(o.editScreenProperty(s.id,"panel.background",e),(null===(t=s.panel.background)||void 0===t?void 0:t.color)!==e.color){const t=y.colorUtils.getReadableThemeColor(e.color,(0,y.getTheme2)());o.editScreenProperty(s.id,"panel.textColor",t)}o.exec()},this.onSideForegroundChange=e=>{const{screen:t}=this.props;(0,i.getAppConfigAction)().editScreenProperty(t.id,"panel.textColor",e).exec()},this.setOverlay=e=>{const{screen:t}=this.props,s=(0,i.getAppConfigAction)();s.editScreenProperty(t.id,"panel.overlay",e),e||(s.editScreenProperty(t.id,"panel.offset",0),"center"===t.panel.side&&s.editScreenProperty(t.id,"panel.side","left")),s.exec()},this.updateWidth=e=>{var t,o,n;const{screen:a,viewportSize:r}=this.props,{distance:c,unit:d}=e;let p;if(l.utils.isPercentage(null===(t=a.panel)||void 0===t?void 0:t.size)&&d===s.DistanceUnits.PIXEL){const t=l.utils.fromRatio(null===(o=a.panel)||void 0===o?void 0:o.size,r.width);p=`${Math.round(t)}${e.unit}`}else if(l.utils.isPercentage(null===(n=a.panel)||void 0===n?void 0:n.size)||d!==s.DistanceUnits.PERCENTAGE)p=`${e.distance}${e.unit}`;else{p=`${l.utils.toRatio(c,r.width)}`}(0,i.getAppConfigAction)().editScreenProperty(a.id,"panel.size",p).exec()},this.updateSide=e=>{const{screen:t}=this.props;(0,i.getAppConfigAction)().editScreenProperty(t.id,"panel.side",e).exec()},this.updateOffsetX=e=>{const{screen:t}=this.props;(0,i.getAppConfigAction)().editScreenProperty(t.id,"panel.offset",`${e}px`).exec()},this.updatePadding=e=>{const{screen:t}=this.props;(0,i.getAppConfigAction)().editScreenProperty(t.id,"panel.padding",e).exec()},this.handleGapChange=e=>{const{screen:t}=this.props,s=(0,i.getAppConfigAction)();s.editScreenProperty(t.id,"panel.gap",e.distance),Object.keys(t.panel.layout).map(e=>t.panel.layout[e]).forEach(t=>{s.editLayoutProperty(t,"setting.space",e.distance)}),s.exec()},this._getStyle=()=>{const e=this.props.theme?this.props.theme.ref.palette.neutral[1e3]:"#c5c5c5",i=this.props.theme?this.props.theme.ref.palette.neutral[1e3]:"#a8a8a8";return t.css`
      height: 100%;
      overflow: auto;
      & {
        width: 100%;
      }
      .inner-section {
        border-bottom: none;
        padding-bottom: 0;
      }
      .back-btn-con {
        margin: 1rem 0.25rem 0;
        cursor: pointer;
        align-items: center;
      }
      .screen-group-title {
        margin: 1rem 1rem 0;
      }
      .background-set-back {
        color: ${i};
        font-weight: 500;
      }
      .background-setting-con .form-group {
        margin-bottom: ${t.polished.rem(16)};
      }
      .background-setting-header {
        color: ${e};
        font-weight: 500;
      }
    `},this.isRTL=(0,t.getAppStore)().getState().appContext.isRTL}render(){var i,o,n;const{screen:a,formatMessage:r}=this.props;return a?(0,e.jsxs)("div",{css:this._getStyle(),className:"pb-2",children:[(0,e.jsxs)("div",{role:"group","aria-label":r("mainStage"),children:[(0,e.jsx)("div",{className:"screen-group-title",children:r("mainStage")}),(0,e.jsx)(c.SettingSection,{title:r("background"),children:(0,e.jsx)(c.SettingRow,{role:"group","aria-label":r("background"),children:(0,e.jsx)(I.BackgroundSetting,{background:a.main.background,onChange:this.onMainBackgroundChange,hasForeground:!0,foreground:a.main.textColor,onForegroundChange:this.onMainForegroundChange})})})]}),a.panel&&(0,e.jsxs)("div",{role:"group","aria-label":r("scrollingPanel"),children:[(0,e.jsx)("div",{className:"screen-group-title",children:r("scrollingPanel")}),(0,e.jsxs)(c.SettingSection,{className:"inner-section",role:"group","aria-label":r("mode"),title:r("mode"),children:[(0,e.jsx)("div",{children:(0,e.jsxs)(s.Label,{className:"mr-4 d-flex align-items-center",children:[(0,e.jsx)(s.Radio,{className:"mr-2",onChange:()=>{this.setOverlay(!1)},value:"docked",checked:!(null!==(i=a.panel.overlay)&&void 0!==i&&i)}),r("docked")]})}),(0,e.jsx)("div",{children:(0,e.jsxs)(s.Label,{className:"mr-4 d-flex align-items-center",children:[(0,e.jsx)(s.Radio,{className:"mr-2",onChange:()=>{this.setOverlay(!0)},value:"floating",checked:a.panel.overlay}),r("floatingScreen")]})})]}),(0,e.jsx)(c.SettingSection,{className:"inner-section",role:"group","aria-label":r("size"),title:r("size"),children:(0,e.jsx)(c.SettingRow,{label:r("width"),children:(0,e.jsx)("div",{style:{width:110},children:(0,e.jsx)(I.InputUnit,{"aria-label":r("width"),units:Ke,min:0,max:1/0,value:l.utils.normalizeLinearUnit(a.panel.size),onChange:this.updateWidth})})})}),(0,e.jsxs)(c.SettingSection,{className:"inner-section",role:"group","aria-label":r("position"),title:r("position"),children:[(0,e.jsx)(c.SettingRow,{label:r("align"),children:(0,e.jsxs)(s.ButtonGroup,{size:"sm",children:[(0,e.jsx)(s.Tooltip,{title:r(this.isRTL?"right":"left"),placement:"bottom",children:(0,e.jsx)(s.Button,{icon:!0,"aria-label":r("align"),active:"left"===a.panel.side,"aria-pressed":"left"===a.panel.side,onClick:()=>{this.updateSide("left")},children:(0,e.jsx)(be,{size:"s",autoFlip:!0})})}),a.panel.overlay&&(0,e.jsx)(s.Tooltip,{title:r("center"),placement:"bottom",children:(0,e.jsx)(s.Button,{icon:!0,"aria-label":r("align"),active:"center"===a.panel.side,"aria-pressed":"center"===a.panel.side,onClick:()=>{this.updateSide("center")},children:(0,e.jsx)(Ze,{size:"s"})})}),(0,e.jsx)(s.Tooltip,{title:r(this.isRTL?"left":"right"),placement:"bottom",children:(0,e.jsx)(s.Button,{icon:!0,"aria-label":r("align"),active:"right"===a.panel.side,"aria-pressed":"right"===a.panel.side,onClick:()=>{this.updateSide("right")},children:(0,e.jsx)(Ne,{size:"s",autoFlip:!0})})})]})}),(null===(o=a.panel)||void 0===o?void 0:o.overlay)&&(0,e.jsx)(c.SettingRow,{label:r("offsetX"),children:(0,e.jsx)(s.NumericInput,{value:parseInt(null!==(n=a.panel.offset)&&void 0!==n?n:"0"),onChange:this.updateOffsetX,size:"sm",css:t.css`width: 110px`,"aria-label":r("offsetX")})})]}),(0,e.jsx)(c.SettingSection,{className:"inner-section",title:r("gap"),children:(0,e.jsx)(c.SettingRow,{role:"group",children:(0,e.jsx)(I.InputUnit,{"aria-label":r("gap"),className:"w-100",value:{distance:a.panel.gap>=0?a.panel.gap:10,unit:void 0},min:0,onChange:this.handleGapChange})})}),(0,e.jsx)(c.SettingSection,{className:"inner-section",title:r("padding"),children:(0,e.jsx)(c.SettingRow,{role:"group","aria-label":r("padding"),children:(0,e.jsx)(I.Padding,{value:a.panel.padding,onChange:this.updatePadding})})}),(0,e.jsx)(c.SettingSection,{className:"inner-section",title:r("background"),children:(0,e.jsx)(c.SettingRow,{role:"group","aria-label":r("background"),children:(0,e.jsx)(I.BackgroundSetting,{background:a.panel.background,onChange:this.onSideBackgroundChange,hasForeground:!0,foreground:a.panel.textColor,onForegroundChange:this.onSideForegroundChange})})})]})]}):null}}const Qe=t.ReactRedux.connect((e,i)=>{const{screenId:s}=i,{appConfig:o}=e.appStateInBuilder,n=e.browserSizeMode||t.BrowserSizeMode.Large;let a=t.utils.findViewportSize(o,n);return 0===a.width&&(a=t.CONSTANTS.SCREEN_RESOLUTIONS[n][1]),{screen:o.screens[s],viewportSize:a}})(qe);class Xe extends t.React.PureComponent{constructor(e){super(e),this.sidePopperTrigger=t.React.createRef(),this.formatMessage=(e,i=!1)=>i?this.props.intl.formatMessage({id:e,defaultMessage:t.defaultMessages[e]}):this.props.formatMessage(e),this._addScreen=e=>{const t=(0,i.getAppConfigAction)(),{screenGroupId:s}=this.props;t.createScreenFromTemplate(e.screenId,e).then(e=>{let o=t.appConfig;o=o.setIn(["screenGroups",s,"screens"],[].concat(o.screenGroups[s].screens,e)).setIn(["screens",e,"parent"],s),i.builderAppSync.publishAppConfigChangeToApp(o),i.builderAppSync.publishScreenGroupNavInfoToApp(s,o.screenGroups[s].screens.length-1)}),this.closeScreenPopper()},this._duplicateScreen=e=>{const{screenGroupId:t}=this.props,s=(0,i.getAppConfigAction)();s.duplicateScreenByIndex(e,t),s.exec(),i.builderAppSync.publishScreenGroupNavInfoToApp(t,e+1)},this._duplicateActiveScreen=()=>{this._duplicateScreen(this.props.activeScreen)},this._selectScreen=e=>{const{screenGroupId:t,activeScreen:s}=this.props;s!==e&&i.builderAppSync.publishScreenGroupNavInfoToApp(t,e),this.setState({showScreenSetting:!0})},this._removeScreen=e=>{const{screenGroupId:t,screens:s,activeScreen:o}=this.props;(0,i.getAppConfigAction)().removeScreen(s[e],t).exec(),(o>e||o===e&&o===s.length-1)&&i.builderAppSync.publishScreenGroupNavInfoToApp(t,o-1)},this.getStyle=()=>t.css`
      .screen-list {
        padding: 0 1rem;
      }

      .setting-header {
        margin-bottom: 1rem;
      }

      .screen-group-title {
        font-size: 14px;
        color: var(--ref-palette-neutral-1200);
      }
    `,this.hideScreenSetting=()=>{this.setState({showScreenSetting:!1})},this.toggleScreenPopper=()=>{if(this.props.hasPanel)this.setState({showPopper:!this.state.showPopper});else{const e=(0,Fe.getScreenTemplates)().find(e=>"nopanel"===e.name);e&&this._addScreen(e)}},this.closeScreenPopper=()=>{this.setState({showPopper:!1})},this.popperRef=t.React.createRef(),this.state={showPopper:!1,showScreenSetting:!1}}showEditButtons(){const{editable:e,browserSizeMode:i}=this.props,s=i===t.BrowserSizeMode.Large;return e&&s}render(){var o;const{screenGroup:n,screenGroupId:a,screens:r,theme:l,dispatch:d,activeScreen:g,browserSizeMode:h,editable:u,enableA11yForWidgetSettings:m}=this.props,{showScreenSetting:f}=this.state;if(!r)return null;const v=t.css`
      cursor: pointer;
      margin-top: ${t.polished.rem(-8)};
    `;return(0,e.jsxs)("div",{className:"screen-group-setting mb-5",css:this.getStyle(),role:"group","aria-label":this.formatMessage("screen"),children:[(0,e.jsxs)("div",{className:"h-100 screen-list",ref:this.sidePopperTrigger,children:[(0,e.jsx)("div",{className:"d-flex align-items-center setting-header",children:(0,e.jsx)("div",{title:this.formatMessage("screen"),className:"screen-group-title",children:this.formatMessage("screen")})}),this.showEditButtons()&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)("div",{className:"mt-4",children:(0,e.jsxs)(s.Button,{ref:this.popperRef,"aria-label":this.formatMessage("newScreen"),css:v,type:"primary",onClick:this.toggleScreenPopper,className:"w-100",children:[(0,e.jsx)(ze,{className:"mr-0"}),(0,e.jsx)("span",{className:"ml-2",children:this.formatMessage("newScreen")})]})}),this.state.showPopper&&(0,e.jsx)(c.TemplateSelector,{templates:(0,Fe.getScreenTemplates)(),referenceElement:this.popperRef.current,onItemSelect:this._addScreen,onClose:this.closeScreenPopper})]}),(0,e.jsx)(ae.List,{size:"sm",className:"selected-fields-list mt-4",itemsJson:Array.from(r).map((e,t)=>({itemStateDetailContent:e,itemStateChecked:r[g]===e,itemKey:`${t}`})),dndEnabled:!0,onUpdateItem:(e,t)=>{const{itemJsons:s}=t.props,[,o]=s,n=o.map(e=>e.itemStateDetailContent),l=r[g],c=n.indexOf(l);(0,i.getAppConfigAction)().editScreenGroupProperty(a,"screens",n).exec(),this._selectScreen(c)},onClickItemBody:(e,t)=>{const{itemJsons:i}=t.props,s=+i[0].itemKey;this._selectScreen(s)},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:ae.TreeItemActionType.RenderOverrideItem,children:[{name:ae.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemBody,children:[{name:ae.TreeItemActionType.RenderOverrideItemDragHandle},{name:ae.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(t,i)=>{const{itemJsons:s}=i.props,o=s[0],n=o.itemStateDetailContent,c=+o.itemKey;return(0,e.jsx)(Ve,{index:c,screenGroupId:a,screenId:n,canRemove:r.length>1,formatMessage:this.formatMessage,dispatch:d,theme:l,editable:u,onRemove:this._removeScreen,onDuplicate:this._duplicateScreen,selected:r[g]===n,browserSizeMode:h},n)}}),m&&(0,e.jsx)(p,{className:"pl-0 pr-0",theme:l,widgetId:a,label:n.a11yLabel,addToSkip:n.addToA11ySkip,onA11ySettingChange:(e,t)=>{(0,i.getAppConfigAction)().editScreenGroupProperty(a,e,t).exec()},formatMessage:this.formatMessage})]}),(0,e.jsx)(c.SidePopper,{isOpen:f,position:"right",toggle:this.hideScreenSetting,trigger:null===(o=this.sidePopperTrigger)||void 0===o?void 0:o.current,title:this.props.activeScreenLabel,backToFocusNode:this.popperRef.current,children:(0,e.jsx)(Qe,{formatMessage:this.formatMessage,theme:this.props.theme,screenId:r[g],hideBackgroundWidget:this.hideScreenSetting})})]})}}const Ye=t.ReactRedux.connect((e,i)=>{var s,o,n,a,r,l,c,d,p,g,h,u;const{screenGroupId:m}=i,{appConfig:f}=e.appStateInBuilder,v=f.screenGroups[m];if(!v)return null;const w=f.screens[v.screens[0]],x=null!==(a=null===(n=null===(o=null===(s=e.appStateInBuilder)||void 0===s?void 0:s.appConfig)||void 0===o?void 0:o.forBuilderAttributes)||void 0===n?void 0:n.lockLayout)&&void 0!==a&&a,y=null===(l=null===(r=e.appStateInBuilder)||void 0===r?void 0:r.appRuntimeInfo)||void 0===l?void 0:l.appMode,b=v.screens,I=null!==(h=null===(g=null===(p=null===(d=null===(c=e.appStateInBuilder)||void 0===c?void 0:c.appRuntimeInfo)||void 0===d?void 0:d.screenGroupNavInfos)||void 0===p?void 0:p[m])||void 0===g?void 0:g.activeIndex)&&void 0!==h?h:0,S=b[I];return{screenGroup:v,screens:b,activeScreen:I,activeScreenLabel:null===(u=f.screens[S])||void 0===u?void 0:u.label,browserSizeMode:e.appStateInBuilder.browserSizeMode,hasPanel:null!=w.panel,editable:y===t.AppMode.Design&&!x}})(Xe);class et extends t.React.PureComponent{constructor(){super(...arguments),this.isInControllerWidget=()=>{let e=!1;const i=(0,t.getAppStore)().getState().appStateInBuilder.appConfig,s=i.layouts[this.props.layoutId];if(s.parent.type===t.LayoutParentType.Widget){const t=s.parent.id;"widgets/common/controller/"===i.widgets[t].uri&&(e=!0)}return e},this.renderItemSetting=()=>{let s=null;if(this.props.layoutType===t.LayoutType.FixedLayout){this.isInControllerWidget()||(s=j.FixedLayoutItemSetting)}else if(this.props.layoutType===t.LayoutType.FlowLayout)s=j.FlowLayoutItemSetting;else if(this.props.layoutType===t.LayoutType.ColumnLayout)s=j.ColumnLayoutItemSetting;else if(this.props.layoutType===t.LayoutType.RowLayout)s=j.RowLayoutItemSetting;else if(this.props.layoutType===t.LayoutType.GridLayout)s=j.GridLayoutItemSetting;else if(this.props.layoutType===t.LayoutType.AccordionLayout)s=j.AccordionLayoutItemSetting;else if(this.props.layoutType===t.LayoutType.FlexRowLayout)s=j.FlexRowLayoutItemSetting;else{const{containerWidgetId:e,hasLayoutSetting:t}=this.props;t&&(s=i.WidgetSettingManager.getInstance().getItemSettingClass(e))}return s?(0,e.jsx)(t.ErrorBoundary,{children:(0,e.jsx)(s,{layoutId:this.props.layoutId,layoutItem:this.props.layoutItem,isLockLayout:this.props.isLockLayout,supportAutoSize:this.props.supportAutoSize,style:this.props.style,onSettingChange:this.props.onSettingChanged,onStyleChange:this.props.onStyleChange,onPosChange:this.props.onPosChanged,formatMessage:this.props.formatMessage})}):(0,e.jsx)(c.SettingSection,{children:(0,e.jsx)("div",{className:"w-100 justify-content-center d-flex",children:this.props.formatMessage("noStyle")})})}}componentDidUpdate(){this.loadItemSettingClass()}componentDidMount(){this.loadItemSettingClass()}loadItemSettingClass(){const{containerWidgetId:e,hasLayoutSetting:t}=this.props;e&&t&&!i.WidgetSettingManager.getInstance().getItemSettingClass(e)&&i.WidgetSettingManager.getInstance().loadItemSettingClass(e)}getStyle(){return t.css`
      &.single-setting {
        border-top: 1px solid var(--ref-palette-neutral-700);
      }
      &.fixed-layout-setting {
        overflow-y: hidden;
        height: unset;
      }
    `}render(){const{isSingle:i=!1,layoutType:s}=this.props;return(0,e.jsx)("div",{className:(0,t.classNames)("setting-container",{"single-setting":i,"fixed-layout-setting":s===t.LayoutType.FixedLayout&&!this.isInControllerWidget()}),css:this.getStyle(),children:this.renderItemSetting()})}}const tt=t.ReactRedux.connect((e,i)=>{var s,o,n,a,r,c,d,p,g,h,u,m;const{layoutId:f,layoutItemId:v}=i,w=null===(s=e.appStateInBuilder)||void 0===s?void 0:s.appConfig.layouts,x=null==w?void 0:w[f];let y=null,b=!0;if(!x)return null;const I=l.searchUtils.findLayoutItem(e.appStateInBuilder.appConfig,{layoutId:f,layoutItemId:v}),S=l.searchUtils.getWidgetIdThatUseTheLayoutId(e.appStateInBuilder.appConfig,f);let C=!1;if(S){C=null!==(a=null===(n=null===(o=e.appStateInBuilder.appConfig.widgets[S].manifest)||void 0===o?void 0:o.properties)||void 0===n?void 0:n.hasLayoutItemSettingPage)&&void 0!==a&&a}const j=null==I?void 0:I.type;if(j===t.LayoutItemType.Widget)if(I.widgetId){const t=e.appStateInBuilder.appConfig.widgets[I.widgetId];y=t.style,b=null===(d=null===(c=null===(r=t.manifest)||void 0===r?void 0:r.properties)||void 0===c?void 0:c.supportAutoSize)||void 0===d||d}else y=null===(p=I.setting)||void 0===p?void 0:p.placeholderStyle,b=!1;else j===t.LayoutItemType.Section&&(y=e.appStateInBuilder.appConfig.sections[I.sectionId].style,b=!1);return{containerWidgetId:S,hasLayoutSetting:C,style:y,supportAutoSize:b,layoutType:x.type,layoutItem:I,runtimeInfo:e.builder.widgetsSettingRuntimeInfo[S],isLockLayout:null!==(m=null===(u=null===(h=null===(g=e.appStateInBuilder)||void 0===g?void 0:g.appConfig)||void 0===h?void 0:h.forBuilderAttributes)||void 0===u?void 0:u.lockLayout)&&void 0!==m&&m}})(et);var it=f(6300),st=f.n(it),ot=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const nt=i=>{const s=window.SVG,{className:o}=i,n=ot(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:st()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var at;!function(e){e.MessageChoose="MESSAGECHOOSE",e.TargetChoose="TARGETCHOOSE",e.ActionChoose="ACTIONCHOOSE",e.ActionSetting="ACTIONSETTING"}(at||(at={}));class rt extends t.React.PureComponent{getStyle(e){var i,s;return t.css`
      .setting-header {
        padding: ${t.polished.rem(16)} ${t.polished.rem(16)} ${t.polished.rem(0)} ${t.polished.rem(16)}
      }
      .panel-header title{
        max-height: 198px;
      }
      .setting-title {
        font-size: ${t.polished.rem(16)};
        color: ${null===(s=null===(i=null==e?void 0:e.ref.palette)||void 0===i?void 0:i.neutral)||void 0===s?void 0:s[1e3]}
      }
      .back-setting {
        padding: 0;
        &:hover {
          svg {
            color: var(--ref-palette-black) !important;
          }
        }
      }
    `}render(){var t;return(0,e.jsxs)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme),children:[(0,e.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-between setting-header border-0",children:[(null===(t=this.props.Routes)||void 0===t?void 0:t.length)>1&&!this.props.hideBackArrow&&(0,e.jsx)(s.Button,{type:"tertiary",size:"sm",icon:!0,className:"d-flex align-items-center h-100 back-setting mr-2",style:{cursor:"pointer"},"aria-label":this.props.title,title:this.props.title,onClick:this.props.onBack,children:(0,e.jsx)(nt,{autoFlip:!0})}),(0,e.jsx)(s.PanelHeader,{level:1,className:"flex-grow-1 p-0",showClose:!0,onClose:this.props.onClose,title:this.props.title})]}),this.props.children]})}}const lt=(0,y.withTheme)(rt);var ct=f(170),dt=f.n(ct),pt=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const gt=i=>{const s=window.SVG,{className:o}=i,n=pt(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:dt()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var ht;!function(e){e.Small="SMALL",e.Medium="MEDIUM",e.Large="LARGE",e.Pending="PENDING"}(ht||(ht={}));const ut=(e,s)=>{var o,n,a;const r=(0,i.getAppConfigAction)().appConfig,l=null===(o=null==r?void 0:r.widgets)||void 0===o?void 0:o[e];if(!l)return(0,t.Immutable)([]);const c=l.manifest.publishMessages,d=t.i18n.getIntl(),p=[];if(c)for(let e=0;e<c.length;e++){let i=!1;if(s)for(let t=0;t<s.length;t++){const o=(null===(n=c[e])||void 0===n?void 0:n.messageType)?null===(a=c[e])||void 0===a?void 0:a.messageType:c[e];if(s[t].messageType===o){i=!0;break}}if(!i){const i=c[e],s=(null==i?void 0:i.messageType)||i;p.push({messageType:s,messageLabel:(0,t.getMessageTypeLabel)(s,d)})}}return(0,t.Immutable)(p)},mt=(e,s,o=!1)=>{const n=[],a=[];let r=[];const l=[],c=(0,i.getAppConfigAction)().appConfig,d=i.AppMessageManager.getInstance().getFilteredActions(e,s);for(let i=0;i<d.length;i++){const p=d[i].widgetId,g=d[i].sectionId;if(p||g){const r=g||p,h=!!g,u=h?t.LayoutItemType.Section:t.LayoutItemType.Widget,m=bt(r,h),f=St(r,u),v=!m&&!f&&r,w=vt(e,s,d[i],h).includes(r)&&o;if(!l.includes(r)&&(v||w))if(l.push(r),h){const e=c.sections[g];e&&e.id!==s&&a.push(e)}else{const e=c.widgets[p];if(e){if(e.id===s)continue;n.push(e)}}}else{r=[{uri:d[i].id,label:"Framework"}]}}return{widgetTargets:n,sectionTargets:a,frameWorkTargets:r}};function ft(e,t){const s=i.AppMessageManager.getInstance().getAllActions();let o=null,n=null;for(let t=0;t<s.length;t++)if(e.actionId.includes(s[t].id)){o=s[t];break}return o&&(n=i.AppMessageManager.getInstance().getActionSettingComponentUri(o,t,e.messageWidgetId)),n}function vt(e,t,s,o){var n;const a=o?s.sectionId:s.widgetId;if(!a)return[];const r=null===(n=(0,i.getAppConfigAction)().appConfig)||void 0===n?void 0:n.messageConfigs,l=[];return Object.keys(r).forEach(i=>{const n=r[i];if((null==n?void 0:n.widgetId)===t&&e===(null==n?void 0:n.messageType)){((null==n?void 0:n.actions)||[]).forEach(e=>{(o?e.sectionId:e.widgetId)===a&&l.push(a||(null==s?void 0:s.name))})}}),l}const wt=(e,t,s)=>{const o=[],n=[];e.id;const a=i.AppMessageManager.getInstance().getFilteredActions(s,t);for(let t=0;t<a.length;t++){const i=a[t];(!n.includes(i.name)&&!e.id&&!i.widgetId&&!i.sectionId||e.id&&a[t].widgetId===e.id||e.id&&a[t].sectionId===e.id)&&(n.push(a[t].name),o.push(a[t]))}return o};const xt=(e,t,i)=>{const{useDataSources:s,config:o,actionId:n}=e;if(function(e,t){var i;const s=yt(e,t)||[],o=yt(t,e)||[];return(null===(i=s.concat(o))||void 0===i?void 0:i.length)>0}(null==i?void 0:i.config,o)&&n===(null==i?void 0:i.actionId)){const e=Object.assign([],t.actions);let a=null;for(let t=0;t<e.length;t++)if(e[t].actionId===n&&e[t].widgetId===i.widgetId){e[t]=e[t].set("config",o).set("useDataSources",s),a=e[t];break}return{action:a,message:t=t.set("actions",e)}}},yt=(e,t)=>{const i=[],s=(e,t,o)=>{for(const n in e){const a=e[n],r=null==t?void 0:t[n],l=o?`${o}.${n}`:n;"object"==typeof a&&"object"==typeof r?s(a,r,l):a!==r&&i.push(l)}};return s(e,t,""),i};function bt(e,i=!1){if(!e)return!1;let s=!0;const o=At(i?t.LayoutItemType.Section:t.LayoutItemType.Widget);return Object.keys(o).forEach(t=>{o[t].includes(e)&&(s=!1)}),s}function It(e,i){const s=!!i,o=i||e,n=s?t.LayoutItemType.Section:t.LayoutItemType.Widget,a=[],r=jt(n),l=Ct(n);if(!(null==l?void 0:l.includes(o)))for(const e in r){r[e].includes(o)&&a.push(e)}return bt(o,s)&&0===(null==a?void 0:a.length)&&a.push(ht.Pending),a}function St(e,i=t.LayoutItemType.Widget){const s=Ct(i);if(null==s?void 0:s.includes(e))return!1;const o=jt(i);let n=!1;for(const t in o){o[t].includes(e)&&(n=!0)}return n}function Ct(e=t.LayoutItemType.Widget){const i=(0,t.getAppStore)().getState().appStateInBuilder.browserSizeMode,s=At(e);return(null==s?void 0:s[i])||[]}function jt(e=t.LayoutItemType.Widget){const i=At(e),s=(0,t.getAppStore)().getState().appStateInBuilder.browserSizeMode;return(null==i?void 0:i[s])&&(i[s]=[]),i}function At(e=t.LayoutItemType.Widget){const i={SMALL:[],MEDIUM:[],LARGE:[]},s=Tt(t.ContainerType.Page,e),o=Tt(t.ContainerType.Dialog,e),n=Tt(t.ContainerType.Header,e),a=Tt(t.ContainerType.Footer,e);for(const e in i){const t=s[e].concat(o[e]).concat(n[e]).concat(a[e]);i[e]=t}return i}function Tt(e,i=t.LayoutItemType.Widget){const s=(0,t.getAppStore)().getState().appStateInBuilder,o=null==s?void 0:s.appConfig,n=function(e){const i=(0,t.getAppStore)().getState().appStateInBuilder,s=null==i?void 0:i.appConfig,o=(null==s?void 0:s.pages)||{},n=(null==s?void 0:s.dialogs)||{};let a;switch(e){case t.ContainerType.Page:a=o;break;case t.ContainerType.Dialog:a=n;break;case t.ContainerType.Header:a={header:(null==s?void 0:s.header)||{}};break;case t.ContainerType.Footer:a={footer:(null==s?void 0:s.footer)||{}}}return a}(e),a={SMALL:[],MEDIUM:[],LARGE:[]};if(!n)return a;for(const s in n){const r=n[s];if(e===t.ContainerType.Page&&(!(null==r?void 0:r.layout)||(null==r?void 0:r.type)!==t.PageType.Normal))continue;const c=(null==r?void 0:r.layout)||{};for(const t in c){const s={type:e,id:null==r?void 0:r.id},n=l.searchUtils.getContentsInContainerRecursive(o,s,i,t);let c=(null==a?void 0:a[t])||[];c=c.concat(n),a[t]=c}}return a}var Mt=f(6739);class Nt extends t.React.PureComponent{constructor(){super(...arguments),this.onSelectMessageType=e=>{const i=Mt.messageActionUtils.getNewMessage(e,this.props.widgetId);this.props.onSelected((0,t.Immutable)(i))}}getStyle(e){return t.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .choose-message-list {
        .list-item {
          color: ${e.ref.palette.black};
        }
        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${t.polished.rgba(e.ref.palette.white,1)};
          color: ${e.ref.palette.neutral[800]} !important;
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${e.ref.palette.neutral[500]};
            user-select: none;
            font-size: ${t.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${e.ref.palette.neutral[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${e.ref.palette.white};
          }
        }
      }
    `}render(){const{widgetId:t,messages:i}=this.props,o=ut(t,i);return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme),children:(0,e.jsx)("div",{className:"w-100 choose-message-list",children:(0,e.jsx)(c.SettingSection,{children:(0,e.jsxs)(c.SettingRow,{children:[(0,e.jsxs)("div",{className:"w-100",style:{display:"none"},children:[(0,e.jsx)(s.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchTrigger"),value:""}),(0,e.jsx)(gt,{className:"p-0 searchIcon"})]}),(0,e.jsxs)("div",{className:"w-100 list",children:[0===o.length&&(0,e.jsx)("div",{className:"d-flex mb-2 p-1 text-break",children:this.props.formatMessage("noMessage")}),o.length>0&&o.map((t,i)=>(0,e.jsx)(s.Button,{variant:"text",color:"default",className:"justify-content-start list-item mb-2 pt-1 pb-1 pl-2 pr-2 w-100 align-items-center",onClick:()=>{this.onSelectMessageType(t.messageType)},title:t.messageLabel,children:(0,e.jsx)("div",{className:"w-100 text-left text-truncate",children:t.messageLabel})},i))]})]})})})})}}const kt=(0,y.withTheme)((0,t.injectIntl)(Nt));class Ot extends t.React.PureComponent{constructor(){super(...arguments),this.onSelectAction=e=>{let i=this.props.message;const{target:s,widgetId:o}=this.props,n=Mt.messageActionUtils.getNewActionItem(s,e,o,i.messageType);i=i.set("actions",i.actions.concat(n)),this.props.onSelected(i,(0,t.Immutable)(n),e)}}getStyle(e){return t.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .action-choose-list {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${t.polished.rgba(e.ref.palette.white,1)};
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${e.ref.palette.neutral[500]};
            user-select: none;
            font-size: ${t.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${e.ref.palette.neutral[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${e.ref.palette.white};
          }
        }
      }
    `}render(){const{target:t,widgetId:i,message:o}=this.props,n=wt(t,i,o.messageType);return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme),children:(0,e.jsx)("div",{className:"w-100 action-choose-list",children:(0,e.jsx)(c.SettingSection,{children:(0,e.jsxs)(c.SettingRow,{children:[(0,e.jsxs)("div",{className:"w-100",style:{display:"none"},children:[(0,e.jsx)(s.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchAction"),value:""}),(0,e.jsx)(gt,{className:"p-0 searchIcon"})]}),(0,e.jsxs)("div",{className:"w-100 list",children:[0===n.length&&(0,e.jsx)("div",{className:"d-flex mb-2 p-1 text-break",children:this.props.formatMessage("noAction")}),n.length>0&&n.map((t,i)=>(0,e.jsx)(s.Button,{className:"text-truncate list-item mb-2 pt-1 pb-1 pl-2 pr-2 w-100 justify-content-start",title:t.label,onClick:()=>{this.onSelectAction(t)},children:(0,e.jsx)("div",{className:"w-100 text-left text-truncate",children:t.label})},i))]})]})})})})}}const Pt=(0,y.withTheme)(Ot);var Rt=f(8485),Dt=f.n(Rt),Lt=f(1408),Et=f.n(Lt),Bt=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const zt=i=>{const s=window.SVG,{className:o}=i,n=Bt(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component has-rtl-svg",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Dt(),srcRTL:Et()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};class Ut extends t.React.PureComponent{constructor(){super(...arguments),this.searchItems=e=>null,this.onSelectTarget=e=>{this.props.onSelected(e)}}getStyle(e){return t.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .target-choose-list {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${t.polished.rgba(e.ref.palette.white,1)};
        }

        .seperateline-mt {
          margin-top: ${t.polished.rem(5)};
        }

        .seperateline-mb {
          margin-bottom: ${t.polished.rem(1)};
        }

        .seperateline {
          border-top: 1px solid ${e.ref.palette.neutral[500]};
        }

        .widgets-title {
          font-weight: 600;
          font-size: ${t.polished.rem(14)};
          color: ${e.ref.palette.neutral[900]};
        }

        .nodata {
          font-size: ${t.polished.rem(13)};
        }

        button {
          color: ${e.ref.palette.black};
        }
        .widgets-list-con svg{
          color: ${e.sys.color.primary.text}!important;
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${e.ref.palette.neutral[500]};
            user-select: none;
            font-size: ${t.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${e.ref.palette.neutral[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${e.ref.palette.white};
          }
        }
      }
    `}render(){const{message:t}=this.props,o=mt(t.messageType,t.widgetId),n=o.frameWorkTargets,a=o.widgetTargets,r=o.sectionTargets;return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme),children:(0,e.jsx)("div",{className:"w-100 target-choose-list",children:(0,e.jsx)(c.SettingSection,{children:(0,e.jsxs)(c.SettingRow,{children:[(0,e.jsxs)("div",{className:"w-100",style:{display:"none"},children:[(0,e.jsx)(s.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchTarget"),onChange:this.searchItems,value:""}),(0,e.jsx)(gt,{autoFlip:!0,className:"p-0 searchIcon",size:"m"})]}),(0,e.jsxs)("div",{className:"w-100 list",children:[0===n.length&&0===a.length&&(0,e.jsx)("div",{className:"d-flex justify-content-center nodata text-break",children:this.props.formatMessage("noTargetWidgets")}),n.map((t,i)=>(0,e.jsxs)(s.Button,{variant:"text",color:"default",className:"list-item pt-1 pb-1 pl-2 pr-2 w-100 justify-content-start",title:this.props.formatMessage("data"),onClick:()=>{this.onSelectTarget(t)},children:[(0,e.jsx)(zt,{className:"mr-0",size:"m",autoFlip:!0}),(0,e.jsx)("div",{className:"ml-2 text-truncate",children:this.props.formatMessage("data")})]},i)),n.length>0&&0===a.length&&0===r.length&&(0,e.jsxs)("div",{className:"w-100",children:[(0,e.jsx)("div",{className:"w-100 seperateline-mt seperateline-mb",style:{position:"relative",height:"20px"},children:(0,e.jsx)("div",{className:"seperateline w-100",style:{top:"10px",position:"absolute"}})}),(0,e.jsx)("div",{className:"w-100 widgets-title",children:this.props.formatMessage("targetWidgets")}),(0,e.jsx)("div",{className:"d-flex mt-2 nodata text-break",children:this.props.formatMessage("noTargetWidgets")})]}),(a.length>0||r.length>0)&&(0,e.jsxs)("div",{className:"w-100 widgets-list-con",children:[n.length>0&&(0,e.jsx)("div",{className:"w-100 seperateline-mb",style:{position:"relative",height:"20px"},children:(0,e.jsx)("div",{className:"seperateline w-100",style:{top:"10px",position:"absolute"}})}),(0,e.jsx)("div",{className:"w-100 widgets-title",children:this.props.formatMessage("targetWidgets")}),a.map((t,i)=>{let o;const n=t.icon;return o=n&&n.svg?n:{svg:n},(0,e.jsxs)(s.Button,{variant:"text",color:"default",className:"list-item mt-2 p-1 w-100 justify-content-start",title:t.label,onClick:()=>{this.onSelectTarget(t)},children:[(0,e.jsx)(s.Icon,{className:"mr-0",autoFlip:!0,width:16,height:16,icon:o.svg,color:o.properties&&o.properties.color}),(0,e.jsx)("div",{className:"ml-2 text-truncate",children:t.label})]},i)}),null==r?void 0:r.map((t,o)=>{let n;const a=t.icon;return n=a&&a.svg?a:{svg:i.utils.getDefaultSectionIcon().toString()},(0,e.jsxs)(s.Button,{variant:"text",color:"default",className:"list-item mt-2 p-1 w-100 justify-content-start",title:t.label,onClick:()=>{this.onSelectTarget(t)},children:[(0,e.jsx)(s.Icon,{className:"mr-0",autoFlip:!0,width:16,height:16,icon:n.svg,color:n.properties&&n.properties.color}),(0,e.jsx)("div",{className:"ml-2 text-truncate",children:t.label})]},o)})]})]})]})})})})}}const _t=(0,y.withTheme)(Ut),Wt={pageSetting:"Page settings",dialogSetting:"Dialog settings",openWithWindow:"Open with Window",openWithWindowTip:"Only fixed windows are supported (except splash).",folderSetting:"Folder settings",linkSetting:"Link settings",noSelection:"No selection",customWidth:"Fixed width",fitToWindow:"Fit to window",fitToWidthOnly:"Full width",fitToContainer:"Fit to container",keepAspectRatio:"Keep aspect ratio",aspectRatio:"Aspect ratio",fixedHeight:"Fixed height",content:"Content",dynamicSettingStyle:"Style",action:"Action",donotSupportDataAction:"The widget does not support any data actions.",daynamicLayout:"Layout",displayMode:"Display mode",dynamicWidth:"Width",dynamicHeight:"Height",dynamicLoading:"Loading",heightMode:"Height mode",urlIsHere:"Type URL here.",sectionDelete:"Delete",noWidget:"No widget",docked:"Docked",floatingScreen:"Floating",verticalSpacing:"Vertical spacing",triggerPosition:"Trigger position",upper:"Upper",lower:"Lower",dsDuplicateView:"Duplicate view",dsDuplicateScreen:"Duplicate screen",newView:"New view",noSettingOptions:"No setting options",contentWidth:"Content width",dsCustom:"Custom",dsAuto:"Auto",size:"Size",lockParent:"Kept within the parent container",margin:"Margin",noStyle:"This widget does not support style settings.",addTrigger:"Add a trigger",noTrigger:"The widget does not generate any triggers.",selectTrigger:"Select a trigger",selectTarget:"Select a target",selectAction:"Select an action",actionBack:"Back",actionSet:"Action settings",actionSettings:"Settings",actionDelete:"Delete",addAction:"Add action",targetWidgets:"Widgets",targetSections:"Sections",noMessage:"No message",noTargetWidgets:"No widget",messageAction:"Message action",dataAction:"Data action",noAction:"No action",chooseSearchTrigger:"Select or search a trigger",chooseSearchTarget:"Select or search a target",chooseSearchAction:"Select or search an action",actionDone:"Done",actionFramework:"Data",actionSettingLoading:"Loading...",turnTo:"Switch to:",dsFill:"Fill",keepFixedOnScroll:"Stays at the top of the page when scrolling",titleBackground:"Background",copyPage:"Copy",fixedMode:"Fixed",anchoredMode:"Anchored",fixedModeTip:"Display in a fixed position.",anchoredModeTip:"Appears next to the linked widget.",splashDlgWarning:"Splash cannot be set to Anchored.",pageDlgWarning:"Window opened with pages cannot be set to Anchored.",keepLeft:"Keep left",keepRight:"Keep right",keepCenter:"Keep center",keepTop:"Keep top",keepBottom:"Keep bottom",closeOptions:"Close options",blockPage:"Block page",clickOutside:"Click outside to close Window",interaction:"Interaction",interactionStyle1:"Checkbox only",interactionStyle2:"Button in the same line",interactionStyle3:"Button in a different line",confirmation:"Confirmation",confirmationRequiredText:"Check to proceed",confirmationButtonTextHolder:"Required",closeIcon:"Close icon",closeIconPosition:"Position",closeIconPositionTL:"Top left",closeIconPositionTR:"Top right",preventDisplayAgain:'"Don\'t show this again" option',checkboxText:"Checkbox text",checkboxButtonText:"Button text",alwaysShow:"Always show this window",arrows:"Arrows",dots:"Dots",interval:"Interval (Second)",loop:"Loop",toggleViewList:"Toggle view list",spacing:"Spacing",scrollToSwitch:"Scroll to switch",dataActions:"Data actions",enableDataAction:"Enable data action",enableBatchDataAction:"Enable batch data action",selectWidgets:"Select widgets",dataActionTooltip:"Show data action button on the widget. The widget will not have any data actions, if no action is configured, or the data type does not support data action.",batchDataActionTooltip:"Show batch data action button on the widget. The widget will not have any batch data actions, if no action is configured, or the data type does not support data action.",noDataAction:"To see data action options, please add a widget that provides data action onto the same page.",noBatchDataAction:"To see batch data action options, please add a widget that provides batch data action onto the same page.",noTriggerTip:'Click the "{ButtonString}" button to add and configure actions.',exportNotes:"Note: Export is configured in the Data panel.",lazyLoading:"Lazy loading",lazyLoadingTip:"Load content when switched for the first time.",cookieBannerSettingTitle:"Cookie Banner",bannerButtonSettings:"Banner button settings",closeButton:"Close button",acceptAllButton:"Accept all button",declineAllButton:"Decline all button",cookieSettingsButton:"Cookie settings button",cookieSettingsWindow:"Cookie settings window",actionWidgetPending:"This action is configured with a pending widget.",actionWidgetInLarge:"This action is configured in large screen device.",actionWidgetInMedium:"This action is configured in medium screen device.",actionWidgetInSmall:"This action is configured in small screen device.",noAvailableActions:"No available actions.",showAllDataCount:"Show all data count",a11ySettings:"Accessibility settings",a11yLabel:"Accessible label",a11yLabelTip:"Describe this widget for screen readers.",a11yEnableSkipTo:"Enable in Skip to"};var Ft=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Ht=i=>{const s=window.SVG,{className:o}=i,n=Ft(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:k()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Vt=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Gt=i=>{const s=window.SVG,{className:o}=i,n=Vt(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:P()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var $t=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Jt=i=>{const s=window.SVG,{className:o}=i,n=$t(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:D()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Zt=f(3387),Kt=f.n(Zt),qt=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Qt=i=>{const s=window.SVG,{className:o}=i,n=qt(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Kt()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},Xt=i=>{const o=t.hooks.useTranslation(Wt),{actionWidgetId:n,size:a,sectionIdOfAction:r}=i,[l,c]=t.React.useState([]);return t.React.useEffect(()=>{const e=n||r?It(n,r):[];c(e)},[n,r]),(0,e.jsxs)("div",{className:"flex-grow-1 d-flex align-items-center",children:[l.includes(ht.Pending)&&(0,e.jsx)(s.Tooltip,{placement:"top",css:t.css`max-width: 300px;`,title:o("actionWidgetPending"),children:(0,e.jsx)(s.Button,{className:"p-0 jimu-outline-inside","aria-label":o("actionWidgetPending"),type:"tertiary",icon:!0,children:(0,e.jsx)(Qt,{size:a||12,className:"ml-1"})})}),l.includes(ht.Large)&&(0,e.jsx)(s.Tooltip,{placement:"top",css:t.css`max-width: 300px;`,title:o("actionWidgetInLarge"),children:(0,e.jsx)(s.Button,{className:"p-0 jimu-outline-inside","aria-label":o("actionWidgetInLarge"),type:"tertiary",icon:!0,children:(0,e.jsx)(Ht,{size:a||12,className:"ml-1"})})}),l.includes(ht.Medium)&&(0,e.jsx)(s.Tooltip,{placement:"top",css:t.css`max-width: 300px;`,title:o("actionWidgetInMedium"),children:(0,e.jsx)(s.Button,{className:"p-0 jimu-outline-inside","aria-label":o("actionWidgetInMedium"),type:"tertiary",icon:!0,children:(0,e.jsx)(Gt,{size:a||12,className:"ml-1"})})}),l.includes(ht.Small)&&(0,e.jsx)(s.Tooltip,{placement:"top",css:t.css`max-width: 300px;`,title:o("actionWidgetInSmall"),children:(0,e.jsx)(s.Button,{className:"p-0 jimu-outline-inside","aria-label":o("actionWidgetInSmall"),type:"tertiary",icon:!0,children:(0,e.jsx)(Jt,{size:a||12,className:"ml-1"})})})]})};function Yt(e){let t=null;t=e.widgetId?(0,i.getAppConfigAction)().appConfig.widgets[e.widgetId]:{label:"Framework"};let s=e.actionName;if(t.manifest)if(t.manifest.i18nMessages[`_action_${e.actionName}_label`])s=t.manifest.i18nMessages[`_action_${e.actionName}_label`];else{const i=t.manifest.messageActions;if(i)for(let t=0;t<i.length;t++)if(i[t].name===e.actionName){s=i[t].label;break}}else if("Framework"===t.label){const t=i.AppMessageManager.getInstance().getAllActions();for(let i=0;i<t.length;i++)if(e.actionId.includes(t[i].id)){s=t[i].label;break}}return s}class ei extends t.React.PureComponent{constructor(){super(...arguments),this.onEditAction=(e,t=!1)=>{const{message:i}=this.props;ft(e,i.messageType)&&this.props.onClickEditAction(this.props.message,e,t)},this.onRemoveAction=(e,t)=>{e.stopPropagation();let s=this.props.message;const o=Object.assign([],s.actions),n=[];for(let e=0;e<o.length;e++)o[e].actionName===t.actionName&&n.push(o[e]);for(let e=0;e<o.length;e++)if(o[e].actionId===t.actionId&&o[e].widgetId===t.widgetId){const n=Object.assign([],o);n.splice(e,1),s=s.set("actions",n);const a=i.AppMessageManager.getInstance().getAction(t.widgetId,t.actionName);a&&a.onRemoveListen(s.messageType,s.widgetId);break}this.props.onMessageChanged(s)},this.onActionOrderChanged=e=>{let t=this.props.message;t=t.set("actions",e),this.props.onMessageChanged(t)},this.handleRemoveButtonKeyDown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||this.onRemoveAction(e,t)},this.createActionItem=(o,n)=>{var a;let r=null;r=o.widgetId?(0,i.getAppConfigAction)().appConfig.widgets[o.widgetId]:o.sectionId?(0,i.getAppConfigAction)().appConfig.sections[o.sectionId]:{label:"Framework"};const l=o.widgetId,c=o.sectionId,d=l||c?It(l,c):null,p=(null==d?void 0:d.length)>0,g=(null===(a=(d||[]).filter(e=>e!==ht.Pending))||void 0===a?void 0:a.length)>0;return(0,e.jsxs)("div",{className:(0,t.classNames)("action-item flex-grow-1",p?"disable-edit-con":""),css:this.getStyle(),children:[(0,e.jsxs)("div",{className:"d-flex w-100 justify-content-between align-items-start widget-name-con",children:["Framework"===r.label&&(0,e.jsx)("div",{className:"widget-name text-truncate",title:this.props.formatMessage(`action${r.label}`),children:this.props.formatMessage(`action${r.label}`)}),"Framework"!==r.label&&(0,e.jsxs)("div",{className:"widget-name text-truncate  d-flex align-items-center",children:[(0,e.jsx)("div",{className:"text-truncate mr-1",title:r.label,children:r.label}),(0,e.jsx)(Xt,{actionWidgetId:l,sectionIdOfAction:c})]}),!g&&(0,e.jsx)(s.Button,{onKeyDown:e=>{this.handleRemoveButtonKeyDown(e,o)},className:"delete-item-button",type:"tertiary",size:"sm",icon:!0,onClick:e=>{this.onRemoveAction(e,o)},"aria-label":this.props.formatMessage("actionDelete"),title:this.props.formatMessage("actionDelete"),children:(0,e.jsx)($,{size:"s",className:"p-0 deleteIcon"})})]}),(0,e.jsx)("div",{className:"hint-paper w-100 align-items-center action-name",children:(0,e.jsx)("div",{className:"w-100",title:Yt(o),children:Yt(o)})})]})},this.getActionList=()=>(0,e.jsx)("div",{style:{position:"relative"},children:(0,e.jsx)(ae.List,{size:"sm",className:"setting-ui-unit-list",itemsJson:this.props.message.actions.asMutable().map((e,t)=>{var i,s;return{itemStateDetailContent:e,itemStateChecked:(null===(s=null===(i=null==this?void 0:this.props)||void 0===i?void 0:i.action)||void 0===s?void 0:s.actionId)===e.actionId,itemKey:`${t}`}}),dndEnabled:!0,onUpdateItem:(e,t)=>{if(e.updateType===ae.TreeItemActionType.HandleDidDrop){const{itemJsons:[,e]}=t.props;this.onActionOrderChanged(e.map(e=>e.itemStateDetailContent))}},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:ae.TreeItemActionType.RenderOverrideItem,children:[{name:ae.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ae.TreeItemActionType.RenderOverrideItemBody,children:[{name:ae.TreeItemActionType.RenderOverrideItemDragHandle},{name:ae.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(e,t)=>{const{itemJsons:i}=t.props,s=i[0],o=null==s?void 0:s.itemKey;return this.createActionItem(s.itemStateDetailContent,o)},onClickItemBody:(e,t)=>{const{itemJsons:i}=t.props,s=i[0].itemStateDetailContent,o=s.widgetId,n=s.sectionId,a=o||n?It(o,n):null,r=(null==a?void 0:a.length)>0;this.onEditAction(s,r)}})})}getStyle(){const{theme:e}=this.props;return t.css`
      & {
        position: relative;
        flex: 1;
      }
      .widget-name-con {
        .widget-name {
          max-width: ${t.polished.rem(130)};
        }
      }
      .drag-icon-con {
        position: absolute;
        top: ${t.polished.rem(23)};
        left: 0
      }
      &.disable-edit-con{
        &,&:hover {
          background: ${e.sys.color.action.disabled.default}!important;
        }
        .widget-name, .action-name {
          color: ${e.sys.color.action.disabled.text}!important;
        }
        svg {
          color: ${e.sys.color.action.text};
        }
      }
    `}getContainerStyle(){const{theme:e}=this.props;return t.css`
      .jimu-tree-item__body.jimu-tree-item_selectable_true:hover{
        background: var(--sys-color-secondary-main) !important;
      }
      .jimu-tree-item__body:has(.disable-edit-con) {
        background: ${e.sys.color.action.disabled.default}!important;
      }
    `}render(){const i=(0,t.getMessageTypeLabel)(this.props.message.messageType,this.props.intl);return(0,e.jsx)("div",{className:"w-100",css:this.getContainerStyle(),role:"group","aria-label":i,children:(0,e.jsxs)("div",{className:(0,t.classNames)("w-100 message-item message-item-container mb-4",this.props.isActive?"active-border":""),children:[(0,e.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center",children:[(0,e.jsx)("h2",{className:"message-item-title",title:i,children:i}),(0,e.jsx)(s.Button,{className:"close-message-button",type:"tertiary",size:"sm",icon:!0,onClick:()=>{this.props.onMessageRemoved(this.props.message)},"aria-label":this.props.formatMessage("sectionDelete"),title:this.props.formatMessage("sectionDelete"),children:(0,e.jsx)($,{size:14,className:"p-0 deleteIcon"})})]}),this.props.message.actions&&this.props.message.actions.length>0&&this.getActionList(),(0,e.jsx)(s.Button,{className:"mt-2 item-add-action text-truncate w-100",onClick:()=>{this.props.onClickAddAction(this.props.message)},type:"tertiary",title:this.props.formatMessage("addAction"),children:`+ ${this.props.formatMessage("addAction")}`})]})})}}const ti=(0,t.injectIntl)(ei);class ii extends t.React.PureComponent{constructor(s){super(s),this.getActionSettingClass=()=>{const{action:e,message:t}=this.props,s=ft(e,t.messageType);i.AppMessageManager.getInstance().loadActionSettingClass(this.props.action,s).then(e=>{this.setState({settingClass:e})})},this.onSettingChange=e=>{const t=xt(e,this.props.message,this.state.cacheActionJson);if(t){const{action:e,message:i}=t;(null==e?void 0:e.config)&&(this.setState({cacheActionJson:this.state.cacheActionJson.set("config",e.config).set("useDataSources",e.useDataSources)}),this.props.onUpdateAction(i,e,!1))}},this.onDisableDoneBtn=e=>{this.setState({isDisableDoneBtn:e})},this.renderActionSetting=()=>{var i,s;const o=this.state.settingClass;return o?(0,e.jsx)(t.ErrorBoundary,{children:(0,e.jsx)(o,{actionId:this.state.cacheActionJson.actionId,widgetId:this.props.action.widgetId,messageWidgetId:this.props.widgetId,sectionId:this.props.action.sectionId,config:this.state.cacheActionJson.config?this.state.cacheActionJson.config:void 0,useDataSources:null===(s=null===(i=this.state.cacheActionJson)||void 0===i?void 0:i.asMutable({deep:!0}))||void 0===s?void 0:s.useDataSources,messageType:this.props.message.messageType,onSettingChange:this.onSettingChange,onDisableDoneBtn:this.onDisableDoneBtn})}):(0,e.jsx)("div",{className:"p-4",children:this.props.formatMessage("actionSettingLoading")})},this.state={settingClass:null,cacheActionJson:this.props.action,isDisableDoneBtn:!1}}componentDidMount(){this.getActionSettingClass()}componentDidUpdate(e){this.getActionSettingClass(),this.props.action!==e.action&&this.setState({cacheActionJson:this.props.action})}style(){return t.css`
      & {
        overflow-y: auto
      }
      &.disable-setting{
        -webkit-filter: grayscale(100%);
        -moz-filter: grayscale(100%);
        -ms-filter: grayscale(100%);
        -o-filter: grayscale(100%);
        filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
      }
      .disable-setting-mask {
        top: 0;
        bottom: 0;
        z-index: 1;
      }
    `}render(){const{disableActionSetting:i,action:s,message:o}=this.props,n=ft(s,o.messageType);return(0,e.jsxs)("div",{className:(0,t.classNames)("setting-container h-100",i?"disable-setting position-relative":""),css:this.style(),children:[n?this.renderActionSetting():(0,e.jsx)("div",{children:"\xa0\xa0No widget"}),(0,e.jsx)("div",{className:"w-100",style:{height:"50px"}}),i&&(0,e.jsx)("div",{className:"disable-setting-mask position-absolute w-100"})]})}}var si=f(1027),oi=f.n(si),ni=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const ai=i=>{const s=window.SVG,{className:o}=i,n=ni(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:oi()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};class ri extends t.React.PureComponent{constructor(e){super(e),this.sidePopperTrigger=t.React.createRef(),this.popperFocusNode=t.React.createRef(),this.resetState=()=>{this.setState({currentTriggeredMessage:null,currentTriggeredTarget:null,currentTriggeredAction:null,panelRoutes:[]})},this.updateLocalState=(e,t)=>{const s=(0,i.getAppConfigAction)().appConfig;if(e.messageConfigs&&e.messageConfigs!==t.messageConfigs){let t=null,i=null,o=null;if(this.state.currentTriggeredMessage&&this.state.currentTriggeredMessage.messageType){const n=Object.keys(e.messageConfigs);for(let i=0;i<n.length;i++)if(e.messageConfigs[n[i]].messageType===this.state.currentTriggeredMessage.messageType&&e.messageConfigs[n[i]].widgetId===this.state.currentTriggeredMessage.widgetId){t=e.messageConfigs[n[i]];break}if(t&&this.state.currentTriggeredTarget)if(this.state.currentTriggeredTarget.id){const e=this.state.currentTriggeredTarget;if(this.state.panelRoutes&&this.state.panelRoutes.length>0&&this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.ActionChoose)i=s.widgets[e.id];else for(let o=0;o<t.actions.length;o++)if(t.actions[o].widgetId===e.id){i=s.widgets[e.id];break}}else{const e=this.state.currentTriggeredTarget;if(this.state.panelRoutes&&this.state.panelRoutes.length>0&&this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.ActionChoose)i=e;else for(let s=0;s<t.actions.length;s++)if(!t.actions[s].widgetId){i=e;break}}if(t&&this.state.currentTriggeredAction&&this.state.currentTriggeredAction.actionName)for(let e=0;e<t.actions.length;e++)if(t.actions[e].actionId===this.state.currentTriggeredAction.actionId&&t.actions[e].widgetId===this.state.currentTriggeredAction.widgetId&&t.actions[e].actionName===this.state.currentTriggeredAction.actionName){o=t.actions[e];break}}this.setState({currentTriggeredMessage:t,currentTriggeredTarget:i,currentTriggeredAction:o})}},this.getMessages=()=>{const e=this.props.messageConfigs,t=[],i=Object.keys(e);if(i.length>0)for(let s=0;s<i.length;s++)e[i[s]]&&e[i[s]].widgetId===this.props.widgetId&&t.push(e[i[s]]);return t},this.onShowMessageChooseList=()=>{const e=[{pathType:at.MessageChoose,message:null}];this.setState({panelRoutes:e})},this.onMessageRemoved=e=>{e.actions.forEach(t=>{const s=i.AppMessageManager.getInstance().getAction(t.widgetId,t.actionName);s&&s.onRemoveListen(e.messageType,e.widgetId)}),(0,i.getAppConfigAction)().removeMessage(e).exec()},this.onMessageChanged=e=>{this.setState({currentTriggeredMessage:e},()=>{(0,i.getAppConfigAction)().editMessage(e).exec()})},this.onShowTargetChooseList=e=>{const t=[{pathType:at.TargetChoose,message:e}];this.setState({currentTriggeredMessage:e,currentTriggeredAction:null,panelRoutes:t})},this.onShowActionSettingPage=(e,t,i=!1)=>{const s=[{pathType:at.ActionSetting,message:e}];this.setState({currentTriggeredMessage:e,currentTriggeredAction:t,panelRoutes:s,disableActionSetting:i})},this.backForwardPanel=()=>{const e=Object.assign([],this.state.panelRoutes);if(e.splice(e.length-1,1),e[e.length-1].message){const t=e[e.length-1].message;this.setState({panelRoutes:e,currentTriggeredMessage:e[e.length-1].message},()=>{(0,i.getAppConfigAction)().editMessage(t).exec()})}else{const t=this.state.panelRoutes[this.state.panelRoutes.length-1].message;this.setState({panelRoutes:e,currentTriggeredMessage:null},()=>{(0,i.getAppConfigAction)().removeMessage(t).exec()})}},this.closePanel=()=>{var e;(0,t.focusElementInKeyboardMode)(null===(e=null==this?void 0:this.popperFocusNode)||void 0===e?void 0:e.current),this.setState({panelRoutes:[]})},this.onMessageChooseListSelected=e=>{const t=Object.assign([],this.state.panelRoutes);t.push({pathType:at.TargetChoose,message:e}),this.setState({currentTriggeredMessage:e,panelRoutes:t},()=>{(0,i.getAppConfigAction)().addMessage(e).exec()})},this.onTargetChooseListSelected=e=>{const t=Object.assign([],this.state.panelRoutes);t.push({pathType:at.ActionChoose,message:this.state.currentTriggeredMessage}),this.setState({currentTriggeredTarget:e,panelRoutes:t})},this.onActionChooseListSelected=(e,s,o)=>{const n=ft(s,null==e?void 0:e.messageType);if(null===s.config||"function"==typeof o.getDefaultMessageActionConfig&&n){const o=Object.assign([],this.state.panelRoutes);o.push({pathType:at.ActionSetting,message:e}),this.setState({currentTriggeredMessage:e,currentTriggeredAction:(0,t.Immutable)(s),panelRoutes:o},()=>{(0,i.getAppConfigAction)().editMessage(e).exec()})}else this.setState({currentTriggeredMessage:e,currentTriggeredAction:null,panelRoutes:[]},()=>{(0,i.getAppConfigAction)().editMessage(e).exec()})},this.onUpdateAction=(e,t,s)=>{s?this.setState({currentTriggeredMessage:e,currentTriggeredAction:t,panelRoutes:[]},()=>{(0,i.getAppConfigAction)().editMessage(e).exec()}):this.setState({currentTriggeredMessage:e,currentTriggeredAction:t},()=>{(0,i.getAppConfigAction)().editMessage(e).exec()})},this.modalStyle=t.css`
      position: absolute;
      top: 0;
      bottom: 0;
      width: 259px;
      height: 100%;
      padding-bottom: 1px;
      border-right: 1px solid ${this.props.theme.ref.palette.white};
      border-bottom: 1px solid ${this.props.theme.ref.palette.white};
    `,this.state={currentTriggeredMessage:null,currentTriggeredTarget:null,currentTriggeredAction:null,panelRoutes:[],disableActionSetting:!1}}componentDidUpdate(e){this.props.widgetId!==e.widgetId?this.resetState():this.updateLocalState(this.props,e)}render(){var t,i,o,n;const{formatMessage:a}=this.props,{disableActionSetting:r}=this.state,l=this.getMessages();return(0,e.jsxs)("div",{className:"d-flex h-100 flex-column",children:[(0,e.jsx)("div",{ref:this.sidePopperTrigger,children:(0,e.jsxs)(c.SettingSection,{children:[(0,e.jsx)(c.SettingRow,{flow:"wrap",children:(0,e.jsx)("div",{className:"w-100 justify-content-center d-flex",children:(0,e.jsx)(s.Button,{className:"w-100 jimu-outline-inside",type:"primary",onClick:this.onShowMessageChooseList,"aria-describedby":"trigger-empty-tip",ref:this.popperFocusNode,children:(0,e.jsx)("div",{className:"w-100 text-truncate",children:a("addTrigger")})})})}),(0,e.jsx)(c.SettingRow,{flow:"wrap",children:l.map((t,i)=>(0,e.jsx)(ti,{message:t,onMessageRemoved:this.onMessageRemoved,isActive:t===this.state.currentTriggeredMessage&&this.state.panelRoutes.length>0,onMessageChanged:this.onMessageChanged,onClickAddAction:this.onShowTargetChooseList,onClickEditAction:this.onShowActionSettingPage,formatMessage:a,action:this.state.panelRoutes.length>0&&this.state.currentTriggeredAction,theme:this.props.theme},i))}),this.state.panelRoutes.length>0&&!this.props.pageId&&(0,e.jsxs)("div",{children:[this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.MessageChoose&&(0,e.jsx)(c.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(t=this.sidePopperTrigger)||void 0===t?void 0:t.current,children:(0,e.jsx)("div",{className:"bg-default border-color-gray-400",css:this.modalStyle,children:(0,e.jsx)(lt,{formatMessage:a,Routes:this.state.panelRoutes,title:a("selectTrigger"),onBack:this.backForwardPanel,onClose:this.closePanel,children:(0,e.jsx)(kt,{widgetId:this.props.widgetId,onSelected:this.onMessageChooseListSelected,messages:l,formatMessage:a})})})}),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.TargetChoose&&this.state.currentTriggeredMessage&&(0,e.jsx)(c.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(i=this.sidePopperTrigger)||void 0===i?void 0:i.current,children:(0,e.jsx)("div",{className:"bg-default border-color-gray-400",css:this.modalStyle,children:(0,e.jsx)(lt,{formatMessage:a,Routes:this.state.panelRoutes,title:a("selectTarget"),onBack:this.backForwardPanel,onClose:this.closePanel,children:(0,e.jsx)(_t,{onSelected:this.onTargetChooseListSelected,message:this.state.currentTriggeredMessage,formatMessage:a})})})}),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.ActionChoose&&this.state.currentTriggeredMessage&&this.state.currentTriggeredTarget&&(0,e.jsx)(c.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(o=this.sidePopperTrigger)||void 0===o?void 0:o.current,children:(0,e.jsx)("div",{className:"bg-default border-color-gray-400",css:this.modalStyle,children:(0,e.jsx)(lt,{formatMessage:a,Routes:this.state.panelRoutes,title:a("selectAction"),onBack:this.backForwardPanel,onClose:this.closePanel,children:(0,e.jsx)(Pt,{widgetId:this.props.widgetId,onSelected:this.onActionChooseListSelected,message:this.state.currentTriggeredMessage,target:this.state.currentTriggeredTarget,formatMessage:a})})})}),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===at.ActionSetting&&this.state.currentTriggeredMessage&&this.state.currentTriggeredAction&&(0,e.jsx)(c.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(n=this.sidePopperTrigger)||void 0===n?void 0:n.current,children:(0,e.jsx)("div",{className:"bg-default border-color-gray-400",css:this.modalStyle,children:(0,e.jsx)(lt,{hideBackArrow:!0,formatMessage:a,Routes:this.state.panelRoutes,title:a("actionSet"),onBack:this.backForwardPanel,onClose:this.closePanel,children:(0,e.jsx)(ii,{widgetId:this.props.widgetId,message:this.state.currentTriggeredMessage,action:this.state.currentTriggeredAction,onUpdateAction:this.onUpdateAction,formatMessage:a,disableActionSetting:r})})})})]})]})}),0===l.length&&(0,e.jsx)("div",{className:"flex-grow-1 text-center no-trigger-tip position-relative",children:(0,e.jsxs)("div",{className:"position-absolute",children:[(0,e.jsx)(ai,{size:48}),(0,e.jsx)("p",{className:"trigger-tip",id:"trigger-empty-tip",children:a("noTriggerTip",{ButtonString:a("addTrigger")})})]})})]})}}var li=f(655),ci=f.n(li),di=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const pi=i=>{const s=window.SVG,{className:o}=i,n=di(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:ci()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};function gi(i){const{enabled:o,isOpen:n,icon:a,label:r,onEnableToggled:l,onOpenToggled:c,formatMessage:d,hideCollapseIcon:p}=i;return(0,e.jsxs)("div",{className:"d-flex align-items-center pl-2 pr-1 h-100",children:[(0,e.jsxs)(s.Label,{className:"d-flex align-items-center mb-0",css:t.css`max-width: 85%;`,children:[(0,e.jsx)(s.Checkbox,{checked:o,onChange:l}),"string"==typeof a?(0,e.jsx)(s.Icon,{className:"ml-2",icon:a}):a,(0,e.jsx)("span",{className:"ml-2 text-truncate",title:r,children:r})]}),!p&&(0,e.jsx)(s.Button,{className:"ml-auto p-0",size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,icon:!0,onClick:c,disabled:!o,"aria-label":d(n?"collapse":"expand"),children:(0,e.jsx)(pi,{size:"s",css:t.css`transform: rotateZ(${n&&o?180:0}deg);`})})]})}function hi(o){const{widgetId:n,enabled:a,items:r,dataActions:l=(0,t.Immutable)({}),formatMessage:d,onEnableToggled:p}=o,[g,h]=t.React.useState(!1),u=r[0],m=t.hooks.useTranslation(s.defaultMessages),f=t.React.useCallback(()=>{h(!g)},[g,h]),v=[];r.forEach(e=>{var t,i,s,o;(null===(o=null===(s=(null!==(i=null===(t=null==l?void 0:l[e.name])||void 0===t?void 0:t.actions)&&void 0!==i?i:{})[e.widgetId])||void 0===s?void 0:s.enabled)||void 0===o||o)&&v.push(e.widgetId)});const w=t.React.useCallback(e=>m("numSelected",{number:e.length}),[m]),x=t.React.useCallback(e=>{var s,o,a,r;const c=null===(r=null===(a=(null!==(o=null===(s=null==l?void 0:l[u.name])||void 0===s?void 0:s.actions)&&void 0!==o?o:(0,t.Immutable)({}))[e])||void 0===a?void 0:a.enabled)||void 0===r||r;(0,i.getAppConfigAction)().editWidgetProperty(n,"dataActions",l.setIn([u.name,"actions",e,"enabled"],!c)).exec()},[l,n,u.name]),y=!g||!a||u.hideCollapseIcon;return(0,e.jsx)(c.SettingSection,{title:(0,e.jsx)(gi,{enabled:a,icon:u.icon,label:u.label,isOpen:g,onEnableToggled:p,onOpenToggled:f,formatMessage:d,hideCollapseIcon:u.hideCollapseIcon}),className:(0,t.classNames)("p-0 data-action-item",{[`data-action-${u.name}`]:!0}),css:t.css`
        border-top: ${y?"none !important":"2px solid var(--sys-color-primary-main)"};
        border-bottom: none !important;
        background-color: var(--ref-palette-neutral-500);
        margin-top: 8px;
        .jimu-widget-setting--section-header {
          height: 32px;
          .hint-paper {
            height: 100%;
          }
        }
      `,role:"group","aria-label":u.label,children:!u.hideCollapseIcon&&(0,e.jsxs)(s.Collapse,{isOpen:g&&a,className:"mt-0 px-2",children:[(0,e.jsx)(c.SettingRow,{flow:"wrap",label:d("selectWidgets"),className:"py-2",children:(0,e.jsx)(s.MultiSelect,{"aria-label":d("selectWidgets"),onChange:x,values:(0,t.Immutable)(v),displayByValues:w,size:"sm",children:r.map(o=>{var a,r,c,p;const g=null!==(c=(null!==(r=null===(a=null==l?void 0:l[o.name])||void 0===a?void 0:a.actions)&&void 0!==r?r:{})[o.widgetId])&&void 0!==c?c:(0,t.Immutable)({}),h=(0,i.getAppConfigAction)().appConfig.widgets[o.widgetId],u=o.widgetId===n?d("current"):h.label;return(0,e.jsxs)(s.MultiSelectItem,{value:o.widgetId,label:u,children:[(0,e.jsx)(s.Checkbox,{checked:null===(p=g.enabled)||void 0===p||p}),(0,e.jsx)("span",{className:"jimu-multi-select-item-label",children:u})]},o.widgetId)})})}),o.children]})})}var ui=f(6420),mi=f.n(ui),fi=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const vi=i=>{const s=window.SVG,{className:o}=i,n=fi(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:mi()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var wi=f(5356),xi=f.n(wi),yi=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const bi=i=>{const s=window.SVG,{className:o}=i,n=yi(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:xi()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Ii=function(e,t,i,s){return new(i||(i=Promise))(function(o,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,r)}l((s=s.apply(e,t||[])).next())})};class Si extends t.React.PureComponent{constructor(e){super(e),this.handleEnableDataActionChanged=e=>{const t=(0,i.getAppConfigAction)().appConfig.widgets[this.props.widgetId];(0,i.getAppConfigAction)().editWidget(t.set("enableDataAction",e.target.checked)).exec()},this.handleShowAllDataCountChange=e=>{const t=(0,i.getAppConfigAction)().appConfig.widgets[this.props.widgetId];(0,i.getAppConfigAction)().editWidget(t.set("showAllDataCount",e.target.checked)).exec()},this.state={settingClasses:{}}}componentDidMount(){const e=i.AppDataActionManager.getInstance().loadAllActionSettingClasses(),t=Object.keys(null!=e?e:{});if(t.length>0){const i=t.map(t=>Ii(this,void 0,void 0,function*(){return yield e[t]}));Promise.allSettled(i).then(e=>{const i={};e.forEach((e,s)=>{"fulfilled"===e.status?i[t[s]]=e.value:console.error(e.reason)}),this.setState({settingClasses:i})}).catch(e=>{console.error(e)})}}getAvailableActions(){var e;const s={},o={},n=(0,i.getAppConfigAction)(),a=null===(e=n.appConfig.widgets[this.props.widgetId].manifest)||void 0===e?void 0:e.excludeDataActions,r=t.DataActionManager.getInstance(),l=this.props.appMode===t.AppMode.Design,c=this.props.appMode===t.AppMode.Design;this.getAllWidgetsInSameRootContainer(n.appConfig,this.props.widgetId,this.props.sizeMode,l,c).forEach(e=>{var i;const o=n.appConfig.widgets[e],l=null===(i=o.manifest)||void 0===i?void 0:i.dataActions;(null==l?void 0:l.length)>0&&l.forEach(i=>{var n,l;const c=`${null===(n=o.manifest)||void 0===n?void 0:n.name}.${i.name}`;if(r.isActionExcluded(c,a))return;s[i.name]||(s[i.name]=[]);const d=t.urlUtils.isAbsoluteUrl(o.uri)?`${o.uri}dist/${i.icon}`:`${t.moduleLoader.resolveModuleFullPath("widgets/")}../${o.uri}dist/${i.icon}`;s[i.name].push({name:i.name,icon:d,label:null!==(l=o.manifest.i18nMessages[`_action_${i.name}_label`])&&void 0!==l?l:i.label,widgetId:e,settingUri:`${o.uri}dist/${i.settingUri}`})})});return t.DataActionManager.getInstance().getActions().forEach(e=>{e.widgetId||e.name.includes("export")||(null==a?void 0:a.includes(e.name))||(o[e.name]||(o[e.name]=[]),o[e.name].push({name:e.name,icon:e.icon,label:e.label,hideCollapseIcon:!0}))}),{widgetActions:s,frameworkActions:o}}getAllWidgetsInSameRootContainer(e,i,s,o,n){const a=l.searchUtils.getContentRootContainerInfo(e,i,t.LayoutItemType.Widget,s,o),r=this.props.currentPageId;return l.searchUtils.getContentsInContainerRecursiveAdv(e,a,t.LayoutItemType.Widget,s,{includePending:o,includeOtherSizeMode:n,currentPageId:r})}updateActionStatus(e,s){var o;const{widgetId:n}=this.props,a=(0,i.getAppConfigAction)(),r=null!==(o=a.appConfig.widgets[n].dataActions)&&void 0!==o?o:(0,t.Immutable)({});a.editWidgetProperty(n,"dataActions",r.setIn([e,"enabled"],s)).exec()}createActionItemSetting(t,i){const s=this.state.settingClasses[t.settingUri];return s?(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(s,{widgetId:this.props.widgetId,actionName:t.name,config:i,onSettingChange:e=>{this.updateActionItemSetting(t.name,e)}})}):null}updateActionItemSetting(e,s){var o;const{widgetId:n}=this.props,a=(0,i.getAppConfigAction)(),r=null!==(o=a.appConfig.widgets[n].dataActions)&&void 0!==o?o:(0,t.Immutable)({});a.editWidgetProperty(n,"dataActions",r.setIn([e,"config"],s)).exec()}createActionItem(t,i,s){var o,n,a;const{dataActions:r}=this.props,l=null===(n=null===(o=null==r?void 0:r[t])||void 0===o?void 0:o.enabled)||void 0===n||n,c=i[0];return(0,e.jsx)(hi,{widgetId:this.props.widgetId,enabled:l,items:i,dataActions:r,formatMessage:this.props.formatMessage,onEnableToggled:()=>{this.updateActionStatus(t,!l)},children:l&&c.settingUri&&this.createActionItemSetting(c,null===(a=null==r?void 0:r[t])||void 0===a?void 0:a.config)},s)}createExportNotes(){return(0,e.jsxs)("div",{className:"d-flex mt-4 pl-2 pr-1 w-100 pr-1 align-items-center title2 hint-paper",css:t.css`
          color: var(--ref-palette-neutral-1000);
          height: 32px;
          background: var(--ref-palette-neutral-500);
        `,children:[(0,e.jsx)(vi,{color:"var(--dark-50)"}),(0,e.jsx)("span",{className:"ml-2",children:this.props.formatMessage("export")}),(0,e.jsx)(s.Tooltip,{placement:"bottom",css:t.css`max-width: 300px; margin-left: auto;`,showArrow:!0,title:this.props.formatMessage("exportNotes"),children:(0,e.jsx)(s.Button,{className:"ml-auto p-0",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,icon:!0,children:(0,e.jsx)(r,{className:"mr-1",color:"var(--dark-50)"})})})]})}createEnableBtn(i){const{formatMessage:o,enableDataAction:n}=this.props,a="enableDataAction";return(0,e.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center pb-4",children:[(0,e.jsxs)("div",{className:"title d-flex align-items-center",css:t.css`max-width: 80%; color: var(--ref-palette-neutral-1100);`,children:[(0,e.jsx)(s.Label,{className:"text-truncate title2 hint-paper mb-0",title:o(a),for:"enable-data-action",children:o(a)}),(0,e.jsx)(s.Tooltip,{placement:"left",css:t.css`max-width: 300px;`,showArrow:!0,title:o("dataActionTooltip"),children:(0,e.jsx)(s.Button,{className:"ml-2",icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,children:(0,e.jsx)(r,{})})})]}),(0,e.jsx)(s.Switch,{id:"enable-data-action","aria-describedby":i?"noDataActionDesc":void 0,checked:n,onChange:this.handleEnableDataActionChanged})]})}render(){const{enableDataAction:i,showAllDataCount:o}=this.props,{widgetActions:n,frameworkActions:a}=this.getAvailableActions(),r=t.lodash.merge({},n,a),l=Object.keys(a).sort(),d=Object.keys(n).sort(),p=(0,e.jsx)(c.SettingRow,{bottomLine:!0,className:"w-100",children:(0,e.jsxs)(s.Label,{"aria-label":this.props.formatMessage("showAllDataCount"),className:"cursor-pointer hint-paper",children:[(0,e.jsx)(s.Checkbox,{className:"mr-2",checked:o,onChange:e=>{this.handleShowAllDataCountChange(e)}}),(0,e.jsx)("span",{children:this.props.formatMessage("showAllDataCount")})]})});return 0===l.length&&0===d.length?(0,e.jsxs)(c.SettingSection,{className:(0,t.classNames)({"h-100":i,"d-flex":!0,"flex-column":!0,"data-action-list":!0}),children:[this.createEnableBtn(!0),i&&(0,e.jsxs)("div",{className:"d-flex flex-column align-items-center flex-grow-1 mt-4",children:[p,this.createExportNotes(),(0,e.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center flex-grow-1",children:[(0,e.jsx)(bi,{size:42,color:"var(--ref-palette-neutral-800)"}),(0,e.jsx)("p",{id:"noDataActionDesc",className:"p-2",css:t.css`color: var(--ref-palette-neutral-1000); text-align: center;`,children:this.props.formatMessage("noDataAction")})]})]})]}):(0,e.jsxs)(c.SettingSection,{className:(0,t.classNames)({"h-100":i,"data-action-list":!0}),children:[this.createEnableBtn(!1),i&&(0,e.jsxs)(t.React.Fragment,{children:[p,this.createExportNotes(),(0,e.jsx)("div",{className:"framework-actions pb-1",children:l.map((e,t)=>this.createActionItem(e,r[e],t))}),(0,e.jsx)("div",{className:"widget-actions",children:d.map((e,t)=>this.createActionItem(e,r[e],t))})]})]})}}const Ci=t.ReactRedux.connect((e,t)=>{var i,s,o,n,a,r,l;const c=null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.widgets[t.widgetId];return{dataActions:null==c?void 0:c.dataActions,sizeMode:null===(o=e.appStateInBuilder)||void 0===o?void 0:o.browserSizeMode,appMode:null===(n=e.appStateInBuilder)||void 0===n?void 0:n.appRuntimeInfo.appMode,enableDataAction:null===(a=null==c?void 0:c.enableDataAction)||void 0===a||a,showAllDataCount:null===(r=null==c?void 0:c.showAllDataCount)||void 0===r||r,currentPageId:null===(l=e.appStateInBuilder)||void 0===l?void 0:l.appRuntimeInfo.currentPageId}})(Si);class ji extends t.React.PureComponent{getStyle(e){return t.css`
      .jimu-widget-setting--row {
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      .message-setting {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
        }

        .listItem {
          cursor: pointer;
          padding: 5px 0px;
        }

        .listItem.active {
          background-color: ${e.sys.color.primary.light};
          border: 0;
        }

        .listItem:hover {
          background-color: ${t.polished.rgba(e.sys.color.primary.light,.4)};
        }

        .active-border {
          border-left: 2px solid var(--sys-color-primary-light) !important;
        }

        .message-item-container {
          background-color: var(--ref-palette-neutral-500);
          border: 1px solid ${e.ref.palette.neutral[500]};
        }

        .message-item {

          .widget-name {
            font-size: ${t.polished.rem(14)};
            font-weight: 400;
          }

          .action-name {
            font-size: ${t.polished.rem(13)};
            margin-top: ${t.polished.rem(13)};
          }

          padding: 0 ${t.polished.rem(12)} ${t.polished.rem(6)} ${t.polished.rem(12)};

          .action-item {
            padding: ${t.polished.rem(8)} ${t.polished.rem(10)} ${t.polished.rem(10)} ${t.polished.rem(5)};
            .delete-item-button {
              visibility: hidden;
              padding: 0;
              color: var(--ref-palette-neutral-1000);
            }
          }

          .action-item:hover, .jimu-tree-item:focus, .jimu-tree-item:focus-within {
            .delete-item-button {
              visibility: unset;
            }
          }

          .drag-item {
            &:hover {
              .action-item {
                border: 1px solid ${e.sys.color.primary.dark};
              }
              .action-name {
                background-color: ${e.sys.color.secondary.light};
              }
            }
          }

          .message-item-title {
            font-size: ${t.polished.rem(14)};
            line-height: 1.3;
            margin: 0;
            padding: ${t.polished.rem(8)} 0;
            width: 190px;
            overflow: hidden;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            display: -webkit-box;
          }

          .close-message-button {
            svg {
              margin: 0;
            }
          }

          .deleteIcon-disable {
            opacity: .3;
          }

          .deleteIcon {
            cursor: pointer;
            opacity: .8;
          }

          .deleteIcon:hover {
            opacity: 1;
          }

          .item-add-action {
            cursor: pointer;
            color: ${e.sys.color.primary.light};
            padding: 0;
            border: 1px dashed var(--ref-palette-neutral-700);
            height: ${t.polished.rem(26)};
            &:hover {
              color: ${t.polished.rgba(e.sys.color.primary.light,.8)};
            }
          }
        }

        .jimu-widget-setting--section {
          padding-left: 0;
          padding-right: 0;
        }
        .jimu-widget-setting--row {
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .no-trigger-tip {
          &>div {
            top: 50%;
            transform: translateY(-50%);
            color: ${e.ref.palette.neutral[800]};
          }
          p {
            color: ${e.ref.palette.neutral[1e3]};
            font-size: ${t.polished.rem(14)};
            margin: ${t.polished.rem(16)} auto 0;
            line-height: ${t.polished.rem(19)};
            width: ${t.polished.rem(228)};
          }
        }
      }
    `}createMessageActionSetting(){const{pageId:t,widgetId:i,theme:s,messageConfigs:o}=this.props;return(0,e.jsx)(ri,{pageId:t,widgetId:i,theme:s,messageConfigs:o,formatMessage:this.props.formatMessage})}createDataActionSetting(){const{canConsumeDataAction:t}=this.props;if(t)return(0,e.jsx)(Ci,{widgetId:this.props.widgetId,formatMessage:this.props.formatMessage})}render(){const{supportMessageAction:t,canConsumeDataAction:i,formatMessage:o}=this.props;return t&&!i?(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme),children:(0,e.jsx)("div",{className:"jimu-widget message-setting px-4",children:this.createMessageActionSetting()})}):!t&&i?(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme),children:this.createDataActionSetting()}):(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme),children:(0,e.jsx)("div",{className:"jimu-widget message-setting",children:(0,e.jsxs)(s.Tabs,{type:"pills",fill:!0,className:"p-4 h-100",defaultValue:"message",children:[(0,e.jsx)(s.Tab,{id:"message",title:o("messageAction"),children:this.createMessageActionSetting()}),(0,e.jsx)(s.Tab,{id:"data",title:o("dataAction"),children:this.createDataActionSetting()})]})})})}}const Ai=t.ReactRedux.connect((e,t)=>{var i,s;return{messageConfigs:null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.messageConfigs}})((0,y.withTheme)(ji));var Ti=f(3303),Mi=f.n(Ti),Ni=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const ki=i=>{const s=window.SVG,{className:o}=i,n=Ni(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Mi()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},{useState:Oi,useEffect:Pi,useRef:Ri}=t.React,Di=o=>{const n=t.hooks.useTranslation(Wt,s.defaultMessages),a=Ri({}),{widgetId:r,message:l,settingClassUri:d,sidePopperTrigger:p,actionId:g,closePanel:h,onMessageChanged:u}=o,[m,f]=Oi({}),[v,w]=Oi(null);Pi(()=>{if(g&&l){const e=l.actions||[],t=null==e?void 0:e.filter(e=>e.actionId===g)[0];w(t)}},[l,g]),Pi(()=>{d&&(null==v?void 0:v.actionId)&&x(v,d)},[d,v]);const x=(e,t)=>{!a.current[t]&&t&&i.AppMessageManager.getInstance().loadActionSettingClass(e,t).then(e=>{a.current[t]=e,f(a.current)})},y=t.hooks.useEventCallback(e=>{const t=xt(e,l,v);if(t){const{action:e,message:i}=t;(null==e?void 0:e.config)&&(w(e),u(i))}});return(0,e.jsx)("div",{children:(()=>{var t;const i=m[d];return i&&v&&g?(0,e.jsx)(c.SidePopper,{isOpen:!!(m[d]&&d&&l),position:"right",toggle:h,trigger:p,children:(0,e.jsx)("div",{className:"bg-default border-color-gray-400",children:(0,e.jsx)(lt,{formatMessage:n,hideBackArrow:!0,title:n("actionSet"),onClose:h,children:l&&(0,e.jsx)(i,{actionId:v.actionId,widgetId:v.widgetId,messageWidgetId:r,config:v.config,useDataSources:null===(t=null==v?void 0:v.asMutable({deep:!0}))||void 0===t?void 0:t.useDataSources,messageType:l.messageType,onSettingChange:y})})})}):null})()})},{useState:Li,useEffect:Ei,useRef:Bi}=t.React;var zi;!function(e){e.WIDGET="widget",e.SECTION="section",e.FRAMEWORK="framework"}(zi||(zi={}));const Ui=t.css`
  .disable-advance-selector .jimu-dropdown-button {
    background: var(--sys-color-action-disabled) !important;
    color: var(--sys-color-action-disabled-text) !important;
  }
  .hide-border {
    border-color: transparent;
    opacity: 0;
  }
  .no-available-action-con {
    color: var(--sys-color-action-disabled-text) !important;
  }
`,_i=o=>{const n=t.hooks.useTranslation(Wt,s.defaultMessages),a=t.ReactRedux.useSelector(e=>e.appStateInBuilder.widgetsClassStatus),r=Bi(null),l=Bi(!1),d=Bi(null),{widgetId:p,publishMessageItem:g,messages:h,sidePopperTrigger:u}=o,m=t.ReactRedux.useSelector(e=>{var t,i,s;return null===(s=null===(i=null===(t=e.appStateInBuilder.appConfig)||void 0===t?void 0:t.widgets)||void 0===i?void 0:i[p])||void 0===s?void 0:s.useMapWidgetIds}),f=t.ReactRedux.useSelector(e=>{var t,i,s;return null===(s=null===(i=null===(t=e.appStateInBuilder.appConfig)||void 0===t?void 0:t.widgets)||void 0===i?void 0:i[p])||void 0===s?void 0:s.useDataSources}),v=t.ReactRedux.useSelector(e=>{var t,i,s;return null===(s=null===(i=null===(t=e.appStateInBuilder.appConfig)||void 0===t?void 0:t.widgets)||void 0===i?void 0:i[p])||void 0===s?void 0:s.outputDataSources}),[w,x]=Li(null),[y,b]=Li(null),[I,S]=Li(null),[C,j]=Li({}),[A,T]=Li(null),[M,N]=Li(!1),[k,O]=Li(0);Ei(()=>{const e=E(h,g.messageType);T((0,t.Immutable)(e)),r.current=(0,t.Immutable)(e)},[h,g]),Ei(()=>{D(g.messageType,p)},[g.messageType,p,a,M,m,f,v]),Ei(()=>{P(v)},[v]),Ei(()=>{l.current=!1,O(k+1)},[p]),Ei(()=>{if(!l.current){const e=(null==A?void 0:A.actions)||[],t=(null==e?void 0:e.length)>0;N(t),t&&(l.current=!0)}},[A]);const P=e=>{R(e)?D(g.messageType,p):(clearTimeout(d.current),d.current=setTimeout(()=>{P(e)},1e3))},R=e=>{let i=!0;const s=t.DataSourceManager.getInstance();return null==e||e.forEach(e=>{s.getDataSource(e)||(i=!1)}),i},D=(e,t)=>{const i=mt(e,t,!0),{widgetTargets:s,frameWorkTargets:o,sectionTargets:n}=i;x(s),S(o),b(n)},L=e=>{(0,i.getAppConfigAction)().addMessage(e).exec()},E=(e,t)=>{let i;return Object.keys(e).forEach(s=>{var o,n;(null===(o=e[s])||void 0===o?void 0:o.messageType)===t&&(i=null===(n=e[s])||void 0===n?void 0:n.asMutable({deep:!0}))}),i},B=t.hooks.useEventCallback((e,t,i)=>{var s;const o=(null===(s=r.current)||void 0===s?void 0:s.actions)||[];return(null==o?void 0:o.filter(s=>i===zi.WIDGET?s.actionName===e&&t.id===s.widgetId:i===zi.SECTION?s.actionName===e&&t.id===s.sectionId:s.actionName===e))[0]}),z=e=>i.AppMessageManager.getInstance().getActionSettingComponentUri(e,g.messageType,p),U=(e,t,i)=>{let s;return null==e||e.forEach(e=>{var o;(null===(o=B(e.name,t,i))||void 0===o?void 0:o.actionId)&&(s=s?`${s}, ${e.label}`:e.label)}),s||n("none")},_=()=>{j(null)},W=t.hooks.useEventCallback((e,t,i,s)=>{const o=(null==C?void 0:C.actionSettingUri)?null:e,n=(null==C?void 0:C.actionId)?null:t,a=(null==C?void 0:C.action)?null:i;j({actionSettingUri:o,actionId:n,action:a}),(null==s?void 0:s.stopPropagation)&&s.stopPropagation()}),F=(e,t)=>{let i=null,s=null;return t!==zi.SECTION?i=null==e?void 0:e.id:s=null==e?void 0:e.id,{targetWidgetId:i,targetSectionId:s}},H=(t,i)=>{const s=V(t,i),{targetWidgetId:o,targetSectionId:n}=F(t,i);return(0,e.jsxs)("div",{className:"d-flex align-items-center",children:[(0,e.jsx)("div",{className:"pr-1",children:s}),(0,e.jsx)(Xt,{actionWidgetId:o,sectionIdOfAction:n,size:12})]})},V=(e,t)=>(null==e?void 0:e.id)?null==e?void 0:e.label:n("data"),G=(i,o=0,n)=>{const a=wt(i,p,g.messageType),{targetWidgetId:r,targetSectionId:l}=F(i,n),d=(null==i?void 0:i.id)?It(r,l):null;if(0===a.length)return null;const h=Z(a,i,n);if((null==d?void 0:d.length)>0)return null;const u=V(i,n);return(0,e.jsx)(c.SettingRow,{label:H(i,n),className:"w-100",flow:"wrap",children:(0,e.jsx)(s.AdvancedSelect,{className:(0,t.classNames)({"disable-advance-selector":(null==d?void 0:d.length)>0}),size:"sm",sortList:!1,selectedValues:h,isMultiple:!0,strategy:"absolute",hideSearchInput:!0,hideBottomTools:!0,"aria-label":u,title:U(a,i,n),customDropdownButtonContent:()=>U(a,i,n),version:k,onChange:e=>{$(e,a,i,n)},staticValues:K(a,i,n)})},o)},$=(e,i,s,o)=>{var n;const a=Z(i,s,o).map(e=>e.value),c=(null==e?void 0:e.map(e=>e.value))||[],d=null==c?void 0:c.filter(e=>!a.includes(e)),h=null==a?void 0:a.filter(e=>!c.includes(e)),u=null==i?void 0:i.filter(e=>h.includes(e.name));if(0===(null==d?void 0:d.length)&&0===(null==h?void 0:h.length))return;let m,f,v,w=null===(n=r.current)||void 0===n?void 0:n.asMutable({deep:!0});if(w||(w=Mt.messageActionUtils.getNewMessage(g.messageType,p),r.current=(0,t.Immutable)(w)),(null==h?void 0:h.length)>0){_();let e=(null==w?void 0:w.actions)||[];e=null==e?void 0:e.filter(e=>!(null==h?void 0:h.includes(e.actionName))),w.actions=e,J(u)}(null==d?void 0:d.length)>0&&d.forEach(e=>{const t=null==i?void 0:i.filter(t=>t.name===e)[0],o=Mt.messageActionUtils.getNewActionItem(s,t,p,g.messageType);w.actions.push(o),v=z(t),m=t,f=o.actionId}),m&&v&&W(v,f,m),l.current=!0,L((0,t.Immutable)(w))},J=e=>{e.forEach(e=>{const t=i.AppMessageManager.getInstance().getAction(e.widgetId,e.name);t&&t.onRemoveListen(A.messageType,A.widgetId)})},Z=(e,t,i)=>{const s=[];return null==e||e.forEach(e=>{var o;(null===(o=B(e.name,t,i))||void 0===o?void 0:o.actionId)&&s.push({value:e.name,label:e.label})}),s},K=(e=[],t,i)=>{const{targetWidgetId:s,targetSectionId:o}=F(t,i),n=(null==t?void 0:t.id)?It(s,o):null;return null==e?void 0:e.map((e,s)=>({value:e.name,label:e.label,disabled:(null==n?void 0:n.length)>0,render:o=>q(e,s,t,i)}))},q=t.hooks.useEventCallback((t,i,s,o)=>{const a=z(t),r=B(t.name,s,o),l=a&&(null==r?void 0:r.actionId);return(0,e.jsxs)("div",{className:"d-flex align-items-center flex-grow-1",children:[(0,e.jsx)("div",{className:"flex-grow-1 d-flex align-items-center",children:(0,e.jsx)("div",{className:"flex-grow-1 text-left",children:t.label})}),l&&(0,e.jsx)("div",{className:"px-2 settings-icon py-0",title:n("settings"),onClick:e=>{W(a,null==r?void 0:r.actionId,t,e)},children:(0,e.jsx)(ki,{size:"s"})})]},`${t.label}-${i}`)}),Q=(e,t,i)=>((null==e?void 0:e.length)||0)+((null==t?void 0:t.length)||0)+((null==i?void 0:i.length)||0)>0,X=(e,t)=>{if(t)N(!0);else{let e=r.current;!function(e){(null==e?void 0:e.actions)&&e.actions.forEach(t=>{const s=i.AppMessageManager.getInstance().getAction(t.widgetId,t.actionName);s&&s.onRemoveListen(e.messageType,e.widgetId)})}(r.current),e=null==e?void 0:e.set("actions",[]),N(!1),e&&L(e)}};return(0,e.jsx)("div",{className:"w-100 h-100",css:Ui,children:Q(I,w,y)&&(0,e.jsxs)("div",{className:"w-100 h-100",children:[(0,e.jsx)("div",{className:(0,t.classNames)("top-line-con",{"hide-border":!M}),children:(0,e.jsx)(c.SettingRow,{bottomLine:!0})}),(0,e.jsxs)(c.SettingSection,{title:(t=>(0,e.jsxs)(s.Label,{check:!0,className:"d-flex align-items-center",children:[(0,e.jsx)("div",{className:"flex-grow-1 text-truncate",title:g.messageLabel,children:g.messageLabel}),(0,e.jsx)(s.Switch,{checked:t,"aria-describedby":"noAvailableActions",onChange:X})]}))(M),role:"group","aria-label":g.messageLabel,className:(0,t.classNames)("w-100 h-100",{"clear-padding-bottom":!M}),children:[M&&(0,e.jsxs)("div",{className:"w-100 h-100",children:[(null==I?void 0:I.length)>0&&(null==I?void 0:I.map((e,t)=>G(e,t,zi.FRAMEWORK))),(null==w?void 0:w.length)>0&&(null==w?void 0:w.map((e,t)=>G(e,t,zi.WIDGET))),(null==y?void 0:y.length)>0&&(null==y?void 0:y.map((e,t)=>G(e,t,zi.SECTION))),!Q(I,w,y)&&(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)("div",{className:"no-available-action-con",id:"noAvailableActions",children:n("noAvailableActions")})})]}),(0,e.jsx)(Di,{widgetId:p,action:null==C?void 0:C.action,actionId:null==C?void 0:C.actionId,settingClassUri:null==C?void 0:C.actionSettingUri,onMessageChanged:L,sidePopperTrigger:u,message:A,closePanel:_})]})]})})},{useState:Wi,useEffect:Fi}=t.React,Hi=i=>{const s=(0,y.getTheme)(),o=t.hooks.useTranslation(Wt),n=t.ReactRedux.useSelector(e=>{var t;return null===(t=e.appStateInBuilder.appConfig)||void 0===t?void 0:t.messageConfigs}),{sidePopperTrigger:a,widgetId:r,supportMessageAction:l}=i,[d,p]=Wi(null),[g,h]=Wi(null),u=t.css`
    .message-action-con {
      border-top: 1px solid ${s.sys.color.divider.tertiary};
      border-bottom: none;
    }
    .top-line-con {
      padding: 0 ${t.polished.rem(16)};
      .bottom-line {
        margin: 0;
        padding: 0;
      }
    }
    .clear-padding-top {
      padding-top: 0;
    }
    .clear-padding-bottom {
      padding-bottom: 0;
    }
    .clear-top-padding {
      padding-top: 0;
      padding-bottom: 0;
    }
    .action-item-dropdown-button:not(:disabled), button.action-item-dropdown-button:hover {
      background: ${s.ref.palette.secondary[200]} !important;
      border-color: transparent !important;
    }
  `;return Fi(()=>{const e=((e,t)=>{const i=[],s=Object.keys(e);if(s.length>0)for(let o=0;o<s.length;o++)e[s[o]]&&e[s[o]].widgetId===t&&i.push(e[s[o]]);return i})(n,r);p(e)},[n,r]),Fi(()=>{const e=ut(r);h(e)},[r]),(0,e.jsx)("div",{className:"w-100 h-100",css:u,role:"group","aria-label":o("messageAction"),children:l&&(0,e.jsxs)("div",{className:"w-100 h-100 message-action-con",children:[(0,e.jsx)(c.SettingSection,{title:o("messageAction"),className:"w-100 message-action-con"}),(0,e.jsx)("div",{className:"jimu-widget message-setting",children:null==g?void 0:g.map((t,i)=>(0,e.jsx)(_i,{widgetId:r,theme:s,messages:d,publishMessageItem:t,sidePopperTrigger:a},i))})]})})};var Vi=f(5549),Gi=f.n(Vi),$i=f(7528),Ji=f.n($i),Zi=f(6745),Ki=f.n(Zi),qi=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Qi=i=>{const s=window.SVG,{className:o}=i,n=qi(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Ki()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Xi;!function(e){e[e.BringForward=0]="BringForward",e[e.SendBackward=1]="SendBackward",e[e.BringToFront=2]="BringToFront",e[e.SendToBack=3]="SendToBack"}(Xi||(Xi={}));var Yi,es;function ts(e,i,s){var o,n,a,r,l,c,d,p,g,h;const{layoutId:u}=e,m=i.layouts[u];switch(null===(o=null==m?void 0:m.parent)||void 0===o?void 0:o.type){case t.LayoutParentType.View:{const e=i.views[m.parent.id],t=i.sections[e.parent];return 1===(null===(a=null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n[s])||void 0===a?void 0:a.length)?t.parent[s][0]:(null===(l=null===(r=null==t?void 0:t.parent)||void 0===r?void 0:r[s])||void 0===l?void 0:l.length)>1?ts(t.parent[s][0],i,s):null}case t.LayoutParentType.Widget:{const e=i.widgets[m.parent.id];return 1===(null===(d=null===(c=null==e?void 0:e.parent)||void 0===c?void 0:c[s])||void 0===d?void 0:d.length)?e.parent[s][0]:(null===(g=null===(p=null==e?void 0:e.parent)||void 0===p?void 0:p[s])||void 0===g?void 0:g.length)>1?ts(e.parent[s][0],i,s):null}case t.LayoutParentType.Screen:{const e=i.screens[m.parent.id];return null===(h=i.screenGroups[e.parent].parent)||void 0===h?void 0:h[s]}default:return null}}function is(e,i,s){var o;let n=e.layouts[i];for(;(null==n?void 0:n.parent)&&[t.LayoutParentType.Screen,t.LayoutParentType.View,t.LayoutParentType.Widget].includes(n.parent.type);){const t=ts({layoutId:i},e,s);i=null==t?void 0:t.layoutId,n=e.layouts[i]}switch(null===(o=null==n?void 0:n.parent)||void 0===o?void 0:o.type){case t.LayoutParentType.Dialog:return{type:t.ContainerType.Dialog,id:n.parent.id};case t.LayoutParentType.Page:return{type:t.ContainerType.Page,id:n.parent.id};case t.LayoutParentType.Header:return{type:t.ContainerType.Header,id:"header"};case t.LayoutParentType.Footer:return{type:t.ContainerType.Footer,id:"footer"};default:return null}}!function(e){e.Auto="auto",e[e.Normal=0]="Normal",e[e.BoundaryDropArea=10]="BoundaryDropArea",e[e.DragMoveTip=20]="DragMoveTip",e[e.HandlerTools=30]="HandlerTools",e[e.DraggingItem=40]="DraggingItem"}(Yi||(Yi={})),function(e){e.Auto="AUTO",e.Stretch="STRETCH",e.Custom="CUSTOM"}(es||(es={}));(0,t.createSelector)([e=>e.appConfig.mainSizeMode,e=>e.browserSizeMode,(e,i)=>{var s,o,n,a,r;let l;if(e.browserSizeMode===e.appConfig.mainSizeMode)l=!0;else{let a;(null===(s=i.layouts)||void 0===s?void 0:s[e.browserSizeMode])?a=e.browserSizeMode:(null===(o=i.layouts)||void 0===o?void 0:o[e.appConfig.mainSizeMode])&&(a=e.appConfig.mainSizeMode);const r=null===(n=i.layouts)||void 0===n?void 0:n[a],c=is(e.appConfig,r,a);if((null==c?void 0:c.type)===t.ContainerType.Header)l=null!=e.appConfig.header.layout[e.browserSizeMode];else if((null==c?void 0:c.type)===t.ContainerType.Footer)l=null!=e.appConfig.footer.layout[e.browserSizeMode];else if((null==c?void 0:c.type)===t.ContainerType.Dialog){l=null!=e.appConfig.dialogs[c.id].layout[e.browserSizeMode]}else if((null==c?void 0:c.type)===t.ContainerType.Page){l=null!=e.appConfig.pages[c.id].layout[e.browserSizeMode]}}if(l&&(null===(a=i.layouts)||void 0===a?void 0:a[e.browserSizeMode])){const t=i.layouts[e.browserSizeMode];return e.appConfig.layouts[t]}const c=null===(r=i.layouts)||void 0===r?void 0:r[e.appConfig.mainSizeMode];return e.appConfig.layouts[c]}],(e,t,i)=>({mainSizeMode:e,browserSizeMode:t,layout:i})),(0,t.createSelector)([(e,t)=>{var i,s,o;const{layoutId:n,layoutItemId:a}=t;return null===(o=null===(s=null===(i=e.appConfig.layouts)||void 0===i?void 0:i[n])||void 0===s?void 0:s.content)||void 0===o?void 0:o[a]},(e,i)=>{var s,o,n,a,r,l;const{layoutId:c,layoutItemId:d}=i,p=null===(n=null===(o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[c])||void 0===o?void 0:o.content)||void 0===n?void 0:n[d];if((null==p?void 0:p.type)===t.LayoutItemType.Widget&&p.widgetId){const t=e.appConfig.widgets[p.widgetId];return null!==(l=null===(r=null===(a=null==t?void 0:t.manifest)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.watchViewportVisibility)&&void 0!==l&&l}return!1},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.selection},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.animationPreview},e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.hoverPreview},(e,t)=>t.layoutId],(e,t,i,s,o,n)=>{var a;if(!e)return{layoutItem:null,selected:!1};let r=!1;const l=null!==(a=e.isPending)&&void 0!==a&&a;i&&(r=i.layoutId===n&&i.layoutItemId===e.id);const c={selected:r,watchViewportVisibility:t,layoutItem:l?null:e,autoScroll:r?i.autoScroll:void 0};if(r&&(null==s?void 0:s.layoutInfo)){const{layoutId:t,layoutItemId:i}=s.layoutInfo;c.animationPreview=t===n&&i===e.id,c.playMode=c.animationPreview?s.playMode:null,c.previewId=c.animationPreview?s.id:null}else if(r&&(null==o?void 0:o.layoutInfo)){const{layoutId:t,layoutItemId:i}=o.layoutInfo;c.hoverPreview=t===n&&i===e.id,c.previewId=c.hoverPreview?o.id:null}return c}),(0,t.createSelector)([(e,i)=>{var s,o,n;const{layoutId:a,layoutItemId:r}=i,l=null===(n=null===(o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[a])||void 0===o?void 0:o.content)||void 0===n?void 0:n[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&l.widgetId)return e.appConfig.widgets[l.widgetId]},(e,i)=>{var s,o,n,a;const{layoutId:r,layoutItemId:l}=i,c=null===(n=null===(o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[r])||void 0===o?void 0:o.content)||void 0===n?void 0:n[l];if((null==c?void 0:c.type)===t.LayoutItemType.Widget&&!c.widgetId)return null===(a=c.setting)||void 0===a?void 0:a.placeholderStyle},(e,i)=>{var s,o,n;const{layoutId:a,layoutItemId:r}=i,l=null===(n=null===(o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[a])||void 0===o?void 0:o.content)||void 0===n?void 0:n[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&l.widgetId)return e.widgetsRuntimeInfo[l.widgetId]},(e,i)=>{var s,o,n;const{layoutId:a,layoutItemId:r}=i,l=null===(n=null===(o=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[a])||void 0===o?void 0:o.content)||void 0===n?void 0:n[r];if((null==l?void 0:l.type)===t.LayoutItemType.Widget&&!l.widgetId)return e.widgetsState[l.widgetId]},(e,i)=>{var s,o;const{layoutId:n}=i,a=null===(s=e.appConfig.layouts)||void 0===s?void 0:s[n];if((null===(o=a.parent)||void 0===o?void 0:o.type)===t.LayoutParentType.Widget){const t=a.parent.id,i=e.appConfig.widgets[t];return/widgets\/common\/controller\/?/.test(i.uri)}return!1}],(e,i,s,o,n)=>{var a,r,l,c,d,p,g,h,u,m,f,v,w,x,y,b,I,S,C;const j=null===(r=null===(a=null==e?void 0:e.manifest)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.supportInlineEditing;return{hasEmbeddedLayout:(null===(c=null===(l=null==e?void 0:e.manifest)||void 0===l?void 0:l.properties)||void 0===c?void 0:c.hasEmbeddedLayout)&&Object.keys(null!==(d=e.layouts)&&void 0!==d?d:{}).length>0,supportInlineEditing:j,supportRepeat:null===(g=null===(p=null==e?void 0:e.manifest)||void 0===p?void 0:p.properties)||void 0===g?void 0:g.supportRepeat,isClassLoaded:null!==(h=null==s?void 0:s.isClassLoaded)&&void 0!==h&&h,isInlineEditing:j&&(null==s?void 0:s.isInlineEditing),isInController:n,useDragHandler:null!==(f=null===(m=null===(u=null==e?void 0:e.manifest)||void 0===u?void 0:u.properties)||void 0===m?void 0:m.useDragHandler)&&void 0!==f&&f,widgetStyle:null!=e?e.style:i,canCrossLayoutBoundary:null===(w=null===(v=null==e?void 0:e.manifest)||void 0===v?void 0:v.properties)||void 0===w?void 0:w.canCrossLayoutBoundary,hasExtension:(null===(y=null===(x=null==e?void 0:e.manifest)||void 0===x?void 0:x.extensions)||void 0===y?void 0:y.length)>0,needHiddenState:null!==(S=null===(I=null===(b=null==e?void 0:e.manifest)||void 0===b?void 0:b.properties)||void 0===I?void 0:I.needHiddenState)&&void 0!==S&&S,widgetJson:e,widgetId:null==e?void 0:e.id,isFunctionalWidget:(null===(C=null==e?void 0:e.manifest)||void 0===C?void 0:C.widgetType)!==t.WidgetType.Layout,widgetState:o}});var ss;!function(e){e.GENERAL="GENERAL"}(ss||(ss={}));function os(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;function ns(e){return Object.keys(e).some(t=>{let i=e[t];if(!i)return!1;i&&i.toParam&&(i=i.toParam());switch(i.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function as(e){const t={};return Object.keys(e).forEach(i=>{var s,o;let n=e[i];if(n&&n.toParam&&(n=n.toParam()),!n&&0!==n&&"boolean"!=typeof n&&"string"!=typeof n)return;let a;switch(n.constructor.name){case"Array":const e=null===(o=null===(s=n[0])||void 0===s?void 0:s.constructor)||void 0===o?void 0:o.name;a="Array"===e?n:"Object"===e?JSON.stringify(n):n.join(",");break;case"Object":a=JSON.stringify(n);break;case"Date":a=n.valueOf();break;case"Function":a=null;break;case"Boolean":a=n+"";break;default:a=n}(a||0===a||"string"==typeof a||Array.isArray(a))&&(t[i]=a)}),t}function rs(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map(t=>rs(e,t)).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function ls(e){const t=as(e);return Object.keys(t).map(e=>rs(e,t[e])).join("&")}const cs=globalThis.FormData;globalThis.File,globalThis.Blob;class ds extends Error{constructor(e,t,i,s,o){super(e);const n=new.target.prototype;Object.setPrototypeOf(this,n),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=i,this.url=s,this.options=o}}const ps={noCorsDomains:[],crossOriginNoCorsDomains:{},pendingNoCorsRequests:{}},gs="ARCGIS_REST_JS_NO_CORS";globalThis[gs]||(globalThis[gs]=Object.assign({},ps));const hs=globalThis[gs];function us(e){const t=new URL(e).origin;-1===hs.noCorsDomains.indexOf(t)&&hs.noCorsDomains.push(t)}function ms(e){let t=!1;if(hs.noCorsDomains.length){const i=new URL(e).origin.toLowerCase();t=hs.noCorsDomains.some(e=>i.includes(e))}return t}const fs="@esri/arcgis-rest-js";class vs extends ds{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",i,s,o){super(e,t,i,s,o),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const n=new.target.prototype;Object.setPrototypeOf(this,n)}retry(e,t=1){let i=0;const s=(o,n)=>{i+=1,e(this.url,this.options).then(e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return ws(this.url,t)}).then(e=>{o(e)}).catch(e=>{"ArcGISAuthError"===e.name&&i<t?s(o,n):e.name===this.name&&e.message===this.message&&i>=t?n(this):n(e)})};return new Promise((e,t)=>{s(e,t)})}}function ws(e,t){const i=globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}},s=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},i),t),{params:Object.assign(Object.assign({},i.params),t.params),headers:Object.assign(Object.assign({},i.headers),t.headers)}),{httpMethod:o,rawResponse:n}=s,a=Object.assign({f:"json"},s.params);let r=null;const l={method:o,signal:s.signal,credentials:s.credentials||"same-origin"};let c;if(ms(e)&&(l.credentials="include"),s.headers&&s.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include"),"string"==typeof s.authentication){const e=s.authentication;c={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},s.authentication.startsWith("AAPK")||s.authentication.startsWith("AAPT")||s.authentication.startsWith("AATK")||s.authentication.startsWith("AAST")||s.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||(d="Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information.",console&&console.warn&&console.warn.apply(console,[d]),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else c=s.authentication;var d;const p=e;let g=!1;"undefined"!=typeof window&&(g=function(e,t){var i;if((t||window)&&e){const s=null===(i=(t=t||window).location)||void 0===i?void 0:i.origin;return e.startsWith(s)}return!1}(e));const h=!g&&function(e){let t=!1;if(ms(e)){const i=new URL(e).origin.toLowerCase(),s=hs.crossOriginNoCorsDomains[i]||0;Date.now()-36e5>s&&(t=!0)}return t}(e);s.headers&&s.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include");let u=Promise.resolve();return h&&(l.credentials="include",u=function(e){const t=new URL(e);e=t.origin+t.pathname,t.search.includes("f=json")&&(e+="?f=json");const i=t.origin;return hs.pendingNoCorsRequests[i]||(hs.pendingNoCorsRequests[i]=fetch(e,{mode:"no-cors",credentials:"include",cache:"no-store"}).then(e=>{-1===hs.noCorsDomains.indexOf(i)&&hs.noCorsDomains.push(i),hs.crossOriginNoCorsDomains[i.toLowerCase()]=Date.now(),delete hs.pendingNoCorsRequests[i]}).catch(e=>(delete hs.pendingNoCorsRequests[i],Promise.reject(new Error(`no-cors request to ${i} failed`))))),hs.pendingNoCorsRequests[i]}(e)),u.then(()=>c?c.getToken(e).catch(t=>(t.url=e,t.options=s,r=t,Promise.resolve(""))):Promise.resolve("")).then(t=>{t.length&&(a.token=t),c&&c.getDomainCredentials&&(l.credentials=c.getDomainCredentials(e));const i={};if("GET"===l.method){a.token&&s.hideToken&&"undefined"==typeof window&&(i["X-Esri-Authorization"]=`Bearer ${a.token}`,delete a.token);const o=""===ls(a)?e:e+"?"+ls(a);s.maxUrlLength&&o.length>s.maxUrlLength||!s.maxUrlLength&&o.length>2e3||a.token&&s.hideToken?(l.method="POST",t.length&&s.hideToken&&(a.token=t,delete i["X-Esri-Authorization"])):e=o}const o=new RegExp("/items/.+/updateResources").test(e);return"POST"===l.method&&(l.body=function(e,t){const i=ns(e)||t,s=as(e);if(i){const e=new cs;return Object.keys(s).forEach(t=>{if("undefined"!=typeof Blob&&s[t]instanceof Blob){const i=s.fileName||s[t].name||t;e.append(t,s[t],i)}else e.append(t,s[t])}),e}return ls(e)}(a,o)),l.headers=Object.assign(Object.assign({},i),s.headers),("undefined"==typeof window||window&&void 0===window.document)&&!l.headers.referer&&(l.headers.referer=fs),ns(a)||o||(l.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,l):Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.Request}).then(({fetch:t})=>t(e,l))}).then(t=>{if(!t.ok)return t.json().then(i=>{const{status:o,statusText:n}=t,{message:a,details:r}=i.error,l=`${a}. ${r?r.join(" "):""}`.trim();throw new ds(l,`HTTP ${o} ${n}`,i,e,s)}).catch(i=>{if("ArcGISRequestError"===i.name)throw i;const{status:o,statusText:n}=t;throw new ds(n,`HTTP ${o}`,t,e,s)});if(n)return t;switch(a.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}}).then(t=>{if("json"!==a.f&&"geojson"!==a.f||n)return t;{const i=function(e,t,i,s,o){if(e.code>=400){const{message:i,code:o}=e;throw new ds(i,o,e,t,s)}if(e.error){const{message:i,code:n,messageCode:a}=e.error,r=a||n||"UNKNOWN_ERROR_CODE";if(498===n||499===n)throw o||new vs(i,r,e,t,s);throw new ds(i,r,e,t,s)}if("failed"===e.status||"failure"===e.status){let i,o="UNKNOWN_ERROR_CODE";try{i=JSON.parse(e.statusMessage).message,o=JSON.parse(e.statusMessage).code}catch(t){i=e.statusMessage||e.message}throw new ds(i,o,e,t,s)}return e}(t,p,0,s,r);if(t&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(e)&&Array.isArray(t.authorizedCrossOriginNoCorsDomains)&&t.authorizedCrossOriginNoCorsDomains.forEach(e=>{e=e.toLowerCase(),/^https?:\/\//.test(e)?us(e):(us("http://"+e),us("https://"+e))}),r){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];s.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},r=null}return i}})}function xs(e,t={params:{f:"json"}}){const{request:i}=t,s=os(t,["request"]);return i?i(e,s):ws(e,s).catch(e=>e instanceof vs&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry(()=>t.authentication.refreshCredentials(),1):Promise.reject(e))}var ys,bs;!function(e){e.TOKEN_REFRESH_FAILED="TOKEN_REFRESH_FAILED",e.GENERATE_TOKEN_FOR_SERVER_FAILED="GENERATE_TOKEN_FOR_SERVER_FAILED",e.REFRESH_TOKEN_EXCHANGE_FAILED="REFRESH_TOKEN_EXCHANGE_FAILED",e.NOT_FEDERATED="NOT_FEDERATED",e.UNKNOWN_ERROR_CODE="UNKNOWN_ERROR_CODE"}(ys||(ys={}));class Is extends Error{constructor(e="UNKNOWN_ERROR",t=ys.UNKNOWN_ERROR_CODE,i,s,o){super(e);const n=new.target.prototype;Object.setPrototypeOf(this,n),this.name="ArcGISTokenRequestError",this.message=`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=i,this.url=s,this.options=o}}class Ss extends Error{constructor(){super("The user has denied your authorization request.");const e=new.target.prototype;Object.setPrototypeOf(this,e),this.name="ArcGISAccessDeniedError"}}Error;function Cs(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}!function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError",e.ArcGISAccessDeniedError="ArcGISAccessDeniedError",e.ArcGISTokenRequestError="ArcGISTokenRequestError"}(bs||(bs={}));const js=3e5;function As(e,t){const i=t;return i.rawResponse=!1,xs(e,i).then(e=>{if("token"in e&&"expires"in e)return{token:e.token,username:t.params.username,expires:new Date(e.expires)};const i={token:e.access_token,username:e.username,expires:new Date(Date.now()+1e3*e.expires_in-js),ssl:!0===e.ssl};return e.refresh_token&&(i.refreshToken=e.refresh_token),e.refresh_token_expires_in&&(i.refreshTokenExpires=new Date(Date.now()+1e3*e.refresh_token_expires_in-js)),i})}class Ts{constructor(e){this.portal=e.portal?Cs(e.portal):"https://www.arcgis.com/sharing/rest",this._username=e.username}get username(){return this._username?this._username:this._user&&this._user.username?this._user.username:void 0}getUsername(){return this.username?Promise.resolve(this.username):this.getUser().then(e=>e.username)}getUser(e){if(this._pendingUserRequest)return this._pendingUserRequest;if(this._user)return Promise.resolve(this._user);{const t=`${this.portal}/community/self`,i=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingUserRequest=xs(t,i).then(e=>(this._user=e,this._pendingUserRequest=null,e)),this._pendingUserRequest}}clearCachedUserInfo(){this._user=null}}function Ms(e){return!e||e.length<=0?{}:e.replace(/^#/,"").replace(/^\?/,"").split("&").reduce((e,t)=>{const{key:i,value:s}=function(e){const[t,i]=e.split("=");return{key:decodeURIComponent(t),value:decodeURIComponent(i)}}(t);return e[i]=s,e},{})}const Ns=/^https?:\/\/(\S+)\.arcgis\.com.+/;function ks(e){return Ns.test(e)}function Os(e){if(!Ns.test(e))return null;const t=e.match(Ns)[1].split(".").pop();return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}function Ps(e,t){const i=Cs(function(e){if(!Ns.test(e))return e;switch(Os(e)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}(t)).replace(/https?:\/\//,""),s=Cs(e).replace(/https?:\/\//,"");return new RegExp(s,"i").test(i)}function Rs(e,t=window){return!t&&window&&(t=window),t.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Ds(e){!e&&window&&(e=window);return Rs(e.crypto.getRandomValues(new Uint8Array(32)))}function Ls(e,t,i){return"string"!=typeof t&&t?JSON.stringify(Object.assign({id:e},t)):JSON.stringify({id:e,originalUrl:i})}class Es extends Ts{constructor(e){if(super(e),this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?Cs(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.server=e.server,this.referer=e.referer,this.state=e.state,this.federatedServers={},this.trustedDomains=[],e.server){const t=this.getServerRootUrl(e.server);this.federatedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}get token(){return this._token}get tokenExpires(){return this._tokenExpires}get refreshToken(){return this._refreshToken}get refreshTokenExpires(){return this._refreshTokenExpires}get canRefresh(){return!(!this.username||!this.password)||!!(this.clientId&&this.refreshToken&&this.redirectUri)}static beginOAuth2(e,t){!t&&window&&(t=window);const{portal:i,provider:s,clientId:o,expiration:n,redirectUri:a,popup:r,popupWindowFeatures:l,locale:c,params:d,style:p,pkce:g,state:h}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:!0,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",locale:"",style:"",pkce:!0},e),u=function(e,t){return"string"==typeof e?e:"object"==typeof e?e.id:Ds(t)}(h,t),m=`ARCGIS_REST_JS_AUTH_STATE_${o}`;t.localStorage.setItem(m,u);let f=`${Cs(i)}/oauth2/authorize`;const v={client_id:o,response_type:g?"code":"token",expiration:n,redirect_uri:a,state:Ls(u,h,t.location.href),locale:c,style:p};let w;if("arcgis"!==s&&(f=`${Cs(i)}/oauth2/social/authorize`,v.socialLoginProviderName=s,v.autoAccountCreateForSocial=!0),g){const e=Ds(t),i=`ARCGIS_REST_JS_CODE_VERIFIER_${o}`;t.localStorage.setItem(i,e),w=function(e,t=window){if(!t&&window&&(t=window),e&&t.isSecureContext&&t.crypto&&t.crypto.subtle){const i=(new t.TextEncoder).encode(e);return t.crypto.subtle.digest("SHA-256",i).then(e=>Rs(new Uint8Array(e),t))}return Promise.resolve(null)}(e,t).then(function(t){v.code_challenge_method=t?"S256":"plain",v.code_challenge=t||e})}else w=Promise.resolve();return w.then(()=>(f=`${f}?${ls(v)}`,d&&(f=`${f}&${ls(d)}`),r?new Promise((e,s)=>{t.addEventListener(`arcgis-rest-js-popup-auth-${o}`,t=>{if("access_denied"===t.detail.error){const e=new Ss;return s(e),e}if(t.detail.errorMessage){const e=new vs(t.detail.errorMessage,t.detail.error);return s(e),e}e(new Es({clientId:o,portal:i,ssl:t.detail.ssl,token:t.detail.token,tokenExpires:t.detail.expires,username:t.detail.username,refreshToken:t.detail.refreshToken,refreshTokenExpires:t.detail.refreshTokenExpires,redirectUri:a,state:t.detail.state}))},{once:!0}),t.open(f,"oauth-window",l),t.dispatchEvent(new CustomEvent("arcgis-rest-js-popup-auth-start"))}):void(t.location.href=f)))}static completeOAuth2(e,t){!t&&window&&(t=window);const{portal:i,clientId:s,popup:o,pkce:n,redirectUri:a}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",popup:!0,pkce:!0},e),r=`ARCGIS_REST_JS_AUTH_STATE_${s}`,l=t.localStorage.getItem(r),c=Ms(n?t.location.search.replace(/^\?/,""):t.location.hash.replace(/^#/,"")),d=c&&c.state?JSON.parse(c.state):void 0;function p(e,i,n){return t.localStorage.removeItem(r),o&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:{error:i,errorMessage:e}})),void t.close()):(n&&t.history.replaceState(t.history.state,"",n),"access_denied"===i?Promise.reject(new Ss):Promise.reject(new vs(e,i)))}function g(e,n){return t.localStorage.removeItem(r),o&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${s}`,{detail:Object.assign(Object.assign({},e),{state:n})})),void t.close()):(n.originalUrl&&t.history.replaceState(t.history.state,"",n.originalUrl),new Es({clientId:s,portal:i,ssl:e.ssl,token:e.token,tokenExpires:e.expires,username:e.username,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:a||location.href.replace(location.search,""),state:n}))}if(!l||!d)return p("No authentication state was found, call `ArcGISIdentityManager.beginOAuth2(...)` to start the authentication process.","no-auth-state");if(d.id!==l)return p("Saved client state did not match server sent state.","mismatched-auth-state");if(c.error){const e=c.error;return p(c.error_description||"Unknown error",e,d.originalUrl)}if(n&&c.code){const e=Cs(`${i}/oauth2/token/`),o=`ARCGIS_REST_JS_CODE_VERIFIER_${s}`,n=t.localStorage.getItem(o);return t.localStorage.removeItem(o),As(e,{httpMethod:"POST",params:{client_id:s,code_verifier:n,grant_type:"authorization_code",redirect_uri:a||location.href.replace(location.search,""),code:c.code}}).then(e=>g(Object.assign(Object.assign({},e),d),d)).catch(e=>p(e.originalMessage,e.code,d.originalUrl))}return!n&&c.access_token?Promise.resolve(g(Object.assign({token:c.access_token,expires:new Date(Date.now()+1e3*parseInt(c.expires_in,10)),ssl:"true"===c.ssl,username:c.username},d),d)):p("Unknown error","oauth-error",d.originalUrl)}static fromParent(e,t){let i;return!t&&window&&(t=window),new Promise((s,o)=>{i=e=>{if(e.source===t.parent&&e.data)try{return s(Es.parentMessageHandler(e))}catch(e){return o(e)}},t.addEventListener("message",i,!1),t.parent.postMessage({type:"arcgis:auth:requestCredential"},e)}).then(e=>(t.removeEventListener("message",i,!1),e))}static authorize(e,t){const{portal:i,clientId:s,expiration:o,redirectUri:n,state:a}=Object.assign({portal:"https://arcgis.com/sharing/rest",expiration:20160},e),r={client_id:s,expiration:o,response_type:"code",redirect_uri:n};a&&(r.state=a);const l=`${i}/oauth2/authorize?${ls(r)}`;t.writeHead(301,{Location:l}),t.end()}static exchangeAuthorizationCode(e,t){const{portal:i,clientId:s,redirectUri:o}=Object.assign({portal:"https://www.arcgis.com/sharing/rest"},e);return As(`${i}/oauth2/token`,{params:{grant_type:"authorization_code",client_id:s,redirect_uri:o,code:t}}).then(e=>new Es({clientId:s,portal:i,ssl:e.ssl,redirectUri:o,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,token:e.token,tokenExpires:e.expires,username:e.username})).catch(e=>{throw new Is(e.message,ys.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}static deserialize(e){const t=JSON.parse(e);return new Es({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:t.refreshTokenExpires?new Date(t.refreshTokenExpires):void 0,username:t.username,password:t.password,token:t.token,tokenExpires:t.tokenExpires?new Date(t.tokenExpires):void 0,portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,server:t.server})}static fromCredential(e,t){const i=void 0===e.ssl||e.ssl,s=e.expires||Date.now()+72e5;return t.hasServer?new Es({server:e.server,ssl:i,token:e.token,username:e.userId,tokenExpires:new Date(s)}):new Es({portal:Cs(e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest"),ssl:i,token:e.token,username:e.userId,tokenExpires:new Date(s)})}static parentMessageHandler(e){if("arcgis:auth:credential"===e.data.type){const t=e.data.credential;return function(e){return"string"==typeof e.userId||"number"==typeof e.expires}(t)?Es.fromCredential(t,{hasPortal:!0,hasServer:!1,server:t.server}):new Es(t)}if("arcgis:auth:error"===e.data.type){const t=new Error(e.data.error.message);throw t.name=e.data.error.name,t}throw new Error("Unknown message type.")}static destroy(e){return function(e){const t=`${Cs(e.portal||"https://www.arcgis.com/sharing/rest")}/oauth2/revokeToken/`,i=e.token,s=e.clientId;delete e.portal,delete e.clientId,delete e.token;const o=Object.assign(Object.assign({},e),{httpMethod:"POST",params:{client_id:s,auth_token:i}});return xs(t,o).then(e=>{if(!e.success)throw new ds("Unable to revoke token",500,e,t,o);return e})}({clientId:e.clientId,portal:e.portal,token:e.refreshToken||e.token})}static fromToken(e){const t=new Es(e);return t.getUser().then(()=>t)}static signIn(e){const t=new Es(e);return t.getUser().then(()=>t)}toCredential(){return{expires:this.tokenExpires.getTime(),server:this.server||this.portal,ssl:this.ssl,token:this.token,userId:this.username}}getPortal(e){if(this._pendingPortalRequest)return this._pendingPortalRequest;if(this._portalInfo)return Promise.resolve(this._portalInfo);{const t=`${this.portal}/portals/self`,i=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingPortalRequest=xs(t,i).then(e=>(this._portalInfo=e,this._pendingPortalRequest=null,e)),this._pendingPortalRequest}}getToken(e,t){return function(e,t){const i=ks(e),s=ks(t),o=Os(e),n=Os(t);return!(!i||!s||o!==n)}(this.portal,e)||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)}validateAppAccess(e){return this.getToken(this.portal).then(t=>function(e,t,i="https://www.arcgis.com/sharing/rest"){return xs(`${i}/oauth2/validateAppAccess`,{method:"POST",params:{f:"json",client_id:t,token:e}})}(t,e))}toJSON(){return{type:"ArcGISIdentityManager",clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires||void 0,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires||void 0,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,server:this.server}}serialize(){return JSON.stringify(this)}enablePostMessageAuth(e,t){!t&&window&&(t=window),this._hostHandler=this.createPostMessageHandler(e),t.addEventListener("message",this._hostHandler,!1)}disablePostMessageAuth(e){!e&&window&&(e=window),e.removeEventListener("message",this._hostHandler,!1)}refreshCredentials(e){return this.clearCachedUserInfo(),this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new Is("Unable to refresh token. No refresh token or password present.",ys.TOKEN_REFRESH_FAILED))}getServerRootUrl(e){const[t]=Cs(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/),[i,s,o]=t.match(/(https?:\/\/)(.+)/),[n,...a]=o.split("/");return`${s}${n.toLowerCase()}/${a.join("/")}`}getDomainCredentials(e){return this.trustedDomains&&this.trustedDomains.length?(e=e.toLowerCase(),this.trustedDomains.some(t=>e.startsWith(t.toLowerCase()))?"include":"same-origin"):"same-origin"}signOut(){return Es.destroy(this)}createPostMessageHandler(e){return t=>{const i=e.indexOf(t.origin)>-1,s="arcgis:auth:requestCredential"===t.data.type,o=this.tokenExpires.getTime()>Date.now();if(i&&s){let e={};if(o){const t=this.toCredential();t.server=t.server.replace("/sharing/rest",""),e={type:"arcgis:auth:credential",credential:t}}else e={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Token was expired, and not returned to the child application"}};t.source.postMessage(e,t.origin)}}}getTokenForServer(e,t){const i=this.getServerRootUrl(e),s=this.federatedServers[i];return s&&s.expires&&s.expires.getTime()>Date.now()?Promise.resolve(s.token):(this._pendingTokenRequests[i]||(this._pendingTokenRequests[i]=this.fetchAuthorizedDomains().then(()=>xs(`${i}/rest/info`,{credentials:this.getDomainCredentials(e)}).then(s=>{if(s.owningSystemUrl){if(Ps(s.owningSystemUrl,this.portal))return xs(`${s.owningSystemUrl}/sharing/rest/info`,t);throw new Is(`${e} is not federated with ${this.portal}.`,ys.NOT_FEDERATED)}if(s.authInfo&&void 0!==this.federatedServers[i])return Promise.resolve({authInfo:s.authInfo});throw new Is(`${e} is not federated with any portal and is not explicitly trusted.`,ys.NOT_FEDERATED)}).then(e=>this.token&&this.tokenExpires.getTime()<Date.now()?this.server?this.refreshCredentials().then(()=>({token:this.token,expires:this.tokenExpires})):this.refreshCredentials().then(()=>this.generateTokenForServer(e.authInfo.tokenServicesUrl,i)):this.generateTokenForServer(e.authInfo.tokenServicesUrl,i)).then(e=>(this.federatedServers[i]=e,delete this._pendingTokenRequests[i],e.token)))),this._pendingTokenRequests[i])}generateTokenForServer(e,t){return xs(e,{params:{token:this.token,serverUrl:t,expiration:this.tokenDuration}}).then(e=>({token:e.token,expires:new Date(e.expires-3e5)})).catch(e=>{throw new Is(e.message,ys.GENERATE_TOKEN_FOR_SERVER_FAILED,e.response,e.url,e.options)})}getFreshToken(e){return this.token&&!this.tokenExpires||this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshCredentials(e).then(()=>(this._pendingTokenRequests[this.portal]=null,this.token))),this._pendingTokenRequests[this.portal])}refreshWithUsernameAndPassword(e){const t={username:this.username,password:this.password,expiration:this.tokenDuration,client:"referer",referer:this.referer?this.referer:"undefined"!=typeof window&&void 0!==window.document&&window.location&&window.location.origin?window.location.origin:fs};return(this.server?xs(`${this.getServerRootUrl(this.server)}/rest/info`).then(i=>xs(i.authInfo.tokenServicesUrl,Object.assign({params:t},e))):xs(`${this.portal}/generateToken`,Object.assign({params:t},e))).then(e=>(this.updateToken(e.token,new Date(e.expires)),this)).catch(e=>{throw new Is(e.message,ys.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}refreshWithRefreshToken(e){if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()-864e5<Date.now())return this.exchangeRefreshToken(e);const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e);return As(`${this.portal}/oauth2/token`,t).then(e=>this.updateToken(e.token,e.expires)).catch(e=>{throw new Is(e.message,ys.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}updateToken(e,t){return this._token=e,this._tokenExpires=t,this}exchangeRefreshToken(e){const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e);return As(`${this.portal}/oauth2/token`,t).then(e=>(this._token=e.token,this._tokenExpires=e.expires,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this)).catch(e=>{throw new Is(e.message,ys.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}fetchAuthorizedDomains(){return this.server||!this.portal?Promise.resolve(this):this.getPortal().then(e=>(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length&&(this.trustedDomains=e.authorizedCrossOriginDomains.filter(e=>!e.startsWith("http://")).map(e=>e.startsWith("https://")?e:`https://${e}`)),this))}}function Bs(e){return console.log("DEPRECATED:, 'UserSession' is deprecated. Use 'ArcGISIdentityManager' instead."),new Es(e)}var zs;Bs.beginOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.beginOAuth2' is deprecated. Use 'ArcGISIdentityManager.beginOAuth2' instead."),Es.beginOAuth2(...e)},Bs.completeOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.completeOAuth2()' is deprecated. Use 'ArcGISIdentityManager.completeOAuth2()' instead."),e.length<=1&&console.warn("WARNING:, 'UserSession.completeOAuth2()' is now async and returns a promise the resolves to an instance of `ArcGISIdentityManager`."),Es.completeOAuth2(...e)},Bs.fromParent=function(...e){return console.warn("DEPRECATED:, 'UserSession.fromParent' is deprecated. Use 'ArcGISIdentityManager.fromParent' instead."),Es.fromParent(...e)},Bs.authorize=function(...e){return console.warn("DEPRECATED:, 'UserSession.authorize' is deprecated. Use 'ArcGISIdentityManager.authorize' instead."),Es.authorize(...e)},Bs.exchangeAuthorizationCode=function(...e){return console.warn("DEPRECATED:, 'UserSession.exchangeAuthorizationCode' is deprecated. Use 'ArcGISIdentityManager.exchangeAuthorizationCode' instead."),Es.exchangeAuthorizationCode(...e)},Bs.fromCredential=function(...e){return console.log("DEPRECATED:, 'UserSession.fromCredential' is deprecated. Use 'ArcGISIdentityManager.fromCredential' instead."),console.warn("WARNING:, 'UserSession.fromCredential' now requires a `ServerInfo` object from the JS API as a second parameter."),Es.fromCredential(...e)},Bs.deserialize=function(...e){return console.log("DEPRECATED:, 'UserSession.deserialize' is deprecated. Use 'ArcGISIdentityManager.deserialize' instead."),Es.deserialize(...e)},function(e){e.Success="Succeeded",e.Failed="Failed",e.Waiting="Waiting",e.Cancelled="Cancelled",e.Cancelling="Cancelling",e.New="New",e.Executing="Executing",e.Submitted="Submitted",e.Failure="Failure",e.TimedOut="TimedOut",e.Error="Error",e.Status="Etatus",e.Unknown="Unknown"}(zs||(zs={}));function Us(e,t){var s,o;let n=(0,i.getAppConfigAction)().appConfig;n.cookieBanner||(n=n.set("cookieBanner",{}));let a=null;a="string"==typeof e?null===(s=n.cookieBanner)||void 0===s?void 0:s.set(e,t):null===(o=n.cookieBanner)||void 0===o?void 0:o.setIn(e,t),(0,i.getAppConfigAction)().updateCookieBannerConfig(a).exec()}var _s=f(2046),Ws=f.n(_s),Fs=f(7408),Hs=f.n(Fs),Vs=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Gs=i=>{const s=window.SVG,{className:o}=i,n=Vs(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Hs()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var $s=f(6371),Js=f.n($s),Zs=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i};const Ks=i=>{const s=window.SVG,{className:o}=i,n=Zs(i,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:a,src:Js()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},qs=(0,y.styled)(s.CollapsablePanel)`
  .collapse-header {
    .collapse-label {
      font-size: 13px;
    }
  }
`,Qs=(0,y.styled)(s.CollapsableCheckbox)`
  .collapse-header {
    .collapse-label {
      font-size: 13px;
    }
  }
`,Xs=t.css`
  .banner-layout-item {
    padding: 0;
    .banner-layout-icon {
      width: 108px;
      height: 80px;
      background: var(--ref-palette-neutral-300);
    }
  }

  .banner-layout-item:first-of-type {
    margin-right: 12px;
  }
`,Ys=o=>{var n,a,r,l,d,p,g,h,u,m;const{formatMessage:v,theme:w,browserSizeMode:x}=o,y=t.ReactRedux.useSelector(e=>{var t,i;return null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.cookieBanner}),b=t.ReactRedux.useSelector(e=>{var t,i,s;return null===(s=null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.analytics)||void 0===s?void 0:s.enable}),S=t.ReactRedux.useSelector(e=>{var t,i,s;return null===(s=null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo)||void 0===i?void 0:i.cookieBanner)||void 0===s?void 0:s.isCookieSettingsWindowOpen}),[C,j]=t.React.useState(null!==(n=null==y?void 0:y.acceptAllButton)&&void 0!==n?n:(0,t.Immutable)({})),[A,T]=t.React.useState(null!==(a=null==y?void 0:y.closeButton)&&void 0!==a?a:(0,t.Immutable)({})),[M,N]=t.React.useState(null!==(r=null==y?void 0:y.declineAllButton)&&void 0!==r?r:(0,t.Immutable)({})),[O,R]=t.React.useState(null!==(l=null==y?void 0:y.cookieSettingsButton)&&void 0!==l?l:(0,t.Immutable)({})),[L,E]=t.React.useState(null!==(p=null===(d=null==y?void 0:y.positionSize)||void 0===d?void 0:d[x])&&void 0!==p?p:s.DEFAULT_FIXED_POSITION_SIZE_JSON),[B,z]=t.React.useState((null==y?void 0:y.layout)||t.ECookieBannerLayout.Vertical),U=t.React.useRef(null);const _=t.React.useCallback(e=>{(0,i.getAppConfigAction)().editCookieBannerConfig("backgroundStyle",e).exec()},[]),W=t.React.useCallback(e=>{(0,i.getAppConfigAction)().editCookieBannerConfig("border",e).exec()},[]),F=t.React.useCallback(e=>{(0,i.getAppConfigAction)().editCookieBannerConfig("borderRadius",e).exec()},[]),H=t.React.useCallback(e=>{(0,i.getAppConfigAction)().editCookieBannerConfig("boxShadow",e).exec()},[]),V=t.React.useCallback(()=>{S&&i.builderAppSync.publishOpenCookieSettingsWindowToApp(!S)},[S]),G=t.React.useCallback(e=>{"Tab"===e.key&&(U.current=e.target,S&&i.builderAppSync.publishOpenCookieSettingsWindowToApp(!1))},[S]);t.React.useEffect(()=>{(0,t.isKeyboardMode)()&&setTimeout(()=>{U.current&&U.current.focus()},100)},[S]);return t.React.useEffect(()=>{var e,i;E((null===(e=null==y?void 0:y.positionSize)||void 0===e?void 0:e[x])||(null===(i=null==y?void 0:y.positionSize)||void 0===i?void 0:i[t.BrowserSizeMode.Large])||s.DEFAULT_FIXED_POSITION_SIZE_JSON)},[x,null==y?void 0:y.positionSize]),(0,e.jsxs)("div",{className:"cookie-banner-setting-panel h-100",style:{overflow:"auto"},onClick:V,onKeyUp:G,children:[(0,e.jsx)(c.SettingSection,{className:"cookie-banner-setting-header",children:(0,e.jsx)(c.SettingRow,{children:(0,e.jsxs)(s.Label,{children:[(0,e.jsx)(Ks,{}),(0,e.jsx)("span",{className:"ml-2",children:v("cookieBannerSettingTitle")})]})})}),(0,e.jsx)(c.SettingSection,{title:v("layout"),"aria-label":v("layout"),role:"group",children:(0,e.jsxs)("div",{className:"banner-layout-setting d-flex justify-content-center",css:Xs,children:[(0,e.jsx)(s.Button,{title:v("vertical"),icon:!0,className:"banner-layout-item",color:B===t.ECookieBannerLayout.Vertical?"primary":"default","aria-label":v("vertical"),onClick:()=>{z(t.ECookieBannerLayout.Vertical),Us("layout",t.ECookieBannerLayout.Vertical)},children:(0,e.jsx)(s.Icon,{autoFlip:!0,icon:f(2384),className:"banner-layout-icon"})}),(0,e.jsx)(s.Button,{title:v("horizontal"),icon:!0,className:"banner-layout-item",color:B===t.ECookieBannerLayout.Horizontal?"primary":"default","aria-label":v("horizontal"),onClick:()=>{z(t.ECookieBannerLayout.Horizontal),Us("layout",t.ECookieBannerLayout.Horizontal)},children:(0,e.jsx)(s.Icon,{autoFlip:!0,icon:f(4142),className:"banner-layout-icon"})})]})}),(0,e.jsxs)(c.SettingSection,{"aria-label":`${v("position")} & ${v("size")}`,role:"group",children:[(0,e.jsxs)("div",{className:"d-flex mb-4",children:[(0,e.jsx)("h6",{className:"flex-lg-grow-1 mb-0 text-truncate title2 hint-paper",children:`${v("position")} & ${v("size")}`}),(()=>{var i,o;const n=!(null===(i=null==y?void 0:y.positionSize)||void 0===i?void 0:i[t.BrowserSizeMode.Medium]),a=!(null===(o=null==y?void 0:y.positionSize)||void 0===o?void 0:o[t.BrowserSizeMode.Small]),r=x===t.BrowserSizeMode.Large||n&&a,l=x===t.BrowserSizeMode.Large&&n||x===t.BrowserSizeMode.Medium||x===t.BrowserSizeMode.Small&&n&&a,c=x===t.BrowserSizeMode.Large&&a||x===t.BrowserSizeMode.Medium&&n&&a||x===t.BrowserSizeMode.Small,d=w.ref.palette.neutral[800],p=v("appliedToLargeScreen"),g=v("appliedToMediumScreen"),h=v("appliedToSmallScreen");return(0,e.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[r&&(0,e.jsx)(s.Tooltip,{title:p,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:12,icon:k(),color:d,className:"border-0"})})}),l&&(0,e.jsx)(s.Tooltip,{title:g,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:12,icon:P(),color:d,className:"border-0"})})}),c&&(0,e.jsx)(s.Tooltip,{title:h,children:(0,e.jsx)(s.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,className:"p-0 border-0",children:(0,e.jsx)(s.Icon,{size:12,icon:D(),color:d,className:"border-0"})})})]})})()]}),(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(I.FixedPositionSize,{fixedPositionSizeJson:L,onChange:e=>{E(e),Us(["positionSize",x],e)}})})]}),(0,e.jsxs)(c.SettingSection,{title:v("bannerButtonSettings"),"aria-label":v("bannerButtonSettings"),role:"group",children:[b&&(0,e.jsx)(c.SettingRow,{className:"accept-button-setting",children:(0,e.jsxs)(qs,{label:v("acceptAllButton"),rightIcon:Ws(),"aria-label":v("acceptAllButton"),children:[(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("text"),flow:"wrap",children:(0,e.jsx)(s.TextInput,{className:"w-100 mt-2",defaultValue:(null==C?void 0:C.label)||v("acceptAll"),"aria-label":v("text"),onAcceptValue:e=>{const t=C.set("label",e);j(t),Us("acceptAllButton",t)}})}),(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("icon"),children:(0,e.jsx)(fe.IconPicker,{configurableOption:"none",icon:null===(g=null==C?void 0:C.icon)||void 0===g?void 0:g.asMutable({deep:!0}),setButtonUseColor:!1,previewOptions:{color:!0},onChange:e=>{const t=C.set("icon",e);j(t),Us("acceptAllButton",t)}})})]})}),!b&&(0,e.jsx)(c.SettingRow,{className:"close-button-setting",children:(0,e.jsxs)(qs,{label:v("closeButton"),rightIcon:Ws(),"aria-label":v("closeButton"),children:[(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("text"),flow:"wrap",children:(0,e.jsx)(s.TextInput,{className:"w-100 mt-2",defaultValue:(null==A?void 0:A.label)||v("close"),"aria-label":v("text"),onAcceptValue:e=>{const t=A.set("label",e);T(t),Us("closeButton",t)}})}),(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("icon"),children:(0,e.jsx)(fe.IconPicker,{configurableOption:"none",icon:null===(h=null==A?void 0:A.icon)||void 0===h?void 0:h.asMutable({deep:!0}),setButtonUseColor:!1,previewOptions:{color:!0},onChange:e=>{const t=A.set("icon",e);T(t),Us("closeButton",t)}})})]})}),b&&(0,e.jsx)(c.SettingRow,{className:"decline-button-setting",children:(0,e.jsxs)(Qs,{openForCheck:!0,closeForUncheck:!0,disableActionForUnchecked:!0,label:v("declineAllButton"),rightIcon:Ws(),"aria-label":v("declineAllButton"),checked:(null==M?void 0:M.enable)||!1,onCheckedChange:e=>{const t=M.set("enable",e);N(t),Us("declineAllButton",t)},children:[(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("text"),flow:"wrap",children:(0,e.jsx)(s.TextInput,{className:"w-100 mt-2",defaultValue:(null==M?void 0:M.label)||v("declineAll"),"aria-label":v("text"),onAcceptValue:e=>{const t=M.set("label",e);N(t),Us("declineAllButton",t)}})}),(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("icon"),children:(0,e.jsx)(fe.IconPicker,{configurableOption:"none",icon:null===(u=null==M?void 0:M.icon)||void 0===u?void 0:u.asMutable({deep:!0}),setButtonUseColor:!1,previewOptions:{color:!0},onChange:e=>{const t=M.set("icon",e);N(t),Us("declineAllButton",t)}})})]})}),b&&(0,e.jsx)(c.SettingRow,{className:"cookie-settings-button-setting",children:(0,e.jsxs)(Qs,{openForCheck:!0,closeForUncheck:!0,disableActionForUnchecked:!0,label:v("cookieSettingsButton"),rightIcon:Ws(),"aria-label":v("cookieSettingsButton"),checked:(null==O?void 0:O.enable)||!1,onCheckedChange:e=>{const t=O.set("enable",e);R(t),Us("cookieSettingsButton",t)},children:[(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("text"),flow:"wrap",children:(0,e.jsx)(s.TextInput,{className:"w-100 mt-2",defaultValue:(null==O?void 0:O.label)||v("preferences"),"aria-label":v("text"),onAcceptValue:e=>{const t=O.set("label",e);R(t),Us("cookieSettingsButton",t)}})}),(0,e.jsx)(c.SettingRow,{className:"mt-2",label:v("icon"),children:(0,e.jsx)(fe.IconPicker,{configurableOption:"none",icon:null===(m=null==O?void 0:O.icon)||void 0===m?void 0:m.asMutable({deep:!0}),setButtonUseColor:!1,previewOptions:{color:!0},onChange:e=>{const t=O.set("icon",e);R(t),Us("cookieSettingsButton",t)}})}),(0,e.jsx)(c.SettingRow,{label:v("cookieSettingsWindow"),children:(0,e.jsx)(s.Button,{"aria-label":v("cookieSettingsWindow")+" "+v("preview"),icon:!0,active:S,onClick:()=>{i.builderAppSync.publishOpenCookieSettingsWindowToApp(!S)},children:(0,e.jsx)(Gs,{})})})]})})]}),(0,e.jsx)(c.SettingSection,{role:"group",title:v("animation"),"aria-label":v("animation"),children:(0,e.jsx)(c.SettingRow,{children:(0,e.jsx)(I.AnimationSettingComponent,{contentId:"cookie-banner",effectSetting:null==y?void 0:y.effect,onSettingChange:function(e,s){(0,i.getAppConfigAction)().editCookieBannerConfig("effect",s).exec(),i.builderAppSync.publishAnimationPreviewToApp({dialogId:"cookie-banner",playMode:e,id:(0,t.getNextAnimationId)()})},previewEnabled:!0,supportAsOne:!0,onPreviewClicked:function(e){y.effect&&i.builderAppSync.publishAnimationPreviewToApp({dialogId:"cookie-banner",playMode:e,id:(0,t.getNextAnimationId)()})},formatMessage:v})})}),(0,e.jsx)(I.ThemeBackgroundSection,{background:(null==y?void 0:y.backgroundStyle)||{fillType:s.FillType.FILL},onChange:_}),(0,e.jsx)(I.ThemeBorderSection,{border:null==y?void 0:y.border,borderRadius:null==y?void 0:y.borderRadius,onBorderChange:W,onBorderRadiusChange:F}),(0,e.jsx)(I.ThemeBoxShadowSection,{value:null==y?void 0:y.boxShadow,onChange:H})]})};var eo=function(e,t,i,s){return new(i||(i=Promise))(function(o,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,r)}l((s=s.apply(e,t||[])).next())})};const{useState:to,useEffect:io}=t.React,so={svg:Gi()},oo={svg:Ji()},no=Object.assign({},Wt,s.defaultMessages,l.defaultMessages,t.defaultMessages);const ao=o=>{const[n,a]=to("#"),{id:r,type:l,theme:c,intl:d,linkTitle:p,ariaLabel:g}=o;return io(()=>{((e,s)=>eo(void 0,void 0,void 0,function*(){var o,n,a,r,l,c,d;const p=null===(n=null===(o=(0,t.getAppStore)().getState())||void 0===o?void 0:o.appStateInBuilder)||void 0===n?void 0:n.appConfig;let g;if("page"===s||"dialog"===s)return yield i.helpUtils.getBuildAppsHelpLink(`add-a-${s}`);if("screen"===s)return yield i.helpUtils.getBuildAppsHelpLink("add-screen-groups");{let t="";if("section"===s)g="section";else if("placeholder"===s)g="placeholder";else if(g=null===(l=null===(r=null===(a=null==p?void 0:p.widgets)||void 0===a?void 0:a[e])||void 0===r?void 0:r.manifest)||void 0===l?void 0:l.name,t=null===(d=null===(c=null==p?void 0:p.widgets)||void 0===c?void 0:c[e])||void 0===d?void 0:d.uri,!g)return yield Promise.resolve(null);return yield i.helpUtils.getWidgetHelpLink(g,t)}}))(r,l).then(e=>{a(e)})},[r,l]),(0,e.jsx)(s.Link,{icon:!0,to:n,target:"_blank",title:p,css:t.css`
        padding: 0 !important;
        .svg-component{
          margin-right: 0;
          color: ${c.ref.palette.neutral[1e3]};
        }
        :hover {
          .svg-component{
            color: ${c.ref.palette.black};
          }
        }
      `,"aria-label":g,children:(0,e.jsx)(Qi,{autoFlip:!t.i18n.isSameLanguage(null==d?void 0:d.locale,"he")})})},ro=o=>{var n;const{hideColorSelector:a,headTitle:r,icon:l,customIcon:c,customName:d,id:p,type:g,needIconFlip:h,theme:u,intl:m,handleIconChange:f,handleTitleChange:v,handleKeydown:w,headTitleInput:x,defaultLabel:y}=o,[b,I]=to("");let S,C="";const j="string"==typeof c?[{svg:c}]:[c],A=JSON.parse(JSON.stringify(l));if(null==A?void 0:A.svg){const e=null===(n=null==A?void 0:A.properties)||void 0===n?void 0:n.filename;e?(null==e?void 0:e.indexOf(".svg"))>0&&(C=y):A.properties=Object.assign({filename:y},A.properties),S=A}else{S={svg:l,properties:{filename:y,originalName:`default/${`${d}.svg`}`}}}io(()=>{I(r)},[r]);const T=e=>m.formatMessage({id:e,defaultMessage:no[e]}),M=e=>{if("page"===g||"dialog"===g){const t=(0,i.getAppConfigAction)();if(i.appConfigUtils.isLabelDuplicated(t.appConfig,g,p,e))return{valid:!1,msg:T("duplicatedLabel")}}return{valid:!0}};return(0,e.jsxs)("div",{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between",children:[(0,e.jsxs)("div",{className:"d-flex align-items-center",children:[(0,e.jsx)(fe.IconPicker,{previewOptions:{autoFlip:h,color:!0},configurableOption:a?"none":"color",className:"flex-none",icon:S,customLabel:C,customIcons:j,onChange:f,hideRemove:!0,onKeyDown:e=>{if("Tab"===e.key&&e.shiftKey&&(0,t.getAppStore)().getState().appStateInBuilder.appRuntimeInfo.appMode===t.AppMode.Design){e.preventDefault();const i=document.querySelector(`iframe[name="${t.APP_FRAME_NAME_IN_BUILDER}"]`),s=(null==i?void 0:i.contentDocument)||(null==i?void 0:i.contentWindow.document);(0,t.focusElementInKeyboardMode)(s.body,!0)}},setButtonUseColor:!1,applyDefaultColor:!1}),(0,e.jsx)("div",{className:"d-flex mx-1",css:t.css`max-width: 170px;`,children:(0,e.jsx)(s.TextInput,{className:"header-title-input w-100 h5",ref:x,size:"sm",title:b,"aria-label":T("rename"),value:b||"",onChange:e=>{I(e.target.value)},onAcceptValue:e=>v(p,e,g),checkValidityOnChange:M,checkValidityOnAccept:M,onBlur:e=>{(e=>{if(""===e.trim()){const t=(0,i.getAppConfigAction)();"widget"===g?e=t.appConfig.widgets[p].label:"section"===g?e=t.appConfig.sections[p].label:"screen"===g?e=t.appConfig.screenGroups[p].label:"page"===g&&(e=t.appConfig.pages[p].label),I(e)}})(e.target.value)},onKeyDown:w,borderless:!0})})]}),(0,e.jsx)(ao,{id:p,type:g,theme:u,intl:m,linkTitle:T("help")})]})};class lo extends t.React.PureComponent{constructor(e){super(e),this.spanText=t.React.createRef(),this.headTitleInput=t.React.createRef(),this.sidePopperTrigger=t.React.createRef(),this.getCss=(e,i)=>{const{theme:s}=this.props,o=window.isExpressBuilder;return t.css`
      height: 100%;
      overflow: hidden;
      overflow-x: hidden;

      .jimu-widget-setting--header {
        ${o&&!e&&!i&&`border-bottom: 1px solid ${s.ref.palette.neutral[700]};`}
      }
      .jimu-widget-setting {
        overflow-x: hidden;
      }
      .widget-setting-tab{
        position: absolute;
        background-color: ${s.sys.color.surface.background};
      }

      .widget-setting, .section-setting {
        height: calc(100% - ${t.polished.rem(2)});
      }

      .jimu-widget-setting--row {
        label {
          user-select: none;
        }
      }
      .jimu-widget-setting--section-header {
        user-select: none;
      }
      .tab-content {
        height: calc(100% - ${t.polished.rem(40)});
      }
      .tab-pane{
        width: 100%;
      }

      .tab-title-item{
        width: 30%;
      }

      .edit-label-input {
        width: 50%;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }

      .title-span-hide {
        &.h5 {
          font-weight: ${s.ref.typeface.fontWeightBold};
          font-size: 1rem;
        }
      }

      .header-title-input {
        .input-wrapper {
          height: 100%;
          background-color: transparent;
        }
        &.h5 {
          input {
            width: 100%;
            font-weight: ${s.ref.typeface.fontWeightMedium};
            font-size: ${t.polished.rem(16)};
            color: var(--ref-palette-neutral-1000);
          }
        }
      }

      .setting-container {
        overflow-y: auto;
        overflow-x: hidden;
        height: 100%;
      }

      .single-setting {
        border-top: 1px solid ${s.ref.palette.neutral[700]};
      }

      .help-btn {
        color: ${s.ref.palette.neutral[700]};
      }
      .help-btn:hover {
        color: ${s.ref.palette.black};
      }
    `},this.onLayoutItemSettingChanged=(e,t)=>{(0,i.getAppConfigAction)().editLayoutItemProperty(e,"setting",t).exec()},this.onLayoutItemStyleChanged=(e,s)=>{const o=(0,i.getAppConfigAction)(),{layoutId:n,layoutItemId:a}=e,r=o.appConfig.layouts[n].content[a];r.type===t.LayoutItemType.Widget?r.widgetId?o.editWidgetProperty(r.widgetId,"style",s).exec():o.editLayoutItemProperty(e,"setting.placeholderStyle",s,!0).exec():r.type===t.LayoutItemType.Section&&o.editSectionProperty(r.sectionId,"style",s).exec()},this.onLayoutPosChanged=(e,t)=>{(0,i.getAppConfigAction)().editLayoutItemProperty(e,"bbox",t).exec()},this.getPageType=(e,t)=>{for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.formatMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:no[e]},t),this.editTitle=(e,t,s)=>{const o=(0,i.getAppConfigAction)();t?"widget"===s||"block"===s?o.editWidgetProperty(e,"label",t).exec():"section"===s?o.editSectionProperty(e,"label",t).exec():"screen"===s?o.editScreenGroupProperty(e,"label",t).exec():"page"===s?o.editPageProperty(e,"label",t).exec():"dialog"===s&&o.editDialogProperty(e,"label",t).exec():"widget"===s?t=o.appConfig.widgets[e].label:"section"===s?t=o.appConfig.sections[e].label:"screen"===s?t=o.appConfig.screenGroups[e].label:"page"===s&&(t=o.appConfig.pages[e].label)},this.handleKeydown=e=>{"Enter"===e.key&&this.headTitleInput.current&&this.headTitleInput.current.blur()},this.handleIconChange=e=>{const s=this.getDisplay(),{selection:o,currentPageId:n,currentDialogId:a}=this.props,r=(0,i.getAppConfigAction)(),c=r.appConfig;if(s.page)r.editPageProperty(n,"icon",e).exec();else if(s.dialog)r.editDialogProperty(a,"icon",e).exec();else if(s.widget){const i=l.searchUtils.findLayoutItem(c,o);i&&(t.urlUtils.isAbsoluteUrl(e.svg)?fetch(e.svg).then(e=>e.text()).then(t=>{const s=Object.assign(Object.assign({},e),{svg:t});r.editWidgetProperty(i.widgetId,"icon",s).exec()}).catch(e=>{console.error("Error fetching SVG:",e)}):r.editWidgetProperty(i.widgetId,"icon",e).exec())}else if(s.section){const t=l.searchUtils.findLayoutItem(c,o);t&&r.editSectionProperty(t.sectionId,"icon",e).exec()}else if(s.screen){const t=l.searchUtils.findLayoutItem(c,o);t&&r.editScreenGroupProperty(t.screenGroupId,"icon",e).exec()}},this.focusEditTitle=e=>{this.headTitleInput.current&&(this.headTitleInput.current.select(),this.headTitleInput.current.focus())},this.getDisplay=()=>{var e;const{selection:i,appConfig:s}=this.props,o={widget:!1,section:!1,screen:!1,layoutItem:!1,placeholder:!1,page:!1,link:!1,folder:!1,dialog:!1,noSelection:!1,cookieBanner:!1};if(i){const n=l.searchUtils.findLayoutItem(s,i);n?n.type===t.LayoutItemType.Widget?n.widgetId?o.widget=!0:(o.layoutItem=!0,o.placeholder=!0):n.type===t.LayoutItemType.Section&&!1!==(null===(e=i.additionalInfo)||void 0===e?void 0:e.commonSection)?o.section=!0:n.type===t.LayoutItemType.ScreenGroup?o.screen=!0:o.layoutItem=!0:o.noSelection=!0}else this.props.currentDialogId?o.dialog=!0:this.props.currentPageId?(o.page=!0,o.link=this.getPageType(this.props.currentPageId,s.pages).type===t.PageType.Link,o.folder=this.getPageType(this.props.currentPageId,s.pages).type===t.PageType.Folder):o.noSelection=!0;return this.props.isCookieBannerOpen&&(o.cookieBanner=!0),o},this.onA11ySettingChange=(e,t,s)=>{const o=this.props.appConfig.widgets[e].set(t,s);return(0,i.getAppConfigAction)().editWidget(o.asMutable({deep:!0})).exec()};const s={titleText:"",headTitleText:"",helpLink:""},{selection:o,appConfig:n,currentPageId:a}=e;if(o){const e=l.searchUtils.findLayoutItem(n,o);e&&(e.type===t.LayoutItemType.Widget?e.widgetId&&(s.headTitleText=n.widgets[e.widgetId].label):e.type===t.LayoutItemType.Section&&(s.headTitleText=n.sections[e.sectionId].label))}else a&&(s.headTitleText=n.pages[a].label);this.state=s,i.AppMessageManager.getInstance().registerActionRawSettingClass("filter-data-record-action",Mt.FilterDataRecordActionSetting),i.AppMessageManager.getInstance().registerActionRawSettingClass("select-data-record-action",Mt.SelectDataRecordActionSetting),i.AppMessageManager.getInstance().registerActionRawSettingClass("change-section-view-action",Mt.ChangeSectionViewActionSetting)}isWidgetOriginalCustomIcon(e,t){if("string"!=typeof t)return!1;const i=t.lastIndexOf("/"),s=t.lastIndexOf(".");return e===t.substring(i+1,s)}getDefaultWidgetIcon(e,i,s){var o,n,a;let r,l,c;"widget"===e?(c=s,"string"!=typeof i.icon&&this.isWidgetOriginalCustomIcon(i.manifest.name,null===(o=i.icon.properties)||void 0===o?void 0:o.originalName)?this.isWidgetOriginalCustomIcon(i.manifest.name,null===(n=i.icon.properties)||void 0===n?void 0:n.originalName)&&(r=i.icon.svg):r=t.urlUtils.getAbsoluteRootUrl()+i.uri+"icon.svg",l=`${null===(a=null==i?void 0:i.manifest)||void 0===a?void 0:a.name}.svg`):(c=this.formatMessage("block"),r=Gi().toString(),l=`${e}.svg`);return{svg:r,properties:{filename:c,inlineSvg:!0,originalName:`default/${l}`,path:`default/${l}`}}}getDefaultIcon(e,t){if("page"===e)return i.utils.getDefaultTocPageIcon(t,this.formatMessage);let s,o;"section"===e?(s=i.utils.getDefaultSectionIcon().toString(),o=this.formatMessage("section")):"screen"===e?(s=Ji().toString(),o=this.formatMessage("screenGroup")):"dialog"===e&&(s=i.utils.getDefaultTocDialogIcon().toString(),o=this.formatMessage("dialog"));const n=`${e}.svg`;return{svg:s,properties:{filename:o,inlineSvg:!0,originalName:`default/${n}`,path:`default/${n}`}}}onTabChange(e,i,s){i(t.appActions.widgetStatePropChange(s,"settingPanelChange",e))}widgetSettingsWithSimpleAction(i,s){var o,n,a;const{dispatch:r,widgetsSettingRuntimeInfo:l,widgetMessageActionSettingStatus:c}=this.props,d=s.widgets[i].manifest,p=(null===(o=null==d?void 0:d.publishMessages)||void 0===o?void 0:o.length)>0,g=null!==(a=null===(n=null==d?void 0:d.properties)||void 0===n?void 0:n.canConsumeDataAction)&&void 0!==a&&a,u=!1===(null==c?void 0:c[i]),m=!p||u;return(0,e.jsxs)("div",{className:m?"h-100":null,ref:this.sidePopperTrigger,children:[(0,e.jsx)(h,{widgetId:i,dispatch:r,formatMessage:this.formatMessage,widgetsSettingRuntimeInfo:l}),!u&&(0,e.jsx)("div",{children:(0,e.jsx)(Hi,{widgetId:i,supportMessageAction:p,canConsumeDataAction:g,pageId:t.urlUtils.getAppIdPageIdFromUrl().pageId,sidePopperTrigger:this.sidePopperTrigger})})]})}renderWidgetSettings(i,o,n,a,r){var c,d,g,u,m,f,v,w;let x;const{currentSelectionIcon:y,currentSelectionTitle:b,dispatch:I,selection:S}=this.props,C=null==n?void 0:n.layouts[null==a?void 0:a.layoutId],j=l.searchUtils.findLayoutItem(n,a).widgetId,A=n.widgets[j],T=A.manifest,M=(null===(c=null==T?void 0:T.publishMessages)||void 0===c?void 0:c.length)>0,N=null!==(g=null===(d=null==T?void 0:T.properties)||void 0===d?void 0:d.canConsumeDataAction)&&void 0!==g&&g,k=(null===(u=null==T?void 0:T.i18nMessages)||void 0===u?void 0:u._widgetLabel)||(null==T?void 0:T.label),O=C.type===t.LayoutType.FlowLayout?"block":"widget",P=window.isExpressBuilder;return x=(null==T?void 0:T.properties.hasConfig)&&(null==T?void 0:T.properties.hasConfigInSettingPage)?P?this.widgetSettingsWithSimpleAction(j,n):(0,e.jsxs)(s.Tabs,{type:"underline",className:"widget-setting flex-grow-1 w-100",fill:!0,defaultValue:"content",onChange:e=>{this.onTabChange(e,I,A.id)},children:[(0,e.jsx)(s.Tab,{id:"content",title:this.formatMessage("content"),className:"tab-title-item",children:(0,e.jsx)(h,{theme:i,formatMessage:this.formatMessage,dispatch:this.props.dispatch,widgetId:j,widgetsSettingRuntimeInfo:this.props.widgetsSettingRuntimeInfo})}),(0,e.jsx)(s.Tab,{id:"dynamicSettingStyle",title:this.formatMessage("dynamicSettingStyle"),className:"tab-title-item",children:(0,e.jsx)("div",{className:"setting-container",children:(0,e.jsx)(tt,{layoutId:a.layoutId,layoutItemId:a.layoutItemId,formatMessage:this.formatMessage,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})})}),(M||N)&&(0,e.jsx)(s.Tab,{id:"action",title:this.formatMessage("action"),className:"tab-title-item",children:(0,e.jsx)("div",{className:"setting-container",children:(0,e.jsx)(Ai,{widgetId:j,supportMessageAction:M,canConsumeDataAction:N,formatMessage:this.formatMessage,pageId:t.urlUtils.getAppIdPageIdFromUrl().pageId})})})]},"widget-setting"):(0,e.jsxs)("div",{className:"h-100",children:[(0,e.jsx)(tt,{layoutId:a.layoutId,layoutItemId:a.layoutItemId,formatMessage:this.formatMessage,isSingle:!0,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged}),(null===(m=n.attributes)||void 0===m?void 0:m.enableA11yForWidgetSettings)&&(0,e.jsx)(p,{theme:i,widgetId:j,label:A.a11yLabel,addToSkip:A.addToA11ySkip,onA11ySettingChange:(e,t)=>{this.onA11ySettingChange(j,e,t)},formatMessage:this.formatMessage})]}),x=(0,e.jsxs)("div",{css:r&&t.css`z-index: -1;`,className:"w-100 h-100 d-flex flex-column widget-setting-tab","data-is-parent":!!r||void 0,children:[S.layoutId===a.layoutId&&(0,e.jsx)(ro,{headTitle:b,icon:y,customIcon:this.getDefaultWidgetIcon(O,A,k),customName:null===(f=null==A?void 0:A.manifest)||void 0===f?void 0:f.name,id:A.id,type:O,needIconFlip:null===(w=null===(v=null==A?void 0:A.manifest)||void 0===v?void 0:v.properties)||void 0===w?void 0:w.flipIcon,theme:i,intl:o,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:k}),(0,e.jsx)("div",{style:{flex:1,overflow:"auto"},children:x})]}),x}render(){var i,o,n;const{appConfig:a,selection:r,browserSizeMode:c,theme:d,intl:p,currentSelectionIcon:g,currentSelectionTitle:h}=this.props;if(!a)return(0,e.jsx)("div",{css:this.getCss(!0),className:"builder-dynamic-setting bg-default",children:(0,e.jsx)(M,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,theme:this.props.theme,pageId:"empty",browserSizeMode:this.props.browserSizeMode,appTheme:this.props.theme2})});const u=this.getDisplay();let m;if(u.widget){const s=l.searchUtils.findLayoutItem(a,r);if(a.widgets[null==s?void 0:s.widgetId]){const o=s.widgetId,n=l.searchUtils.getParentWidgetIdOfContent(a,o,t.LayoutItemType.Widget,c),g=a.widgets[n];if(n&&(null===(i=null==g?void 0:g.manifest)||void 0===i?void 0:i.widgetType)!==t.WidgetType.Layout){const i=l.searchUtils.getLayoutInfosHoldContent(a,t.LayoutItemType.Widget,n,c)[0];m=(0,e.jsxs)(t.React.Fragment,{children:[i&&this.renderWidgetSettings(d,p,a,i,!0),this.renderWidgetSettings(d,p,a,r)]})}else m=(0,e.jsx)(t.React.Fragment,{children:this.renderWidgetSettings(d,p,a,r)})}else m=(0,e.jsx)("div",{children:this.formatMessage("noSelection")})}if(u.layoutItem&&!window.isExpressBuilder){let i=u.placeholder?this.formatMessage("placeholder"):this.formatMessage("daynamicLayout");if(r){const e=a.layouts[r.layoutId];(null==e?void 0:e.type)===t.LayoutType.GridLayout&&(i=(0,j.getLabelOfGridTab)(a,r,this.formatMessage))}m=(0,e.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,e.jsxs)("h4",{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between",children:[(0,e.jsx)("div",{children:i}),u.placeholder&&(0,e.jsx)(ao,{type:"placeholder",theme:d,intl:p,linkTitle:this.formatMessage("help"),ariaLabel:i})]}),(0,e.jsx)("div",{className:"flex-grow-1 setting-container",children:(0,e.jsx)(tt,{layoutId:r.layoutId,layoutItemId:r.layoutItemId,formatMessage:this.formatMessage,isSingle:!0,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})})]})}if(u.section){const t=l.searchUtils.findLayoutItem(a,r),i=a.sections[t.sectionId];m=(0,e.jsxs)(s.Tabs,{type:"underline",className:"flex-grow-1 section-setting",fill:!0,defaultValue:"content",children:[(0,e.jsx)(s.Tab,{id:"content",title:this.formatMessage("content"),children:(0,e.jsx)(We,{intl:this.props.intl,formatMessage:this.formatMessage,theme:this.props.theme,appTheme:this.props.theme2,dispatch:this.props.dispatch,sectionId:i.id,enableA11yForWidgetSettings:null===(o=a.attributes)||void 0===o?void 0:o.enableA11yForWidgetSettings})},"section-setting"),(0,e.jsx)(s.Tab,{id:"dynamicSettingStyle",title:this.formatMessage("dynamicSettingStyle"),children:(0,e.jsx)("div",{className:"h-100 setting-container",children:(0,e.jsx)(tt,{layoutId:r.layoutId,layoutItemId:r.layoutItemId,formatMessage:this.formatMessage,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})})})]}),m=(0,e.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,e.jsx)(ro,{headTitle:h,icon:g,customIcon:this.getDefaultIcon("section"),customName:"section",id:i.id,type:"section",theme:d,intl:p,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:this.formatMessage("section")}),(0,e.jsx)("div",{className:"h-100 setting-container",children:m})]})}if(u.screen){const t=l.searchUtils.findLayoutItem(a,r);m=(0,e.jsx)(Ye,{intl:this.props.intl,formatMessage:this.formatMessage,theme:this.props.theme,dispatch:this.props.dispatch,screenGroupId:t.screenGroupId,enableA11yForWidgetSettings:null===(n=a.attributes)||void 0===n?void 0:n.enableA11yForWidgetSettings}),m=(0,e.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,e.jsx)(ro,{headTitle:h,icon:g,customIcon:this.getDefaultIcon("screen"),customName:"screen",id:t.screenGroupId,type:"screen",theme:d,intl:p,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:this.formatMessage("screenGroup")}),(0,e.jsx)("div",{className:"h-100 setting-container",children:m})]})}if(u.page){m=(0,e.jsx)(M,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,pageId:this.props.currentPageId,pageMode:this.props.pageMode,maxWidth:this.props.maxPageWidth,browserSizeMode:this.props.browserSizeMode,theme:this.props.theme,appTheme:this.props.theme2}),u.link?m=(0,e.jsx)(se,{dispatch:this.props.dispatch,appConfig:a,formatMessage:this.formatMessage,pageId:this.props.currentPageId}):u.folder&&(m=(0,e.jsx)(ne,{dispatch:this.props.dispatch,appConfig:a,formatMessage:this.formatMessage,pageId:this.props.currentPageId}));const{currentPageId:t}=this.props,i=a.pages[t];m=i?(0,e.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,e.jsx)(ro,{hideColorSelector:!0,headTitle:h,icon:g,customIcon:this.getDefaultIcon("page",i),customName:"page",id:i.id,type:"page",theme:d,intl:p,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:h}),(0,e.jsx)("div",{className:"h-100 setting-container single-setting",children:m})]}):null}if(u.dialog){const{currentDialogId:t}=this.props;m=(0,e.jsx)(F,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,dialogId:t,browserSizeMode:this.props.browserSizeMode,theme:this.props.theme,appTheme:this.props.theme2});const i=a.dialogs[t];m=(0,e.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,e.jsx)(ro,{hideColorSelector:!0,headTitle:h,icon:g,customIcon:this.getDefaultIcon("dialog"),customName:"dialog",id:i.id,type:"dialog",theme:d,intl:p,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:this.formatMessage("dialog")}),(0,e.jsx)("div",{className:"h-100 setting-container single-setting",children:m})]})}u.cookieBanner&&(m=(0,e.jsx)(Ys,{browserSizeMode:this.props.browserSizeMode,theme:this.props.theme,dispatch:this.props.dispatch,appConfig:a,formatMessage:this.formatMessage})),u.noSelection&&(m=(0,e.jsx)("div",{className:"h-100",children:this.formatMessage("noSelection")}));const f=!!u.page,v=!!u.dialog;return(0,e.jsxs)("div",{css:this.getCss(f,v),className:"builder-dynamic-setting bg-default",children:[(0,e.jsx)("span",{ref:this.spanText,className:"title-span-hide px-1 border h5",style:{width:"auto",position:"absolute",opacity:0,whiteSpace:"nowrap",zIndex:-1},children:this.state.headTitleText||""}),m]})}}lo.mapExtraStateProps=(e,s)=>{var o,n,a,r,c,d,p,g,h,u,m,f;const v=null===(o=e.appStateInBuilder)||void 0===o?void 0:o.appRuntimeInfo.currentPageId,w=null===(n=e.appStateInBuilder)||void 0===n?void 0:n.appRuntimeInfo.currentDialogId,x=null===(c=null===(r=null===(a=e.appStateInBuilder)||void 0===a?void 0:a.appRuntimeInfo)||void 0===r?void 0:r.cookieBanner)||void 0===c?void 0:c.isCookieBannerOpenByPrivacyPanel,y=null===(d=e.appStateInBuilder)||void 0===d?void 0:d.appConfig;let b,I;v&&(b=null===(g=null===(p=null==y?void 0:y.pages)||void 0===p?void 0:p[v])||void 0===g?void 0:g.mode,I=null===(u=null===(h=null==y?void 0:y.pages)||void 0===h?void 0:h[v])||void 0===u?void 0:u.maxWidth);const S=null===(m=e.appStateInBuilder)||void 0===m?void 0:m.appRuntimeInfo.selection,{icon:C,title:j}=function(e,s,o,n,a){var r,c;let d,p;if(e){const s=l.searchUtils.findLayoutItem(n,e);if(s)if(s.type===t.LayoutItemType.Widget){if(s.widgetId){const i=n.widgets[s.widgetId],o=n.layouts[e.layoutId];p=i&&i.label,d=o.type!==t.LayoutType.FlowLayout||(null===(r=s.setting)||void 0===r?void 0:r.isFloating)?i&&i.icon:"string"!=typeof(null==i?void 0:i.icon)&&(null==i?void 0:i.icon)||so}}else if(s.type===t.LayoutItemType.Section){if(s.sectionId){const e=n.sections[s.sectionId];p=null==e?void 0:e.label,d=(null==e?void 0:e.icon)||i.utils.getDefaultSectionIcon().toString()}}else if(s.type===t.LayoutItemType.ScreenGroup&&s.screenGroupId){const e=n.screenGroups[s.screenGroupId];p=null==e?void 0:e.label,d=null!==(c=null==e?void 0:e.icon)&&void 0!==c?c:oo}}else if(n)if(s){const e=n.dialogs[s];e&&(p=e.label,d=e.icon||i.utils.getDefaultTocDialogIcon())}else if(o){const e=n.pages[o];e&&(p=e.label,d=e.icon||i.utils.getDefaultTocPageIcon(e,null,a))}return{icon:d,title:p}}(S,w,v,y,s.i18nMessages.page);return{appConfig:y,currentPageId:v,pageMode:b,maxPageWidth:I,widgetsSettingRuntimeInfo:e.builder.widgetsSettingRuntimeInfo,currentDialogId:w,selection:S,browserSizeMode:e.appStateInBuilder&&e.appStateInBuilder.browserSizeMode,currentSelectionIcon:C,currentSelectionTitle:j,isCookieBannerOpen:x,widgetMessageActionSettingStatus:null===(f=null==e?void 0:e.builder)||void 0===f?void 0:f.widgetMessageActionSettingStatus}};const co=lo;function po(e){f.p=e}})(),v})())}}});