System.register(["jimu-core","widgets/shared-code/lrs"],function(e,t){var r={},o={};return{setters:[function(e){r.AbstractDataAction=e.AbstractDataAction,r.DataLevel=e.DataLevel,r.DataSourceStatus=e.DataSourceStatus,r.DataSourceTypes=e.DataSourceTypes,r.Immutable=e.Immutable,r.MutableStoreManager=e.MutableStoreManager,r.getAppStore=e.getAppStore},function(e){o.LrsLayerType=e.LrsLayerType,o.isDefined=e.isDefined}],execute:function(){e((()=>{var e={47626:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=r}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var i={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(i),a.d(i,{default:()=>r});var e=a(79244),t=a(47626);class r extends e.AbstractDataAction{isSupported(r,a){var i;if(r.length>1)return Promise.resolve(!1);const s=r[0];if(s.records.length<2)return Promise.resolve(!1);const{dataSource:n,records:u}=s,l=n.type===e.DataSourceTypes.FeatureLayer||n.type===e.DataSourceTypes.SceneLayer,d=n.isDataSourceSet(),c=a!==e.DataLevel.Records,p=a===e.DataLevel.Records&&0===(null==u?void 0:u.length),f=!n.isInAppConfig()&&!l;if(d||c||p||f)return Promise.resolve(!1);if(!n||n.getStatus()===e.DataSourceStatus.NotReady)return Promise.resolve(!1);const v=n;if(!(0,t.isDefined)(v))return Promise.resolve(!1);const g=o(),S=null===(i=null==g?void 0:g.widgets)||void 0===i?void 0:i[this.widgetId];let y;if(S.config.lrsLayers.forEach(e=>{e.id===v.id&&(y=e)}),!(0,t.isDefined)(y)){const e=S.config.mapViewsConfig;for(const t in e)if(e[t].lrsLayers)for(const r of e[t].lrsLayers)r.id===v.id&&(y=r)}return(0,t.isDefined)(y)&&y.layerType===t.LrsLayerType.Event?Promise.resolve(!0):Promise.resolve(!1)}onExecute(t,r){var a;const i=t[0].dataSource,s=o();let n;return(null===(a=null==s?void 0:s.widgets)||void 0===a?void 0:a[this.widgetId]).config.lrsLayers.forEach(e=>{e.id===i.id&&(n=e)}),setTimeout(()=>{e.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedEventLyr",(0,e.Immutable)(n))},1e3),Promise.resolve(!0)}}function o(){var t,r,o;return window.jimuConfig.isBuilder?null===(r=null===(t=(0,e.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===r?void 0:r.appConfig:null===(o=(0,e.getAppStore)().getState())||void 0===o?void 0:o.appConfig}})(),i})())}}});