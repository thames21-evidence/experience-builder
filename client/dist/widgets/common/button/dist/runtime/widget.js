System.register(["jimu-core/emotion","jimu-core","jimu-ui","jimu-theme"],function(e,t){var i={},o={},n={},s={};return{setters:[function(e){i.jsx=e.jsx,i.jsxs=e.jsxs},function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.ButtonClickMessage=e.ButtonClickMessage,o.DynamicStyleResolverComponent=e.DynamicStyleResolverComponent,o.ExpressionPartType=e.ExpressionPartType,o.ExpressionResolverComponent=e.ExpressionResolverComponent,o.ExpressionResolverErrorCode=e.ExpressionResolverErrorCode,o.Immutable=e.Immutable,o.LinkType=e.LinkType,o.MessageManager=e.MessageManager,o.React=e.React,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.getAppStore=e.getAppStore},function(e){n.DistanceUnits=e.DistanceUnits,n.Icon=e.Icon,n.Link=e.Link,n.Popper=e.Popper,n.defaultMessages=e.defaultMessages,n.styleUtils=e.styleUtils,n.utils=e.utils},function(e){s.getThemeModule=e.getThemeModule,s.mapping=e.mapping}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=s},14321:e=>{"use strict";e.exports=n},67386:e=>{"use strict";e.exports=i},79244:e=>{"use strict";e.exports=o}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var l={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(l),r.d(l,{__set_webpack_public_path__:()=>h,default:()=>g});var e,t=r(67386),i=r(79244),o=r(14321);function n(e,t){return i.css`
    &>a {
      display: flex !important;
      justify-content: center;
      ${!t&&i.css`
        &.jimu-link-link {
          text-decoration: underline;
        }
      `}
    }

    .auto-size-icon {
      line-height: 1;
    }
    .widget-button-text{
        width: 100%;
        height: 100%;
    }
  `}!function(e){e.Left="LEFT",e.Right="RIGHT"}(e||(e={}));class s extends i.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"The first release.",upgrader:e=>{let t=e;return t.getIn(["styleConfig","name"])&&(t=t.set("styleConfig",t.styleConfig.without("name"))),t.getIn(["styleConfig","customStyle"])&&(t=t.set("styleConfig",t.styleConfig.without("customStyle"))),t.getIn(["styleConfig","themeStyle","quickStyleType"])&&(t=t.setIn(["styleConfig","themeStyle"],{quickStyleType:t.styleConfig.themeStyle.quickStyleType})),t=t.setIn(["styleConfig","useCustom"],!1),t}},{version:"1.1.0",description:"1.1.0",upgrader:e=>{let t=e;return t.getIn(["styleConfig","useCustom"])&&t.getIn(["styleConfig","customStyle","regular","border","width"])&&(t=t.setIn(["styleConfig","customStyle","regular","border","width"],o.utils.stringOfLinearUnit(t.getIn(["styleConfig","customStyle","regular","border","width"])))),t.getIn(["styleConfig","useCustom"])&&t.getIn(["styleConfig","customStyle","hover","border","width"])&&(t=t.setIn(["styleConfig","customStyle","hover","border","width"],o.utils.stringOfLinearUnit(t.getIn(["styleConfig","customStyle","hover","border","width"])))),t}},{version:"1.12.0",description:"fix icon picker config",upgrader:e=>{let t=e;if(t.getIn(["functionConfig","icon","data"])){const e={svg:t.getIn(["functionConfig","icon","data"]),properties:{filename:""}};t=t.setIn(["functionConfig","icon","data"],e)}return t}}]}}const a=new s;var d=r(1888);const p={rootBoundary:"viewport",crossAxis:!0,padding:4},c={boundary:document.body,fallbackPlacements:["right-start","left-start","top","bottom","left","right","top-start","bottom-start"]};class u extends i.React.PureComponent{constructor(n){var s,r,l,a,d;super(n),this.getTextFromProps=()=>{var e,t,i,n;return"string"==typeof(null===(t=null===(e=this.props.config)||void 0===e?void 0:e.functionConfig)||void 0===t?void 0:t.text)?null===(n=null===(i=this.props.config)||void 0===i?void 0:i.functionConfig)||void 0===n?void 0:n.text:this.props.intl.formatMessage({id:"variableButton",defaultMessage:o.defaultMessages.variableButton})},this.getTipExpression=()=>{var e,t;return this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTipExpression&&this.props.config.functionConfig.toolTipExpression||(0,i.Immutable)({name:"",parts:[{type:i.ExpressionPartType.String,exp:`"${(null===(t=null===(e=this.props.config)||void 0===e?void 0:e.functionConfig)||void 0===t?void 0:t.toolTip)||""}"`}]})},this.getTextExpression=()=>{var e,t;return this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.textExpression&&this.props.config.functionConfig.textExpression||(0,i.Immutable)({name:"",parts:[{type:i.ExpressionPartType.String,exp:`"${(null===(t=null===(e=this.props.config)||void 0===e?void 0:e.functionConfig)||void 0===t?void 0:t.text)||this.getTextFromProps()}"`}]})},this.getUrlExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.expression||null,this.onTextExpResolveChange=e=>{if(e.isSuccessful)this.setState({text:e.value});else{let t="";e.value===i.ExpressionResolverErrorCode.Failed&&(t=this.state.textExpression&&this.state.textExpression.name),this.setState({text:t})}},this.onTipExpResolveChange=e=>{e.isSuccessful?this.setState({toolTip:e.value}):this.setState({toolTip:""})},this.onUrlExpResolveChange=e=>{if(e.isSuccessful)this.setState({url:e.value});else{let t="";e.value===i.ExpressionResolverErrorCode.Failed&&(t=this.state.urlExpression&&this.state.urlExpression.name),this.setState({url:t})}},this.getWhetherUseQuickStyle=e=>!!(e&&e.styleConfig&&e.styleConfig.themeStyle&&e.styleConfig.themeStyle.quickStyleType),this.getIconStyle=(e,t)=>{const n=e||{},s=t||{};return i.css`
      & img, & svg{
        color: ${n.color};
        fill: ${n.color};
        width: ${n.size}${o.DistanceUnits.PIXEL};
        height: ${n.size}${o.DistanceUnits.PIXEL};
      }
      &:hover{
        img, svg{
          color: ${s.color};
          fill: ${s.color};
          width: ${s.size}${o.DistanceUnits.PIXEL};
          height: ${s.size}${o.DistanceUnits.PIXEL};
        }
      }
    `},this.getMixinStyleSettings=(e,t)=>{const n=(null==t?void 0:t.without("iconProps").without("dynamicStyleConfig").without("enableDynamicStyle").asMutable({deep:!0}))||{},s=null==e?void 0:e.without("icon").asMutable({deep:!0});if(null==s?void 0:s.border){s.border=o.styleUtils.mixinBorderWithDynamicStyle(null==s?void 0:s.border,n),Object.assign(s,s.border);["border","borderLeft","borderRight","borderTop","borderBottom"].forEach(e=>delete n[e])}(null==s?void 0:s.borderRadius)&&(s.borderRadius=o.styleUtils.mixinBorderRadiusWithDynamicStyle(null==s?void 0:s.borderRadius,n.borderRadius),delete n.borderRadius);let r=null;return s&&(r=(0,i.Immutable)(n).merge((0,i.Immutable)(s),{deep:!0}).asMutable({deep:!0})),r},this.removeUndefinedStyle=e=>{if(!e)return e;const t={};return Object.keys(e).forEach(i=>{("string"==typeof e[i]&&!e[i].includes("undefined")||"number"==typeof e[i])&&(t[i]=e[i])}),t},this.updateIconWithDynamicStyle=(e,t)=>{if(!t)return e;const o=t.without("color").without("size");return e?(0,i.Immutable)(Object.assign(Object.assign({},e.asMutable({deep:!0})),o)):(0,i.Immutable)(t)},this.getLinkComponent=n=>{var s,r,l,a,d,p,c,u,g,h,v,y,f,m,x,S,C,b,E,D,I,w,T,j,k,L,M,R,P,O,U,A,$;const N=this.props.config,B=N.functionConfig.linkParam,z=this.state.text,q=this.state.toolTip,H=this.state.textExpLoading||this.state.urlExpLoading||this.state.tipExpLoading,W=this.getWhetherUseQuickStyle(N);let _,F,X,V,Q,G,K=null===(s=N.functionConfig)||void 0===s?void 0:s.icon;if(N.styleConfig&&N.styleConfig.useCustom&&N.styleConfig.customStyle){let e=N.styleConfig.customStyle.regular;const t=N.styleConfig.customStyle.hover;if(e.borderRadius){const t=e.borderRadius.number.map(e=>null===e?0:e);e=e.setIn(["borderRadius","number"],t)}const s=e.enableDynamicStyle,U=this.state.regularDynamicStyles,A=s&&this.getMixinStyleSettings(U,e),$=null===(d=null===(a=null===(l=null===(r=this.props.config)||void 0===r?void 0:r.styleConfig)||void 0===l?void 0:l.customStyle)||void 0===a?void 0:a.hover)||void 0===d?void 0:d.enableDynamicStyle,B=this.state.hoverDynamicStyles,z=$&&this.getMixinStyleSettings(B,t);if(s&&U?(X=o.styleUtils.toCSSStyle(A,!0),V=Object.assign(Object.assign({},null==e?void 0:e.iconProps),null==U?void 0:U.icon)):(X=o.styleUtils.toCSSStyle(e&&e.without("iconProps").asMutable({deep:!0}),!0),V=null==e?void 0:e.iconProps),$&&B?(G=o.styleUtils.toCSSStyle(z,!0),Q=Object.assign(Object.assign({},null==t?void 0:t.iconProps),null==B?void 0:B.icon)):(G=o.styleUtils.toCSSStyle(t&&t.without("iconProps").asMutable({deep:!0}),!0),Q=null==t?void 0:t.iconProps),G=Object.assign(Object.assign({},X),G),Q=Object.assign(Object.assign({},V),Q),W&&"link"===(null===(p=N.styleConfig.themeStyle)||void 0===p?void 0:p.quickStyleType))if(n){const i=null===(v=null===(h=null===(g=null===(u=null===(c=this.props.theme)||void 0===c?void 0:c.comp)||void 0===u?void 0:u.Link)||void 0===g?void 0:g.root)||void 0===h?void 0:h.vars)||void 0===v?void 0:v.decoration,o=null===(S=null===(x=null===(m=null===(f=null===(y=this.props.theme)||void 0===y?void 0:y.comp)||void 0===f?void 0:f.Link)||void 0===m?void 0:m.root)||void 0===x?void 0:x.vars)||void 0===S?void 0:S.decorationStyle,n=null===(w=null===(I=null===(D=null===(E=null===(b=null===(C=this.props.theme)||void 0===C?void 0:C.comp)||void 0===b?void 0:b.Link)||void 0===E?void 0:E.root)||void 0===D?void 0:D.vars)||void 0===I?void 0:I.hover)||void 0===w?void 0:w.decoration,s=null===(R=null===(M=null===(L=null===(k=null===(j=null===(T=this.props.theme)||void 0===T?void 0:T.comp)||void 0===j?void 0:j.Link)||void 0===k?void 0:k.root)||void 0===L?void 0:L.vars)||void 0===M?void 0:M.hover)||void 0===R?void 0:R.decorationStyle;let r=null!==(P=null==X?void 0:X.textDecoration)&&void 0!==P?P:"";r=this.getMergedTextDecoration(r,i);let l=null!==(O=null==G?void 0:G.textDecoration)&&void 0!==O?O:"";l=this.getMergedTextDecoration(l,n),(null==e?void 0:e.text)&&Object.prototype.hasOwnProperty.call(e.text,"underline")&&!e.text.underline&&(r=r.replace("underline","").trim()),X.textDecorationLine=`${r||"none"} !important`,X.textDecorationStyle=o||"initial",(null==t?void 0:t.text)&&Object.prototype.hasOwnProperty.call(t.text,"underline")&&!t.text.underline&&(l=l.replace("underline","").trim()),G.textDecorationLine=`${l||"none"} !important`,G.textDecorationStyle=s||"initial"}else(null==e?void 0:e.text)&&Object.prototype.hasOwnProperty.call(e.text,"underline")&&!e.text.underline?X.textDecoration=`${(null==X?void 0:X.textDecoration)||"none"} !important`:X.textDecoration=this.getMergedTextDecoration(null==X?void 0:X.textDecoration,"underline")+" !important",(null==t?void 0:t.text)&&Object.prototype.hasOwnProperty.call(t.text,"underline")&&!t.text.underline?G.textDecoration=`${(null==G?void 0:G.textDecoration)||"none"} !important`:G.textDecoration=this.getMergedTextDecoration(null==G?void 0:G.textDecoration,"underline")+" !important";if(this.props.active&&this.props.appMode!==i.AppMode.Run){const e=(0,i.getAppStore)().getState().widgetsState[this.props.id]||(0,i.Immutable)({});_={style:e.isConfiguringHover?Object.assign(Object.assign({},this.removeUndefinedStyle(X)),this.removeUndefinedStyle(G)):X,hoverStyle:G},F=this.getIconStyle(e.isConfiguringHover?Q:V,Q)}else _={style:X,hoverStyle:G},F=this.getIconStyle(V,t&&Q);(null==U?void 0:U.icon)&&(K=this.updateIconWithDynamicStyle(K,U.icon)),this.state.isHovered&&(null==B?void 0:B.icon)&&(K=this.updateIconWithDynamicStyle(K,B.icon))}const J=W?{type:N.styleConfig.themeStyle.quickStyleType}:{type:"default"};let Y,Z,ee;B&&B.linkType&&(Z=B.openType,ee={linkType:B.linkType},B.linkType===i.LinkType.WebAddress?ee.value=this.state.url:(ee.value=B.value,Y=this.props.queryObject));const te=null===(U=null==K?void 0:K.data)||void 0===U?void 0:U.properties,ie=(null==te?void 0:te.isUploaded)?null==te?void 0:te.originalName:null==te?void 0:te.filename,oe=null==ie?void 0:ie.replace(/\.[^/.]+$/,"");let ne=this.state.toolTip||z||oe;const se=this.props.isRTL,re=null===(A=null==K?void 0:K.data)||void 0===A?void 0:A.svg,le=re&&(!K.position||K.position===e.Left)&&(0,t.jsx)(o.Icon,{icon:K.data.svg,className:(0,i.classNames)({"mr-2 ml-0":!!z&&!se,"ml-2 mr-0":!!z&&se,"mx-0":!z}),"aria-hidden":!0}),ae=re&&K.position===e.Right&&(0,t.jsx)(o.Icon,{icon:K.data.svg,className:(0,i.classNames)({"ml-2 mr-0":!!z&&!se,"mr-2 ml-0":!!z&&se,"mx-0":!z}),"aria-hidden":!0});"_blank"===Z&&(ne=`${ne}, ${this.props.intl.formatMessage({id:"openInNewWindow"})}`);const de=this.props.autoWidth&&this.props.autoHeight,pe=K&&!z,ce=n&&W&&"tertiary"===(null===($=N.styleConfig.themeStyle)||void 0===$?void 0:$.quickStyleType)?"inherit":null;return(0,t.jsx)(o.Link,Object.assign({to:ee,target:Z,queryObject:Y,title:q,className:"widget-button-link text-truncate w-100 h-100 p-0 d-flex align-items-center justify-content-center",role:"button",color:ce,customStyle:_},J,{css:F,"aria-label":ne,disabled:H,onMouseEnter:()=>{this.setState({isHovered:!0})},onMouseLeave:()=>{this.setState({isHovered:!1})},children:(0,t.jsxs)("span",{className:(0,i.classNames)("widget-button-text d-flex align-items-center justify-content-center",{"auto-size-icon":de&&pe}),children:[se?ae:le,(0,t.jsx)("span",{className:"text-truncate",children:z}),se?le:ae]})}))},this.getMergedTextDecoration=(e,t)=>{const i=new Set;return e&&e.split(" ").forEach(e=>{i.add(e)}),t&&t.split(" ").forEach(e=>{i.add(e)}),i.has("none")&&i.size>1&&i.delete("none"),Array.from(i).join(" ")},this.onClick=e=>{e.exbEventType="linkClick",i.MessageManager.getInstance().publishMessage(new i.ButtonClickMessage(this.props.id))},this.onRegularDynamicStyleChange=e=>{this.setState({regularDynamicStyles:e})},this.onHoverDynamicStyleChange=e=>{this.setState({hoverDynamicStyles:e})},this.getDynamicActive=()=>((e,t,i)=>{var o,n;if(e&&t){const{widgetId:e,recordIndex:s}=t;if(e&&void 0!==s&&(null===(n=null===(o=null==i?void 0:i.previewRepeatedRecordInfo)||void 0===o?void 0:o[e])||void 0===n?void 0:n.recordIndex)!==s)return!1}return e})(this.props.isDynamicActive,this.props.repeatedDataSource,this.props.dynamicStyleState),this.onArcadeLoadingChange=(e,t=!0)=>{"text"===e?this.setState({textExpLoading:t}):"tip"===e?this.setState({tipExpLoading:t}):"url"===e&&this.setState({urlExpLoading:t})},this.state={text:this.getTextFromProps(),toolTip:(null===(r=null===(s=this.props.config)||void 0===s?void 0:s.functionConfig)||void 0===r?void 0:r.toolTip)||"",url:(null===(d=null===(a=null===(l=this.props.config)||void 0===l?void 0:l.functionConfig)||void 0===a?void 0:a.linkParam)||void 0===d?void 0:d.value)||"",textExpression:this.props.useDataSourcesEnabled&&this.getTextExpression(),tipExpression:this.props.useDataSourcesEnabled&&this.getTipExpression(),urlExpression:this.props.useDataSourcesEnabled&&this.getUrlExpression(),regularDynamicStyles:null,hoverDynamicStyles:null,isHovered:!1,tipExpLoading:!1,urlExpLoading:!1,textExpLoading:!1},this.domNode=i.React.createRef()}componentDidUpdate(e,t){var o,n;if(this.props.useDataSourcesEnabled||this.props.config===e.config&&!e.useDataSourcesEnabled||this.setState({text:this.getTextFromProps(),toolTip:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip,url:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.value}),!this.props.useDataSourcesEnabled||this.props.config===e.config&&e.useDataSourcesEnabled||this.setState({textExpression:this.getTextExpression(),tipExpression:this.getTipExpression(),urlExpression:this.getUrlExpression()}),this.props.isDynamicActive!==e.isDynamicActive&&this.props.isDynamicActive&&this.props.repeatedDataSource){const e=this.props.repeatedDataSource,t=(null===(n=null===(o=this.props.dynamicStyleState)||void 0===o?void 0:o.previewRepeatedRecordInfo)||void 0===n?void 0:n[e.widgetId])||{};this.props.dispatch(i.appActions.changeDynamicStylePreviewRepeatedRecordInfo(e.widgetId,Object.assign(Object.assign({},t),{needUpdateRecordIndex:!0})))}}render(){var e,s,r,l,a,u,g,h,v;const y=this.props.useDataSourcesEnabled,f=d.mapping.whetherIsNewTheme((0,d.getThemeModule)(null===(e=this.props.theme)||void 0===e?void 0:e.uri)),m=this.getLinkComponent(f);return(0,t.jsxs)("div",{className:"jimu-widget widget-button w-100 h-100 "+(this.state.textExpLoading||this.state.urlExpLoading||this.state.tipExpLoading,""),css:n(this.props.theme,f),ref:this.domNode,onClick:this.onClick,onKeyUp:e=>{" "!==e.key&&"Enter"!==e.key||this.onClick(e)},children:[m,(0,t.jsx)(o.Popper,{open:this.getDynamicActive(),offsetOptions:[0,4],css:i.css`
      white-space: nowrap;
      z-index: 12;
      background-color: var(--sys-color-info-dark);
      font-size: 12px;
      font-weight: 400;
      border: none;
      box-shadow: none;
      color: var(--sys-color-info-text);
  `,autoUpdate:!0,shiftOptions:p,flipOptions:c,reference:this.domNode,placement:"right-start",children:(0,t.jsx)("div",{className:"pl-2 pr-2 pt-1 pb-1",children:this.props.intl.formatMessage({id:"conditionalStylePreview",defaultMessage:o.defaultMessages.conditionalStylePreview})})}),(0,t.jsx)("div",{style:{display:"none"},children:y&&(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.state.textExpression,onChange:this.onTextExpResolveChange,widgetId:this.props.id,onLoading:()=>{this.onArcadeLoadingChange("text")},onLoaded:()=>{this.onArcadeLoadingChange("text",!1)}}),(0,t.jsx)(i.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.state.tipExpression,onChange:this.onTipExpResolveChange,widgetId:this.props.id,onLoading:()=>{this.onArcadeLoadingChange("tip")},onLoaded:()=>{this.onArcadeLoadingChange("tip",!1)}}),(0,t.jsx)(i.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.state.urlExpression,onChange:this.onUrlExpResolveChange,widgetId:this.props.id,onLoading:()=>{this.onArcadeLoadingChange("url")},onLoaded:()=>{this.onArcadeLoadingChange("url",!1)}})]})}),(0,t.jsx)(i.DynamicStyleResolverComponent,{widgetId:this.props.widgetId,useDataSources:this.props.useDataSources,dynamicStyleConfig:null===(a=null===(l=null===(r=null===(s=this.props.config)||void 0===s?void 0:s.styleConfig)||void 0===r?void 0:r.customStyle)||void 0===l?void 0:l.regular)||void 0===a?void 0:a.dynamicStyleConfig,onChange:this.onRegularDynamicStyleChange}),(0,t.jsx)(i.DynamicStyleResolverComponent,{widgetId:this.props.widgetId,useDataSources:this.props.useDataSources,dynamicStyleConfig:null===(v=null===(h=null===(g=null===(u=this.props.config)||void 0===u?void 0:u.styleConfig)||void 0===g?void 0:g.customStyle)||void 0===h?void 0:h.hover)||void 0===v?void 0:v.dynamicStyleConfig,onChange:this.onHoverDynamicStyleChange})]})}}u.mapExtraStateProps=(e,t)=>{var i,o,n,s;let r=!1;const l=e.appRuntimeInfo.selection;if(l&&e.appConfig.layouts[l.layoutId]){const i=e.appConfig.layouts[l.layoutId].content[l.layoutItemId];r=i&&i.widgetId===t.id}const a=e.appContext.isInBuilder&&r,d="number"==typeof(null===(n=null===(o=null===(i=e.dynamicStyleState)||void 0===i?void 0:i.previewConditionInfo)||void 0===o?void 0:o[t.id])||void 0===n?void 0:n.conditionId);return{active:a,appMode:e.appRuntimeInfo.appMode,queryObject:e.queryObject,isRTL:e.appContext.isRTL,browserSizeMode:e.browserSizeMode,uri:null===(s=e.appConfig.widgets[t.id])||void 0===s?void 0:s.uri,dynamicStyleState:e.dynamicStyleState,isDynamicActive:d}},u.versionManager=a;const g=u;function h(e){r.p=e}})(),l})())}}});