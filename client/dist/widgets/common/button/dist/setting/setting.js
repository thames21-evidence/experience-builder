System.register(["jimu-core/emotion","jimu-core","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/resource-selector","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder","jimu-ui/advanced/dynamic-style-builder","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],function(e,t){var s={},i={},o={},n={},r={},a={},p={},l={},u={},c={},g={};return{setters:[function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){i.DataSourceTypes=e.DataSourceTypes,i.DynamicStyleType=e.DynamicStyleType,i.ExpressionPartType=e.ExpressionPartType,i.Immutable=e.Immutable,i.LinkType=e.LinkType,i.React=e.React,i.css=e.css,i.defaultMessages=e.defaultMessages,i.dynamicStyleUtils=e.dynamicStyleUtils,i.expressionUtils=e.expressionUtils,i.lodash=e.lodash,i.polished=e.polished},function(e){o.builderAppSync=e.builderAppSync},function(e){n.CollapsableResetPanel=e.CollapsableResetPanel,n.LinkSelector=e.LinkSelector,n.SettingRow=e.SettingRow,n.SettingSection=e.SettingSection},function(e){r.IconPicker=e.IconPicker},function(e){a.Collapse=e.Collapse,a.DistanceUnits=e.DistanceUnits,a.Label=e.Label,a.Select=e.Select,a.Switch=e.Switch,a.Tab=e.Tab,a.Tabs=e.Tabs,a.TextInput=e.TextInput,a.defaultMessages=e.defaultMessages},function(e){p.DataSourceSelector=e.DataSourceSelector},function(e){l.ExpressionInput=e.ExpressionInput,l.ExpressionInputType=e.ExpressionInputType},function(e){u.DynamicStyleBuilderSwitch=e.DynamicStyleBuilderSwitch},function(e){c.BackgroundSetting=e.BackgroundSetting,c.BorderRadiusSetting=e.BorderRadiusSetting,c.BorderSetting=e.BorderSetting,c.BoxShadowSetting=e.BoxShadowSetting,c.InputUnit=e.InputUnit,c.TextStyle=e.TextStyle},function(e){g.ThemeColorPicker=e.ThemeColorPicker}],execute:function(){e((()=>{var e={4108:e=>{"use strict";e.exports=o},13089:e=>{"use strict";e.exports=p},14321:e=>{"use strict";e.exports=a},15562:e=>{"use strict";e.exports=c},35809:e=>{"use strict";e.exports=r},54337:e=>{"use strict";e.exports=g},67386:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=n},84845:e=>{"use strict";e.exports=l},85252:e=>{"use strict";e.exports=u}},t={};function h(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,h),o.exports}h.d=(e,t)=>{for(var s in t)h.o(t,s)&&!h.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="";var d={};return h.p=window.jimuConfig.baseUrl,(()=>{"use strict";h.r(d),h.d(d,{__set_webpack_public_path__:()=>P,default:()=>k});var e,t=h(67386),s=h(79244),i=h(4108),o=h(79298),n=h(35809),r=h(14321),a=h(13089),p=h(84845);!function(e){e.Left="LEFT",e.Right="RIGHT"}(e||(e={}));var l=h(85252);const u="Use Button Text content";var c=h(15562);const g=e=>null==e||""===e,f=e=>{if(!e)return!0;return g(e.color)&&C(e.image)};class S extends s.React.PureComponent{constructor(){super(...arguments),this.onBackgroundStyleChange=e=>{var t,i;let o=(0,s.Immutable)(null!==(i=null===(t=this.props.style)||void 0===t?void 0:t.background)&&void 0!==i?i:{});for(const t in e)switch(t){case"fillType":o.fillType!==e[t]&&(o=o.set("fillType",e[t]));break;case"color":o=o.set("color",e[t]);break;case"image":o=o.set("image",e[t])}this.props.onChange(this.getStyleSettings().set("background",o))},this.resetBackground=()=>{this.props.onChange(this.getStyleSettings().without("background"))},this.updateBorder=e=>{this.props.onChange(this.getStyleSettings().set("border",e).without("borderTop").without("borderLeft").without("borderRight").without("borderBottom"))},this.updateSideBorder=(e,t)=>{this.props.onChange(this.getStyleSettings().set(s.lodash.camelCase(`border-${e}`),t).without("border"))},this.resetBorder=()=>{this.props.onChange(this.getStyleSettings().without("border").without("borderTop").without("borderLeft").without("borderRight").without("borderBottom"))},this.updateRadius=e=>{const t=null==e?void 0:e.number;[0,1,2,3].every(e=>g(null==t?void 0:t[e]))?this.resetRadius():this.props.onChange(this.getStyleSettings().set("borderRadius",e))},this.resetRadius=()=>{this.props.onChange(this.getStyleSettings().without("borderRadius"))},this.updateShadow=e=>{this.props.onChange(this.getStyleSettings().set("boxShadow",e))}}getStyleSettings(){return this.props.style?this.props.style:(0,s.Immutable)({})}render(){const e=this.props.style||(0,s.Immutable)({}),{intl:i}=this.props,n=i.formatMessage({id:"background",defaultMessage:r.defaultMessages.background}),a=i.formatMessage({id:"border",defaultMessage:r.defaultMessages.border}),p=i.formatMessage({id:"borderRadius",defaultMessage:r.defaultMessages.borderRadius}),l=i.formatMessage({id:"shadow",defaultMessage:r.defaultMessages.shadow}),u=C(e.border)&&C(e.borderTop)&&C(e.borderLeft)&&C(e.borderRight)&&C(e.borderBottom),g=C(e.borderRadius);return(0,t.jsxs)(s.React.Fragment,{children:[(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:n,isEmpty:f(e.background),bottomLine:!0,keepMount:!0,onReset:this.resetBackground,children:(0,t.jsx)(c.BackgroundSetting,{background:e.background,applyDefaultValue:!1,onChange:this.onBackgroundStyleChange})})}),(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:a,isEmpty:u,bottomLine:!0,keepMount:!0,onReset:this.resetBorder,children:(0,t.jsx)(c.BorderSetting,{value:e.border,top:e.borderTop,left:e.borderLeft,right:e.borderRight,bottom:e.borderBottom,applyDefaultValue:!1,onChange:this.updateBorder,onSideChange:this.updateSideBorder})})}),(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:p,isEmpty:g,bottomLine:!0,keepMount:!0,onReset:this.resetRadius,children:(0,t.jsx)(c.BorderRadiusSetting,{value:e.borderRadius,applyDefaultValue:!1,onChange:this.updateRadius})})}),(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:l,isEmpty:C(e.boxShadow),keepMount:!0,onReset:()=>{this.updateShadow(null)},children:(0,t.jsx)(c.BoxShadowSetting,{value:e.boxShadow,applyDefaultValue:!1,onChange:this.updateShadow})})})]})}}var x=h(54337);class m extends s.React.PureComponent{constructor(){super(...arguments),this.units=[r.DistanceUnits.PIXEL],this.onSizeChange=e=>{this.changeIcon("size",e.distance)},this.onColorChange=e=>{this.changeIcon("color",e)},this.changeIcon=(e,t)=>{const i=this.props.iconProps?this.props.iconProps.set(e,t):(0,s.Immutable)({[e]:t});this.props.onChange(i)}}render(){const e=this.props.iconProps||{},s=isNaN(e.size)?void 0:e.size+"px";return(0,t.jsxs)("div",{className:"w-100 d-flex justify-content-between icon-size-font-style-setting",children:[(0,t.jsx)(c.InputUnit,{className:"pr-1",units:this.units,value:s,applyDefaultValue:!1,placeholder:"##",onChange:this.onSizeChange}),(0,t.jsx)(x.ThemeColorPicker,{specificTheme:this.props.appTheme,value:e.color,onChange:this.onColorChange})]})}}class y extends s.React.PureComponent{constructor(){super(...arguments),this.changeText=(e,t)=>{const i=this.props.text?this.props.text.set(e,t):(0,s.Immutable)({[e]:t});this.props.onChange(i)}}render(){return(0,t.jsx)(c.TextStyle,Object.assign({},this.props.text,{applyDefaultValue:!1,onChange:this.changeText}))}}const C=e=>{if(!e)return!0;return!Object.keys(e).some(t=>null!==e[t]&&void 0!==e[t]&&""!==e[t])},v=(0,s.Immutable)([s.DynamicStyleType.Text,s.DynamicStyleType.Background,s.DynamicStyleType.Border,s.DynamicStyleType.Icon]),T=(0,s.Immutable)([s.DynamicStyleType.Text,s.DynamicStyleType.Background,s.DynamicStyleType.Border,s.DynamicStyleType.Icon,s.DynamicStyleType.BorderRadius]);class b extends s.React.PureComponent{constructor(){super(...arguments),this.onTextChange=e=>{const t=this.getStyleFromCustom().set("text",e);this.props.onChange(t)},this.onIconChange=e=>{const t=this.getStyleFromCustom().set("iconProps",e);this.props.onChange(t)},this.onCommonChange=e=>{this.props.onChange((0,s.Immutable)(e))},this.onDynamicStyleSwitchChange=(e,t)=>{let s=this.getStyleFromCustom().set("enableDynamicStyle",t);t||(s=s.without("dynamicStyleConfig")),this.props.onChange(s)},this.onDynamicStyleBuilderConfigChange=e=>{const t=this.getStyleFromCustom().set("dynamicStyleConfig",e);this.props.onChange(t)},this.getStyleFromCustom=()=>this.props.style||(0,s.Immutable)({})}render(){const e=this.getStyleFromCustom(),{isTextSettingOpen:i,isIconSettingOpen:n,intl:a,appTheme:p,widgetId:c,useDataSources:g,expressions:h}=this.props,d=a.formatMessage({id:"text",defaultMessage:r.defaultMessages.text}),f=a.formatMessage({id:"icon",defaultMessage:s.defaultMessages.icon}),x=a.formatMessage({id:"dynamicStyleExpressionsLabel",defaultMessage:u});return(0,t.jsxs)("div",{className:"advance-style-setting mt-4",children:[i&&(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:d,isEmpty:C(e.text),bottomLine:!0,onReset:()=>{this.onTextChange(null)},children:(0,t.jsx)(y,{appTheme:p,text:e.text,onChange:this.onTextChange})})}),n&&(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(o.CollapsableResetPanel,{label:f,isEmpty:C(e.iconProps),bottomLine:!0,onReset:()=>{this.onIconChange(null)},children:(0,t.jsx)(m,{appTheme:p,intl:a,iconProps:e.iconProps,onChange:this.onIconChange})})}),(0,t.jsx)(S,{intl:a,style:e,onChange:this.onCommonChange}),this.props.useDataSourcesEnabled&&this.props.useDataSources&&this.props.useDataSources.length>0&&(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)(l.DynamicStyleBuilderSwitch,{widgetId:c,useDataSources:g,expressions:h,widgetDynamicContentCapability:"single",configuredExpressionsLabel:x,useIconsForArcade:!0,config:this.props.style.dynamicStyleConfig,conditionStyleTypes:v,arcacdeStyleTypes:T,switchChecked:this.props.style.enableDynamicStyle,onChange:this.onDynamicStyleBuilderConfigChange,onSwitchChange:this.onDynamicStyleSwitchChange})})]})}}class D extends s.React.PureComponent{render(){return(0,t.jsxs)("div",{className:"w-100",children:[(0,t.jsxs)(r.Label,{className:"collapse-label title3 hint-default mb-2 d-flex justify-content-between align-items-center",children:[this.props.title,(0,t.jsx)(r.Switch,{name:"open-collapse",onChange:this.props.toggle,checked:this.props.isOpen})]}),(0,t.jsx)(r.Collapse,{isOpen:this.props.isOpen,children:this.props.isOpen&&this.props.children})]})}}const I=(0,s.Immutable)([p.ExpressionInputType.Static,p.ExpressionInputType.Attribute,p.ExpressionInputType.Statistics,p.ExpressionInputType.Expression]),E=I.concat([p.ExpressionInputType.Arcade]),w=(0,s.Immutable)([s.DataSourceTypes.FeatureLayer,s.DataSourceTypes.SceneLayer,s.DataSourceTypes.BuildingComponentSubLayer,s.DataSourceTypes.OrientedImageryLayer,s.DataSourceTypes.ImageryLayer,s.DataSourceTypes.SubtypeGroupLayer,s.DataSourceTypes.SubtypeSublayer]);var j;!function(e){e.hover="HOVER",e.regular="REGULAR"}(j||(j={}));class k extends s.React.PureComponent{constructor(t){var o,n,r,a;super(t),this.onSettingLinkConfirm=e=>{let t;if(e){if(e.expression){const s=this.getTextExpression(),i=this.getTipExpression(),o=e.expression,n=this.mergeUseDataSources(s,i,o,null,this.props.useDataSources);t={id:this.props.id,config:this.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:n}}else{let i;if(this.getIsDataSourceUsed()){const e=this.getTextExpression(),t=this.getTipExpression();i=this.mergeUseDataSources(e,t,null,null,this.props.useDataSources)}else i=s.expressionUtils.getUseDataSourcesWithoutFields(this.props.useDataSources);t={id:this.props.id,config:this.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:i}}this.props.onSettingChange(t)}},this.onTextChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","text"],this.state.currentTextInput).setIn(["functionConfig","textExpression"],null),useDataSources:s.expressionUtils.getUseDataSourcesWithoutFields(this.props.useDataSources)};this.props.onSettingChange(e)},this.onToolTipChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTip"],this.state.currentTipInput).setIn(["functionConfig","toolTipExpression"],null),useDataSources:s.expressionUtils.getUseDataSourcesWithoutFields(this.props.useDataSources)};this.props.onSettingChange(e)},this.onTextExpChange=e=>{if(!e)return;const t=this.getTipExpression(),i=this.getLinkSettingExpression(),o=this.mergeUseDataSources((0,s.Immutable)(e),t,i,null,this.props.useDataSources);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","textExpression"],e).setIn(["functionConfig","text"],""),useDataSources:o}),this.setState({isTextExpOpen:!1})},this.onTipExpChange=e=>{if(!e)return;const t=this.getTextExpression(),i=this.getLinkSettingExpression(),o=this.mergeUseDataSources(t,(0,s.Immutable)(e),i,null,this.props.useDataSources);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTipExpression"],e).setIn(["functionConfig","toolTip"],""),useDataSources:o}),this.setState({isTipExpOpen:!1})},this.onToggleUseDataEnabled=e=>{var t,i,o,n,r,a;let p,l=this.props.config;e?(l=l.setIn(["functionConfig","textExpression"],this.getTextExpression()).setIn(["functionConfig","toolTipExpression"],this.getTipExpression()),l=l.set("functionConfig",l.functionConfig.without("text").without("toolTip")),(null===(o=null===(i=null===(t=this.props.config)||void 0===t?void 0:t.functionConfig)||void 0===i?void 0:i.linkParam)||void 0===o?void 0:o.linkType)===s.LinkType.WebAddress&&(l=l.setIn(["functionConfig","linkParam","expression"],this.getLinkSettingExpression()),l=l.setIn(["functionConfig","linkParam"],l.functionConfig.linkParam.without("value")))):(l=l.setIn(["functionConfig","text"],this.state.currentTextInput).setIn(["functionConfig","toolTip"],this.state.currentTipInput),l=l.set("functionConfig",l.functionConfig.without("textExpression").without("toolTipExpression")),(null===(a=null===(r=null===(n=this.props.config)||void 0===n?void 0:n.functionConfig)||void 0===r?void 0:r.linkParam)||void 0===a?void 0:a.linkType)===s.LinkType.WebAddress&&(l=l.setIn(["functionConfig","linkParam","value"],""),l=l.setIn(["functionConfig","linkParam"],l.functionConfig.linkParam.without("expression")))),({config:l,dynamicStyleUseDataSources:p}=this.resetDynamicStyle(l)),this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e,config:l,useDataSources:this.mergeUseDataSources(this.getTextExpression(),this.getTipExpression(),this.getLinkSettingExpression(),p,this.props.useDataSources)})},this.onDataSourceChange=e=>{const t=this.props.config,i=this.getDynamicStyleUseDataSources(t,(0,s.Immutable)(e));this.props.onSettingChange({id:this.props.id,useDataSources:this.mergeUseDataSources(this.getTextExpression(),this.getTipExpression(),this.getLinkSettingExpression(),i,(0,s.Immutable)(e),!1)})},this.onIconResultChange=t=>{let i;if(t){i=this.props.config;const s=this.props.config.getIn(["functionConfig","icon","position"])||e.Left;i=i.setIn(["functionConfig","icon","data"],t).setIn(["functionConfig","icon","position"],s)}else i=this.props.config.set("functionConfig",this.props.config.functionConfig.without("icon")).setIn(["styleConfig","customStyle","regular"],this.props.config.getIn(["styleConfig","customStyle","regular"],(0,s.Immutable)({})).without("iconProps")).setIn(["styleConfig","customStyle","hover"],this.props.config.getIn(["styleConfig","customStyle","hover"],(0,s.Immutable)({})).without("iconProps"));this.props.onSettingChange({id:this.props.id,config:i})},this.getWhetherHaveCustomStyle=e=>{const t=e?"regular":"hover";let s=this.props.config.getIn(["styleConfig","customStyle",t]);return s&&s.iconProps&&(s=s.without("iconProps")),!!(s&&Object.keys(s).length>0)},this.onRegularStyleChange=e=>{const t=this.props.config.setIn(["styleConfig","customStyle","regular"],e),s=this.getDynamicStyleUseDataSources(t),i=this.mergeUseDataSources(this.getTextExpression(),this.getTipExpression(),this.getLinkSettingExpression(),s,this.props.useDataSources);this.props.onSettingChange({id:this.props.id,config:t,useDataSources:i})},this.onHoverStyleChange=e=>{const t=this.props.config.setIn(["styleConfig","customStyle","hover"],e),s=this.getDynamicStyleUseDataSources(t),i=this.mergeUseDataSources(this.getTextExpression(),this.getTipExpression(),this.getLinkSettingExpression(),s,this.props.useDataSources);this.props.onSettingChange({id:this.props.id,config:t,useDataSources:i})},this.onIconPositionChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","icon","position"],e.target.value)})},this.onAdvanceTabSelect=e=>{const t=e===j.hover;i.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"isConfiguringHover",value:t})},this.mergeUseDataSources=(e,t,i,o,n,r=!0)=>{null===o&&(o=this.getDynamicStyleUseDataSources());const a=s.expressionUtils.generateFieldsForUseDataSourcesByExpressionParts(e&&e.parts,n),p=s.expressionUtils.generateFieldsForUseDataSourcesByExpressionParts(t&&t.parts,n),l=s.expressionUtils.generateFieldsForUseDataSourcesByExpressionParts(i&&i.parts,n);return this.mergeUseDataSourcesByDss(a,p,l,o,n,r)},this.mergeUseDataSourcesByDss=(e,t,i,o,n,r=!0)=>{const a=r?s.expressionUtils.getUseDataSourcesWithoutFields(n):n;let p=s.expressionUtils.mergeUseDataSources(a,e);return p=s.expressionUtils.mergeUseDataSources(p,t),p=s.expressionUtils.mergeUseDataSources(p,i),o&&o.length>0&&(p=o.reduce((e,t)=>s.expressionUtils.mergeUseDataSources(e,t),p)),p},this.getIsDataSourceUsed=()=>!!this.props.useDataSourcesEnabled,this.getDefaultExpression=e=>{let t=[];return e&&(t=[{type:s.ExpressionPartType.String,exp:`"${e}"`}]),(0,s.Immutable)({name:"",parts:t})},this.getTipExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTipExpression&&this.props.config.functionConfig.toolTipExpression||this.getDefaultExpression(this.state.currentTipInput),this.getTextExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.textExpression&&this.props.config.functionConfig.textExpression||this.getDefaultExpression(this.state.currentTextInput),this.getLinkSettingExpression=()=>{var e,t,i,o,n,r,a,p,l;return this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.expression||((null===(i=null===(t=null===(e=this.props.config)||void 0===e?void 0:e.functionConfig)||void 0===t?void 0:t.linkParam)||void 0===i?void 0:i.linkType)===s.LinkType.WebAddress&&(null===(r=null===(n=null===(o=this.props.config)||void 0===o?void 0:o.functionConfig)||void 0===n?void 0:n.linkParam)||void 0===r?void 0:r.value)?this.getDefaultExpression(null===(l=null===(p=null===(a=this.props.config)||void 0===a?void 0:a.functionConfig)||void 0===p?void 0:p.linkParam)||void 0===l?void 0:l.value):null)},this.getDynamicStyleUseDataSources=(e=this.props.config,t=this.props.useDataSources)=>{var i,o,n,r,a,p,l;const u=[];return this.props.useDataSourcesEnabled&&(null===(i=null==e?void 0:e.styleConfig)||void 0===i?void 0:i.useCustom)&&this.props.useDataSources&&this.props.useDataSources.length>0?((null===(r=null===(n=null===(o=null==e?void 0:e.styleConfig)||void 0===o?void 0:o.customStyle)||void 0===n?void 0:n.regular)||void 0===r?void 0:r.dynamicStyleConfig)&&u.push(s.dynamicStyleUtils.generateFieldsForUseDataSourcesByDynamicStyle(e.styleConfig.customStyle.regular.dynamicStyleConfig,t)),(null===(l=null===(p=null===(a=null==e?void 0:e.styleConfig)||void 0===a?void 0:a.customStyle)||void 0===p?void 0:p.hover)||void 0===l?void 0:l.dynamicStyleConfig)&&u.push(s.dynamicStyleUtils.generateFieldsForUseDataSourcesByDynamicStyle(e.styleConfig.customStyle.hover.dynamicStyleConfig,t)),u):u},this.resetDynamicStyle=e=>{var t,s,i,o;(null===(s=null===(t=null==e?void 0:e.styleConfig)||void 0===t?void 0:t.customStyle)||void 0===s?void 0:s.regular)&&(e=(e=e.setIn(["styleConfig","customStyle","regular","enableDynamicStyle"],!1)).setIn(["styleConfig","customStyle","regular"],e.styleConfig.customStyle.regular.without("dynamicStyleConfig"))),(null===(o=null===(i=null==e?void 0:e.styleConfig)||void 0===i?void 0:i.customStyle)||void 0===o?void 0:o.hover)&&(e=(e=e.setIn(["styleConfig","customStyle","hover","enableDynamicStyle"],!1)).setIn(["styleConfig","customStyle","hover"],e.styleConfig.customStyle.hover.without("dynamicStyleConfig")));return{config:e,dynamicStyleUseDataSources:this.getDynamicStyleUseDataSources(e)}},this.openTextExpPopup=()=>{this.setState({isTextExpOpen:!0,isTipExpOpen:!1})},this.openTipExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!0})},this.closeTextExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!1})},this.closeTipExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!1})},this.showTextSetting=()=>!!(this.getIsDataSourceUsed()?!this.props.config.getIn(["functionConfig","textExpression"])||this.props.config.getIn(["functionConfig","textExpression"])&&this.props.config.getIn(["functionConfig","textExpression","parts"])&&(this.props.config.getIn(["functionConfig","textExpression","parts"]).length>1||'""'!==this.props.config.getIn(["functionConfig","textExpression","parts","0","exp"])):this.state.currentTextInput),this.showIconSetting=()=>!!this.props.config.getIn(["functionConfig","icon"]),this.toggleUseCustom=()=>{let e,t=this.props.config;t=t.setIn(["styleConfig","useCustom"],!t.getIn(["styleConfig","useCustom"])),t.getIn(["styleConfig","useCustom"])?(t=t.setIn(["styleConfig","customStyle","hover"],{}),t=t.setIn(["styleConfig","customStyle","regular"],{})):t=t.set("styleConfig",t.styleConfig.without("customStyle")),({config:t,dynamicStyleUseDataSources:e}=this.resetDynamicStyle(t)),this.props.onSettingChange({id:this.props.id,config:t,useDataSources:this.mergeUseDataSources(this.getTextExpression(),this.getTipExpression(),this.getLinkSettingExpression(),e,this.props.useDataSources)})},this.state={isTextExpOpen:!1,isTipExpOpen:!1,currentTextInput:"string"==typeof(null===(n=null===(o=this.props.config)||void 0===o?void 0:o.functionConfig)||void 0===n?void 0:n.text)?null===(a=null===(r=this.props.config)||void 0===r?void 0:r.functionConfig)||void 0===a?void 0:a.text:this.getDefaultText(),currentTipInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip||""}}componentDidUpdate(e){var t,s,i,o,n,r,a,p,l,u,c,g;this.getIsDataSourceUsed()||((null===(s=null===(t=this.props.config)||void 0===t?void 0:t.functionConfig)||void 0===s?void 0:s.text)!==(null===(o=null===(i=e.config)||void 0===i?void 0:i.functionConfig)||void 0===o?void 0:o.text)&&this.setState({currentTextInput:"string"==typeof(null===(r=null===(n=this.props.config)||void 0===n?void 0:n.functionConfig)||void 0===r?void 0:r.text)?null===(p=null===(a=this.props.config)||void 0===a?void 0:a.functionConfig)||void 0===p?void 0:p.text:this.getDefaultText()}),(null===(u=null===(l=this.props.config)||void 0===l?void 0:l.functionConfig)||void 0===u?void 0:u.toolTip)!==(null===(g=null===(c=e.config)||void 0===c?void 0:c.functionConfig)||void 0===g?void 0:g.toolTip)&&this.setState({currentTipInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip||""}))}componentWillUnmount(){i.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"isConfiguringHover",value:!1})}getDefaultText(){const{config:e,intl:t}=this.props;return void 0===e.functionConfig.text&&void 0===e.functionConfig.textExpression?t.formatMessage({id:"variableButton",defaultMessage:r.defaultMessages.variableButton}):""}render(){var i,l,u,c;const g=(null===(i=this.props.config.functionConfig.icon)||void 0===i?void 0:i.data)||null,h=(null===(l=this.props.config.functionConfig)||void 0===l?void 0:l.customIcons)||null,d=this.props.config.styleConfig&&this.props.config.styleConfig.customStyle,f=this.showTextSetting(),S=this.showIconSetting(),x=f&&S,m=this.props.useDataSourcesEnabled?[this.getTextExpression()]:null;return(0,t.jsx)("div",{css:(y=this.props.theme,s.css`
    .widget-setting-link {
      overflow-y: auto;
      font-size: 13px;
      font-weight: lighter;
      .collapse-label{
        color: ${y.ref.palette.neutral[900]};
      }
      .font-size-container{
        width: ${s.polished.rem(82)};
      }
      .advance-style-setting{
        padding: 0 ${s.polished.rem(4)};
      }
      .px-14{
        padding-left: ${s.polished.rem(14)} !important;
        padding-right: ${s.polished.rem(14)} !important;
      }
    }
    .tab-label{
      font-weight: 500 !important;
    }

  `),children:(0,t.jsx)("div",{className:"widget-setting-link jimu-widget",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(o.SettingSection,{children:(0,t.jsx)(o.SettingRow,{children:(0,t.jsx)("div",{className:"choose-ds w-100",children:(0,t.jsx)(a.DataSourceSelector,{types:w,useDataSources:this.props.useDataSources,useDataSourcesEnabled:this.getIsDataSourceUsed(),onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.onDataSourceChange,widgetId:this.props.id})})})}),(0,t.jsxs)(o.SettingSection,{children:[(0,t.jsx)(o.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"setLink",defaultMessage:r.defaultMessages.setLink}),children:(0,t.jsx)(o.LinkSelector,{onSettingConfirm:this.onSettingLinkConfirm,linkParam:this.props.config.functionConfig.linkParam,useDataSources:this.getIsDataSourceUsed()&&this.props.useDataSources,widgetId:this.props.id})}),(0,t.jsx)(o.SettingRow,{label:this.props.intl.formatMessage({id:"tooltip",defaultMessage:r.defaultMessages.tooltip})}),(0,t.jsx)(o.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"tooltip",defaultMessage:r.defaultMessages.tooltip}),children:this.getIsDataSourceUsed()?(0,t.jsx)("div",{className:"w-100",children:(0,t.jsx)(p.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.onTipExpChange,openExpPopup:this.openTipExpPopup,expression:this.getTipExpression(),isExpPopupOpen:this.state.isTipExpOpen,closeExpPopup:this.closeTipExpPopup,types:I,widgetId:this.props.id,"aria-label":this.props.intl.formatMessage({id:"tooltip",defaultMessage:r.defaultMessages.tooltip})})}):(0,t.jsx)(r.TextInput,{className:"w-100",value:this.state.currentTipInput,size:"sm",onChange:e=>{this.setState({currentTipInput:e.target.value})},onBlur:()=>{this.onToolTipChange()},onPressEnter:()=>{this.onToolTipChange()},"aria-label":this.props.intl.formatMessage({id:"tooltip",defaultMessage:r.defaultMessages.tooltip})})}),(0,t.jsx)(o.SettingRow,{label:this.props.intl.formatMessage({id:"text",defaultMessage:r.defaultMessages.text})}),(0,t.jsx)(o.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"text",defaultMessage:r.defaultMessages.text}),children:this.getIsDataSourceUsed()?(0,t.jsx)("div",{className:"w-100",children:(0,t.jsx)(p.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.onTextExpChange,openExpPopup:this.openTextExpPopup,expression:this.getTextExpression(),isExpPopupOpen:this.state.isTextExpOpen,closeExpPopup:this.closeTextExpPopup,types:E,widgetId:this.props.id})}):(0,t.jsx)(r.TextInput,{className:"w-100",value:this.state.currentTextInput,size:"sm",onChange:e=>{this.setState({currentTextInput:e.target.value})},onBlur:()=>{this.onTextChange()},onPressEnter:()=>{this.onTextChange()}})}),(0,t.jsx)(o.SettingRow,{label:this.props.intl.formatMessage({id:"icon",defaultMessage:s.defaultMessages.icon}),children:(0,t.jsx)(n.IconPicker,{icon:g,customIcons:h,configurableOption:"none",onChange:this.onIconResultChange,"aria-label":this.props.intl.formatMessage({id:"icon",defaultMessage:s.defaultMessages.icon}),setButtonUseColor:!1})}),x&&(0,t.jsx)(o.SettingRow,{label:this.props.intl.formatMessage({id:"position",defaultMessage:r.defaultMessages.position}),children:(0,t.jsx)("div",{children:(0,t.jsx)(r.Select,{onChange:this.onIconPositionChange,size:"sm",value:this.props.config.functionConfig&&this.props.config.functionConfig.icon&&this.props.config.functionConfig.icon.position,"aria-label":this.props.intl.formatMessage({id:"position",defaultMessage:r.defaultMessages.position}),children:Object.keys(e).map(s=>(0,t.jsx)("option",{value:e[s],children:this.props.intl.formatMessage({id:s.toLowerCase(),defaultMessage:r.defaultMessages[s.toLowerCase()]})},s))})})})]}),(0,t.jsx)(o.SettingSection,{className:"px-14",children:(0,t.jsx)(D,{title:this.props.intl.formatMessage({id:"advance",defaultMessage:r.defaultMessages.advance}),isOpen:!!(null===(c=null===(u=this.props.config)||void 0===u?void 0:u.styleConfig)||void 0===c?void 0:c.useCustom),toggle:this.toggleUseCustom,children:(0,t.jsxs)(r.Tabs,{fill:!0,type:"pills",className:"w-100 h-100",css:s.css`
                    & > .tab-content {
                      overflow: hidden;
                    }
                  `,onChange:this.onAdvanceTabSelect,defaultValue:j.regular,children:[(0,t.jsx)(r.Tab,{className:"tab-label",id:j.regular,title:this.props.intl.formatMessage({id:"default",defaultMessage:r.defaultMessages.default}),children:(0,t.jsx)(b,{intl:this.props.intl,appTheme:this.props.theme2,style:d&&d.regular,onChange:this.onRegularStyleChange,isTextSettingOpen:f,isIconSettingOpen:S,widgetId:this.props.id,useDataSourcesEnabled:this.props.useDataSourcesEnabled,useDataSources:this.props.useDataSources,expressions:m})}),(0,t.jsx)(r.Tab,{className:"tab-label",id:j.hover,title:this.props.intl.formatMessage({id:"hover",defaultMessage:r.defaultMessages.hover}),children:(0,t.jsx)(b,{intl:this.props.intl,appTheme:this.props.theme2,style:d&&d.hover,onChange:this.onHoverStyleChange,isTextSettingOpen:f,isIconSettingOpen:S,widgetId:this.props.id,useDataSourcesEnabled:this.props.useDataSourcesEnabled,useDataSources:this.props.useDataSources,expressions:m})})]})})})]})})});var y}}function P(e){h.p=e}})(),d})())}}});