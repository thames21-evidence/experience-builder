System.register(["jimu-core/emotion","jimu-core","jimu-arcgis","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/basic/list-tree","jimu-ui/advanced/utility-selector","jimu-for-builder/service","jimu-theme","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],function(e,t){var l={},o={},i={},n={},a={},r={},s={},u={},d={},c={},p={},m={},v={};return{setters:[function(e){l.jsx=e.jsx,l.jsxs=e.jsxs},function(e){o.AllDataSourceTypes=e.AllDataSourceTypes,o.DataSourceManager=e.DataSourceManager,o.DataSourceTypes=e.DataSourceTypes,o.Immutable=e.Immutable,o.LayoutType=e.LayoutType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.ServiceManager=e.ServiceManager,o.SessionManager=e.SessionManager,o.SupportedUtilityType=e.SupportedUtilityType,o.UtilityManager=e.UtilityManager,o.classNames=e.classNames,o.css=e.css,o.defaultMessages=e.defaultMessages,o.esri=e.esri,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,o.moduleLoader=e.moduleLoader,o.polished=e.polished,o.portalUrlUtils=e.portalUrlUtils},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.builderAppSync=e.builderAppSync,n.getAppConfigAction=e.getAppConfigAction},function(e){a.Alert=e.Alert,a.AlertPopup=e.AlertPopup,a.Button=e.Button,a.Checkbox=e.Checkbox,a.CollapsablePanel=e.CollapsablePanel,a.Dropdown=e.Dropdown,a.DropdownButton=e.DropdownButton,a.DropdownItem=e.DropdownItem,a.DropdownMenu=e.DropdownMenu,a.Icon=e.Icon,a.Loading=e.Loading,a.LoadingType=e.LoadingType,a.MultiSelect=e.MultiSelect,a.MultiSelectItem=e.MultiSelectItem,a.NumericInput=e.NumericInput,a.Option=e.Option,a.Radio=e.Radio,a.Select=e.Select,a.Switch=e.Switch,a.TextArea=e.TextArea,a.TextInput=e.TextInput,a.Tooltip=e.Tooltip,a.defaultMessages=e.defaultMessages},function(e){r.MapWidgetSelector=e.MapWidgetSelector,r.SettingRow=e.SettingRow,r.SettingSection=e.SettingSection,r.SidePopper=e.SidePopper},function(e){s.List=e.List,s.TreeItemActionType=e.TreeItemActionType},function(e){u.UtilitySelector=e.UtilitySelector,u.addNewUtility=e.addNewUtility,u.extractService=e.extractService},function(e){d.appServices=e.appServices},function(e){c.colorUtils=e.colorUtils,c.getAppThemeVariables=e.getAppThemeVariables,c.styled=e.styled},function(e){p.DataSourceSelector=e.DataSourceSelector},function(e){m.SizeColorSetting=e.SizeColorSetting},function(e){v.ColorPicker=e.ColorPicker}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=c},3158:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA4NyA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHdpZHRoPSI4NyIgaGVpZ2h0PSI2NCIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMyIgeT0iNTIiIHdpZHRoPSI4MSIgaGVpZ2h0PSI4IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04NCAyNUgzVjI5SDg0VjI1Wk00MyAzN0gzVjQxSDQzVjM3WiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iMTQiIHk9IjUiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MyIgeT0iNSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjMiIHk9IjE2IiB3aWR0aD0iODEiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMyIgeT0iMTYiIHdpZHRoPSI0MCIgaGVpZ2h0PSIxIiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},4108:e=>{"use strict";e.exports=n},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},12046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},13089:e=>{"use strict";e.exports=p},14321:e=>{"use strict";e.exports=a},15417:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNDYiIHZpZXdCb3g9IjAgMCA4NyA0NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHk9IjE2IiB3aWR0aD0iODciIGhlaWdodD0iMzAiIGZpbGw9IiMyODI4MjgiLz4NCjxyZWN0IHg9IjQiIHk9IjIzIiB3aWR0aD0iNzkiIGhlaWdodD0iNiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iNCIgeT0iMzgiIHdpZHRoPSI0MCIgaGVpZ2h0PSIzIiBmaWxsPSIjNDQ0NDQ0Ii8+DQo8cmVjdCB4PSI2MyIgeT0iMzYiIHdpZHRoPSIyMCIgaGVpZ2h0PSI3IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzUyNTI1MiIvPg0KPC9zdmc+DQo="},15562:e=>{"use strict";e.exports=m},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},29435:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8"></path></svg>'},31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},50170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},54337:e=>{"use strict";e.exports=v},62686:e=>{"use strict";e.exports=i},67386:e=>{"use strict";e.exports=l},71371:e=>{"use strict";e.exports=u},79244:e=>{"use strict";e.exports=o},79298:e=>{"use strict";e.exports=r},79860:e=>{"use strict";e.exports=d},98640:e=>{"use strict";e.exports=s}},t={};function h(l){var o=t[l];if(void 0!==o)return o.exports;var i=t[l]={exports:{}};return e[l](i,i.exports,h),i.exports}h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},h.d=(e,t)=>{for(var l in t)h.o(t,l)&&!h.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="";var g={};return h.p=window.jimuConfig.baseUrl,(()=>{"use strict";h.r(g),h.d(g,{__set_webpack_public_path__:()=>pl,default:()=>cl});var e=h(67386),t=h(79244),l=h(62686),o=h(4108),i=h(14321),n=h(79298);const a="CIMMarkerNorthArrow",r={color:"#000",size:"4px"};var s,u,d;!function(e){e.ExportWebMap="ExportWebMap",e.GetLayoutTemplatesInfo="GetLayoutTemplatesInfo",e.GetReportTemplatesInfo="GetReportTemplatesInfo"}(s||(s={})),function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(u||(u={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(d||(d={}));const c={layoutOptions:{customTextElements:[],hasAuthorText:!0,hasCopyrightText:!0,hasLegend:!0,hasTitleText:!0},mapSurroundInfos:[],pageSize:null,pageUnits:null,webMapFrameSize:null},p={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:u.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:null,wkidLabel:null,enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var m,v,f,y,b,x,T,S,w;!function(e){e.LayoutTemplate="Layout Template",e.ReportTemplate="Report Template"}(m||(m={})),function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(v||(v={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(f||(f={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(y||(y={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(b||(b={})),function(e){e.PrintTemplate="PRINT TEMPLATE",e.PrintResult="PRINT RESULT"}(x||(x={})),function(e){e.ServiceLayout="Service Layout",e.CustomLayout="Custom Layout"}(T||(T={})),function(e){e.RPTT="RPTT",e.RPTX="RPTX"}(S||(S={})),function(e){e.ServiceReport="Service Report",e.CustomReport="Custom Report"}(w||(w={}));const I={printSource:"Source",selectMap:"Select a map widget with 2D data",printMode:"Mode",printClassic:"Classic",printCompact:"Compact",configurePrintTemplate:"Print template",printService:"Print service",useOrganizationService:"Use organization service",printCustomize:"Customize",printTemplate:"Print template",useOrganizationTemplate:"Use organization template",newPrintTemplate:"New print template",newTemplate:"New template",templateCommonSettings:"Template common settings",setDefaults:"Set defaults",printTitle:"Title",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",allowEditing:"Select settings that allow editing at runtime",wellKnownId:"Enter a well-known ID ({wkid})",includeAttribution:"Include attribution",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",fileFormat:"File format",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",overrideCommonSettings:"Override common settings",printTemplateAuthor:"Author",copyright:"Copyright",legend:"Legend",scaleBarUnit:"Scalebar unit",miles:"Miles",kilometers:"Kilometers",meters:"Meters",feet:"Feet",mapAttribution:"Map attribution",utilityPlaceholder:'Click the "Select utility" button to add utilities for further configurations.',featureAttributes:"Feature attributes",includeAttributes:"Include attributes",northArrow:"North arrow",includeNorthArrow:"Include north arrow",serviceIsNotAvailable:"Service is not available.",printPreviewStyle:"Print preview style",enablePrintPreview:"Enable print preview",useServiceLayout:"Use service layout",useCustomLayout:"Use layout from layout item",useServiceReport:"Use service report",useCustomReport:"Use report from report item",report:"Report",reportRemind:"The report can only be generated in PDF format. If you want to print the report only, please choose the MAP_ONLY layout option.",reportNotConfigured:"The report is not configured with any data.",selectLayoutItemPlaceholder:"Select an layout item",selectReportItemPlaceholder:"Select a report item",checkingReport:"Checking report",notSupportReport:"Report template is not supported.",untitledTemplate:"Untitled template",includeElementOverrides:"Include {name}",wkidRemind:"Leave empty to use the basemap's spatial reference. Enter a valid WKID (e.g., 3857) to override.",wkidSettingPlaceholder:"Basemap: {wkid}"};var C=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const j=e=>C(void 0,void 0,void 0,function*(){return q(e).then(e=>t.ServiceManager.getInstance().fetchArcGISServerInfo(e).then(e=>Promise.resolve(null==e?void 0:e.owningSystemUrl),e=>Promise.reject(new Error(e))))}),O=(e,l,o)=>C(void 0,void 0,void 0,function*(){const i=null==l?void 0:l.id;return i?R(i,null==e?void 0:e.useUtility,m.LayoutTemplate).then(i=>{var n,a;const r=null==i?void 0:i[0];let s=((null==e?void 0:e.printTemplateType)===y.Customize?null===(n=e.printCustomTemplate)||void 0===n?void 0:n.asMutable({deep:!0}):null===(a=e.printOrgTemplate)||void 0===a?void 0:a.asMutable({deep:!0}))[o];s.customLayoutItem=l,s=function(e,l){if(!e||!l)return l;(null==e?void 0:e.webMapFrameSize)&&(l.mapFrameSize=null==e?void 0:e.webMapFrameSize),(null==e?void 0:e.pageUnits)&&(l.mapFrameUnit=null==e?void 0:e.pageUnits);const o=null==e?void 0:e.layoutOptions,i=(0,t.Immutable)(o).without("hasAuthorText","hasCopyrightText","hasLegend","hasTitleText");l.layoutOptions=null==i?void 0:i.asMutable({deep:!0}),l=A(l,o),o&&(l.layout="");return l}(r,s);const u=X(e,o,s);return Promise.resolve(u)},e=>Promise.reject(new Error(e))).catch(e=>Promise.reject(new Error(e))):Promise.reject(new Error("No custom layout item id"))}),R=(e,t,l)=>C(void 0,void 0,void 0,function*(){return q(t).then(t=>Q(t,l,e))});function N(e,l,o,i){return C(this,void 0,void 0,function*(){var n;let a=null===(n=V((0,t.Immutable)(l),(0,t.Immutable)(p)))||void 0===n?void 0:n.asMutable({deep:!0});a=yield function(e,t){return C(this,void 0,void 0,function*(){var l;const{layoutChoiceList:o,defaultCustomLayoutItem:i,defaultLayout:n,supportCustomLayout:a}=null==e?void 0:e.asMutable({deep:!0});let r=T.ServiceLayout;e.layoutChoiceList&&0!==(null===(l=e.layoutChoiceList)||void 0===l?void 0:l.length)||(r=T.CustomLayout);let s={layoutTypes:r};if(a&&i){const l={defaultCustomLayoutItem:i,defaultLayout:n,supportCustomLayout:a};s=yield k(l,e.useUtility),t.customLayoutItem=(null==s?void 0:s.customLayoutItem)||null;const o=null==s?void 0:s.templateInfo;o&&(t.layoutOptions=null==o?void 0:o.layoutOptions,t.mapFrameUnit=null==o?void 0:o.pageUnits,t.mapFrameSize=null==o?void 0:o.webMapFrameSize)}else null==o||o.forEach((e,l)=>{let o=!1;n?n===(null==e?void 0:e.layoutTemplate)&&(o=!0):0===l&&(o=!0);const i={};o&&(t=Object.assign(Object.assign({},t),e)),s.templateInfo=i});return t.layoutTypes=null==s?void 0:s.layoutTypes,Promise.resolve(t)})}(e,l),a=yield function(e,t){return C(this,void 0,void 0,function*(){const{reportTemplateChoiceList:l,defaultCustomReportItem:o,defaultReportTemplate:i,supportReport:n,supportCustomReport:a}=null==e?void 0:e.asMutable({deep:!0}),r={defaultReportTemplate:i,supportCustomReport:a,defaultCustomReportItem:o,supportReport:n},s=yield P(l,r,e.useUtility);return s&&(t.reportTypes=null==s?void 0:s.reportTypes,t.customReportItem=(null==s?void 0:s.customReportItem)||null,t.report=(null==s?void 0:s.report)||null,t.reportOptions=(null==s?void 0:s.reportOptions)||null),Promise.resolve(t)})}(e,a);const r=function(e,t){var l,o;let i=1,n=t;const a=(null==e?void 0:e.printTemplateType)===y.Customize?null===(l=e.printCustomTemplate)||void 0===l?void 0:l.asMutable({deep:!0}):null===(o=e.printOrgTemplate)||void 0===o?void 0:o.asMutable({deep:!0});return null==a||a.forEach(e=>{e.label===n&&(i+=1,n=`${t} ${i}`)}),n}(e,i);return a.format=e.defaultFormat,a.selectedFormatList=[e.defaultFormat],a.templateId=o,a.label=r,a.overrideCommonSetting=!1,Promise.resolve(a)})}const M=(e,l,o)=>C(void 0,void 0,void 0,function*(){const i=U(null==l?void 0:l.utilityId);return function(e){const l={query:{f:"json"},responseType:"json"};return(0,t.loadArcGISJSAPIModules)(["esri/request"]).then(t=>{const[o]=t;return o(e,l).then(e=>function(e){return B(this,void 0,void 0,function*(){let t=!1,l=!1;const o=(null==e?void 0:e.parameters)||[],i="web_map_as_json",n="output_file",a="layout_item_id",r="layout_template",s="report_template",u="report_item_id";let d=[],c=[],p="pdf",m=!1,v=!1,h=!1,g="",f="",y="",b="";return null==o||o.forEach(e=>{var t,l;if("Format"===e.name){const o=(null===(t=null==e?void 0:e.choiceList)||void 0===t?void 0:t.map(e=>null==e?void 0:e.toLowerCase()))||[];if(e.defaultValue)p=null===(l=e.defaultValue)||void 0===l?void 0:l.toLowerCase();else if((null==o?void 0:o.length)>0){const e=[];null==o||o.forEach(t=>{(t.includes("pdf")||t.includes("png"))&&e.push(t)}),p=(null==e?void 0:e[0])||o[0]}c=o}}),null==o||o.forEach(e=>{if("Layout_Template"===e.name){const t=e.choiceList,l=e.defaultValue;t?d=null==t?void 0:t.map(e=>de(e,c,p)):d.push(de(l,c,p))}e.name.toLowerCase()===r&&(g=(null==e?void 0:e.defaultValue)||""),e.name.toLowerCase()===a&&(m=!0,f=null==e?void 0:e.defaultValue),e.name.toLowerCase()===s&&(h=!0,y=(null==e?void 0:e.defaultValue)||""),e.name.toLowerCase()===u&&(v=!0,b=null==e?void 0:e.defaultValue),"string"==typeof e.name&&e.name.toLowerCase()===i&&(t=!0),"string"==typeof e.name&&e.name.toLowerCase()===n&&(l=!0)}),Promise.resolve({templates:d,formatList:c,defaultFormat:p,defaultReportTemplate:y,defaultCustomReportItem:b,hasWebmapParam:t,hasOutputParam:l,supportCustomLayout:m,supportReport:h,supportCustomReport:v,defaultLayout:g,defaultCustomLayoutItem:f})})}(null==e?void 0:e.data))})}(e).then(t=>{let n=o;return Q(e,m.LayoutTemplate).then(a=>C(void 0,void 0,void 0,function*(){let r;if(t.supportCustomReport||t.supportReport){const o=(yield Q(e,m.ReportTemplate))||[],i=L(o);n=n.set("reportTemplateChoiceList",i).set("defaultReportTemplate",null==t?void 0:t.defaultReportTemplate).set("defaultCustomReportItem",null==t?void 0:t.defaultCustomReportItem),r=yield P(o,t,l)}const s=yield k(t,l),u={templateTaskInfo:a,templatesInTask:null==t?void 0:t.templates,reportOption:r,defaultLayoutOptionInfo:s,printTemplateType:null==o?void 0:o.printTemplateType,printServiceType:i},d=E(u),c=z(null==t?void 0:t.templates,d);return n=n.set("printCustomTemplate",d).set("useUtility",l).set("formatList",null==t?void 0:t.formatList).set("defaultFormat",null==t?void 0:t.defaultFormat).set("layoutChoiceList",c).set("supportCustomLayout",t.supportCustomLayout||!1).set("supportReport",t.supportReport||!1).set("supportCustomReport",t.supportCustomReport||!1).setIn(["commonSetting","forceFeatureAttributes"],t.supportReport||t.supportCustomReport||!1),Promise.resolve(n)}))})}),k=(e,t)=>C(void 0,void 0,void 0,function*(){var l;const o={layoutTypes:T.ServiceLayout};if((null==e?void 0:e.supportCustomLayout)&&(null==e?void 0:e.defaultCustomLayoutItem)){const i=yield R(null===(l=null==e?void 0:e.defaultCustomLayoutItem)||void 0===l?void 0:l.id,t,m.ReportTemplate),n=null==i?void 0:i[0];o.customLayoutItem=null==e?void 0:e.defaultCustomLayoutItem,o.templateInfo=n}return Promise.resolve(o)}),P=(e,t,l)=>C(void 0,void 0,void 0,function*(){var o,i,n,a,r;if(!(null==t?void 0:t.supportCustomReport)||!(null==t?void 0:t.supportReport))return null;const s={reportTypes:w.ServiceReport};if((null==t?void 0:t.supportReport)&&(null==t?void 0:t.defaultReportTemplate)){let l;null==e||e.forEach(e=>{(null==e?void 0:e.reportTemplate)===(null==t?void 0:t.defaultReportTemplate)&&(l=null==e?void 0:e.reportOptions)}),s.report=null==t?void 0:t.defaultReportTemplate,s.reportOptions=l}if((null==t?void 0:t.supportCustomReport)&&(null==t?void 0:t.defaultCustomReportItem)){const e=yield R(null===(o=null==t?void 0:t.defaultCustomReportItem)||void 0===o?void 0:o.id,l,m.ReportTemplate),u=null===(i=null==e?void 0:e[0])||void 0===i?void 0:i.reportOptions;s.customReportItem={id:null===(n=null==t?void 0:t.defaultCustomReportItem)||void 0===n?void 0:n.id,title:(null===(a=null==e?void 0:e[0])||void 0===a?void 0:a.reportTemplate)||(null===(r=null==t?void 0:t.defaultCustomReportItem)||void 0===r?void 0:r.id)},s.reportOptions=u,s.reportTypes=w.CustomReport}return Promise.resolve(s)}),L=e=>{if(!e)return[];return e.filter(e=>Y(null==e?void 0:e.reportOptions)===S.RPTX)},A=(e,t)=>{var l,o;if(!t)return e;const i=null===(l=null==t?void 0:t.customTextElements)||void 0===l?void 0:l.map(e=>{const t={};for(const l in e)t[l]=!0;return t}),n=D(t);return e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText,e.layoutOptions.customTextElements=(null==t?void 0:t.customTextElements)||[],e.layoutOptions.elementOverrides=n,e.customTextElementEnableList=i||[],e.enableNorthArrow=!!J(n),e.enableLegend=e.hasLegend,e.enableAuthor=e.hasAuthorText,e.enableCopyright=e.hasCopyrightText,e.enableScalebarUnit=!0,e.hasLegend&&(null==e?void 0:e.layoutOptions)&&(e.layoutOptions.legendLayers=[]),(null===(o=e.layoutOptions)||void 0===o?void 0:o.scalebarUnit)||(e.layoutOptions.scalebarUnit="Miles"),e},E=e=>{const{templateTaskInfo:t,templatesInTask:l,reportOption:o,defaultLayoutOptionInfo:i,printServiceType:n,printTemplateType:a}=e,r=l?re(l,n,a):[],s=null==r?void 0:r.map(e=>{var l;let n;if(t&&0!==(null==t?void 0:t.length)?t.forEach(t=>{e.label===t.layoutTemplate&&(n=t)}):n=c,(null==e?void 0:e.layout)&&(e.layout=H(null==e?void 0:e.layout)),(null==e?void 0:e.format)&&(e.format=null===(l=null==e?void 0:e.format)||void 0===l?void 0:l.toLowerCase()),(null==n?void 0:n.webMapFrameSize)&&(e.mapFrameSize=null==n?void 0:n.webMapFrameSize,e.mapFrameUnit=null==n?void 0:n.pageUnits),(e=A(e,null==n?void 0:n.layoutOptions)).mapFrameUnit=null==n?void 0:n.pageUnits,e.selectedFormatList=[null==e?void 0:e.format],"boolean"!=typeof e.showLabels&&(e.showLabels=!0),o&&((null==o?void 0:o.customReportItem)&&(e.customReportItem=null==o?void 0:o.customReportItem),(null==o?void 0:o.report)&&(e.report=null==o?void 0:o.report),(null==o?void 0:o.reportOptions)&&(e.reportOptions=null==o?void 0:o.reportOptions),(null==o?void 0:o.reportTypes)&&(e.reportTypes=null==o?void 0:o.reportTypes)),i){(null==i?void 0:i.layoutTypes)&&(e.layoutTypes=null==i?void 0:i.layoutTypes),(null==i?void 0:i.customLayoutItem)&&(e.customLayoutItem=null==i?void 0:i.customLayoutItem);const t=null==i?void 0:i.templateInfo;t&&((null==t?void 0:t.layoutOptions)&&(e.layoutOptions=null==t?void 0:t.layoutOptions),(null==t?void 0:t.pageUnits)&&(e.mapFrameUnit=null==t?void 0:t.pageUnits),(null==t?void 0:t.webMapFrameSize)&&(e.mapFrameSize=null==t?void 0:t.webMapFrameSize))}return e});return s},D=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],l={};return null==t||t.forEach(e=>{e.type===a&&(e.visible=!0),l[e.name]=e}),l},z=(e,t)=>{const l=(null==e?void 0:e.map(e=>{e.layoutTemplate=H(null==e?void 0:e.layout);const l=Z(null==e?void 0:e.layout);return null==t||t.forEach(t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText,!l&&(e.layoutOptions=null==t?void 0:t.layoutOptions),e.customTextElementEnableList=null==t?void 0:t.customTextElementEnableList,e.enableNorthArrow=t.enableNorthArrow,e.enableLegend=t.hasLegend,e.enableAuthor=t.hasAuthorText,e.enableCopyright=t.hasCopyrightText,e.enableScalebarUnit=!0,e.enableNorthArrow=null==t?void 0:t.enableNorthArrow)}),e}))||[];return l},U=e=>{const l=t.UtilityManager.getInstance().getUtilityJson(e);return"org"===(null==l?void 0:l.source)?f.OrganizationService:f.Customize};var $,B=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};!function(e){e.AsynchronousSubmit="esriExecutionTypeAsynchronous",e.SynchronousExecute="esriExecutionTypeSynchronous"}($||($={}));const F=(e,t)=>e===f.Customize||t===y.Customize?"custom":"org",V=(e,l)=>{let o=l;return(null==e?void 0:e.exportOptions)&&(o=o.set("exportOptions",Object.assign(Object.assign({},e.exportOptions||{}),(null==l?void 0:l.exportOptions)||{}))),(null==e?void 0:e.layoutOptions)&&(null==l?void 0:l.layoutOptions)&&(o=o.set("layoutOptions",Object.assign(Object.assign({},(null==e?void 0:e.layoutOptions)||{}),(null==l?void 0:l.layoutOptions)||{}))),(0,t.Immutable)(Object.assign(Object.assign({},e),o))},G=(e,t)=>{let l;return null==e||e.forEach((e,o)=>{(null==e?void 0:e.templateId)===t&&(l=o)}),l},W=(e,t)=>e===f.Customize||t===y.Customize,H=e=>e,Z=e=>"map-only"===(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===l?void 0:l.toLowerCase()})(e),q=e=>B(void 0,void 0,void 0,function*(){return t.UtilityManager.getInstance().getUrlOfUseUtility(e).then(e=>Promise.resolve(e))});function Q(e,l,o){return B(this,void 0,void 0,function*(){const i={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"},n=yield(a=e,C(void 0,void 0,void 0,function*(){return t.ServiceManager.getInstance().fetchArcGISServerInfo(a).then(e=>Promise.resolve(null==e?void 0:e.owningSystemUrl),e=>Promise.reject(new Error(e)))}));var a;const r=n?t.SessionManager.getInstance().getSessionByUrl(n):null;if(o){const e={id:o};r&&(e.token=r.token),l===m.LayoutTemplate&&(r&&(i.query.token=r.token),i.query.Layout_Item_ID=JSON.stringify(e)),l===m.ReportTemplate&&(i.query.Report_Item_ID=JSON.stringify(e))}return function(e){return B(this,void 0,void 0,function*(){var l;if(!e)return Promise.resolve(null);const o=`${null===(l=e.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,i=function(){var e,l;const o=(null===(e=(0,t.getAppStore)().getState().portalSelf)||void 0===e?void 0:e.helperServices)||{};return(null===(l=null==o?void 0:o.asyncPrintTask)||void 0===l?void 0:l.url)||null}(),n=(yield _(o))||{},{tasks:a,supportedOperations:r,executionType:u}=n;let d=u,c=null,p=null,m=null,v=null;const h=null==a?void 0:a.map(e=>function(e,l){return B(this,void 0,void 0,function*(){if(!e||!l)return Promise.resolve(null);const o=`${l}/${e}`,i={query:{f:"json"},responseType:"json"};return(0,t.loadArcGISJSAPIModules)(["esri/request"]).then(e=>{const[t]=e;return t(o,i).then(e=>{var t;const l=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.name;return Promise.resolve(l)})})})}(e,o).then(t=>{t===s.GetLayoutTemplatesInfo&&(c=`${o}/${e}`,p=`${c}/${r}`),t===s.GetReportTemplatesInfo&&(m=`${o}/${e}`,v=`${o}/${e}/${r}`)}));if(yield Promise.all(h),i===e){const e=yield function(e){return B(this,void 0,void 0,function*(){const t=`${null==e?void 0:e.split("/arcgis/")[0]}/arcgis/rest/services/Utilities/PrintingTools/GPServer`,l=(yield _(t))||{},{tasks:o,supportedOperations:i,executionType:n}=l;let a=null,r=null,s=null;return null==o||o.forEach(e=>{((null==e?void 0:e.includes("Layout"))||(null==e?void 0:e.includes("Layout")))&&(s=e)}),a=`${t}/${s}`,r=`${a}/${i}`,{layoutTemplatesInfoTaskUrl:a,layoutTemplatesInfoRequestUrl:r,executionType:n}})}(o);c=e.layoutTemplatesInfoTaskUrl,p=e.layoutTemplatesInfoRequestUrl,d=e.executionType}return Promise.resolve({url:o,layoutTemplatesInfoTaskUrl:c,layoutTemplatesInfoRequestUrl:p,reportTemplatesInfoTaskUrl:m,reportTemplatesInfoRequestUrl:v,executionType:u,layoutTemplateTaskExecutionType:d})})}(e).then(e=>{const{layoutTemplatesInfoRequestUrl:o,reportTemplatesInfoRequestUrl:n,reportTemplatesInfoTaskUrl:a,executionType:r,layoutTemplatesInfoTaskUrl:s,layoutTemplateTaskExecutionType:u}=e,d=l===m.ReportTemplate?n:o,c=l===m.LayoutTemplate?u:r;return d?(0,t.loadArcGISJSAPIModules)(["esri/request"]).then(e=>{const[t]=e;return t(d,i).then(e=>B(this,void 0,void 0,function*(){var o,n,r;if(c===$.AsynchronousSubmit){const n=null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.jobId;return function(e,t,l,o){return B(this,void 0,void 0,function*(){const i=`${e}/jobs/${t}/results/Output_JSON`;return new Promise((e,t)=>{let n=0;const a=10,r=3e3,s=()=>{o(i,l).then(t=>{var l;(null===(l=null==t?void 0:t.data)||void 0===l?void 0:l.value)?e(t.data.value):(n++,n<a?setTimeout(s,r):e([]))}).catch(e=>{t(new Error(e))})};s()})})}(l===m.ReportTemplate?a:s,n,i,t)}return Promise.resolve((null===(r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.results[0])||void 0===r?void 0:r.value)||[])}),e=>Promise.reject(new Error(e))).catch(e=>Promise.reject(new Error(e)))}):Promise.resolve(null)})})}function _(e){return B(this,void 0,void 0,function*(){var l;if(!e)return Promise.resolve(null);const o=`${null===(l=e.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,i={query:{f:"json"},responseType:"json"};return(0,t.loadArcGISJSAPIModules)(["esri/request"]).then(e=>{const[t]=e;return t(o,i).then(e=>{var t,l;const o=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks,i=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.executionType,n=i===$.SynchronousExecute?"execute":"submitJob";return Promise.resolve({tasks:o,supportedOperations:n,executionType:i})})})})}function K(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}function J(e={}){var t;let l=null;for(const o in e)(null===(t=null==e?void 0:e[o])||void 0===t?void 0:t.type)===a&&(l=o);return l}function Y(e){if(!e)return null;let t=S.RPTX;const l=(null==e?void 0:e.reportSectionOverrides)||{};return Object.keys(l).forEach(e=>{const o=l[e];((null==o?void 0:o.fieldElements)||(null==o?void 0:o.fieldLabelElements))&&(t=S.RPTT)}),t}function X(e,t,l){var o,i;const n=(null==e?void 0:e.printTemplateType)===y.Customize?null===(o=e.printCustomTemplate)||void 0===o?void 0:o.asMutable({deep:!0}):null===(i=e.printOrgTemplate)||void 0===i?void 0:i.asMutable({deep:!0});n[t]=l;return(null==e?void 0:e.printTemplateType)===y.Customize?e.set("printCustomTemplate",n):e.set("printOrgTemplate",n)}function ee(e,t){const l=te(e,t),{reportsAvailable:o,elementOverridesAvailable:i}=l;return o&&i}function te(e,t){var l;const{defaultCustomReportItem:o,defaultReportTemplate:i,supportCustomReport:n,supportReport:a}=t;return{reportsAvailable:oe({defaultCustomReportItem:o,defaultReportTemplate:i,supportCustomReport:n,supportReport:a,reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes}),elementOverridesAvailable:function(e){if(!e)return!0;let t=!0;for(const l in e){ie(e[l])||(t=!1)}return t}(null===(l=null==e?void 0:e.layoutOptions)||void 0===l?void 0:l.elementOverrides)}}const le=(e,t,l)=>{const o=te(e,t),{reportsAvailable:i,elementOverridesAvailable:n}=o;let a;return i||(a=l("reportTemplateRemind")),n||(a=a?`${a} ${l("dynamicElementTemplateRemind")}`:l("dynamicElementTemplateRemind")),a};function oe(e){const{reportOptions:t,defaultCustomReportItem:l,defaultReportTemplate:o,supportCustomReport:i,supportReport:n,reportTypes:a}=e;if(!i&&!n)return!0;switch(a){case w.CustomReport:return t?ne(t):!l&&!o;case w.ServiceReport:return t?ne(t):!o}}function ie(e){let t=!0;if(e.visible&&("CIMTableFrame"===e.type||"CIMGraphicElement"===e.type)){const l=null==e?void 0:e.exbDataSource;l&&0!==(null==l?void 0:l.length)||(t=!1)}return t}function ne(e){if(!(null==e?void 0:e.reportSectionOverrides))return!1;const t=(null==e?void 0:e.reportSectionOverrides)||{};let l=!0;return Object.keys(t).forEach((e,o)=>{var i,n;const a=t[e];if((null==a?void 0:a.exbDatasource)&&0!==(null===(i=null==a?void 0:a.exbDatasource)||void 0===i?void 0:i.length)){const e=ae()||[],t=null===(n=null==a?void 0:a.exbDatasource)||void 0===n?void 0:n[0],o=(null==t?void 0:t.rootDataSourceId)||(null==t?void 0:t.mainDataSourceId);(null==e?void 0:e.includes(o))||(l=!1)}else l=!1}),l}const ae=()=>{var e;const l=(0,t.getAppStore)().getState(),o=(null==l?void 0:l.appStateInBuilder)?null===(e=null==l?void 0:l.appStateInBuilder)||void 0===e?void 0:e.appConfig:null==l?void 0:l.appConfig,i=null==o?void 0:o.dataSources,n=[];return Object.keys(i).forEach(e=>{const l=i[e];(null==l?void 0:l.type)!==t.DataSourceTypes.WebScene&&n.push(l.id)}),n.length>0?(0,t.Immutable)(n):void 0},re=(e,l,o)=>{const i=e.map(e=>{var l;let o=(0,t.Immutable)(e);return o=o.set("layout",H(null==e?void 0:e.layout)),o=o.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],null),o=o.set("reportTypes",w.ServiceReport).set("layoutTypes",T.ServiceLayout),Z(null==o?void 0:o.layout)&&(o=o.set("exportOptions",Object.assign({width:800,height:1100},null==e?void 0:e.exportOptions))),null===(l=V((0,t.Immutable)(p),(0,t.Immutable)(o)))||void 0===l?void 0:l.asMutable({deep:!0})});return se(i,l,o)},se=(e,t,l)=>{const o=F(t,l);return e.map((e,t)=>(e.templateId=`config_${o}_${t}`,e))};function ue(e){var l,o,i;return null!==(i=null===(o=null===(l=t.DataSourceManager.getInstance().getDataSource(e))||void 0===l?void 0:l.getDataSourceJson())||void 0===o?void 0:o.isOutputFromWidget)&&void 0!==i&&i}function de(e,t,l){const o=Z(e)?{}:{layoutOptions:{legend:!1}},i=l||t[0]||"PNG32";return Object.assign({label:e,layout:e,format:i},o)}var ce=h(98640),pe=h(71371);const me=(e,t,l)=>{const o=e.map(e=>e.templateId),i=F(t,l);if(!o||0===(null==o?void 0:o.length))return`config_${i}_0`;return`config_${i}_${ve(o)+1}`},ve=e=>{var t;const l=null==e?void 0:e.map(e=>{var t;const l=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return l?Number(l):0});return null===(t=null==l?void 0:l.sort((e,t)=>t-e))||void 0===t?void 0:t[0]};const he=(e,l,o)=>{var i,n;const a=null===(i=null==o?void 0:o.filter(e=>(null==e?void 0:e.layout)===l))||void 0===i?void 0:i[0];let r=Object.assign(Object.assign(Object.assign({},e),a),{layoutTypes:T.ServiceLayout});return Z(null==a?void 0:a.layout)&&(r=null===(n=(0,t.Immutable)(r).setIn(["exportOptions","width"],800).setIn(["exportOptions","height"],1100))||void 0===n?void 0:n.asMutable({deep:!0})),r};function ge(e,t){if(t){const t={reportTemplate:"None"};e.unshift(t)}return e}function fe(e){const l=function(e){var l;const o=null===(l=(0,t.getAppStore)().getState().portalSelf)||void 0===l?void 0:l.helperServices;return(0,pe.extractService)(o,t.SupportedUtilityType.Printing,null,null,e)}(e)||[],o=l[0];if(!o)return null;let i=t.UtilityManager.getInstance().getIdOfOrgUtility(o.name,o.url,o.index,o.label);return i||(i=(0,pe.addNewUtility)(o)),{utilityId:i}}const ye=e=>{const l=t.DataSourceManager.getInstance();let o=!1;const i=e=>{var t,l,n;o||("MAP_SERVICE"===(null===(t=null==e?void 0:e.parentDataSource)||void 0===t?void 0:t.type)?o=!0:(null===(l=null==e?void 0:e.parentDataSource)||void 0===l?void 0:l.parentDataSource)&&i(null===(n=null==e?void 0:e.parentDataSource)||void 0===n?void 0:n.parentDataSource))},n=l.getDataSource(e.id);return i(n),o},be=(e,t)=>!(!e||!t)&&(null==t?void 0:t.some(t=>t.dataSourceId===e.dataSourceId)),xe=(e,t)=>{const l={id:e},i=(0,o.getAppConfigAction)(),n=function(e){const t=[];return e.printCustomTemplate.forEach(e=>{var l,o,i,n;const a=(null==e?void 0:e.reportOptions)||{};for(const e in a){const i=null===(l=a[e])||void 0===l?void 0:l.reportSectionOverrides;for(const e in i){const l=null===(o=a[e])||void 0===o?void 0:o.exbDatasource;(null==l?void 0:l[0])&&!be(l[0],t)&&t.push(l[0])}}const r=(null===(i=null==e?void 0:e.layoutOptions)||void 0===i?void 0:i.elementOverrides)||{};for(const e in r){const l=null===(n=r[e])||void 0===n?void 0:n.exbDataSource;(null==l?void 0:l[0])&&!be(l[0],t)&&t.push(l[0])}}),t}(t);l.config=t,l.useDataSources=n,i.editWidget(l).exec()};var Te=h(4651),Se=h.n(Te),we=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const Ie=l=>{const o=window.SVG,{className:i}=l,n=we(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:Se()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},Ce=t.css`
  .report-remind-alert .jimu-icon-component {
    color: var(--sys-color-warning-main) !important;
  }
`,je=l=>{const o=t.hooks.useTranslation(i.defaultMessages),{config:n,templateList:a,itemStateDetailContent:r,activeTemplateId:s,handelActiveTemplateIdChange:u,handelTemplateListChange:d}=l,[c,p]=t.React.useState(!1),m=t.hooks.useEventCallback(e=>{let t=0;const l=o=>(e=>a.some(t=>t.label===e))(o)?(t+=1,l(o=`${e} ${t}`)):o;return l(e)}),v=e=>{p(!c),null==e||e.stopPropagation()};return(0,e.jsxs)("div",{className:"d-flex align-items-center",css:Ce,children:[!ee(r,n)&&(0,e.jsx)(i.Alert,{className:"report-remind-alert",buttonType:"tertiary",form:"tooltip",size:"small",type:"warning",text:le(r,n,o)}),(0,e.jsxs)(i.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:v,isOpen:c,children:[(0,e.jsx)(i.DropdownButton,{size:"sm",arrow:!1,icon:!0,onClick:v,type:"tertiary","aria-label":o("more"),title:o("more"),children:(0,e.jsx)(Ie,{size:"s"})}),(0,e.jsxs)(i.DropdownMenu,{children:[(0,e.jsx)(i.DropdownItem,{title:o("duplicate"),"aria-label":o("duplicate"),onClick:e=>{e.stopPropagation();const t=G(a,s),l=me(a,n.printServiceType,n.printTemplateType),o=a,i=m(a[t].label),r=Object.assign(Object.assign({},a[t]),{templateId:l,label:i});o.push(r),d(o),setTimeout(()=>{const e=(null==o?void 0:o.length)-1;u(l,e)},200)},children:o("duplicate")}),(0,e.jsx)(i.DropdownItem,{title:o("deleteOption"),"aria-label":o("deleteOption"),onClick:()=>{const e=G(a,s),t=a;null==t||t.splice(e,1),d(t),u(null)},children:o("deleteOption")})]})]})]})},Oe=t.css`
  .report-remind-alert {
    .jimu-icon-component {
      color: var(--sys-color-warning-main) !important;
    }
    &.jimu-btn {
      padding: 0 !important;
    }
  }
`,Re=l=>{const{className:o,config:i,activeTemplateId:n,showNewTemplateItem:a,handelActiveTemplateIdChange:r,handelTemplateListChange:s}=l,u={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:ce.TreeItemActionType.RenderOverrideItem,children:[{name:ce.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:ce.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ce.TreeItemActionType.RenderOverrideItemBody,children:[{name:ce.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:ce.TreeItemActionType.RenderOverrideItemDragHandle},{name:ce.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:ce.TreeItemActionType.RenderOverrideItemTitle},{name:ce.TreeItemActionType.RenderOverrideItemDetailToggle},{name:ce.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})};t.React.useEffect(()=>{c((null==i?void 0:i.printTemplateType)===y.Customize||(null==i?void 0:i.printServiceType)===f.Customize),v()},[i]);const[d,c]=t.React.useState((null==i?void 0:i.printTemplateType)===y.Customize||(null==i?void 0:i.printServiceType)===f.Customize),[p,m]=t.React.useState([]),v=()=>{var e,t;(null==i?void 0:i.printServiceType)===f.Customize||(null==i?void 0:i.printTemplateType)===y.Customize?m((null===(e=null==i?void 0:i.printCustomTemplate)||void 0===e?void 0:e.asMutable({deep:!0}))||[]):m((null===(t=null==i?void 0:i.printOrgTemplate)||void 0===t?void 0:t.asMutable({deep:!0}))||[])};return(0,e.jsxs)("div",{className:`w-100 mt-2 ${o||""}`,css:Oe,children:[(0,e.jsx)(ce.List,Object.assign({className:"w-100",itemsJson:Array.from(p).map((e,t)=>({itemStateDetailContent:e,itemKey:null==e?void 0:e.templateId,itemStateChecked:n&&(null==e?void 0:e.templateId)===n,itemStateTitle:null==e?void 0:e.label,itemStateIcon:null,itemStateCommands:[]})),dndEnabled:d,renderOverrideItemDetailToggle:(t,l)=>{const{itemJsons:o}=l.props,[n]=o,a=null==n?void 0:n.itemStateDetailContent,u=null==n?void 0:n.itemKey;return(0,e.jsx)(je,{activeTemplateId:u,itemStateDetailContent:a,templateList:p,config:i,handelActiveTemplateIdChange:r,handelTemplateListChange:s})},onUpdateItem:(e,t)=>{const{itemJsons:l}=t.props,[,o]=l;if(e.updateType===ce.TreeItemActionType.HandleDidDrop){const e=o.map(e=>e.itemStateDetailContent);r(null),s(e)}},onClickItemBody:(e,t)=>{const{itemJsons:l}=t.props,o=l[0],i=l[1];r(o.itemKey,i.indexOf(o))}},u)),a&&(0,e.jsx)(ce.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:[{name:"......"}].map((e,t)=>({itemStateDetailContent:"item",itemKey:"index",itemStateChecked:!0,itemStateTitle:"......",itemStateCommands:[]})),dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},u))]})};var Ne=h(23662),Me=h.n(Ne),ke=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const Pe=l=>{const o=window.SVG,{className:i}=l,n=ke(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:Me()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Le=h(29435),Ae=h.n(Le),Ee=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const De=l=>{const o=window.SVG,{className:i}=l,n=Ee(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:Ae()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var ze=h(45508),Ue=h.n(ze),$e=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const Be=l=>{const o=window.SVG,{className:i}=l,n=$e(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:Ue()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Fe=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const Ve=h(12046),Ge=new(0,t.esri.Sanitizer),{useRef:We}=t.React;var He;!function(e){e.Title="TITLE",e.Extents="EXTENTS",e.SpatialReference="SPATIAL REFERENCE",e.Feature="FEATURE ATTRIBUTION",e.Quality="QUALITY"}(He||(He={}));const Ze=l=>{var o,a,r,s;const d=t.hooks.useTranslation(I,t.defaultMessages,i.defaultMessages),c=We(null),p=We(null),m=We(!1),h=t.css`
    .dpi-input .input-wrapper{
      padding-right: 0;
    }
    .radio-con {
      cursor: pointer;
    }
    .use-current-map-scale svg{
      margin: 0 auto;
    }
    .enable-setting-con .jimu-widget-setting--row-label{
      margin-bottom: 0;
    }
    .wkid-describtion {
      font-size: ${t.polished.rem(12)};
      color: var(--ref-palette-neutral-900);
    }
    .wkid-describtion-invalid {
      color: var(--sys-color-error-dark)
    }
    .check-box-con, .radio-con {
      color: var(--ref-palette-neutral-900);
      font-size: ${t.polished.rem(14)};
      line-height: ${t.polished.rem(22)};
      margin: ${t.polished.rem(4)} 0 ${t.polished.rem(8)} 0;
    }
  `,{printTemplateProperties:g,modeType:f,jimuMapView:y,id:b,handleTemplatePropertyChange:x}=l,[T,S]=t.React.useState(null),[w,C]=t.React.useState((null===(o=g.layoutOptions)||void 0===o?void 0:o.titleText)||""),[j,O]=t.React.useState(null==g?void 0:g.wkid),[R,N]=t.React.useState(null===(a=null==g?void 0:g.exportOptions)||void 0===a?void 0:a.dpi),[M,k]=t.React.useState(null==g?void 0:g.outScale),[P,L]=t.React.useState(null),[A,E]=t.React.useState(null),D=t.React.useCallback(e=>Fe(void 0,void 0,void 0,function*(){if(m.current){const{getSRLabel:t}=c.current;return Promise.resolve(t(e))}return t.moduleLoader.loadModule("jimu-core/wkid").then(t=>{c.current=t,m.current=!0;const{getSRLabel:l}=c.current;return Promise.resolve(l(e))})}),[]),z=t.React.useCallback(e=>Fe(void 0,void 0,void 0,function*(){var t,l;if(e){const o=null===(l=null===(t=null==e?void 0:e.view)||void 0===t?void 0:t.spatialReference)||void 0===l?void 0:l.wkid,i=o?yield D(o):"";E(i)}}),[D]),U=e=>Fe(void 0,void 0,void 0,function*(){if(m.current){const{isValidWkid:t}=c.current;return Promise.resolve(t(e))}return t.moduleLoader.loadModule("jimu-core/wkid").then(t=>{c.current=t,m.current=!0;const{isValidWkid:l}=c.current;return Promise.resolve(l(e))})}),$=e=>Fe(void 0,void 0,void 0,function*(){if(e===He.SpatialReference&&!(null==g?void 0:g.wkidLabel)){const e=yield D(null==g?void 0:g.wkid);L(e)}S(e)}),B=()=>{S(null)},F=e=>{var t;let l=g.setIn(["printExtentType"],e);const o=y?null===(t=null==y?void 0:y.view)||void 0===t?void 0:t.scale:36978595.474472;switch(e){case u.CurrentMapExtent:l=l.setIn(["scalePreserved"],!1);break;case u.CurrentMapScale:l=l.setIn(["scalePreserved"],!0);break;case u.SetMapScale:l=l.setIn(["scalePreserved"],!0),l=l.setIn(["outScale"],o)}x(l)},V=e=>{const t=g.setIn([e],!(null==g?void 0:g[e]));x(t)},G=t.React.useCallback(e=>e?P:A,[A,P]);return t.React.useEffect(()=>{z(y)},[y,z]),t.React.useEffect(()=>{var e,t;C((null===(e=g.layoutOptions)||void 0===e?void 0:e.titleText)||""),O(null==g?void 0:g.wkid),N(null===(t=null==g?void 0:g.exportOptions)||void 0===t?void 0:t.dpi),k(null==g?void 0:g.outScale),p.current=null==g?void 0:g.wkid,(null==g?void 0:g.wkidLabel)?L(null==g?void 0:g.wkidLabel):c.current&&(null==g?void 0:g.wkid)&&D(null==g?void 0:g.wkid).then(e=>{L(e)})},[D,g]),(0,e.jsxs)("div",{css:h,children:[(0,e.jsxs)("div",{role:"group","aria-label":d("setDefaults"),children:[(0,e.jsx)(n.SettingRow,{label:d("setDefaults"),flow:"wrap"}),(0,e.jsx)(i.CollapsablePanel,{label:d("printTitle"),isOpen:T===He.Title,onRequestOpen:()=>{$(He.Title)},onRequestClose:B,role:"group","aria-label":d("printTitle"),rightIcon:Ve,type:"primary",className:T===He.Title&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{className:"mt-2",children:(0,e.jsx)(i.TextInput,{size:"sm",className:"search-placeholder w-100",placeholder:d("printTitle"),value:w,onAcceptValue:e=>{const t=g.setIn(["layoutOptions","titleText"],e);x(t)},onChange:e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;C(l)},"aria-label":d("printTitle")})})}),(0,e.jsx)(i.CollapsablePanel,{label:d("mapPrintingExtents"),isOpen:T===He.Extents,onRequestOpen:()=>{$(He.Extents)},onRequestClose:B,role:"group","aria-label":d("mapPrintingExtents"),rightIcon:Ve,type:"primary",className:T===He.Extents&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{className:"mt-2",children:(0,e.jsxs)("div",{className:"w-100",role:"radiogroup",children:[(0,e.jsxs)("div",{title:d("currentMapExtent"),"aria-label":d("currentMapExtent"),className:"d-flex align-items-center radio-con",onClick:()=>{F(u.CurrentMapExtent)},children:[(0,e.jsx)(i.Radio,{title:d("currentMapExtent"),checked:(null==g?void 0:g.printExtentType)===u.CurrentMapExtent,className:"mr-2"})," ",d("currentMapExtent")]}),(0,e.jsxs)("div",{title:d("currentMapScale"),"aria-label":d("currentMapScale"),className:"d-flex align-items-center radio-con",onClick:()=>{F(u.CurrentMapScale)},children:[(0,e.jsx)(i.Radio,{title:d("currentMapScale"),checked:(null==g?void 0:g.printExtentType)===u.CurrentMapScale,className:"mr-2"})," ",d("currentMapScale")]}),(0,e.jsxs)("div",{title:d("setMapScale"),"aria-label":d("setMapScale"),className:"d-flex align-items-center radio-con",onClick:()=>{F(u.SetMapScale)},children:[(0,e.jsx)(i.Radio,{title:d("setMapScale"),checked:(null==g?void 0:g.printExtentType)===u.SetMapScale,className:"mr-2"})," ",d("setMapScale")]}),(null==g?void 0:g.printExtentType)===u.SetMapScale&&(0,e.jsxs)("div",{className:"d-flex mt-1 align-items-center",children:[(0,e.jsx)(i.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",value:M,onAcceptValue:e=>{const t=g.setIn(["outScale"],e);x(t)},onChange:e=>{k(e)},showHandlers:!1}),(0,e.jsx)(i.Button,{className:"use-current-map-scale",size:"sm",title:d("useCurrentScale"),disabled:!y,onClick:()=>{var e;if(!y)return;const t=null===(e=null==y?void 0:y.view)||void 0===e?void 0:e.scale,l=g.setIn(["outScale"],t);x(l)},children:(0,e.jsx)(De,{})})]})]})})}),(0,e.jsx)(i.CollapsablePanel,{label:d("outputSpatialReference"),isOpen:T===He.SpatialReference,onRequestOpen:()=>{$(He.SpatialReference)},onRequestClose:B,role:"group",type:"primary","aria-label":d("outputSpatialReference"),rightIcon:Ve,className:T===He.SpatialReference&&"active-collapse",children:(0,e.jsxs)(n.SettingRow,{flow:"wrap",label:(0,e.jsx)("div",{className:"flex-grow-1",dangerouslySetInnerHTML:{__html:Ge.sanitize(d("wellKnownId",{wkid:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}}),className:"mt-2",children:[(0,e.jsx)(i.TextInput,{size:"sm",className:"search-placeholder w-100",value:j||"",onAcceptValue:e=>Fe(void 0,void 0,void 0,function*(){if(!(!e||(yield U(e)))){O(p.current);const e=yield D(p.current);return L(e),!1}const t=e?yield D(e):"";L(t);const l=g.setIn(["wkid"],e).set("wkidLabel",t);x(l)}),onChange:e=>Fe(void 0,void 0,void 0,function*(){var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;O(l);if(!l||(yield U(l))){const e=l?yield D(l):"";L(e)}else L(d("invalidWKID"))}),suffix:(0,e.jsx)(i.Tooltip,{title:d("wkidRemind"),id:`wkidRemind${b}`,describeChild:!0,enterDelay:0,"aria-live":"off",placement:"top",children:(0,e.jsx)(i.Button,{className:"wkid-info-icon p-0",icon:!0,type:"tertiary","aria-label":d("additionalInformation"),"aria-describedby":`wkidRemind${b}`,children:(0,e.jsx)(Be,{})})}),placeholder:d("wkidSettingPlaceholder",{wkid:(null===(s=null===(r=null==y?void 0:y.view)||void 0===r?void 0:r.spatialReference)||void 0===s?void 0:s.wkid)||null}),"aria-label":d("wellKnownId",{wkid:"WKID"}),"aria-describedby":"print-wkid-describtion"}),(0,e.jsx)("div",{id:"print-wkid-describtion",className:(0,t.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!(e=>{if(c.current){const{isValidWkid:t}=c.current;return!e||t(e)}return!0})(Number(j))}),title:G(j),"aria-label":G(j),children:G(j)})]})}),(0,e.jsx)(i.CollapsablePanel,{label:d("printQuality"),isOpen:T===He.Quality,onRequestOpen:()=>{$(He.Quality)},onRequestClose:B,role:"group","aria-label":d("printQuality"),type:"primary",rightIcon:Ve,className:T===He.Quality&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{className:"mt-2",children:(0,e.jsxs)("div",{className:"d-flex align-items-center w-100",children:[(0,e.jsx)(i.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",placeholder:d("printQuality"),value:R,onAcceptValue:e=>{if(e<1)return!1;const t=g.setIn(["exportOptions","dpi"],parseInt(e));x(t)},onChange:e=>{if(e<1)return!1;N(parseInt(e))},showHandlers:!1,"aria-label":d("printQuality"),"aria-describedby":`describeElement${b}`}),(0,e.jsx)(i.Button,{disabled:!0,size:"sm",title:"DPI",children:"DPI"}),(0,e.jsxs)("div",{className:"sr-only",id:`describeElement${b}`,children:[R,"DPI"]})]})})}),(0,e.jsx)(i.CollapsablePanel,{label:d("featureAttributes"),isOpen:T===He.Feature,onRequestOpen:()=>{$(He.Feature)},onRequestClose:B,role:"group",type:"primary","aria-label":d("featureAttributes"),rightIcon:Ve,className:T===He.Feature&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{className:"mt-2",children:(0,e.jsxs)("div",{title:d("includeAttributes"),className:"d-flex w-100 align-items-center check-box-con","aria-label":d("includeAttributes"),onClick:()=>{V("forceFeatureAttributes")},children:[(0,e.jsx)(i.Checkbox,{title:d("includeAttributes"),className:"lock-item-ratio","data-field":"forceFeatureAttributes",checked:(null==g?void 0:g.forceFeatureAttributes)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("includeAttributes")})]})})})]}),f===v.Classic&&(0,e.jsx)(n.SettingRow,{className:"mt-4 enable-setting-con",flow:"wrap",role:"group","aria-label":d("selectEditableSettings"),label:d("selectEditableSettings"),children:(0,e.jsxs)("div",{className:"w-100",children:[(0,e.jsxs)("div",{title:d("printTitle"),"aria-label":d("printTitle"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{(()=>{const e=g.setIn(["enableTitle"],!(null==g?void 0:g.enableTitle));x(e)})()},children:[(0,e.jsx)(i.Checkbox,{title:d("printTitle"),className:"lock-item-ratio","data-field":"enableTitle",checked:(null==g?void 0:g.enableTitle)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("printTitle")})]}),(0,e.jsxs)("div",{title:d("mapPrintingExtents"),"aria-label":d("mapPrintingExtents"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{V("enableMapPrintExtents")},children:[(0,e.jsx)(i.Checkbox,{title:d("mapPrintingExtents"),className:"lock-item-ratio","data-field":"enableMapPrintExtents",checked:(null==g?void 0:g.enableMapPrintExtents)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("mapPrintingExtents")})]}),(0,e.jsxs)("div",{title:d("outputSpatialReference"),"aria-label":d("outputSpatialReference"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{V("enableOutputSpatialReference")},children:[(0,e.jsx)(i.Checkbox,{title:d("outputSpatialReference"),className:"lock-item-ratio","data-field":"enableOutputSpatialReference",checked:(null==g?void 0:g.enableOutputSpatialReference)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("outputSpatialReference")})]}),(0,e.jsxs)("div",{title:d("printQuality"),"aria-label":d("printQuality"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{V("enableQuality")},children:[(0,e.jsx)(i.Checkbox,{title:d("printQuality"),className:"lock-item-ratio","data-field":"enableQuality",checked:(null==g?void 0:g.enableQuality)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("printQuality")})]}),(0,e.jsxs)("div",{title:d("featureAttributes"),"aria-label":d("featureAttributes"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{V("enableFeatureAttribution")},children:[(0,e.jsx)(i.Checkbox,{title:d("featureAttributes"),className:"lock-item-ratio","data-field":"enableFeatureAttribution",checked:(null==g?void 0:g.enableFeatureAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:d("featureAttributes")})]})]})})]})};var qe=h(50170),Qe=h.n(qe),_e=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const Ke=l=>{const o=window.SVG,{className:i}=l,n=_e(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:Qe()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var Je=h(79860),Ye=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};function Xe(e,l,o,i){var n,a;let r=(new t.esri.restPortal.SearchQueryBuilder).match(l).in("type");i&&(r=r.and().startGroup().not().match(i).in("type").endGroup()),e&&(r=r.and().startGroup().match(e).endGroup());const s=(0,t.getAppStore)().getState(),u=null===(a=null===(n=null==s?void 0:s.portalSelf)||void 0===n?void 0:n.user)||void 0===a?void 0:a.orgId;return o===(null==s?void 0:s.portalUrl)&&u&&(r=r.and().match(u).in("orgid")),r.toParam()}var et=h(1888);const tt={crossAxis:!0},lt=t.css`
  .dropdown >.dropdown-button:hover,  .dropdown >.dropdown-button{
    background: var(--ref-palette-neutral-300);
    border: 1px solid var(--ref-palette-neutral-300);
    border-radius: ${t.polished.rem(2)};
    text-align: left;
  }
`,ot=(0,et.styled)(i.DropdownMenu)`
  & .dropdown-item-con{
    max-height: ${t.polished.rem(400)};
    max-width: ${t.polished.rem(300)};
    min-width: ${t.polished.rem(227)};
    overflow: auto;
  }
  .search-container{
    padding: 0 0.5rem 0.5rem 0.5rem;
  }
  .loading-placeholder, .loading-con {
    width: ${t.polished.rem(16)};
    height: ${t.polished.rem(16)};
  }
  .loading-con {
    @keyframes loading {
      0% {transform: rotate(0deg)};
      100% {transform: rotate(360deg)};
    }
    position: absolute;
    right: ${t.polished.rem(8)};
    bottom: ${t.polished.rem(2)};
    min-width: ${t.polished.rem(16)};
    border: 2px solid var(--ref-palette-neutral-1000);
    border-radius: 50%;
    border-top: 2px solid var(--sys-color-primary-main);
    box-sizing: border-box;
    animation:loading 2s infinite linear;
    box-sizing: border-box;
  }
`,{useState:it,useRef:nt,useEffect:at}=t.React,rt=l=>{const o=nt(null),n=nt(null),a=nt(null),r=nt(1),s=nt(""),u=nt((0,t.Immutable)([])),d=nt(null),c=nt(null),p=nt(null),m=t.hooks.useTranslation(i.defaultMessages),{portalUrl:v,title:h,className:g,size:f,buttonProps:y,menuProps:b,zIndex:x,fluid:T,autoWidth:S,appendToBody:w,strategy:I,useKeyUpEvent:C,hideSearchInput:j,itemtype:O,activeItem:R,placeholder:N,excludeType:M,onChange:k}=l,[P,L]=it(!1),[A,E]=it(""),[D,z]=it(!1),[U,$]=it((0,t.Immutable)([]));at(()=>{p.current=v,B()},[v]);const B=t.hooks.useEventCallback(()=>{if(r.current<0||!p.current)return;const e=t.SessionManager.getInstance().getSessionByUrl(p.current),l={searchText:A,start:r.current,searchItemtype:O||"Layout",portalUrl:p.current,excludeType:M};e&&(l.authentication=e),z(!0),function(e){return Ye(this,void 0,void 0,function*(){const{searchText:t,portalUrl:l,num:o,start:i,sortField:n,sortOrder:a,searchItemtype:r,excludeType:s,authentication:u}=e;if(!l)return Promise.reject(new Error("No portal url"));const d={start:i||1,num:o||30,q:Xe(t,r,l,s),sortField:n||"modified",sortOrder:a||"desc"};return u&&(d.authentication=u),Je.appServices.searchAppByPortalUrl(d,l)})}(l).then(e=>{var l;if(z(!1),e){let o=1===r.current?[]:null===(l=u.current)||void 0===l?void 0:l.asMutable({deep:!0});r.current=null==e?void 0:e.nextStart;const i=(null==e?void 0:e.results)||[];o=o.concat(i),u.current=(0,t.Immutable)(o),$((0,t.Immutable)(o))}}).catch(e=>{z(!1)})}),F=e=>{r.current=1,s.current=e.target.value,E(e.target.value),clearTimeout(d.current),u.current=(0,t.Immutable)([]),d.current=setTimeout(()=>{B()},500)},V=e=>{e&&c.current&&function(e,t,l,o){const i=new IntersectionObserver(function(e,t){const o=e[0].intersectionRatio>0;l&&l(o)},o||{root:t});i.observe(e)}(c.current,e,G)},G=(e=!1)=>{var t;e&&(null===(t=u.current)||void 0===t?void 0:t.length)>0&&B()};return(0,e.jsx)("div",{className:(0,t.classNames)("app-item-selector-con w-100",g),css:lt,children:(0,e.jsxs)(i.Dropdown,{className:"w-100",size:f,direction:"down",fluid:T,autoWidth:S,toggle:()=>{L(!P)},isOpen:P,useKeyUpEvent:C,handelTabEvent:e=>{const l=!j&&n.current;let o;return"Tab"===e.key&&e.shiftKey?o=l:"Tab"===e.key&&e.shiftKey,!!o&&(e.preventDefault(),(0,t.focusElementInKeyboardMode)(o),!0)},menuRole:"listbox","aria-label":l["aria-label"],children:[(0,e.jsx)(i.DropdownButton,Object.assign({size:f},y,{innerRef:e=>{o.current=e},title:h||(null==R?void 0:R.title),"aria-describedby":l["aria-describedby"],"a11y-description":l["a11y-description"],role:"combobox",children:(null==R?void 0:R.title)||N})),(0,e.jsx)(ot,Object.assign({appendToBody:w,strategy:I,zIndex:x,className:"shadow-3",shiftOptions:tt,trapFocus:!1},b,{children:v&&(0,e.jsxs)("div",{children:[!j&&(0,e.jsx)("div",{className:"search-container",children:(0,e.jsx)(i.TextInput,{prefix:(0,e.jsx)(Ke,{}),allowClear:!0,size:"sm",type:"text",value:A,ref:n,placeholder:m("SearchLabel"),onChange:F})}),(0,e.jsxs)("div",{className:"dropdown-item-con",ref:e=>{V(e)},children:[U.map((t,l)=>(0,e.jsx)(i.DropdownItem,{ref:e=>{((e,t)=>{0===t&&e&&(a.current=e)})(e,l)},className:"select-item text-truncate d-block text-left",onClick:e=>{(e=>{e.id!==(null==R?void 0:R.id)&&k&&k(e)})(null==t?void 0:t.asMutable({deep:!0}))},active:(null==R?void 0:R.id)===t.id,title:t.title,"aria-label":t.title,children:t.title},l)),(null==U?void 0:U.length)>0&&!D&&(0,e.jsx)("span",{ref:c}),0===(null==U?void 0:U.length)&&!D&&(0,e.jsx)(i.DropdownItem,{disabled:!0,"aria-label":m("noItemsFound"),children:m("noItemsFound")}),D&&(0,e.jsxs)("div",{className:"loading-item",children:[(0,e.jsx)("div",{className:"loading-placeholder"}),(0,e.jsx)("div",{className:"loading-con"})]})]})]})}))]})})};var st=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const{useState:ut,useEffect:dt,useRef:ct}=t.React,pt=t.css`
  .radio-con {
    cursor: pointer;
  }
`,mt=l=>{const o=t.hooks.useTranslation(I),a=ct(null),{id:r,template:s,config:u,templateIndex:d,handleLayoutChange:c,onSettingChange:p,toggleLoading:m}=l,[v,h]=ut(null),[g,f]=ut(null),[b,x]=ut(!1);dt(()=>{a.current=null==s?void 0:s.customLayoutItem},[s]),dt(()=>{h(a.current)},[d]),dt(()=>{j(u.useUtility).then(e=>{f(e)}),R(u.useUtility)},[u.useUtility]);const S=e=>st(void 0,void 0,void 0,function*(){const t={id:e.id,title:e.title};h(t),m(!0),O(u,t,d).then(e=>{m(!1),p({id:r,config:e})},e=>{h((null==s?void 0:s.customLayoutItem)||null),m(!1)})}),w=()=>{var e,t;const l=s.set("layoutTypes",T.CustomLayout).set("customLayoutItem",null),o=(null==u?void 0:u.printTemplateType)===y.Customize?null===(e=u.printCustomTemplate)||void 0===e?void 0:e.asMutable({deep:!0}):null===(t=u.printOrgTemplate)||void 0===t?void 0:t.asMutable({deep:!0});o[d]=null==l?void 0:l.asMutable({deep:!0});const i=(null==u?void 0:u.printTemplateType)===y.Customize?u.set("printCustomTemplate",o):u.set("printOrgTemplate",o);h(null),p({id:r,config:i})},C=()=>{var e,t;const l=null===(t=null===(e=null==u?void 0:u.layoutChoiceList)||void 0===e?void 0:e[d])||void 0===t?void 0:t.layout;c(H(l))},R=e=>st(void 0,void 0,void 0,function*(){var l,o;const i=yield q(null==e?void 0:e.asMutable({deep:!0})),n=(null===(l=(0,t.getAppStore)().getState().portalSelf)||void 0===l?void 0:l.helperServices)||{},a=(0,t.getAppStore)().getState().portalUrl,r=t.portalUrlUtils.isAGOLDomain(a),s=null===(o=null==n?void 0:n.printTask)||void 0===o?void 0:o.url;x((!i||i!==s||!r)&&u.supportCustomLayout)});return(0,e.jsxs)("div",{className:"custom-layout-setting-con mt-2",css:pt,children:[(0,e.jsx)(n.SettingRow,{flow:"wrap",label:o("printLayout")}),(()=>{var t,l;const a=!(null==s?void 0:s.layoutTypes)||(null==s?void 0:s.layoutTypes)===T.ServiceLayout||!b,r=(null===(t=null==u?void 0:u.layoutChoiceList)||void 0===t?void 0:t.length)>0;return(0,e.jsxs)("div",{role:"group","aria-label":o("printLayout"),children:[(0,e.jsxs)("div",{role:"radiogroup",children:[b&&r&&(0,e.jsx)(n.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex radio-con align-items-center",title:o("useServiceLayout"),onClick:C,children:[(0,e.jsx)(i.Radio,{className:"mr-1",checked:a,title:o("useServiceLayout")}),(0,e.jsx)("span",{children:o("useServiceLayout")})]})}),b&&r&&(0,e.jsx)(n.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex radio-con align-items-center","aria-label":o("useCustomLayout"),title:o("useCustomLayout"),onClick:w,children:[(0,e.jsx)(i.Radio,{checked:(null==s?void 0:s.layoutTypes)===T.CustomLayout,className:"mr-1",title:o("useCustomLayout")}),(0,e.jsx)("span",{children:o("useCustomLayout")})]})})]}),a&&(0,e.jsx)(n.SettingRow,{className:"mt-3",children:(0,e.jsx)(i.Select,{value:H(null==s?void 0:s.layout)||"",onChange:e=>{c(e.target.value)},size:"sm",disabled:(null==u?void 0:u.printTemplateType)===y.OrganizationTemplate,"aria-label":o("printLayout"),children:null===(l=null==u?void 0:u.layoutChoiceList)||void 0===l?void 0:l.map((t,l)=>(0,e.jsx)(i.Option,{value:null==t?void 0:t.layoutTemplate,title:null==t?void 0:t.layoutTemplate,children:null==t?void 0:t.layoutTemplate},`layout${l}`))})}),(null==s?void 0:s.layoutTypes)===T.CustomLayout&&b&&(0,e.jsx)(n.SettingRow,{className:"mt-3",children:(0,e.jsx)(rt,{portalUrl:g,activeItem:v,itemtype:"Layout",size:"sm",placeholder:o("selectLayoutItemPlaceholder"),onChange:S})})]})})()]})};var vt=h(13089);const ht=t.css`
  & .loading-con {
    width: ${t.polished.rem(16)};
    height: ${t.polished.rem(16)};
  }
`,gt=l=>{const{text:o,className:n}=l;return(0,e.jsxs)("div",{css:ht,className:(0,t.classNames)(n,"d-flex align-items-center"),children:[(0,e.jsx)("div",{className:"loading-con position-relative mr-1",children:(0,e.jsx)(i.Loading,{width:16,height:16,type:i.LoadingType.Donut})}),(0,e.jsx)("div",{children:o})]})};var ft=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const{useState:yt,useEffect:bt}=t.React,xt=t.css`
  .report-temp-tip-button {
    padding: 0;
  }
  .radio-con {
    cursor: pointer;
  }
  .warning-alert-con {
    position: absolute;
    top: ${t.polished.rem(50)};
    right: ${t.polished.rem(8)};
    left: ${t.polished.rem(8)};
  }
`,Tt=l=>{const o=t.hooks.useTranslation(I),{id:a,template:r,config:s,templateIndex:u,onSettingChange:d}=l,[c,p]=yt(null),[v,h]=yt(null),[g,f]=yt(!1);bt(()=>{p(null==r?void 0:r.customReportItem)},[u]),bt(()=>{j(s.useUtility).then(e=>{h(e)})},[s.useUtility]);const b=(e=!1)=>{f(e)},x=e=>ft(void 0,void 0,void 0,function*(){const t={id:e.id,title:e.title};p(t),b(!0),((e,t,l)=>C(void 0,void 0,void 0,function*(){const o=null==t?void 0:t.id;return o?R(o,null==e?void 0:e.useUtility,m.ReportTemplate).then(o=>{var i,n;const a=null==o?void 0:o[0],r=((null==e?void 0:e.printTemplateType)===y.Customize?null===(i=e.printCustomTemplate)||void 0===i?void 0:i.asMutable({deep:!0}):null===(n=e.printOrgTemplate)||void 0===n?void 0:n.asMutable({deep:!0}))[l];r.customReportItem=t,r.reportOptions=(null==a?void 0:a.reportOptions)||{};const s=X(e,l,r);return Promise.resolve(s)},e=>Promise.reject(new Error(e))).catch(e=>Promise.reject(new Error(e))):Promise.reject(new Error("No custom report item id"))}))(s,t,u).then(e=>{b(!1),d({id:a,config:e})},e=>{p((null==r?void 0:r.customLayoutItem)||null),b(!1)})}),T=()=>{let e=r.set("reportTypes",w.CustomReport);p((null==s?void 0:s.defaultCustomReportItem)||null),e=e.set("customReportItem",null).set("reportOptions",null);const t=X(s,u,null==e?void 0:e.asMutable({deep:!0}));d({id:a,config:t})},O=()=>{var e;let t=r.set("reportTypes",w.ServiceReport),l=null;const o=(null==s?void 0:s.defaultReportTemplate)||"";(null==s?void 0:s.defaultReportTemplate)&&(null===(e=null==s?void 0:s.reportTemplateChoiceList)||void 0===e||e.forEach(e=>{e.reportTemplate===(null==s?void 0:s.defaultReportTemplate)&&(l=e.reportOptions)})),t=t.set("report",o).set("reportOptions",l);const i=X(s,u,null==t?void 0:t.asMutable({deep:!0}));d({id:a,config:i})},N=t.hooks.useEventCallback(()=>{if(!(null==r?void 0:r.reportOptions))return!0;return Y(null==r?void 0:r.reportOptions)===S.RPTX}),M=t.hooks.useEventCallback(()=>{const e=(null==s?void 0:s.supportReport)&&(null==s?void 0:s.defaultReportTemplate)&&!(null==s?void 0:s.supportCustomReport),t=(null==r?void 0:r.reportTypes)===w.CustomReport&&!(null==r?void 0:r.customReportItem);return(e&&t||!N())&&!g});return(0,e.jsxs)("div",{className:"custom-layout-setting-con mt-2",css:xt,children:[(0,e.jsx)(n.SettingRow,{flow:"wrap",label:(0,e.jsxs)("div",{className:"d-flex align-items-center",children:[(0,e.jsx)("div",{className:"mr-1",children:o("report")}),(0,e.jsx)(i.Tooltip,{title:o("reportRemind"),showArrow:!0,placement:"left",children:(0,e.jsx)(i.Button,{className:"report-temp-tip-button",type:"tertiary","aria-label":o("reportRemind"),children:(0,e.jsx)(Be,{size:"s"})})})]})}),(()=>{var t;const l=s.supportCustomReport,p=!(null==r?void 0:r.reportTypes)||(null==r?void 0:r.reportTypes)===w.ServiceReport||!l,m=ge(null===(t=null==s?void 0:s.reportTemplateChoiceList)||void 0===t?void 0:t.asMutable({deep:!0}),!(null==s?void 0:s.defaultReportTemplate)),h=l&&!(null==s?void 0:s.defaultCustomReportItem);return(0,e.jsxs)("div",{role:"group","aria-label":o("report"),children:[(0,e.jsxs)("div",{role:"radiogroup",children:[h&&(0,e.jsx)(n.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex radio-con align-items-center","aria-label":o("useServiceReport"),title:o("useServiceReport"),onClick:O,children:[(0,e.jsx)(i.Radio,{className:"mr-1",checked:p,title:o("useServiceReport")}),(0,e.jsx)("span",{children:o("useServiceReport")})]})}),h&&(0,e.jsx)(n.SettingRow,{children:(0,e.jsxs)("div",{className:"d-flex radio-con align-items-center","aria-label":o("useCustomReport"),title:o("useCustomReport"),onClick:T,children:[(0,e.jsx)(i.Radio,{checked:(null==r?void 0:r.reportTypes)===w.CustomReport,className:"mr-1",title:o("useCustomReport")}),(0,e.jsx)("span",{children:o("useCustomReport")})]})})]}),p&&(0,e.jsx)(n.SettingRow,{className:"mt-3",children:(0,e.jsx)(i.Select,{value:(null==r?void 0:r.report)||"None",size:"sm",disabled:(null==s?void 0:s.printTemplateType)===y.OrganizationTemplate,"aria-label":o("report"),children:null==m?void 0:m.map((t,l)=>(0,e.jsx)(i.Option,{value:null==t?void 0:t.reportTemplate,title:null==t?void 0:t.reportTemplate,onClick:()=>{((e,t)=>{var l,o;let i=!1;s.supportCustomReport&&(null==r?void 0:r.reportTypes)===w.CustomReport?i=!s.defaultCustomReportItem:s.supportReport&&(null==r?void 0:r.reportTypes)===w.ServiceReport&&(i=!s.defaultReportTemplate);const n=ge(null===(l=null==s?void 0:s.reportTemplateChoiceList)||void 0===l?void 0:l.asMutable({deep:!0}),i);let c=null;"None"===n[t].reportTemplate&&i&&0===Number(t)?e="":c=(null===(o=n[t])||void 0===o?void 0:o.reportOptions)||null;const p=r.set("reportOptions",c).set("report",e),m=X(s,u,null==p?void 0:p.asMutable({deep:!0}));d({id:a,config:m})})(null==t?void 0:t.reportTemplate,l)},children:null==t?void 0:t.reportTemplate},l))})}),(null==r?void 0:r.reportTypes)===w.CustomReport&&s.supportCustomReport&&(0,e.jsx)(n.SettingRow,{className:"mt-3",children:(0,e.jsx)(rt,{portalUrl:v,activeItem:c,itemtype:"Pro Report",excludeType:"Pro Report Template",size:"sm",placeholder:o("selectReportItemPlaceholder"),onChange:x})}),g&&(0,e.jsx)(gt,{className:"mt-2","aria-label":o("checkingReport"),text:o("checkingReport")}),M()&&(0,e.jsx)("div",{className:"warning-alert-con",children:(0,e.jsx)(i.Alert,{type:"warning",text:o("notSupportReport"),withIcon:!0})})]})})(),(()=>{const e=N();return!g&&e})()&&(()=>{var l,o;const i=(null===(l=null==r?void 0:r.reportOptions)||void 0===l?void 0:l.reportSectionOverrides)||(0,t.Immutable)({});if(0!==(null===(o=Object.keys(i))||void 0===o?void 0:o.length))return(0,e.jsx)("div",{className:"mt-3",children:Object.keys(i).map((l,o)=>{const d=i[l];return(0,e.jsx)(n.SettingRow,{label:l,flow:"wrap",children:(0,e.jsx)(vt.DataSourceSelector,{types:(0,t.Immutable)([t.AllDataSourceTypes.FeatureLayer,t.AllDataSourceTypes.ImageryLayer,t.AllDataSourceTypes.OrientedImageryLayer]),useDataSources:null==d?void 0:d.exbDatasource,mustUseDataSource:!0,onChange:e=>{((e,t)=>{var l;const o=ue(null===(l=e[0])||void 0===l?void 0:l.dataSourceId),i=r.setIn(["reportOptions","reportSectionOverrides",t,"exbDatasource"],e).setIn(["reportOptions","reportSectionOverrides",t,"isDsOutputDs"],o),n=X(s,u,null==i?void 0:i.asMutable({deep:!0}));xe(a,n)})(e,l)},widgetId:a,closeDataSourceListOnChange:!0,"aria-describedby":"list-empty-tip",hideDs:ye})},o)})})})()]})};var St=h(28996),wt=h.n(St),It=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const Ct=l=>{const o=window.SVG,{className:i}=l,n=It(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:wt()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))};var jt;!function(e){e.MapSize="MAP SIZE",e.Author="AUTHOR",e.Copyright="COPYRIGHT",e.Legend="LEGEND",e.ScaleBarUnit="SCALE BAR UNIT",e.AttributionVisible="ATTRIBUTION VISIBLE",e.CustomTextElements="CUSTOM TEXT ELEMENTS",e.NorthArrow="NORTH ARROW"}(jt||(jt={}));const Ot=l=>{const{elementOverridesOption:o,needDsSelector:n}=l,a=t.hooks.useTranslation(I,i.defaultMessages,t.defaultMessages),r=o.name;if(n){const t=ie(o);return(0,e.jsxs)("div",{className:"d-flex w-100 align-item-center",children:[(0,e.jsx)("span",{className:"flex-grow-1",children:r}),!t&&(0,e.jsx)(i.Tooltip,{title:a("dynamicElementTemplateRemind"),children:(0,e.jsx)(i.Button,{tag:"div",tabIndex:0,icon:!0,variant:"text",className:"p-0 warning-icon-con","aria-label":a("dynamicElementTemplateRemind"),children:(0,e.jsx)(Ct,{})})})]})}return r},{useEffect:Rt,useState:Nt,useRef:Mt}=t.React,kt=h(12046),Pt=t.css`
  .warning-icon-con {
    color: var(--sys-color-warning-main) !important;
  }
`,Lt=l=>{var o,a,r,s,u,d,c,p;const m=t.hooks.useTranslation(I,i.defaultMessages,t.defaultMessages),{id:h,config:g,templateIndex:f,template:y,handelCustomSettingChange:b}=l,x=Mt(null),T=Mt(!1),[S,w]=Nt((null===(o=null==y?void 0:y.layoutOptions)||void 0===o?void 0:o.authorText)||""),[C,j]=Nt((null===(a=null==y?void 0:y.layoutOptions)||void 0===a?void 0:a.copyrightText)||""),[O,R]=Nt(null),[N,M]=Nt(null===(r=null==y?void 0:y.layoutOptions)||void 0===r?void 0:r.customTextElements),[k,P]=Nt(null),[L,A]=Nt(null),[E,D]=Nt(null),[z,U]=Nt(null);Rt(()=>{var e,t,l,o,i;A(J(null===(e=null==y?void 0:y.layoutOptions)||void 0===e?void 0:e.elementOverrides)),w((null===(t=null==y?void 0:y.layoutOptions)||void 0===t?void 0:t.authorText)||""),j((null===(l=null==y?void 0:y.layoutOptions)||void 0===l?void 0:l.copyrightText)||""),M(null===(o=null==y?void 0:y.layoutOptions)||void 0===o?void 0:o.customTextElements);const n=function(e){var t;if(!e)return null;const l={northArrow:[],scaleBar:[],legend:[],dynamicText:[],table:[],chart:[]};for(const o in e){const i=e[o];switch(i.type){case"CIMMarkerNorthArrow":l.northArrow.push(i);break;case"CIMGraphicElement":(null===(t=i.dynamicTextElements)||void 0===t?void 0:t.some(e=>"table"===e.type))&&l.dynamicText.push(i);break;case"CIMTableFrame":l.table.push(i)}}return l}(null===(i=null==y?void 0:y.layoutOptions)||void 0===i?void 0:i.elementOverrides);D(n),x.current=y},[y]),Rt(()=>{F()},[]),Rt(()=>{B()&&F()},[N]),Rt(()=>{$(E)},[E]);const $=e=>{const l=ee(e);if(T.current||!l)return;const o={};for(const t in e){const l=e[t];o[t]||(o[t]={}),l.forEach(e=>{o[t][e.name]=!1})}U((0,t.Immutable)(o)),T.current=!0},B=()=>{if(!N)return!1;if((null==N?void 0:N.length)!==(null==k?void 0:k.length))return!0;{let e=!1;return null==N||N.forEach((t,l)=>{for(const o in t)Object.prototype.hasOwnProperty.call(k[l],o)||(e=!0)}),e}},F=()=>{const e=null==N?void 0:N.map((e,t)=>{const l={};for(const t in e)l[t]=!1;return l});P((0,t.Immutable)(e||[]))},V=e=>{W(),Q(),R(e)},G=()=>{W(),R(null),Q()},W=()=>{const e=null==k?void 0:k.map(e=>{const t={};for(const l in e)t[l]=!1;return t});P(e)},H=e=>{b([e],!(null==y?void 0:y[e]))},Z=()=>{var e;return!!(null===(e=null==y?void 0:y.layoutOptions)||void 0===e?void 0:e.legendLayers)},q=(e,t)=>{const l=null==k?void 0:k.map((l,o)=>{const i={};for(const n in l)i[n]=t===o&&n===e&&!k[t][e];return i});R(null),Q(),P(l)},Q=()=>{let e=z;for(const t in z){const l=z[t];for(const o in l)e=e.setIn([t,o],!1)}U(e)},_=(l,o,a)=>{var r,s;const u=Y(l.type),d=l.name,c=(null===(r=null==z?void 0:z[o])||void 0===r?void 0:r[d])||!1;return(0,e.jsxs)(i.CollapsablePanel,{label:(0,e.jsx)(Ot,{elementOverridesOption:l,needDsSelector:u}),isOpen:c,onRequestOpen:()=>{((e,t)=>{var l;let o=z;for(const i in z){const n=z[i];for(const a in n){const n=a===t&&i===e&&!(null===(l=null==z?void 0:z[e])||void 0===l?void 0:l[t]);o=o.setIn([i,a],n)}}R(null),W(),U(o)})(o,d)},onRequestClose:G,role:"group","aria-label":d,rightIcon:kt,type:"primary",className:(null===(s=null==z?void 0:z[o])||void 0===s?void 0:s[d])&&"active-collapse",children:[(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"align-item-center mt-2",children:(0,e.jsxs)("div",{title:d,"aria-label":m("includeElementOverrides",{name:d}),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{((e,t,l,o=!1)=>{if(o&&!l){const o=y.setIn(["layoutOptions","elementOverrides",e,"exbDataSource"],[]).setIn(["layoutOptions","elementOverrides",e,"isDsOutputDs"],!1).setIn(["layoutOptions","elementOverrides",e,t],l),i=X(g,f,null==o?void 0:o.asMutable({deep:!0}));xe(h,i)}else b(["layoutOptions","elementOverrides",e,t],l)})(d,"visible",!l.visible,u)},children:[(0,e.jsx)(i.Checkbox,{title:d,className:"lock-item-ratio","aria-label":m("includeElementOverrides",{name:d}),checked:l.visible||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("includeElementOverrides",{name:d})})]})}),u&&l.visible&&(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"align-item-center mt-2",children:(0,e.jsx)(vt.DataSourceSelector,{types:(0,t.Immutable)([t.AllDataSourceTypes.FeatureLayer,t.AllDataSourceTypes.ImageryLayer,t.AllDataSourceTypes.OrientedImageryLayer]),useDataSources:null==l?void 0:l.exbDataSource,mustUseDataSource:!0,onChange:e=>{((e,t)=>{var l;const o=ue(null===(l=e[0])||void 0===l?void 0:l.dataSourceId),i=y.setIn(["layoutOptions","elementOverrides",t,"exbDataSource"],e).setIn(["layoutOptions","elementOverrides",t,"isDsOutputDs"],o),n=X(g,f,null==i?void 0:i.asMutable({deep:!0}));xe(h,n)})(e,d)},widgetId:h,closeDataSourceListOnChange:!0,"aria-describedby":"list-empty-tip",hideDataView:!0,hideDs:ye})})]},`${d}_${a}`)},Y=e=>"CIMChartFrame"===e||"CIMGraphicElement"===e||"CIMTableFrame"===e,ee=e=>{let t=0;for(const l in e){t+=(e[l]||[]).length}return t>0},te=(e,t)=>{var l,o;const i=null===(l=null==y?void 0:y.customTextElementEnableList)||void 0===l?void 0:l[t],n=i.set(e,!(null==i?void 0:i[e])),a=null===(o=null==y?void 0:y.customTextElementEnableList)||void 0===o?void 0:o.asMutable({deep:!0});a.splice(t,1,n),b(["customTextElementEnableList"],a)},le=(e,t,l)=>{const o=N[e].set(t,l),i=null==N?void 0:N.asMutable({deep:!0});i.splice(e,1,o),b(["layoutOptions","customTextElements"],i)},oe=(e,l,o)=>{var i;const n=null===(i=null==o?void 0:o.target)||void 0===i?void 0:i.value,a=N[e].set(l,n),r=null==N?void 0:N.asMutable({deep:!0});r.splice(e,1,a),M((0,t.Immutable)(r))};return(0,e.jsxs)(n.SettingSection,{title:m("LayoutOptions"),role:"group","aria-label":m("LayoutOptions"),css:Pt,children:[(0,e.jsxs)("div",{role:"group","aria-label":m("setDefaults"),children:[(0,e.jsx)(n.SettingRow,{label:m("setDefaults"),flow:"wrap"}),(null==y?void 0:y.hasAuthorText)&&(0,e.jsx)(i.CollapsablePanel,{label:m("printTemplateAuthor"),isOpen:O===jt.Author,onRequestOpen:()=>{V(jt.Author)},onRequestClose:G,role:"group","aria-label":m("printTemplateAuthor"),type:"primary",rightIcon:kt,className:"mb-2",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2",children:(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:S,onAcceptValue:e=>{b(["layoutOptions","authorText"],e)},onChange:e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;w(l)},"aria-label":m("printTemplateAuthor")})})}),(null==y?void 0:y.hasCopyrightText)&&(0,e.jsx)(i.CollapsablePanel,{label:m("copyright"),isOpen:O===jt.Copyright,onRequestOpen:()=>{V(jt.Copyright)},onRequestClose:G,role:"group","aria-label":m("copyright"),rightIcon:kt,type:"primary",className:"mb-2",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2",children:(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:C,onAcceptValue:e=>{b(["layoutOptions","copyrightText"],e)},onChange:e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;j(l)},"aria-label":m("copyright")})})}),(null==y?void 0:y.hasLegend)&&(0,e.jsx)(i.CollapsablePanel,{label:m("legend"),isOpen:O===jt.Legend,onRequestOpen:()=>{V(jt.Legend)},onRequestClose:G,role:"group",type:"primary","aria-label":m("legend"),rightIcon:kt,className:"mb-2",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2",children:(0,e.jsxs)("div",{title:m("includeLegend"),"aria-label":m("includeLegend"),className:"d-flex w-100 align-items-center check-box-con",onClick:e=>{const t=Z();b(["layoutOptions","legendLayers"],t?null:[])},children:[(0,e.jsx)(i.Checkbox,{title:m("includeLegend"),className:"lock-item-ratio",checked:Z()}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("includeLegend")})]})})}),(0,e.jsx)(i.CollapsablePanel,{label:m("scaleBarUnit"),isOpen:O===jt.ScaleBarUnit,onRequestOpen:()=>{V(jt.ScaleBarUnit)},onRequestClose:G,role:"group","aria-label":m("scaleBarUnit"),rightIcon:kt,type:"primary",className:O===jt.ScaleBarUnit&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2",children:(0,e.jsx)(i.Select,{value:(null===(s=null==y?void 0:y.layoutOptions)||void 0===s?void 0:s.scalebarUnit)||"",onChange:e=>{const t=e.target.value;b(["layoutOptions","scalebarUnit"],t)},size:"sm","aria-label":m("scaleBarUnit"),children:K(m).map((t,l)=>(0,e.jsx)(i.Option,{value:t.value,title:t.label,children:t.label},`unit${l}`))})})}),(null===(d=null===(u=null==y?void 0:y.layoutOptions)||void 0===u?void 0:u.customTextElements)||void 0===d?void 0:d.length)>0&&(t=>{const l=[];return null==N||N.forEach((o,a)=>{var r;for(const s in o){const u=(0,e.jsx)(i.CollapsablePanel,{label:s,isOpen:(null===(r=null==t?void 0:t[a])||void 0===r?void 0:r[s])||!1,onRequestOpen:()=>{q(s,a)},onRequestClose:G,role:"group","aria-label":s,rightIcon:kt,type:"primary",className:(null==t?void 0:t[s])&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"align-item-center mt-2",children:(0,e.jsx)(i.TextArea,{className:"flex-grow-1",value:o[s]||"","aria-label":s,onAcceptValue:e=>{le(a,s,e)},onChange:e=>{oe(a,s,e)}})})},`${s}_${a}`);l.push(u)}}),l})(k),ee(E)&&(()=>{const e=[];for(const t in E){E[t].forEach((l,o)=>{const i=_(l,t,o);e.push(i)})}return e})()]}),g.modeType===v.Classic&&(0,e.jsx)(n.SettingRow,{className:"mt-2",flow:"wrap",role:"group","aria-label":m("selectEditableSettings"),label:m("selectEditableSettings"),children:(0,e.jsxs)("div",{className:"w-100",children:[(null==y?void 0:y.hasAuthorText)&&(0,e.jsxs)("div",{title:m("printTemplateAuthor"),"aria-label":m("printTemplateAuthor"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{H("enableAuthor")},children:[(0,e.jsx)(i.Checkbox,{title:m("printTemplateAuthor"),className:"lock-item-ratio",checked:(null==y?void 0:y.enableAuthor)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("printTemplateAuthor")})]}),(null==y?void 0:y.hasCopyrightText)&&(0,e.jsxs)("div",{title:m("copyright"),"aria-label":m("copyright"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{H("enableCopyright")},children:[(0,e.jsx)(i.Checkbox,{title:m("copyright"),className:"lock-item-ratio",checked:(null==y?void 0:y.enableCopyright)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("copyright")})]}),(null==y?void 0:y.hasLegend)&&(0,e.jsxs)("div",{title:m("legend"),"aria-label":m("legend"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{H("enableLegend")},children:[(0,e.jsx)(i.Checkbox,{title:m("legend"),className:"lock-item-ratio",checked:(null==y?void 0:y.enableLegend)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("legend")})]}),(0,e.jsxs)("div",{title:m("scaleBarUnit"),"aria-label":m("scaleBarUnit"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{H("enableScalebarUnit")},children:[(0,e.jsx)(i.Checkbox,{title:m("scaleBarUnit"),className:"lock-item-ratio",checked:(null==y?void 0:y.enableScalebarUnit)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("scaleBarUnit")})]}),(null===(p=null===(c=null==y?void 0:y.layoutOptions)||void 0===c?void 0:c.customTextElements)||void 0===p?void 0:p.length)>0&&(()=>{const t=[];return null==N||N.forEach((l,o)=>{var n,a;for(const r in l){const l=(0,e.jsxs)("div",{title:r,"aria-label":r,className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{te(r,o)},children:[(0,e.jsx)(i.Checkbox,{title:r,className:"lock-item-ratio",checked:(null===(a=null===(n=null==y?void 0:y.customTextElementEnableList)||void 0===n?void 0:n[o])||void 0===a?void 0:a[r])||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:r})]},`${r}_${o}`);t.push(l)}}),t})(),L&&(0,e.jsxs)("div",{title:m("northArrow"),"aria-label":m("northArrow"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{H("enableNorthArrow")},children:[(0,e.jsx)(i.Checkbox,{title:m("northArrow"),className:"lock-item-ratio",checked:(null==y?void 0:y.enableNorthArrow)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:m("northArrow")})]})]})})]})},{useEffect:At,useState:Et}=t.React,Dt=h(12046),zt=l=>{var o,a;const r=t.hooks.useTranslation(I,i.defaultMessages,t.defaultMessages),{config:s,template:u,handelCustomSettingChange:d}=l,[c,p]=Et(null===(o=null==u?void 0:u.exportOptions)||void 0===o?void 0:o.width),[m,h]=Et(null===(a=null==u?void 0:u.exportOptions)||void 0===a?void 0:a.height),[g,f]=Et(null);At(()=>{var e,t;p(null===(e=null==u?void 0:u.exportOptions)||void 0===e?void 0:e.width),h(null===(t=null==u?void 0:u.exportOptions)||void 0===t?void 0:t.height)},[u]);const y=e=>{f(e)},b=()=>{f(null)},x=e=>{d([e],!(null==u?void 0:u[e]))};return(0,e.jsxs)(n.SettingSection,{title:r("MapOnlyOptions"),role:"group","aria-label":r("MapOnlyOptions"),children:[(0,e.jsxs)("div",{role:"group","aria-label":r("setDefaults"),children:[(0,e.jsx)(n.SettingRow,{label:r("setDefaults"),flow:"wrap"}),(0,e.jsxs)(i.CollapsablePanel,{label:r("mapSize"),isOpen:g===jt.MapSize,onRequestOpen:()=>{y(jt.MapSize)},onRequestClose:b,role:"group","aria-label":r("mapSize"),rightIcon:Dt,type:"primary",className:g===jt.MapSize&&"active-collapse",children:[(0,e.jsx)(n.SettingRow,{label:r("width"),className:"mt-2",children:(0,e.jsx)(i.NumericInput,{className:"map-size-input",size:"sm",placeholder:r("width"),value:c||800,onAcceptValue:e=>{var t;if(!e||Number(e)<1)return p(null===(t=null==u?void 0:u.exportOptions)||void 0===t?void 0:t.width),!1;d(["exportOptions","width"],Number(e))},onChange:e=>{if(e<1)return!1;p(e)},showHandlers:!1,"aria-label":r("width")})}),(0,e.jsx)(n.SettingRow,{label:r("height"),children:(0,e.jsx)(i.NumericInput,{className:"map-size-input",size:"sm",placeholder:r("height"),value:m||1100,onAcceptValue:e=>{var t;if(!e||Number(e)<1)return h(null===(t=null==u?void 0:u.exportOptions)||void 0===t?void 0:t.height),!1;d(["exportOptions","height"],Number(e))},onChange:e=>{h(e)},showHandlers:!1,"aria-label":r("height")})})]}),(0,e.jsx)(i.CollapsablePanel,{label:r("mapAttribution"),isOpen:g===jt.AttributionVisible,onRequestOpen:()=>{y(jt.AttributionVisible)},onRequestClose:b,role:"group","aria-label":r("mapAttribution"),rightIcon:Dt,type:"primary",className:g===jt.AttributionVisible&&"active-collapse",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2",children:(0,e.jsxs)("div",{title:r("includeAttribution"),"aria-label":r("includeAttribution"),className:"d-flex w-100 align-items-center check-box-con",onClick:e=>{const t=!(null==u?void 0:u.attributionVisible);d(["attributionVisible"],t)},children:[(0,e.jsx)(i.Checkbox,{title:r("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:!!(null==u?void 0:u.attributionVisible)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:r("includeAttribution")})]})})})]}),s.modeType===v.Classic&&(0,e.jsxs)(n.SettingRow,{className:"mt-2",flow:"wrap",role:"group","aria-label":r("selectEditableSettings"),label:r("selectEditableSettings"),children:[(0,e.jsx)("div",{className:"w-100",children:(0,e.jsxs)("div",{className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{x("enableMapSize")},title:r("mapSize"),"aria-label":r("mapSize"),children:[(0,e.jsx)(i.Checkbox,{title:r("mapSize"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==u?void 0:u.enableMapSize)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:r("mapSize")})]})}),(0,e.jsx)("div",{className:"w-100 mt-1",children:(0,e.jsxs)("div",{title:r("mapAttribution"),"aria-label":r("mapAttribution"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{x("enableMapAttribution")},children:[(0,e.jsx)(i.Checkbox,{title:r("mapAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==u?void 0:u.enableMapAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2",children:r("mapAttribution")})]})})]})]})},{useEffect:Ut,useState:$t,useRef:Bt}=t.React,Ft=l=>{const o=t.hooks.useTranslation(I,i.defaultMessages,t.defaultMessages),{id:a,isOpen:r,trigger:s,popperFocusNode:u,config:d,activeTemplateId:c,jimuMapView:p,toggle:m,handelTemplateListChange:v,onSettingChange:h}=l,g=Bt(null),f=Bt(null),b=Bt(null);Ut(()=>{D()},[d,c]);const[x,S]=$t(null),[w,C]=$t(null),[j,O]=$t(null),[R,N]=$t((null==x?void 0:x.label)||""),[M,k]=$t(!1),[P,L]=$t(!1);Ut(()=>(H(g.current),f.current=null,"number"==typeof w&&(g.current=w),()=>{H(g.current)}),[w]),Ut(()=>{N((null==x?void 0:x.label)||""),A(x)},[x]);const A=e=>{const{defaultCustomReportItem:t,defaultReportTemplate:l,supportCustomReport:o,supportReport:i}=d;if(!e)return;if(oe({defaultCustomReportItem:t,defaultReportTemplate:l,supportCustomReport:o,supportReport:i,reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes})){const t={reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes,customReportItem:null==e?void 0:e.customReportItem,report:null==e?void 0:e.report,templateIndex:w,templateId:e.templateId};f.current=t}},E=(e=!1)=>{L(e)},D=()=>{const e=W(null==d?void 0:d.printServiceType,null==d?void 0:d.printTemplateType)?null==d?void 0:d.printCustomTemplate:null==d?void 0:d.printOrgTemplate,t=G(null==e?void 0:e.asMutable({deep:!0}),c);C(t),O(e),S((null==e?void 0:e[t])||null),b.current=e},z=(e,t)=>{const l=x.setIn(e,t),o=null==j?void 0:j.asMutable({deep:!0});o[w]=null==l?void 0:l.asMutable({deep:!0}),v(o)},U=e=>{if(!e)return N(null==x?void 0:x.label),!1;z(["label"],e)},$=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;N(l)},B=e=>{const t=null==j?void 0:j.asMutable({deep:!0});t[w]=null==e?void 0:e.asMutable({deep:!0}),v(t)},F=()=>{const e=!(null==x?void 0:x.overrideCommonSetting);if(e){let t=x.setIn(["overrideCommonSetting"],e);t=V(t,null==d?void 0:d.commonSetting);const l=null==j?void 0:j.asMutable({deep:!0});l[w]=null==t?void 0:t.asMutable({deep:!0}),v(l)}else z(["overrideCommonSetting"],e)},H=e=>{var t;const l="number"==typeof e?e:w,o=null===(t=b.current)||void 0===t?void 0:t.asMutable({deep:!0});let i=null==o?void 0:o[l];if(!i)return;let n=!1;const a=q(i);a.isTemplateChange&&(n=!0,i=a.newTemplateItem);const r=Q(i);r.isTemplateChange&&(n=!0,i=r.newTemplateItem),n&&(o[l]=i,v(o))},q=e=>{var t,l,o;if(!e)return{isTemplateChange:!1};let i=!1;return(null==e?void 0:e.layoutTypes)===T.CustomLayout&&!(null===(t=e.customLayoutItem)||void 0===t?void 0:t.id)&&(null===(l=null==d?void 0:d.layoutChoiceList)||void 0===l?void 0:l.length)>0&&(e=he(e,e.layout,null===(o=null==d?void 0:d.layoutChoiceList)||void 0===o?void 0:o.asMutable({deep:!0})),i=!0),{isTemplateChange:i,newTemplateItem:e}},Q=t.hooks.useEventCallback(e=>{var l;if(!e)return{isTemplateChange:!1};const{defaultCustomReportItem:o,defaultReportTemplate:i,supportCustomReport:n,supportReport:a}=d;let r=!1,s=(0,t.Immutable)(e);if(!oe({defaultCustomReportItem:o,defaultReportTemplate:i,supportCustomReport:n,supportReport:a,reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes})&&f.current&&(null===(l=f.current)||void 0===l?void 0:l.templateId)===e.templateId){const{reportOptions:e,reportTypes:t,customReportItem:l,report:o}=f.current;s=s.set("reportOptions",e).set("reportTypes",t).set("customReportItem",l).set("report",o).set("report",o),r=!0}return{isTemplateChange:r,newTemplateItem:null==s?void 0:s.asMutable({deep:!0})}}),_=(e,t)=>{var l;const o="number"==typeof t?t:w,i=he(null==x?void 0:x.asMutable({deep:!0}),e,null===(l=null==d?void 0:d.layoutChoiceList)||void 0===l?void 0:l.asMutable({deep:!0})),n=null==j?void 0:j.asMutable({deep:!0});n[o]=i,v(n)},K=e=>{var t,l,o;const i=null==e?void 0:e.format,n=null===(t=null==e?void 0:e.selectedFormatList)||void 0===t?void 0:t.asMutable({deep:!0});return!i||(null===(l=d.formatList)||void 0===l?void 0:l.includes(i))?null!=n?n:[]:null!==(o=null==n?void 0:n.filter(e=>e!==i))&&void 0!==o?o:[]},J=(e,t)=>{var l;if(0===(null==t?void 0:t.length))return!1;let o=x.set("selectedFormatList",t);if(!(null==t?void 0:t.includes(o.format))){const e=null===(l=d.formatList)||void 0===l?void 0:l.filter(e=>e.toLocaleLowerCase().includes("pdf")&&t.includes(e));o=o.set("format",e[0]||t[0])}const i=null==j?void 0:j.asMutable({deep:!0});i[w]=null==o?void 0:o.asMutable({deep:!0}),v(i)},Y=()=>{k(!M)},X=t.css`
    .remind-con {
      padding-left: ${t.polished.rem(25)};
      color: var(--ref-palette-neutral-1100);
      margin-bottom: ${t.polished.rem(60)};
      margin-top: ${t.polished.rem(19)};
      font-size: ${t.polished.rem(13)};
    }
    .modal-body {
      padding: ${t.polished.rem(30)} ${t.polished.rem(30)} 0 ${t.polished.rem(30)};
    }
    .modal-footer {
      padding: 0 ${t.polished.rem(30)} ${t.polished.rem(30)} ${t.polished.rem(30)};
    }
    .remind-title {
      font-size: ${t.polished.rem(16)};
      font-weight: 500;
    }
  `,ee=e=>{e.target.checked?F():Y()},te=t.css`
    & {
      overflow: auto;
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .map-size-input {
      width: ${t.polished.rem(80)};
    }
    .setting-collapse {
      & {
        margin-bottom: ${t.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
      }
    }
    .check-box-con {
      color: var(--ref-palette-neutral-900);
      font-size: ${t.polished.rem(14)};
      line-height: ${t.polished.rem(22)};
      margin: ${t.polished.rem(4)} 0 ${t.polished.rem(8)} 0;
    }
    .layout-loading-con {
      left: 0;
      height: ${t.polished.rem(100)};
    }
  `,le=t.hooks.useEventCallback((e,t)=>{var l;const o=!(null==t?void 0:t.layoutTypes)||(null==t?void 0:t.layoutTypes)===T.ServiceLayout;return!e&&!(!o&&!(null===(l=t.customLayoutItem)||void 0===l?void 0:l.id))});return(0,e.jsx)(n.SidePopper,{isOpen:r,position:"right",toggle:m,trigger:s,title:o("templateConfiguration"),backToFocusNode:u,children:(0,e.jsxs)("div",{className:"w-100 h-100",css:te,children:[(0,e.jsxs)(n.SettingSection,{children:[(0,e.jsx)(n.SettingRow,{flow:"wrap",label:o("templateName"),children:(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:R,onAcceptValue:U,onChange:$,"aria-label":o("templateName"),disabled:(null==d?void 0:d.printTemplateType)===y.OrganizationTemplate})}),(0,e.jsx)(n.SettingRow,{flow:"wrap",label:o("fileFormat"),role:"group","aria-label":o("fileFormat"),children:(0,e.jsx)(i.MultiSelect,{"aria-label":o("fileFormat"),onChange:J,values:(0,t.Immutable)(K(x)),size:"sm",children:null==d?void 0:d.formatList.map(t=>(0,e.jsx)(i.MultiSelectItem,{value:t,label:t},t))})}),(0,e.jsx)(mt,{id:a,config:d,template:x,templateIndex:w,handleLayoutChange:_,onSettingChange:h,toggleLoading:E}),((null==d?void 0:d.supportCustomReport)||(null==d?void 0:d.supportReport))&&(0,e.jsx)(Tt,{id:a,config:d,template:x,templateIndex:w,onSettingChange:h}),P&&(0,e.jsx)("div",{className:"layout-loading-con position-absolute w-100",children:(0,e.jsx)(i.Loading,{})})]}),le(P,x)&&(0,e.jsxs)("div",{children:[Z(null==x?void 0:x.layout)&&(0,e.jsx)(zt,{id:a,config:d,template:x,handelCustomSettingChange:z}),!Z(null==x?void 0:x.layout)&&(0,e.jsx)(Lt,{id:a,config:d,template:x,templateIndex:w,handelCustomSettingChange:z}),(0,e.jsxs)(n.SettingSection,{children:[(0,e.jsx)(n.SettingRow,{className:"mb-4",tag:"label","aria-label":o("overrideCommonSettings"),label:o("overrideCommonSettings"),children:(0,e.jsx)(i.Switch,{checked:(null==x?void 0:x.overrideCommonSetting)||!1,onChange:ee})}),(null==x?void 0:x.overrideCommonSetting)&&(0,e.jsx)(Ze,{id:a,printTemplateProperties:x,handleTemplatePropertyChange:B,modeType:null==d?void 0:d.modeType,jimuMapView:p}),(0,e.jsxs)(i.AlertPopup,{isOpen:M,toggle:Y,hideHeader:!0,onClickOk:F,onClickClose:Y,css:X,children:[(0,e.jsxs)("div",{className:"align-middle pt-2 remind-title d-flex align-items-center","aria-label":o("overrideSettingsTitle"),children:[(0,e.jsx)("div",{className:"mr-1",children:(0,e.jsx)(Ct,{className:"align-middle",size:"l",color:"var(--sys-color-warning-main)"})}),(0,e.jsx)("span",{className:"align-middle flex-grow-1",children:o("overrideSettingsTitle")})]}),(0,e.jsx)("div",{className:"remind-con",children:o("overrideSettingsRemind")})]})]})]})]})})};var Vt=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const{useState:Gt,useEffect:Wt,useRef:Ht}=t.React,Zt=[t.SupportedUtilityType.Printing],qt=l=>{const o=Ht(!1),a=t.hooks.useTranslation(I,i.defaultMessages),{config:r,id:s,onSettingChange:u,toggleLoading:d,toggleRemindPopper:c}=l,p=t.ReactRedux.useSelector(e=>{var t;return null===(t=e.appStateInBuilder.appConfig.widgets[s])||void 0===t?void 0:t.useUtilities}),[m,v]=Gt(null==r?void 0:r.useUtility),h=t.css`
    &>div>div {
      padding-left: 0!important;
      padding-right: 0!important;
    }
    .utility-list {
      margin-bottom: 0 !important;
    }
  `;Wt(()=>{v(null==r?void 0:r.useUtility)},[r]),Wt(()=>{r&&!p&&g()},[p,r]);const g=()=>{const e=fe(a);(null==e?void 0:e.utilityId)&&(o.current=!1,y((0,t.Immutable)(e)))},f=()=>{let e=r;e=e.set("useUtility",null),v(null),d(!1),u({id:s,config:e,useUtilities:[]})},y=e=>Vt(void 0,void 0,void 0,function*(){d(!0),v(e),((e,t)=>C(void 0,void 0,void 0,function*(){return q(e).then(l=>M(l,e,t))}))(e,r).then(t=>{if(o.current)return!1;d(!1),u({id:s,config:t,useUtilities:e?[e]:[]})},l=>{!function(e,l,o){var i,n,a,r;const s=t.UtilityManager.getInstance().utilityHasSignInError(e);let u=404===(null===(i=null==o?void 0:o.details)||void 0===i?void 0:i.httpStatus);400===(null===(n=null==o?void 0:o.details)||void 0===n?void 0:n.httpStatus)&&(null===(r=null===(a=null==o?void 0:o.details)||void 0===a?void 0:a.message)||void 0===r?void 0:r.includes("Item does not exist"))&&(u=!0),s||u?(l&&l(!0),t.UtilityManager.getInstance().reportUtilityState(e,!1,s)):(l&&l(!1),t.UtilityManager.getInstance().reportUtilityState(e,!0))}(null==e?void 0:e.utilityId,null,l),f(),d(!1),c(!0)})});return(0,e.jsx)("div",{css:h,children:(0,e.jsx)(n.SettingRow,{flow:"wrap",label:a("printService"),"aria-label":a("printService"),children:(0,e.jsx)(pe.UtilitySelector,{useUtilities:(e=>{var l;if(!e)return(0,t.Immutable)([]);const o=null===(l=(0,t.getAppStore)().getState().appStateInBuilder.appConfig)||void 0===l?void 0:l.utilities;if(null==o?void 0:o[e.utilityId])return(0,t.Immutable)([e]);(0,t.Immutable)([])})(m),onChange:e=>{const t=e[0];v(t),t?(o.current=!1,y(t)):(o.current=!0,f())},showRemove:!0,closePopupOnSelect:!0,types:Zt})})})};var Qt=function(e,t,l,o){return new(l||(l=Promise))(function(i,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function r(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l(function(e){e(t)})).then(a,r)}s((o=o.apply(e,t||[])).next())})};const{useState:_t,useRef:Kt}=t.React,Jt=l=>{const o=Kt(null),a=Kt(null),{config:r,id:s,jimuMapView:u,showLoading:d,className:c,onSettingChange:p,handlePropertyChange:m,toggleRemindPopper:v,toggleLoading:h}=l,g=t.hooks.useTranslation(I,i.defaultMessages),f=t.css`
    .radio-con {
      cursor: pointer;
    }
    .loading-con {
      height: ${t.polished.rem(100)};
    }
  `,[b,x]=_t(null),[T,S]=_t(null),[w,C]=_t(!0),j=(e,t)=>{var l,i;if(e===b)x(null);else{const n=null===(i=null===(l=o.current)||void 0===l?void 0:l.getElementsByClassName("jimu-tree-item__body"))||void 0===i?void 0:i[t];x(e),n&&S(n)}},O=e=>{const t=W(null==r?void 0:r.printServiceType,null==r?void 0:r.printTemplateType);m(t?"printCustomTemplate":"printOrgTemplate",e)},R=()=>{C(!w)};return(0,e.jsx)(n.SettingSection,{className:c,css:f,role:"group","aria-label":g("configurePrintTemplate"),children:(0,e.jsxs)(i.CollapsablePanel,{label:g("configurePrintTemplate"),isOpen:w,onRequestOpen:R,onRequestClose:R,"aria-label":g("configurePrintTemplate"),className:"custom-setting-collapse",children:[(0,e.jsx)(qt,{id:s,config:r,showLoading:d,onSettingChange:p,toggleLoading:h,toggleRemindPopper:v}),d&&(0,e.jsx)("div",{className:"loading-con position-relative",children:(0,e.jsx)(i.Loading,{type:i.LoadingType.Secondary})}),(null==r?void 0:r.useUtility)&&!d&&(0,e.jsxs)("div",{children:[(null==r?void 0:r.printTemplateType)===y.Customize&&(0,e.jsxs)(i.Button,{className:"w-100 mt-2",ref:a,type:"primary","aria-label":g("newTemplate"),onClick:()=>Qt(void 0,void 0,void 0,function*(){var e,t,l;let o=(null===(t=null===(e=null==r?void 0:r.printCustomTemplate)||void 0===e?void 0:e[0])||void 0===t?void 0:t.asMutable({deep:!0}))||{};const i=(null===(l=null==r?void 0:r.printCustomTemplate)||void 0===l?void 0:l.asMutable({deep:!0}))||[],n=me(i,null==r?void 0:r.printServiceType,y.Customize);o=yield N(r,o,n,g("untitledTemplate")),i.push(o),m("printCustomTemplate",i),S(a.current),x(n)}),children:[(0,e.jsx)(Pe,{className:"mr-1"}),g("newTemplate")]}),(0,e.jsx)("div",{ref:o,children:!d&&(0,e.jsx)(Re,{id:s,handelActiveTemplateIdChange:j,handelTemplateListChange:O,showNewTemplateItem:!1,activeTemplateId:b,config:r})}),(0,e.jsx)(Ft,{id:s,isOpen:b,config:r,activeTemplateId:b,toggle:()=>{j(null)},handelTemplateListChange:O,jimuMapView:u,trigger:o.current,popperFocusNode:T,onSettingChange:p})]})]})})};var Yt=h(15562),Xt=h(54337);const el=l=>{const o=t.hooks.useTranslation(I,i.defaultMessages),{config:a,handlePropertyChange:s}=l,u=t.css`
    .outline-con {
      input {
        width: ${t.polished.rem(55)};
      }
    }
    .preview-style-setting-con {
      margin-top: ${t.polished.rem(16)};
    }
    .enable-preview-label {
      margin-right: ${t.polished.rem(10)};
    }
    .enable-preview-switch-button {
      margin-right: 2px;
    }
  `,d=()=>{s("enablePreview",!(null==a?void 0:a.enablePreview))},c=e=>{0===e.length&&(e="rgba(0,216,237,1)"),s("previewBackgroundColor",e)},p=(e,l)=>{const o=null==l?void 0:l.includes("px"),i=function(e){const t=null==e?void 0:e.split("px")[0];return!(!e||!t)&&Number(t)>=0}(l);if(o&&!i)return;const n=(null==a?void 0:a.previewOutLine)||(0,t.Immutable)(r);0===l.length&&(l=r[e]),s("previewOutLine",n.setIn([e],l))},m=e=>e.includes("var(")||e.includes("#")?et.colorUtils.parseThemeVariable(e,(0,et.getAppThemeVariables)()):e;return(0,e.jsx)(n.SettingSection,{className:"show-preview-area-con",css:u,role:"group",title:(0,e.jsxs)("div",{className:"d-flex align-items-center label-con",onClick:d,children:[(0,e.jsx)("div",{className:"flex-grow-1 enable-preview-label text-truncate w-100",title:o("showPrintArea"),"aria-label":o("showPrintArea"),children:o("showPrintArea")}),(0,e.jsx)(i.Switch,{className:"enable-preview-switch-button","aria-label":o("showPrintArea"),checked:null==a?void 0:a.enablePreview,onChange:d,title:o("showPrintArea")})]}),"aria-label":o("showPrintArea"),children:(null==a?void 0:a.enablePreview)&&(0,e.jsxs)("div",{className:"preview-style-setting-con",children:[(0,e.jsx)(n.SettingRow,{label:o("fill"),"aria-label":o("fill"),children:(0,e.jsx)(Xt.ColorPicker,{color:m(null==a?void 0:a.previewBackgroundColor),onChange:c,title:o("fill"),"aria-label":o("fill")})}),(0,e.jsx)(n.SettingRow,{className:"outline-con",role:"group",flow:"no-wrap",label:o("columnOutline"),"aria-label":o("columnOutline"),children:(0,e.jsx)(Yt.SizeColorSetting,{color:m((null===(v=null==a?void 0:a.previewOutLine)||void 0===v?void 0:v.color)||r.color),size:(null===(h=null==a?void 0:a.previewOutLine)||void 0===h?void 0:h.size)||r.size,useColorPicker:!0,onChange:p})})]})});var v,h};var tl=h(31027),ll=h.n(tl),ol=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(l[o[i]]=e[o[i]])}return l};const il=l=>{const o=window.SVG,{className:i}=l,n=ol(l,["className"]),a=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?(0,e.jsx)(o,Object.assign({className:a,src:ll()},n)):(0,e.jsx)("svg",Object.assign({className:a},n))},nl=()=>{const l=t.hooks.useTranslation(I,i.defaultMessages),o=t.css`
    & {
      & {
        color: var(--ref-palette-neutral-800);
      }
      p {
        color: var(--ref-palette-neutral-1000);
        font-size: ${t.polished.rem(14)};
        margin: ${t.polished.rem(16)} auto 0;
        line-height: ${t.polished.rem(19)};
        width: ${t.polished.rem(228)};
      }
    }
  `;return(0,e.jsx)("div",{className:"w-100 mt-4 text-center utility-placeholder",css:o,children:(0,e.jsxs)("div",{className:"text-center w-100",children:[(0,e.jsx)(il,{size:48}),(0,e.jsx)("p",{className:"text-Secondary",id:"list-empty-tip","aria-label":l("utilityPlaceholder"),title:l("utilityPlaceholder"),children:l("utilityPlaceholder")})]})})},{useEffect:al,useRef:rl}=t.React,sl={width:"360px",height:"460px"},ul={width:"40px",height:"40px"},dl={width:"295px",height:"107px"},cl=a=>{const{config:r,id:s,portalUrl:u,onSettingChange:d,useMapWidgetIds:c,controllerWidgetId:p}=a,m=t.hooks.useTranslation(I,i.defaultMessages),g=rl(null),f=t.ReactRedux.useSelector(e=>{var t,l,o;return null===(o=null===(l=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===l?void 0:l.attributes)||void 0===o?void 0:o.enableA11yForWidgetSettings}),y=t.ReactRedux.useSelector(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[s])||void 0===l?void 0:l.layoutInfo}),b=t.ReactRedux.useSelector(e=>e.appStateInBuilder.appConfig),[x,T]=t.React.useState(null),[S,w]=t.React.useState(!1),[C,j]=t.React.useState(!1),[O,R]=t.React.useState(!1),N=t.css`
    & .custom-setting-collapse>div.collapse-header {
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
    .placeholder-con {
      height: calc(100vh - 770px);
      overflow: hidden;
    }
    .no-utility-setting {
      border-bottom: none;
    }
    .select-mode-con {
      &>div {
        flex: 1;
      }
      button {
        height: ${t.polished.rem(80)};
        background: var(--ref-palette-neutral-300);
        border: 2px solid transparent;
        &:not(:disabled):not(.disabled).active {
          border-color: var(--sys-color-primary-main);
          background: var(--ref-palette-neutral-300);
        }
      }
      img {
        width: 100%;
        height: 100%;
        margin: 0 auto;
      }
    }
    .remind-con {
      top: ${t.polished.rem(90)};
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .mode-text {
      max-width: 100px;
      margin-left: auto;
      margin-right: auto;
    }
    .setting-collapse {
      & {
        margin-bottom: ${t.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
      }
      .handle{
        height: ${t.polished.rem(32)};
        background: var(--ref-palette-neutral-500);
        padding-left: ${t.polished.rem(8)};
        padding-right: ${t.polished.rem(8)};
      }
    }
  `,M=t.ReactRedux.useSelector(e=>e.appStateInBuilder.appConfig.utilities);al(()=>{k(M)},[M]),al(()=>{P()},[r]);const k=t.hooks.useEventCallback(e=>{var t,l;const o=null===(t=null==r?void 0:r.useUtility)||void 0===t?void 0:t.utilityId;if(!o)return;(null===(l=Object.keys(e||{}))||void 0===l?void 0:l.includes(o))||L("useUtility",null)}),P=()=>{var e,t;const l=null===(t=null===(e=null==b?void 0:b.widgets)||void 0===e?void 0:e[s])||void 0===t?void 0:t.style;if(!(null==r?void 0:r.hasInitBorder)&&!(null==l?void 0:l.border)){const e=(0,o.getAppConfigAction)(),t={color:"var(--ref-palette-neutral-700)",type:"solid",width:"1px"};let i;i=l?l.set("border",t):{border:t};const n=null==r?void 0:r.set("hasInitBorder",!0);e.editWidgetProperty(s,"style",i).editWidgetProperty(s,"config",n).editWidgetProperty(s,"offPanel",!1).exec()}},L=(e,t)=>{if((null==r?void 0:r[e])===t)return!1;const l=r.setIn([e],t);d({id:s,config:l})},A=(e=!1)=>{w(e),e&&(clearTimeout(g.current),g.current=setTimeout(()=>{w(!1)},5e3))},E=e=>{var l;const i=r.setIn(["modeType"],e),n=(0,o.getAppConfigAction)();let a=sl;e===v.Compact&&(a=p?dl:ul);const u=D(),d=e===v.Compact;if(u===t.LayoutType.FixedLayout){const{layoutId:e,layoutItemId:t}=y,o=b.layouts[e],r=(null===(l=null==o?void 0:o.content)||void 0===l?void 0:l[t]).bbox.set("width",a.width).set("height",a.height);n.editLayoutItemProperty(y,"bbox",r).editWidgetProperty(s,"config",i).editWidgetProperty(s,"offPanel",d).exec()}else n.editWidgetProperty(s,"config",i).editWidgetProperty(s,"offPanel",d).exec()},D=()=>{var e,t;const l=null==y?void 0:y.layoutId;return null===(t=null===(e=null==b?void 0:b.layouts)||void 0===e?void 0:e[l])||void 0===t?void 0:t.type},z=()=>{j(!C)};return(0,e.jsxs)("div",{className:"widget-setting-search jimu-widget-search",css:N,children:[(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",children:[(0,e.jsx)(n.SettingRow,{flow:"wrap",label:m("selectMap"),children:(0,e.jsx)(n.MapWidgetSelector,{autoSelect:!0,onSelect:e=>{d({id:s,useMapWidgetIds:e})},"aria-label":m("selectMap"),useMapWidgetIds:c})}),(0,e.jsx)("div",{className:"fly-map",children:(0,e.jsx)("div",{children:(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:null==c?void 0:c[0],onActiveViewChange:e=>{null==e||"3d"===e.view.type?T(null):(null==e?void 0:e.id)!==(null==x?void 0:x.id)&&T(e)}})})})]}),(0,e.jsx)(n.SettingSection,{className:"map-selector-section",children:(0,e.jsx)(n.SettingRow,{flow:"wrap",label:m("printMode"),role:"radiogroup","aria-label":m("printMode"),children:(0,e.jsxs)("div",{className:"d-flex w-100 select-mode-con",children:[(0,e.jsxs)("div",{className:"flex-grow-1",children:[(0,e.jsx)(i.Button,{variant:"text",role:"radio","aria-checked":(null==r?void 0:r.modeType)===v.Classic,className:"w-100",disableHoverEffect:!0,disableRipple:!0,title:m("printClassic"),active:(null==r?void 0:r.modeType)===v.Classic,onClick:()=>{E(v.Classic)},children:(0,e.jsx)(i.Icon,{autoFlip:!0,icon:h(3158)})}),(0,e.jsx)("div",{className:"mt-2 w-100 text-center text-truncate mode-text",title:m("printClassic"),children:m("printClassic")})]}),(0,e.jsxs)("div",{className:"flex-grow-1 ml-2",children:[(0,e.jsx)(i.Button,{variant:"text",role:"radio","aria-checked":(null==r?void 0:r.modeType)===v.Compact,className:"w-100",disableHoverEffect:!0,disableRipple:!0,active:(null==r?void 0:r.modeType)===v.Compact,title:m("printCompact"),onClick:()=>{E(v.Compact)},children:(0,e.jsx)(i.Icon,{autoFlip:!0,icon:h(15417)})}),(0,e.jsx)("div",{className:"mt-2 text-center text-truncate mode-text",title:m("printCompact"),children:m("printCompact")})]})]})})}),(0,e.jsx)("div",{className:"w-100 position-absolute remind-con",children:(0,e.jsx)(i.Alert,{withIcon:!0,form:"basic",type:"warning",open:S,closable:!0,className:"w-100",text:m("serviceIsNotAvailable"),onClose:()=>{A(!1)}})}),(0,e.jsx)(Jt,{id:s,config:r,portalUrl:u,handlePropertyChange:L,onSettingChange:d,jimuMapView:x,toggleRemindPopper:A,showLoading:O,toggleLoading:e=>{o.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:s,propKey:"loadingPrintService",value:e}),R(e)},className:!(null==r?void 0:r.useUtility)&&!O&&"no-utility-setting"}),(null==r?void 0:r.useUtility)&&(0,e.jsx)(n.SettingSection,{role:"group","aria-label":m("templateCommonSettings"),children:(0,e.jsx)(i.CollapsablePanel,{label:m("templateCommonSettings"),isOpen:C,onRequestOpen:z,onRequestClose:z,"aria-label":m("templateCommonSettings"),className:"custom-setting-collapse",children:(0,e.jsx)(Ze,{id:s,printTemplateProperties:null==r?void 0:r.commonSetting,handleTemplatePropertyChange:e=>{const t=r.set("commonSetting",e);d({id:s,config:t})},modeType:null==r?void 0:r.modeType,jimuMapView:x})})}),(null==r?void 0:r.useUtility)&&(0,e.jsx)(el,{config:r,handlePropertyChange:L}),!(null==r?void 0:r.useUtility)&&!O&&(0,e.jsx)("div",{className:(0,t.classNames)({"placeholder-con":f}),children:(0,e.jsx)(nl,{})})]})};function pl(e){h.p=e}})(),g})())}}});