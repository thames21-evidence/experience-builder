System.register(["jimu-core","jimu-ui/basic/sql-expression-runtime"],function(e,t){var n={},o={};return{setters:[function(e){n.DataSourceManager=e.DataSourceManager},function(e){o.getKeysInSqlExprBuilder=e.getKeysInSqlExprBuilder}],execute:function(){e((()=>{var e={76117:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=n}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var r={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(r),i.d(r,{default:()=>a});var e=i(79244);const t="Label for attribution";var n=i(76117),o=function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function u(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}l((o=o.apply(e,t||[])).next())})};class a{constructor(){this.id="select-builder-operation"}getTranslationKey(e){return o(this,void 0,void 0,function*(){var t,n;const i=[],r=null===(n=null===(t=null==e?void 0:e.widgets)||void 0===t?void 0:t[this.widgetId])||void 0===n?void 0:n.config,a=null==r?void 0:r.dataAttributeInfo,l=null==r?void 0:r.mapInfo;if(a){const e=a.dataSourceItems;if((null==e?void 0:e.length)>0){const t=`widgets.${this.widgetId}.config.dataAttributeInfo`,n=yield u(t,e);(null==n?void 0:n.length)>0&&i.push(...n)}}if(l){const e=Object.keys(l).map(e=>o(this,void 0,void 0,function*(){const t=l[e];if(t){const{enableAttributeSelection:n,dataSourceItems:o}=t;if(n&&(null==o?void 0:o.length)>0){const t=`widgets.${this.widgetId}.config.mapInfo.${e}`,n=yield u(t,o);(null==n?void 0:n.length)>0&&i.push(...n)}}}));yield Promise.all(e)}return i})}}function u(i,r){return o(this,void 0,void 0,function*(){const a=[],u=e.DataSourceManager.getInstance(),l=[];if((null==r?void 0:r.length)>0&&(r.forEach((e,t)=>{var n,o;if((null===(o=null===(n=e.sqlExpression)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length)>0){const n={dataSourceItem:e,itemIndex:t};l.push(n)}}),l.length>0)){const r=l.map(e=>e.dataSourceItem);yield function(t){return o(this,void 0,void 0,function*(){if((null==t?void 0:t.length)>0){const n=e.DataSourceManager.getInstance(),i=t.map(e=>o(this,void 0,void 0,function*(){try{yield n.createDataSourceByUseDataSource(e.useDataSource)}catch(e){}}));yield Promise.all(i)}})}(r),l.forEach(e=>{var o;const{dataSourceItem:r,itemIndex:l}=e,s=u.getDataSource(null===(o=null==r?void 0:r.useDataSource)||void 0===o?void 0:o.dataSourceId),c=(null==s?void 0:s.getLabel())||"";if(r.sqlHint&&a.push({keyType:"value",key:`${i}.dataSourceItems[${l}].sqlHint`,label:{key:"labelForAttribution",enLabel:t},nav:c,valueType:"text"}),r.sqlExpression){const e=(0,n.getKeysInSqlExprBuilder)(r.sqlExpression,`${i}.dataSourceItems[${l}].sqlExpression`);(null==e?void 0:e.length)>0&&a.push(...e)}})}return a})}})(),r})())}}});