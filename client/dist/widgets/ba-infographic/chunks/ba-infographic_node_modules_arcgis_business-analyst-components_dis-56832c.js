"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-56832c"],{4304:(e,t,i)=>{i.r(t),i.d(t,{arcgis_report_list:()=>n});var s=i(982),o=i(7212),r=i(8249),a=i(4712);const n=class{get el(){return(0,s.g)(this)}_instanceId;_idPrefix="arcgis-report-list-";_containerPrefix="arl-container-";_accordionPrefix="acc-";_itemPrefix="arl-item-";_groupPrefix="arl-group-";_groupId;_infographics;_onChangeCallback;_onChangeQueue;_debounceTimer;_hasSetEnv=!1;_accordionTheme;_accList=["MyInfographics","EsriInfographics","SharedInfographics","GalleryInfographics","TabularReports"];_onDefaultReportCallback;_onCheckboxChangeCallback;_dbg=!1;_tmpIgnoreDefault;_expandedListCount=0;constructor(e){(0,s.r)(this,e),this.reportSelected=(0,s.c)(this,"reportSelected",7),this.reportChecked=(0,s.c)(this,"reportChecked",7),this.accordionInit=(0,s.c)(this,"accordionInit",7),this.env=void 0,this.selectedReportId=void 0,this.showCheckboxes=void 0,this.reportList=void 0,this.langCode=void 0,this.sourceCountry=void 0,this.hierarchy=void 0,this.colors=void 0,this.geoenrichmentUrl=void 0,this.portalUrl=void 0,this.expandOne=void 0,this.stEnv=void 0,this.stLangCode=void 0,this.stSourceCountry="US",this.stColors=void 0,this._isInitialized=!1,this.stMultipleChoice=!1,this.stShowCheckboxes=!0,this.stReportList=void 0,this.stSelectedReportId=void 0,this.stColorTheme=void 0,this.stExpandOne=void 0,this._containerId=void 0,this.token=void 0,this.username=void 0,this.defaultReport=void 0,this.stDefaultReport=void 0,o.A._verbose=!0,this._groupId=o.E.generateId(this._groupPrefix).id,this.langCode="en-us",this.sourceCountry="US",this.stMultipleChoice=!1,this.stShowCheckboxes=!0,this.stReportList={},o.B._initialize(this.langCode),this._instanceId=o.E.generateId(this._idPrefix).id,this._infographics={MyInfographics:{dataId:2,tag:"report-my-infographics",data:void 0,accordionId:o.E.generateId(this._instanceId+this._accordionPrefix).id},EsriInfographics:{dataId:3,tag:"report-esri-infographics",data:void 0,accordionId:o.E.generateId(this._instanceId+this._accordionPrefix).id},SharedInfographics:{dataId:4,tag:"report-shared-infographics",data:void 0,accordionId:o.E.generateId(this._instanceId+this._accordionPrefix).id},GalleryInfographics:{dataId:5,tag:"report-gallery-infographics",data:void 0,accordionId:o.E.generateId(this._instanceId+this._accordionPrefix).id},TabularReports:{dataId:6,tag:"report-tabular-reports",data:void 0,accordionId:o.E.generateId(this._instanceId+this._accordionPrefix).id}},this._onChangeQueue={}}queryElementById(e){return this.el&&this.el.shadowRoot?this.el.shadowRoot.querySelector(o.A.fixId(e)):null}onDefaultReportChanged(){if(o.a.Log("REPORT-LIST updating defaultReport",this.defaultReport),"string"==typeof this.defaultReport){if(this.defaultReport&&o.A.hasText(this.defaultReport)){const e=JSON.parse(this.defaultReport);e&&e.id&&e.name?this.stDefaultReport=e:this.stDefaultReport=void 0}}else void 0===this.defaultReport?this.stDefaultReport=void 0:this.defaultReport?.id&&this.defaultReport?.name&&o.A.hasText(this.defaultReport?.id)&&o.A.hasText(this.defaultReport?.name)?this.stDefaultReport=this.defaultReport:this.stDefaultReport=void 0;this.updateChildrenDefaultReport(this.stDefaultReport)}updateChildrenDefaultReport(e){const t=this;this._accList&&this._accList.length>0&&this._accList.forEach(i=>{const s=t._getShadowAccordion(i);s&&s.setDefaultReport(e)})}async setDefaultReport(e){o.a.Log("report-list updating setDefaultReport",e),e&&e.id&&o.A.hasText(e.id)&&e.name&&o.A.hasText(e.name)?(this.stDefaultReport=e,this.updateChildrenDefaultReport(this.stDefaultReport)):(this.stDefaultReport=void 0,this.updateChildrenDefaultReport(void 0))}onEnvChanged(){this.stEnv=this.env,r.E.setEnvironment(this.env)}onLangCodeChanged(){this.stLangCode=this.langCode,o.B._initialize(this.stLangCode)}onSourceCountryChanged(){this.stSourceCountry=this.sourceCountry}onColorsChanged(){this.stColors=JSON.parse(this.colors)}onSelectedReportChanged(){this.stSelectedReportId=this.selectedReportId}onshowCheckboxesChanged(){this.stShowCheckboxes=this.showCheckboxes}onExpandOneChanged(){this.stExpandOne=this.expandOne}onreportListChanged(){this.stReportList=Object.keys(this.reportList).length?JSON.parse(this.reportList):{},this.initializeTemplatesList()}reportSelected;reportChecked;accordionInit;async setColors(e){this.stColors=e}_hasReports(e){return void 0!==typeof e&&(e.public&&e.public.length>0||e.user&&e.user.length>0||e.shared&&e.shared.length>0||e.gallery&&e.gallery.length>0||e.tabular&&e.tabular.length>0)}async initialize(e,t,i,s,n,h,d,c,l){const p=this;p.token=t,p.username=e,p.sourceCountry=i,p.hierarchy=s,p.langCode=n,p.stShowCheckboxes=!!h,p.stReportList=p._hasReports(d)?d:{},c&&o.A.hasText(c)?p.defaultReport=c:p.defaultReport=void 0,o.a.Log("ArcgisBaReports INITIALIZE() -flags=",p.stShowCheckboxes,p.defaultReport,l),(0,a.a)(e,t),p.geoenrichmentUrl&&r.E.setGeoenrichmentUrl(p.geoenrichmentUrl),p.portalUrl&&r.E.setPortalUrl(p.portalUrl);try{if(!l&&Object.keys(p.stReportList).length>0)p.initializeTemplatesList(p.stReportList,!0);else{let e=await(0,a.g)(i,!1,s);e?p.initializeTemplatesList(e):(p._infographics.MyInfographics.data=void 0,p._infographics.EsriInfographics.data=void 0,p._infographics.SharedInfographics.data=void 0,p._infographics.GalleryInfographics.data=void 0,p._infographics.TabularReports.data=void 0)}this._isInitialized=!0}catch(e){o.a.Error("arcgis-report-list request for esri reports failed",e)}}mergeChecked(e,t){if(!Array.isArray(e))return Array.isArray(t)?t:[];if(!Array.isArray(t))return e;let i,s=!0,o={},r={};for(i=0;i<t.length;i++)r[t[i].id]=t[i];for(i=0;i<e.length;i++){e[i].isChecked||(s=!1);const t=e[i].id;o[t]=!0,r[t]&&(r[t].isChecked=e[i].isChecked)}if(s)for(i=0;i<t.length;i++){o[t[i].id]||(t[i].isChecked=!0)}return t}initializeTemplatesList(e,t){let i,s,r,a,n;if(o.a.Log("REPORT LIST: init list",e,this.stReportList),e&&t)e.user&&Object.keys(e.user).length>0&&(i=e.user),e.public&&Object.keys(e.public).length>0&&(s=e.public),e.shared&&Object.keys(e.shared).length>0&&(r=e.shared),e.gallery&&Object.keys(e.gallery).length>0&&(a=e.gallery),e.tabular&&Object.keys(e.tabular).length>0&&(n=e.tabular);else if(this.stReportList&&Object.keys(this.stReportList).length>0)i=this.mergeChecked(this.stReportList.user,e?.user),s=this.mergeChecked(this.stReportList.public,e?.public),r=this.mergeChecked(this.stReportList.shared,e?.shared),a=this.mergeChecked(this.stReportList.gallery,e?.gallery),n=this.mergeChecked(this.stReportList.tabular,e?.tabular);else{if(!e)return void o.a.Error("ArcgisReportList error initializing infographic templates - no data");i=(e.user??[]).map(e=>({...e,isChecked:!1})),s=(e.public??[]).map(e=>({...e,isChecked:!0})),r=(e.shared??[]).map(e=>({...e,isChecked:!1})),a=(e.gallery??[]).map(e=>({...e,isChecked:!1})),n=(e.tabular??[]).map(e=>({...e,isChecked:!1}))}this.accordionInit.emit({user:i,public:s,shared:r,gallery:a,tabular:n}),this._infographics.MyInfographics.data=i,this._infographics.EsriInfographics.data=s,this._infographics.SharedInfographics.data=r,this._infographics.GalleryInfographics.data=a,this._infographics.TabularReports.data=n,o.a.Log("REPORT LIST init end",this._infographics)}_accordianItemClickHandler(e){this.onReportClicked.call(this,e)}_accordianItemsCheckedHandler(e){this.reportChecked.emit(e.detail)}async setMultipleChoice(e){o.a.Warn("arcgis-report-list use of deprecated function setMultipleChoice()",e)}async onPropChange(e,t){this._onChangeCallback={fn:e,ctx:t}}async setColorTheme(e){if(e&&o.A.hasText(e)&&this.el){this.stColorTheme=e.trim().toLowerCase();const t=e.trim().toLowerCase();this._getShadowAccordion("MyInfographics").setColorTheme(t),this._getShadowAccordion("EsriInfographics").setColorTheme(t),this._getShadowAccordion("SharedInfographics").setColorTheme(t),this._getShadowAccordion("GalleryInfographics").setColorTheme(t),this._getShadowAccordion("TabularReports").setColorTheme(t)}}async setSelectedId(e){this.stSelectedReportId=e,this._setAccordionsReportId()}async onDefaultReportChange(e,t){this._onDefaultReportCallback={fn:e,ctx:t}}async onAccordionItemsChecked(e,t){this._onCheckboxChangeCallback={fn:e,ctx:t}}_getShadowAccordion(e){const t=this._infographics[e].accordionId;return this.el?.shadowRoot?this.el.shadowRoot.getElementById(t):null}_setAccordionsReportId(){const e=this;this.stSelectedReportId&&this._accList.forEach(t=>{const i=e._getShadowAccordion(t);i&&i.setSelectedId(e.stSelectedReportId)})}_setAccordionsCheckbox(){const e=this;this._accList.forEach(t=>{const i=e._getShadowAccordion(t);i&&i.setShowCheckbox(e.stShowCheckboxes)})}_setAccordionsDefault(){const e=this;this._accList.forEach(t=>{const i=e._getShadowAccordion(t);i&&i.setDefaultReport(e.stDefaultReport)})}_debounce2(e,t){const i=this;i._debounceTimer&&clearTimeout(i._debounceTimer),i._debounceTimer=setTimeout(function(){i._debounceTimer=null,e.apply(i)},t)}_onFilteredPropChanged(){this._onChangeCallback&&this._onChangeCallback.fn(this._onChangeCallback.ctx,this._onChangeQueue),this._onChangeQueue={}}_onPropChanged(e,t){this._onChangeQueue[e]=t,this._debounce2(this._onFilteredPropChanged,250)}onReportClicked(e){let t=e.detail.item.id;this.setReportId(t,e.detail.item.name,e.detail.item.reportID)}setReportId(e,t,i){this.selectedReportId=e,this.reportSelected.emit({id:this.selectedReportId,name:t,reportID:i}),this._onPropChanged("reportId",this.selectedReportId)}async componentWillLoad(){this.stColors=this.colors,!this._hasSetEnv&&this.env&&(this._hasSetEnv=!0,this.stEnv=this.env,r.E.setEnvironment(this.env)),this.stShowCheckboxes=this.showCheckboxes,this.stSelectedReportId=this.selectedReportId,this.stExpandOne=this.expandOne,this.defaultReport&&o.A.hasText(this.defaultReport)&&(this.stDefaultReport=JSON.parse(this.defaultReport))}componentDidLoad(){const e=this;requestAnimationFrame(()=>{o.A.hasText(e.colors)&&(e.stColors=o.A.parseThemeString(e.colors)),e._setAccordionsDefault()})}componentDidUpdate(){this._setAccordionsReportId(),this._setAccordionsDefault(),this.stShowCheckboxes&&this._setAccordionsCheckbox()}_getAccordionOpenState(e){let t=!1;const i=this._getShadowAccordion(e);return i&&(t=i.getAttribute("isOpen")),t}_checkExpandedStates(){this.stExpandOne&&(this._expandedListCount=0,this._getAccordionOpenState("MyInfographics")&&this._expandedListCount++,this._getAccordionOpenState("EsriInfographics")&&this._expandedListCount++,this._getAccordionOpenState("SharedInfographics")&&this._expandedListCount++,this._getAccordionOpenState("GalleryInfographics")&&this._expandedListCount++,this._getAccordionOpenState("TabularReports")&&this._expandedListCount++)}render(){if(!this._isInitialized)return;const e=this;return this._checkExpandedStates(),o.a.Log("REPORTS RENDER def rep=",this.stDefaultReport),(0,s.h)("div",null,e.renderList("EsriInfographics"),e.renderList("MyInfographics"),e.renderList("SharedInfographics"),e.renderList("GalleryInfographics"),e.renderList("TabularReports"))}renderList(e){const t=this,i=t.stMultipleChoice.toString(),r={MyInfographics:"report-my-infographics",EsriInfographics:"report-esri-infographics",SharedInfographics:"report-shared-infographics",GalleryInfographics:"report-gallery-infographics",TabularReports:"report-tabular-reports"},a=Array.isArray(t._infographics[e].data)?t._infographics[e].data:[];if(o.a.Log("REPORT LIST renderList",e,a),a&&a.length>0){let n=[];if("true"==i&&a.length>4){let t={id:-1,name:o.B.i18n("dropdown-all"),icon:"file-text",usesCheckbox:!0,isChecked:"EsriInfographics"==e};n.push(t)}a.forEach(function(e){let t={id:e.id,reportID:e.reportID,name:e.title,date:e.date,isChecked:e.isChecked,icon:"file-text"};"true"==i&&(t.usesCheckbox=!0),n.push(t)});const h=t.expandOne&&n.length>0&&t._expandedListCount<=0;h&&t._expandedListCount++;const d=JSON.stringify(n),c=o.B.i18n(r[e]),l=t._infographics[e].accordionId;return o.a.Log("REPORTS render: ",this.stShowCheckboxes,this.stDefaultReport,d),(0,s.h)("ba-accordion",{id:l,class:"reportList",displayname:c,reportsGroupId:e,content:d,isOpen:h,showCheckboxes:this.stShowCheckboxes,defaultReport:this.stDefaultReport?JSON.stringify(this.stDefaultReport):void 0,selectedId:this.stSelectedReportId,onAccordionItemClicked:e=>this._accordianItemClickHandler(e),onAccordionItemsChecked:e=>this._accordianItemsCheckedHandler(e)})}return""}static get watchers(){return{defaultReport:["onDefaultReportChanged"],env:["onEnvChanged"],langCode:["onLangCodeChanged"],sourceCountry:["onSourceCountryChanged"],colors:["onColorsChanged"],selectedReportId:["onSelectedReportChanged"],showCheckboxes:["onshowCheckboxesChanged"],expandOne:["onExpandOneChanged"],reportList:["onreportListChanged"]}}};n.style=":host{display:block}.notReadyOuter{position:absolute;top:0;left:0;width:100%;height:100%}.notReadyDiv{position:absolute;top:calc(50% - 50px);left:calc(50% - 50px);width:100px;height:100px}.notReadySvg{position:absolute;top:calc(50% - 29px);left:calc(50% - 33px)}.arcgisReportsTreeItem{min-height:33px;border-bottom:solid 1px lightgray}.arcgisReportsTreeItemIcon{margin-top:-3px;margin-right:6px}.arcgisReportsTreeDiv{width:100%;max-height:500px;overflow:scroll}"},4712:(e,t,i)=>{i.d(t,{a:()=>r,g:()=>n,s:()=>a});var s=i(8249),o=i(7212);function r(e,t){try{return null!=e&&e.length>0?null!=t&&t.length>0?(s.T.setToken(e,t),o.B.i18n("ok")):o.B.i18n("invalid-token"):o.B.i18n("invalid-username")}catch(e){return e}}function a(e){try{return null!=e&&e.length>0?(s.S.setEnvironment(e),o.B.i18n("ok")):o.B.i18n("invalid-environment")}catch(e){return e}}async function n(e,t=!1,i){return await s.G.getInfographicTemplatesList(e,t,i)}}}]);