System.register(["jimu-core/emotion","jimu-core","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector"],function(e,t){var s={},i={},r={},n={},a={},o={};return{setters:[function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){i.AllDataSourceTypes=e.AllDataSourceTypes,i.DataSourceManager=e.DataSourceManager,i.DataSourceTypes=e.DataSourceTypes,i.Immutable=e.Immutable,i.React=e.React,i.SessionManager=e.SessionManager,i.css=e.css,i.defaultMessages=e.defaultMessages,i.esri=e.esri,i.urlUtils=e.urlUtils},function(e){r.BaseWidgetSetting=e.BaseWidgetSetting},function(e){n.Alert=e.Alert,n.Button=e.Button,n.Checkbox=e.Checkbox,n.FloatingPanel=e.FloatingPanel,n.Icon=e.Icon,n.NumericInput=e.NumericInput,n.Select=e.Select,n.Switch=e.Switch,n.Table=e.Table,n.TextInput=e.TextInput,n.Tooltip=e.Tooltip,n.defaultMessages=e.defaultMessages},function(e){a.SettingRow=e.SettingRow,a.SettingSection=e.SettingSection,a.SidePopper=e.SidePopper},function(e){o.DataSourceSelector=e.DataSourceSelector}],execute:function(){e((()=>{var e={4108:e=>{"use strict";e.exports=r},10540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},10567:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSI4IiB5PSI4IiB3aWR0aD0iOTIiIGhlaWdodD0iMTYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjEzIiB5PSIxMyIgd2lkdGg9IjczIiBoZWlnaHQ9IjYiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik04IDg2SDEwMFY4N0g4Vjg2WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZD0iTTE2LjkxNDcgOTVMMTcuNTkwNSA5NS43MzcyTDIwLjcxOTggOTIuODY4NkwxNy41OTA1IDkwTDE2LjkxNDcgOTAuNzM3MkwxOS4yMzk5IDkyLjg2ODZMMTYuOTE0NyA5NVoiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik0xMS44MDUxIDkwLjczNzJMMTEuMTI5NCA5MC4wMDAxTDggOTIuODY4N0wxMS4xMjk0IDk1LjczNzJMMTEuODA1MSA5NS4wMDAxTDkuNDc5ODkgOTIuODY4N0wxMS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBkPSJNOTYgMThMOTAgMThMOTMgMTVMOTYgMThaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI4IiB5PSIyNyIgd2lkdGg9IjUwIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjgwIiB5PSI5MiIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTkgMzVIMjBWNDJIOTlWMzVaTTE5IDM0VjQzSDEwMFYzNEgxOVoiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjgiIHk9IjM0IiB3aWR0aD0iOSIgaGVpZ2h0PSI5IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNTgiIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI0NSIgeT0iNTgiIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI3MyIgeT0iNTgiIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8Y2lyY2xlIGN4PSIxMiIgY3k9IjYwIiByPSIzIiBmaWxsPSIjOTk5OTk5Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNjciIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI0NSIgeT0iNjciIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI3MyIgeT0iNjciIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyIDcxQzEzLjEwNDYgNzEgMTQgNzAuMTA0NiAxNCA2OUMxNCA2Ny44OTU0IDEzLjEwNDYgNjcgMTIgNjdDMTAuODk1NCA2NyAxMCA2Ny44OTU0IDEwIDY5QzEwIDcwLjEwNDYgMTAuODk1NCA3MSAxMiA3MVpNMTIgNzJDMTMuNjU2OSA3MiAxNSA3MC42NTY5IDE1IDY5QzE1IDY3LjM0MzEgMTMuNjU2OSA2NiAxMiA2NkMxMC4zNDMxIDY2IDkgNjcuMzQzMSA5IDY5QzkgNzAuNjU2OSAxMC4zNDMxIDcyIDEyIDcyWiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iOCIgeT0iNDYiIHdpZHRoPSI5MiIgaGVpZ2h0PSI4IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxMCIgeT0iNDgiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI0OCIgd2lkdGg9IjE2IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjQ1IiB5PSI0OCIgd2lkdGg9IjE3IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjczIiB5PSI0OCIgd2lkdGg9IjIzIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI3OCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjQ1IiB5PSI3OCIgd2lkdGg9IjIyIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjczIiB5PSI3OCIgd2lkdGg9IjI3IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIgODJDMTMuMTA0NiA4MiAxNCA4MS4xMDQ2IDE0IDgwQzE0IDc4Ljg5NTQgMTMuMTA0NiA3OCAxMiA3OEMxMC44OTU0IDc4IDEwIDc4Ljg5NTQgMTAgODBDMTAgODEuMTA0NiAxMC44OTU0IDgyIDEyIDgyWk0xMiA4M0MxMy42NTY5IDgzIDE1IDgxLjY1NjkgMTUgODBDMTUgNzguMzQzMSAxMy42NTY5IDc3IDEyIDc3QzEwLjM0MzEgNzcgOSA3OC4zNDMxIDkgODBDOSA4MS42NTY5IDEwLjM0MzEgODMgMTIgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8L3N2Zz4NCg=="},13089:e=>{"use strict";e.exports=o},14321:e=>{"use strict";e.exports=n},31601:e=>{"use strict";e.exports=function(e){return e[1]}},41113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},55056:(e,t,s)=>{"use strict";e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},64662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="M8 14a.52.52 0 0 1-.527-.516V3.976L3.9 7.473a.535.535 0 0 1-.746 0 .51.51 0 0 1 0-.73L8 2l4.846 4.743a.51.51 0 0 1 0 .73.535.535 0 0 1-.746 0L8.527 3.976v9.508A.52.52 0 0 1 8 14"></path></svg>'},67386:e=>{"use strict";e.exports=s},69241:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="M8 2c.291 0 .527.231.527.516v9.508L12.1 8.527a.535.535 0 0 1 .746 0 .51.51 0 0 1 0 .73L8 14 3.154 9.257a.51.51 0 0 1 0-.73.535.535 0 0 1 .746 0l3.573 3.497V2.516C7.473 2.231 7.709 2 8 2"></path></svg>'},73129:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16 32C7.163 32 0 24.837 0 16S7.163 0 16 0s16 7.163 16 16-7.163 16-16 16m0-4c6.627 0 12-5.373 12-12S22.627 4 16 4 4 9.373 4 16s5.373 12 12 12m0-17.333a2 2 0 1 1-.001-3.999A2 2 0 0 1 16 10.667m0 2.666a2 2 0 0 1 2 2v8a2 2 0 1 1-4 0v-8a2 2 0 0 1 2-2"></path></svg>'},74239:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866 30.951 27.18a2.667 2.667 0 0 1-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 0 1 .781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 0 1 4.552.781l11.314 11.314L27.18.781a2.667 2.667 0 0 1 3.771 3.771z"></path></svg>'},76314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var s="",i=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),i&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),i&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s}).join("")},t.i=function(e,s,i,r,n){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&a[d[0]]||(void 0!==n&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=n),s&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=s):d[2]=s),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},77659:e=>{"use strict";var t={};e.exports=function(e,s){var i=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},79244:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=a},81227:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="M5.173 0a.5.5 0 0 1 .5.5v14.7a.8.8 0 0 1-1.407.52L.12 10.712a.5.5 0 0 1 .76-.652l3.793 4.598V.5a.5.5 0 0 1 .5-.5m5.654 16a.5.5 0 0 1-.5-.5V.8a.8.8 0 0 1 1.407-.52l4.146 5.008a.5.5 0 0 1-.76.652l-3.793-4.598V15.5a.5.5 0 0 1-.5.5"></path></svg>'},85072:e=>{"use strict";var t=[];function s(e){for(var s=-1,i=0;i<t.length;i++)if(t[i].identifier===e){s=i;break}return s}function i(e,i){for(var n={},a=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],d=n[c]||0,h="".concat(c," ").concat(d);n[c]=d+1;var g=s(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==g)t[g].references++,t[g].updater(u);else{var m=r(u,i);i.byIndex=o,t.splice(o,0,{identifier:h,updater:m,references:1})}a.push(h)}return a}function r(e,t){var s=t.domAPI(t);s.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,r){var n=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<n.length;a++){var o=s(n[a]);t[o].references--}for(var l=i(e,r),c=0;c<n.length;c++){var d=s(n[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}n=l}}},87820:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 0c4.4 0 8 3.6 8 8s-3.6 8-8 8-8-3.6-8-8 3.6-8 8-8m0 12a1 1 0 1 0 0 2 1 1 0 0 0 0-2M7.938 2C6.387 2 5.058 3.06 4.57 4.465c-.07.174-.07.342-.07.342a.74.74 0 0 0 .765.793l.114-.007c.458-.053.775-.314.947-.742.09-.189.123-.238.14-.262a1.78 1.78 0 0 1 1.47-.789c.98 0 1.782.81 1.782 1.8 0 .54-.178.99-.535 1.26L8.116 8.03c-.578.51-.921 1.198-1.03 1.968l-.006.073v.133a.855.855 0 0 0 .858.796l.104-.006c.45-.049.817-.409.849-.845l.037-.185c.151-.652.474-1.046.969-1.484s.801-.81.801-.81c.446-.54.802-1.26.802-2.07C11.5 3.62 9.897 2 7.938 2"></path></svg>'},97271:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var i=s(31601),r=s.n(i),n=s(76314),a=s.n(n)()(r());a.push([e.id,".css-rygcro th,.css-rygcro td{padding:.5rem .5rem !important}",""]);const o=a},97825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var r=void 0!==s.layer;r&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,r&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var n=s.sourceMap;n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},99473:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSIxNiIgeT0iMzYiIHdpZHRoPSI3NiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNiIgeT0iNDQiIHdpZHRoPSI5IiBoZWlnaHQ9IjkiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTEgNDVIMjhWNTJIOTFWNDVaTTI3IDQ0VjUzSDkyVjQ0SDI3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01MCAzMEg4VjEwMEgxMDBWMzBINThMNTQgMjZMNTAgMzBaTTU0IDI3LjQxNDJMNTAuNDE0MiAzMUg5Vjk5SDk5VjMxSDU3LjU4NThMNTQgMjcuNDE0MloiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGQ9Ik04IDhMMTAwIDhWMjRIOFY4WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iNzQiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTk2IDE4TDkwIDE4TDkzIDE1TDk2IDE4WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjciIHk9IjU4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMjAiIGN5PSI2MCIgcj0iMyIgZmlsbD0iIzk5OTk5OSIvPg0KPHJlY3QgeD0iMjciIHk9IjY4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yMCA3MkMyMS4xMDQ2IDcyIDIyIDcxLjEwNDYgMjIgNzBDMjIgNjguODk1NCAyMS4xMDQ2IDY4IDIwIDY4QzE4Ljg5NTQgNjggMTggNjguODk1NCAxOCA3MEMxOCA3MS4xMDQ2IDE4Ljg5NTQgNzIgMjAgNzJaTTIwIDczQzIxLjY1NjkgNzMgMjMgNzEuNjU2OSAyMyA3MEMyMyA2OC4zNDMxIDIxLjY1NjkgNjcgMjAgNjdDMTguMzQzMSA2NyAxNyA2OC4zNDMxIDE3IDcwQzE3IDcxLjY1NjkgMTguMzQzMSA3MyAyMCA3M1oiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjI3IiB5PSI3OCIgd2lkdGg9IjY1IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjAgODJDMjEuMTA0NiA4MiAyMiA4MS4xMDQ2IDIyIDgwQzIyIDc4Ljg5NTQgMjEuMTA0NiA3OCAyMCA3OEMxOC44OTU0IDc4IDE4IDc4Ljg5NTQgMTggODBDMTggODEuMTA0NiAxOC44OTU0IDgyIDIwIDgyWk0yMCA4M0MyMS42NTY5IDgzIDIzIDgxLjY1NjkgMjMgODBDMjMgNzguMzQzMSAyMS42NTY5IDc3IDIwIDc3QzE4LjM0MzEgNzcgMTcgNzguMzQzMSAxNyA4MEMxNyA4MS42NTY5IDE4LjM0MzEgODMgMjAgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBkPSJNMjQuOTE0NyA5NUwyNS41OTA1IDk1LjczNzJMMjguNzE5OCA5Mi44Njg2TDI1LjU5MDUgOTBMMjQuOTE0NyA5MC43MzcyTDI3LjIzOTkgOTIuODY4NkwyNC45MTQ3IDk1WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTE5LjgwNTEgOTAuNzM3MkwxOS4xMjk0IDkwLjAwMDFMMTYgOTIuODY4N0wxOS4xMjk0IDk1LjczNzJMMTkuODA1MSA5NS4wMDAxTDE3LjQ3OTkgOTIuODY4N0wxOS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTkyIDg3TDE2IDg3TDE2IDg2TDkyIDg2TDkyIDg3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="}},t={};function l(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={id:s,exports:{}};return e[s](r,r.exports,l),r.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var s in t)l.o(t,s)&&!l.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="",l.nc=void 0;var c={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(c),l.d(c,{__set_webpack_public_path__:()=>V,default:()=>A});var e=l(67386),t=l(79244),s=l(4108);const i={alertMessagesAlreadyAdded:"Service already added",alertMessagesErrorAlert:"An error has occurred",alertMessagesNotValid:"Not a valid versioned service",allowancesAutoRefreshList:"Automatically refresh version list",allowancesChangeOwner:"Change owner",allowancesChangePrivileges:"Change access privileges",allowancesCreateNew:"Create new",allowancesDeleteExisting:"Delete existing",allowancesPosting:"Post changes",allowancesSwitch:"Switch versions",allowancesUpdateName:"Update name",allowancesUpdateDescription:"Update description",fieldColumnsAccess:"Access",fieldColumnsColumnAvailable:"Available",fieldColumnsColumnShow:"Show",fieldColumnsCommonAncestorDate:"Common Ancestor Date",fieldColumnsCreationDate:"Creation Date",fieldColumnsDescription:"Description",fieldColumnsEvaluationDate:"Evaluation Date",fieldColumnsModifiedDate:"Modified Date",fieldColumnsPreviousAncestorDate:"Previous Ancestor Date",fieldColumnsReconcileDate:"Reconcile Date",fieldColumnsVersionGuid:"Version GUID",fieldColumnsVersionId:"Version ID",fieldColumnsVersionName:"Name",fieldColumnsVersionOwner:"Owner",layoutStyleTitle:"Arrangement style",layoutStyleBasic:"Basic",layoutStyleAdvanced:"Advanced",settingsSectionsAllowAll:"All",settingsSectionsAllowCapability:"Allow",settingsSectionsExpandBasic:"Expand versions list",settingsSectionsGeneralSettings:"General settings",settingsSectionsMinutes:"Minute(s)",settingsSectionsRecordsPage:"Number of records per page",settingsSectionsSearchName:"Search version name",settingsSectionsSelectVersion:"Select version to load on start",settingsSectionsTooltipNumber:"Enter a number from 1 to 999",settingsSectionsVersionCapability:"Management capability",settingsSectionsVersionCapabilityTooltip:"Version Management capability is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not have access to version management operations.",settingsSectionsVersionInfo:"Version information",settingsSectionsVersionInfoTooltip:"Version information is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not see all version information.",settingsSectionsVersionService:"Version management services",settingsSectionsVersionServiceHelp:"Help"};var r=l(14321),n=l(79298),a=l(13089),o=function(e,t,s,i){return new(s||(s=Promise))(function(r,n){function a(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((i=i.apply(e,t||[])).next())})};class d{constructor(){this.defaultVersion="sde.DEFAULT",this.isOrgUser=!1,this.uniqueURLs=[]}static getInstance(){return d.instance||(d.instance=new d),d.instance}getUniqueVMSURL(e){return new Promise((s,i)=>{const r=t.DataSourceManager.getInstance().getDataSources(),n=[],a=[];for(const s in r)if(e){if(s.includes(e)&&r[s].type===t.DataSourceTypes.FeatureLayer){const e=r[s].getDataSourceJson();if(e.url.includes("FeatureServer")){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));n.includes(t)||n.push(t)}}}else if(r[s].type===t.DataSourceTypes.FeatureLayer){const e=r[s].getDataSourceJson();if(e.url.includes("FeatureServer")){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));n.includes(t)||n.push(t)}}if(n.length>0){const e=n.map((e,t)=>o(this,void 0,void 0,function*(){let t=!1;if(t=yield this.checkValidVMS(e),t){const t=yield this.serviceNameLookup(e);a.push({url:e,name:t})}}));Promise.all(e).then(e=>{this.uniqueURLs=a,s(a)})}else this.uniqueURLs=a,s(a)})}checkValidVMS(e,t){return o(this,void 0,void 0,function*(){let s=!1,i=e;i.includes("FeatureServer")&&(i=i.substring(0,i.indexOf("FeatureServer"))),i.includes("MapServer")&&(i=i.substring(0,i.indexOf("MapServer")));const r=i+"VersionManagementServer";let n=null;return n=t?{f:"json",token:t}:{f:"json"},s=yield this.requestService({method:"POST",url:r,params:n}).then(e=>!!e.hasOwnProperty("name")&&"Version Management Server"===e.name).catch(e=>!1),s})}getVersions(e,t,s){return new Promise((i,r)=>{if(t){let e=t;e.includes("FeatureServer")&&(e=e.substring(0,e.indexOf("FeatureServer"))),e.includes("MapServer")&&(e=e.substring(0,e.indexOf("MapServer"))),i(s?this.requestVersions(e,s):this.requestVersions(e))}else if(0===this.uniqueURLs.length)this.getUniqueVMSURL().then(t=>{let r=t[0];e&&(r=t.filter(t=>t.name===e));const n=r[0].url;i(s?this.requestVersions(n,s):this.requestVersions(n))});else{let t=this.uniqueURLs[0];e&&(t=this.uniqueURLs.filter(t=>t.name===e));const r=t[0].url;i(s?this.requestVersions(r,s):this.requestVersions(r))}})}changeGDBVersion(e,s){let i=!1;for(const r in s){if(s[r].type===t.DataSourceTypes.FeatureLayer||s[r].type===t.DataSourceTypes.SubtypeGroupLayer||s[r].type===t.DataSourceTypes.SubtypeSublayer){this.getLayerObject(s[r]).changeGDBVersion(e),i=!0}(s[r].type===t.DataSourceTypes.FeatureService||s[r].type===t.DataSourceTypes.MapService)&&(s[r].changeGDBVersion(e),i=!0)}return i}createGDBVersion(e,t,s,i,r,n){return new Promise((a,o)=>{const l={};let c=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){if(r)c=r,c.indexOf("FeatureServer")>=0?(c=c.substring(0,c.indexOf("FeatureServer")),c+="VersionManagementServer/create"):c.indexOf("MapServer")>=0?(c=c.substring(0,c.indexOf("MapServer")),c+="VersionManagementServer/create"):c+="VersionManagementServer/create";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter(e=>e.name===i));c=e[0].url+"VersionManagementServer/create"}this.requestService({method:"POST",url:c,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,token:t}}).then(e=>{n&&e.hasOwnProperty("versionInfo")&&this.changeGDBVersion(e.versionInfo.versionName,s),a(e)}).catch(e=>{a(e)})}else a(o)}else a(l)})}deleteGDBVersion(e,s,i,r,n){return new Promise((a,o)=>{if("sde.default"!==e.toLowerCase()){const o={};let l=null;if(this.isOrgUser){if(n)l=n,l.indexOf("FeatureServer")>=0?(l=l.substring(0,l.indexOf("FeatureServer")),l+="VersionManagementServer/delete"):l.indexOf("MapServer")>=0?(l=l.substring(0,l.indexOf("MapServer")),l+="VersionManagementServer/delete"):l+="VersionManagementServer/delete";else{let e=this.uniqueURLs[0];r&&(e=this.uniqueURLs.filter(e=>e.name===r));l=e[0].url+"VersionManagementServer/delete"}this.requestService({method:"POST",url:l,params:{f:"json",versionName:e,token:s}}).then(s=>{const r=[];for(const s in i)if(i[s].type===t.DataSourceTypes.FeatureLayer){this.getLayerObject(i[s]).getGDBVersion()===e&&(r[s]=i[s])}this.changeGDBVersion(this.defaultVersion,r),s.version=this.defaultVersion,a(s)}).catch(e=>{a(e)})}else a(o)}else a({error:{message:"Cannot delete Default version"}})})}alterGDBVersion(e,t,s,i,r,n){return new Promise((a,o)=>{const l={};let c=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){let o=e.versionGuid.replace("{","");if(o=o.replace("}",""),r)c=r,c.indexOf("FeatureServer")>=0?(c=c.substring(0,c.indexOf("FeatureServer")),c=c+"VersionManagementServer/versions/"+o+"/alter"):c.indexOf("MapServer")>=0?(c=c.substring(0,c.indexOf("MapServer")),c=c+"VersionManagementServer/versions/"+o+"/alter"):c=c+"VersionManagementServer/versions/"+o+"/alter";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter(e=>e.name===i));c=e[0].url+"VersionManagementServer/versions/"+o+"/alter"}this.requestService({method:"POST",url:c,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,ownerName:e.versionOwner,token:t}}).then(t=>{n&&this.changeGDBVersion(e.versionOwner+"."+e.versionName,s),a(t)}).catch(e=>{a(e)})}else a(o)}else a(l)})}getVersionState(e,t,s,i){return new Promise((r,n)=>{let a=null,o=e.versionGuid.replace("{","");if(o=o.replace("}",""),i)a=i,a.indexOf("FeatureServer")>=0?(a=a.substring(0,a.indexOf("FeatureServer")),a=a+"VersionManagementServer/versions/"+o):a.indexOf("MapServer")>=0?(a=a.substring(0,a.indexOf("MapServer")),a=a+"VersionManagementServer/versions/"+o):a=a+"VersionManagementServer/versions/"+o;else{let e=this.uniqueURLs[0];s&&(e=this.uniqueURLs.filter(e=>e.name===s));a=e[0].url+"VersionManagementServer/versions/"+o}this.requestService({method:"POST",url:a,params:{f:"json",token:t}}).then(e=>{r(e)}).catch(e=>{r(e)})})}checkValidVersionName(e){const t={success:!0,error:{message:"Version is valid"}};return e.length<=62?" "===e.substring(0,1)?(t.success=!1,t.error.message="Version name can not start with a space"):e.match(/(?=.*[.;'"])/)&&(t.success=!1,t.error.message="Version name can not have a period, semicolon, and single or double quotes"):(t.success=!1,t.error.message="Exceeded 62 characters for version name"),t}requestVersions(e,t){return new Promise((s,i)=>{let r=e,n={};t?(r+="VersionManagementServer/versionInfos",n={f:"json",includeHidden:!0,token:t},this.isOrgUser=!0):(r+="VersionManagementServer/versions",n={f:"json",includeHidden:!0},this.isOrgUser=!1),this.requestService({method:"POST",url:r,params:n}).then(i=>{i.hasOwnProperty("error")?t?e?(console.log("second pass, service url"),this.getVersions(e).then(e=>{e.canManage=!1,s(e)})):(console.log("second pass, no service url"),this.getVersions().then(e=>{e.canManage=!1,s(e)})):(i.canManage=!1,s(i)):(i.canManage=!0,s(i))}).catch(e=>{s(e)})})}getLayerObject(e){return e.type,t.DataSourceTypes.FeatureLayer,e}serviceNameLookup(e){return new Promise((t,s)=>{const i=e+"FeatureServer";this.requestService({method:"POST",url:i,params:{f:"json"}}).then(e=>{e.hasOwnProperty("documentInfo")?t(e.documentInfo.Title):t("")}).catch(e=>{t(e)})})}versionRead(e){return new Promise((t,s)=>{let i=this.uniqueURLs[0],r=e.versionGuid.replace("{","");r=r.replace("}",""),i=i+"VersionManagementServer/versions/"+r+"/"+e.action+"Reading/",this.requestService({method:"POST",url:i,params:{f:"json",sessionId:e.versionGuid,token:e.token}}).then(e=>{t(e)})})}searchPortalUsers(e,t,s){return new Promise((i,r)=>{let n=e+"/sharing/rest/community/users";e.includes("sharing/rest")&&(n=e+"/community/users"),this.requestService({method:"POST",url:n,params:{f:"json",q:t,token:s}}).then(e=>{i(e)}).catch(e=>{i(e)})})}requestService(e){return new Promise(function(s,i){const r={params:e.params,httpMethod:e.method};t.esri.restRequest.request(e.url,r).then(e=>{s(e)}).catch(e=>{s(e)})})}}var h=l(85072),g=l.n(h),u=l(97825),m=l.n(u),p=l(77659),f=l.n(p),S=l(55056),v=l.n(S),I=l(10540),M=l.n(I),x=l(41113),j=l.n(x),y=l(97271),w={};w.styleTagTransform=j(),w.setAttributes=v(),w.insert=f().bind(null,"head"),w.domAPI=m(),w.insertStyleElement=M();g()(y.A,w);y.A&&y.A.locals&&y.A.locals;var D=function(e,t,s,i){return new(s||(s=Promise))(function(r,n){function a(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((i=i.apply(e,t||[])).next())})};const b=l(74239),N=l(64662),T=l(69241),C=l(81227),z=l(73129),O=l(87820);class A extends s.BaseWidgetSetting{constructor(s){super(s),this.sidePopperTrigger=t.React.createRef(),this.defaultVersion="sde.DEFAULT",this.vms=d.getInstance(),this.formatMessage=(e,s)=>{const n=Object.assign({},i,r.defaultMessages,t.defaultMessages);return this.props.intl.formatMessage({id:e,defaultMessage:n[e]},s)},this.fieldColumns=[{field:"access",alias:this.formatMessage("fieldColumnsAccess"),show:!0,sort:"desc",order:2,available:!0},{field:"commonAncestorDate",alias:this.formatMessage("fieldColumnsCommonAncestorDate"),show:!1,sort:"desc",order:5,available:!0},{field:"creationDate",alias:this.formatMessage("fieldColumnsCreationDate"),show:!1,sort:"desc",order:3,available:!0},{field:"description",alias:this.formatMessage("fieldColumnsDescription"),show:!1,sort:"desc",order:4,available:!0},{field:"evaluationDate",alias:this.formatMessage("fieldColumnsEvaluationDate"),show:!1,sort:"desc",order:6,available:!0},{field:"modifiedDate",alias:this.formatMessage("fieldColumnsModifiedDate"),show:!0,sort:"desc",order:7,available:!0},{field:"previousAncestorDate",alias:this.formatMessage("fieldColumnsPreviousAncestorDate"),show:!1,sort:"desc",order:8,available:!0},{field:"reconcileDate",alias:this.formatMessage("fieldColumnsReconcileDate"),show:!1,sort:"desc",order:9,available:!0},{field:"versionGuid",alias:this.formatMessage("fieldColumnsVersionGuid"),show:!1,sort:"desc",order:10,available:!0},{field:"versionId",alias:this.formatMessage("fieldColumnsVersionId"),show:!1,sort:"desc",order:11,available:!0},{field:"versionName",alias:this.formatMessage("fieldColumnsVersionName"),show:!0,sort:"desc",order:0,available:!0},{field:"versionOwner",alias:this.formatMessage("fieldColumnsVersionOwner"),show:!0,sort:"desc",order:1,available:!0}],this.allowance=[{label:this.formatMessage("allowancesSwitch"),key:"Switch",enabled:!0},{label:this.formatMessage("allowancesCreateNew"),key:"CreateNew",enabled:!0},{label:this.formatMessage("allowancesDeleteExisting"),key:"DeleteExisting",enabled:!1},{label:this.formatMessage("allowancesUpdateName"),key:"UpdateName",enabled:!0},{label:this.formatMessage("allowancesUpdateDescription"),key:"UpdateDescription",enabled:!0},{label:this.formatMessage("allowancesChangeOwner"),key:"ChangeOwner",enabled:!1},{label:this.formatMessage("allowancesChangePrivileges"),key:"ChangePrivileges",enabled:!1},{label:this.formatMessage("allowancesAutoRefreshList"),key:"AutoRefreshList",enabled:!0,refreshInterval:1}],this._updateServicesToConfig=e=>{const s=(0,t.Immutable)(this.state.configObject),i=t.Immutable.asMutable(s,{deep:!0});i.services=t.Immutable.asMutable((0,t.Immutable)(this.state.vmsServices),{deep:!0}),this.setState({configObject:i},()=>{e?this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",i),useDataSources:e}):this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",i)})})},this.updateConfigItem=(e,s)=>{const i=(0,t.Immutable)(this.state.vmsServices),r=t.Immutable.asMutable(i,{deep:!0});r.forEach(t=>{t.name===this.state.selectedService.name&&(t.configuredSettings[s]=e.hasOwnProperty("currentTarget")?e.currentTarget.value:e)}),this.setState({vmsServices:r},()=>{this._updateServicesToConfig()})},this.updateGeneralItem=(e,t)=>{const s=Object.assign({},this.state.configObject);s[t]=e,"expandMode"===t?this.setState({configObject:s,expandMode:e},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})}):this.setState({configObject:s},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})})},this.updateArrangementItem=e=>{const t=Object.assign({},this.state.configObject);t.arrangement=e,this.setState({configObject:t,arrangementStyle:e},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",t)})})},this.onToggleUseDataEnabled=e=>{this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e})},this._checkDSInfo=e=>{const s=t.DataSourceManager.getInstance().getDataSources();for(const e in s)s[e].type},this.arrangementHandler=e=>{this.updateArrangementItem(e)},this.renderFieldOrderList=()=>{const s=[];let n=[];if(Object.keys(this.state.selectedService).length>0){const a=(0,t.Immutable)(this.state.vmsServices),o=t.Immutable.asMutable(a,{deep:!0});if(""!==this.state.selectedService){const e=o.filter(e=>e.name===this.state.selectedService.name);e.length>0&&(n=e[0].configuredSettings.displayInfo)}n.sort(this._compare("order","desc")),n.forEach(e=>{for(const t in i)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))}),n.forEach((t,i)=>{t.available&&s.push((0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{style:{fontSize:"smaller"},children:t.alias}),(0,e.jsx)("td",{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[i>0?(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("up",i)},children:(0,e.jsx)(r.Icon,{icon:N,size:"12",color:"#fff"})}):(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm"}),i<n.length-1?(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("down",i)},children:(0,e.jsx)(r.Icon,{icon:T,size:"12",color:"#fff"})}):(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm"})]})})]},t.field))})}return(0,e.jsxs)(r.Table,{style:{height:"100%"},children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{style:{fontSize:"smaller"},children:this.formatMessage("field")}),(0,e.jsx)("th",{style:{fontSize:"smaller"}})]})}),(0,e.jsx)("tbody",{children:s})]})},this.renderConfigSlideout=()=>{var s;const{theme:i}=this.props;let a=!0;return a=this._checkAllowAllState(),(0,e.jsx)(n.SidePopper,{isOpen:this.state.showSidePanel,position:"right",toggle:()=>{this.setState({showSidePanel:!this.state.showSidePanel})},trigger:null===(s=this.sidePopperTrigger)||void 0===s?void 0:s.current,children:(0,e.jsxs)("div",{style:{height:"100%",overflow:"auto"},children:[(0,e.jsx)("div",{style:{textAlign:"right",width:"100%"},children:(0,e.jsx)(r.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-2",onClick:()=>{this.setState({showSidePanel:!1})},children:(0,e.jsx)(r.Icon,{icon:b,size:"16"})})}),this.state.selectedService.hasOwnProperty("name")&&this.renderVersionSelector(),"simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&this.renderVersionInformation():"","simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&(0,e.jsx)(n.SettingSection,{className:"map-selector-section",title:(0,e.jsx)(t.React.Fragment,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,e.jsx)("div",{style:{display:"flex",flex:1},children:this.formatMessage("settingsSectionsVersionCapability")}),(0,e.jsx)(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionCapabilityTooltip"),placement:"bottom",children:(0,e.jsx)("div",{children:(0,e.jsx)(r.Icon,{icon:z,size:"16",color:i.ref.palette.neutral[800]})})})]})}),children:(0,e.jsx)(n.SettingRow,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[(0,e.jsxs)("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1},children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end"}}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"},children:this.formatMessage("settingsSectionsAllowCapability")})]}),(0,e.jsxs)("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1},children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end",paddingLeft:5,paddingRight:5,paddingBottom:5},children:this.formatMessage("settingsSectionsAllowAll")}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end",borderBottom:"1px solid #ccc",paddingBottom:5},children:(0,e.jsx)(r.Switch,{checked:a,onChange:e=>{this.updateAllowanceAction(null,e.currentTarget.checked,!0)}})})]}),this.renderAllowances("advance")]})})}):(0,e.jsx)(n.SettingSection,{children:this.renderAllowances("simple")})]})})},this._checkAllowAllState=()=>{let e=!0;const s=(0,t.Immutable)(this.state.vmsServices);if(""!==this.state.selectedService){const t=s.filter(e=>e.name===this.state.selectedService.name);if(t.length>0){e=!t[0].configuredSettings.allowance.some(e=>!1===e.enabled)}}return e},this.renderAllowances=s=>{const n=[];let a=[];const o=(0,t.Immutable)(this.state.vmsServices),l=t.Immutable.asMutable(o,{deep:!0});if(""!==this.state.selectedService){const e=l.filter(e=>e.name===this.state.selectedService.name);e.length>0&&(a=e[0].configuredSettings.allowance)}return a.forEach(e=>{for(const t in i)t.toLowerCase()===("allowances"+e.key).toLowerCase()&&(e.label=this.formatMessage(t))}),a.forEach(t=>{("advance"===s||"AutoRefreshList"===t.key)&&n.push((0,e.jsxs)("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1},children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:4},children:t.label}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"},children:(0,e.jsx)(r.Switch,{checked:t.enabled,onChange:e=>{this.updateAllowanceAction(t.key,e.currentTarget.checked,!1)}})})]},t.label)),"AutoRefreshList"===t.key&&t.enabled&&(n.push((0,e.jsxs)("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1},children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",flex:6},children:this.formatMessage("settingsSectionsMinutes")}),(0,e.jsx)("div",{style:{textAlign:"right",display:"flex",flexDirection:"row",flex:1},children:(0,e.jsx)(r.NumericInput,{style:{width:75},value:this.state.intervalNumber,size:"sm",min:1,max:999,type:"number",onChange:e=>{this.setState({invalidInterval:!0,intervalNumber:e},()=>{this.updateAllowanceInterval(t.key,e)})}})})]},"refreshInterval")),n.push((0,e.jsx)("div",{style:{textAlign:"right",fontSize:"12px",fontStyle:"italic"},children:this.formatMessage("settingsSectionsTooltipNumber")},"toolTipHolder")))}),n},this.updateAllowanceInterval=(e,s)=>{if(""!==this.state.selectedService){let i=[];const r=(0,t.Immutable)(this.state.vmsServices),n=t.Immutable.asMutable(r,{deep:!0});n.forEach(t=>{t.name===this.state.selectedService.name&&(i=t.configuredSettings.allowance,i.forEach(t=>{t.key===e&&(t.refreshInterval=s)}))}),this.setState({vmsServices:n},()=>{this._updateServicesToConfig()})}},this.updateAllowanceAction=(e,s,i)=>{if(""!==this.state.selectedService){let r=[];const n=(0,t.Immutable)(this.state.vmsServices),a=t.Immutable.asMutable(n,{deep:!0});a.forEach(t=>{t.name===this.state.selectedService.name&&(r=t.configuredSettings.allowance,r.forEach(t=>{(i||t.key===e)&&(t.enabled=s)}))}),this.setState({vmsServices:a},()=>{this._updateServicesToConfig()})}},this.updateActiveService=()=>{if(""!==this.state.selectedService){const e=(0,t.Immutable)(this.state.vmsServices),s=t.Immutable.asMutable(e,{deep:!0});s.forEach(e=>{e.name===this.state.selectedService.name?e.activeInBuilder=!0:e.activeInBuilder=!1}),this.setState({vmsServices:s},()=>{this._updateServicesToConfig()})}},this.renderServiceSelector=()=>{const{theme:s}=this.props,i=[];return this.state.vmsServices.length>0&&this.state.vmsServices.forEach((t,s)=>{const n=(0,e.jsxs)("tr",{style:{borderLeft:t.name===this.state.selectedService.name?"solid #00aabb":""},children:[this.state.vmsServices.length>1&&(0,e.jsxs)("td",{children:[s>0?(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("up",s)},children:(0,e.jsx)(r.Icon,{icon:N,size:"12",color:"#fff"})}):"",s<this.state.vmsServices.length-1?(0,e.jsx)(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("down",s)},children:(0,e.jsx)(r.Icon,{icon:T,size:"12",color:"#fff"})}):""]}),(0,e.jsx)("td",{role:"button",style:{fontSize:"smaller",width:"100%"},onClick:()=>{this.serviceSelectorAction(t)},children:t.name}),(0,e.jsx)("td",{role:"button",style:{fontSize:"smaller"},onClick:()=>{this.serviceRemoveAction(t)},children:(0,e.jsx)(r.Icon,{icon:b,size:"12"})})]},t.name);i.push(n)}),(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",title:(0,e.jsx)(t.React.Fragment,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,e.jsx)(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionService"),placement:"bottom",children:(0,e.jsx)("div",{style:{width:"100%",paddingRight:20,overflow:"hidden",textOverflow:"ellipsis"},children:this.formatMessage("settingsSectionsVersionService")})}),(0,e.jsx)(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionServiceHelp"),placement:"bottom",children:(0,e.jsx)("div",{onClick:()=>{window.open("https://pro.arcgis.com/en/pro-app/latest/help/data/geodatabases/overview/register-a-dataset-as-branch-versioned.htm","_blank")},style:{cursor:"pointer"},children:(0,e.jsx)(r.Icon,{icon:O,size:"16",color:s.ref.palette.neutral[800]})})})]})}),children:[(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(a.DataSourceSelector,{types:(0,t.Immutable)([t.AllDataSourceTypes.FeatureService,t.AllDataSourceTypes.MapService]),mustUseDataSource:!0,isMultiple:!0,useDataSourcesEnabled:this.props.useDataSourcesEnabled,onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.validateVMSExist,widgetId:this.props.id,closeDataSourceListOnChange:!0})}),(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(r.Alert,{form:"basic",type:"warning",open:this.state.showAlert,closable:!0,text:this.state.alertMessage,onClose:()=>{this.setState({showAlert:!this.state.showAlert})}})}),(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)("div",{className:"w-100",children:(0,e.jsx)("div",{className:"component-map-selector",style:{maxHeight:300,overflow:"auto"},ref:this.sidePopperTrigger,children:(0,e.jsx)(r.Table,{size:"sm",hover:!0,style:{fontSize:"medium"},children:(0,e.jsx)("tbody",{children:i})})})})})]})},this.validateVMSExist=e=>D(this,void 0,void 0,function*(){const s=t.DataSourceManager.getInstance().getDataSources();let i=!1,r=!1;for(const n in s)if(n===e[0].dataSourceId){const a=s[n].getDataSourceJson();let o=a.url;if(a.url.includes("FeatureServer")&&(o=a.url.substring(0,a.url.indexOf("FeatureServer"))),a.url.includes("MapServer")&&(o=a.url.substring(0,a.url.indexOf("MapServer"))),this.state.vmsServices.length>0){this.state.vmsServices.filter(e=>e.name===s[n].getLabel()||e.url===o).length>0&&(r=!0)}if(!r){const r=this.getServiceToken(o);let a=!1;if(a=null!==r?yield this.vms.checkValidVMS(o,r):yield this.vms.checkValidVMS(o),a){i=!0;const r={},a=(0,t.Immutable)(this.state.vmsServices),l=t.Immutable.asMutable(a,{deep:!0});r.name=s[n].getLabel(),r.url=o,r.datasource=n,r.activeInBuilder=!0,r.configuredSettings={startupVersion:this.defaultVersion,startOnLoad:!1,allowance:t.Immutable.asMutable((0,t.Immutable)(this.allowance),{deep:!0}),displayInfo:t.Immutable.asMutable((0,t.Immutable)(this.fieldColumns),{deep:!0})},l.forEach(e=>{e.activeInBuilder=!1}),l.push(r),this.setState({vmsServices:l,showAlert:!1,alertMessage:"",selectedService:r,showSidePanel:!0},()=>{this._updateServicesToConfig(e),this.pullVersions(this.state.selectedService)})}}}r?this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesAlreadyAdded")}):i||this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesNotValid")})}),this.serviceSelectorAction=e=>{if(""!==e){const t=this.state.vmsServices.filter(t=>t.name===e.name);t.length>0&&this.setState({selectedService:t[0],showSidePanel:!0,intervalNumber:t[0].configuredSettings.allowance[7].refreshInterval,searchVersionText:"",showAlert:!1},()=>{this.pullVersions(this.state.selectedService),this.updateActiveService()})}else this.setState({selectedService:"",showSidePanel:!1,intervalNumber:1,invalidInterval:!1,searchVersionText:""})},this.serviceRemoveAction=e=>{if(e){let s=-1,i=!1;const r=(0,t.Immutable)(this.state.vmsServices),n=t.Immutable.asMutable(r,{deep:!0});n.forEach((t,r)=>{t.name===e.name&&(s=r,""!==this.state.selectedService&&t.name===this.state.selectedService.name&&(i=!0))}),-1!==s&&(n.splice(s,1),i?this.setState({vmsServices:n,selectedService:"",showSidePanel:!1,searchVersionText:""},()=>{this._updateServicesToConfig()}):this.setState({vmsServices:n},()=>{this._updateServicesToConfig()}))}},this.renderVersionSelector=()=>{let t=this.defaultVersion,s=null;const i=[];let a=!1;const o=this.state.vmsServices.filter(e=>{if(""!==this.state.selectedService&&e.name===this.state.selectedService.name)return e});return o.length>0&&(t=o[0].configuredSettings.startupVersion),""!==this.state.searchVersionText&&this.state.filteredVersionList.length>0&&(t=this.state.filteredVersionList[0].versionGuid),this.state.filteredVersionList.forEach(r=>{r.versionName===this.defaultVersion&&(s=r.versionGuid),t===r.versionGuid&&(a=!0),this.state.searchVersionText===r.versionName&&(a=!0,t=r.versionGuid),i.push((0,e.jsx)("option",{value:r.versionGuid,children:r.versionName},r.versionGuid))}),a||(t=null!==s?s:this.defaultVersion),(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsSelectVersion"),children:[(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(r.TextInput,{type:"text",onChange:this.searchVersions,value:this.state.searchVersionText,placeholder:this.formatMessage("settingsSectionsSearchName"),style:{width:"100%"}})}),(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(r.Select,{onChange:e=>{this.updateVersionSelected(e.currentTarget)},defaultValue:t,value:t,children:i})})]})},this.updateVersionSelected=e=>{const s=(0,t.Immutable)(this.state.vmsServices),i=t.Immutable.asMutable(s,{deep:!0});i.forEach((t,s)=>{""!==this.state.selectedService&&t.name===this.state.selectedService.name&&(t.configuredSettings.startupVersion=e.value)}),""!==this.state.searchVersionText?this.setState({vmsServices:i,searchVersionText:e.textContent},()=>{this._updateServicesToConfig()}):this.setState({vmsServices:i},()=>{this._updateServicesToConfig()})},this.renderGeneralSection=()=>{let s=10;const i=Object.assign({},this.state.configObject);i.hasOwnProperty("pageCounter")&&(s=i.pageCounter);const a=[(0,e.jsx)("option",{value:5,children:"5"},"5"),(0,e.jsx)("option",{value:10,children:"10"},"10"),(0,e.jsx)("option",{value:25,children:"25"},"25"),(0,e.jsx)("option",{value:50,children:"50"},"50")];return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsGeneralSettings"),children:[(0,e.jsx)(n.SettingRow,{children:this.formatMessage("settingsSectionsRecordsPage")}),(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(r.Select,{size:"sm",onChange:e=>{this.updateGeneralItem(e.currentTarget.value,"pageCounter")},defaultValue:s,children:a})})]}),(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",title:"",children:[(0,e.jsx)(n.SettingRow,{children:this.formatMessage("settingsSectionsExpandBasic")}),(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)(r.Switch,{checked:this.state.expandMode,onChange:e=>{this.updateGeneralItem(e.currentTarget.checked,"expandMode")}})})]})]})},this.pullVersions=e=>{let t=e.url;e.url.indexOf("FeatureServer")>=0&&(t=e.url.substring(0,e.url.indexOf("FeatureServer"))),e.url.indexOf("MapServer")>=0&&(t=e.url.substring(0,e.url.indexOf("MapServer")));let s=this.getServiceToken(t);null===s&&(s=void 0),this.vms.getVersions(e.name,t,s).then(e=>{e.hasOwnProperty("success")?e.success&&e.hasOwnProperty("versions")&&this.setState({filteredVersionList:e.versions,allVersionList:e.versions}):e.hasOwnProperty("error")&&this.setState({filteredVersionList:[],allVersionList:[]})})},this.searchVersions=e=>{const t=[...this.state.allVersionList].filter(t=>t.versionName.toLowerCase().indexOf(e.currentTarget.value.toLowerCase())>=0);this.setState({filteredVersionList:t,searchVersionText:e.currentTarget.value},()=>{this.state.filteredVersionList.length>0&&this.updateConfigItem(this.state.filteredVersionList[0].versionGuid,"startupVersion")})},this.renderVersionInformation=()=>{const{theme:s}=this.props,a=[];let o=[];const l=(0,t.Immutable)(this.state.vmsServices),c=t.Immutable.asMutable(l,{deep:!0});if(""!==this.state.selectedService){const t=c.filter(e=>e.name===this.state.selectedService.name);if(t.length>0&&(o=t[0].configuredSettings.displayInfo),o.length>0){const t=(()=>{let e=!1;return o.filter(e=>!0===e.show).length<=1&&(e=!0),e})();o.sort(this._compare("order","desc")),o.forEach(e=>{for(const t in i)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))}),o.forEach(s=>{a.push((0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{style:{fontSize:12,textAlign:"left"},children:s.alias}),(0,e.jsx)("td",{children:(0,e.jsx)(r.Checkbox,{className:"mr-2 font-13",checked:s.available,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"available",e.currentTarget.checked)},value:s.field})}),(0,e.jsx)("td",{children:(0,e.jsx)(r.Checkbox,{className:"mr-2 font-13",checked:s.show,disabled:!!s.show&&t,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"show",e.currentTarget.checked)},value:s.field})})]},s.field))})}}return(0,e.jsxs)(n.SettingSection,{className:"map-selector-section",title:(0,e.jsx)(t.React.Fragment,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,e.jsx)("div",{style:{display:"flex",flex:1},children:this.formatMessage("settingsSectionsVersionInfo")}),(0,e.jsx)(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionInfoTooltip"),placement:"bottom",children:(0,e.jsx)("div",{children:(0,e.jsx)(r.Icon,{icon:z,size:"16",color:s.ref.palette.neutral[800]})})})]})}),children:[(0,e.jsx)(n.SettingRow,{children:(0,e.jsx)("div",{className:"w-100",children:(0,e.jsx)("div",{className:"component-map-selector",style:{maxHeight:250,overflow:"auto"},children:(0,e.jsxs)(r.Table,{size:"sm",hover:!0,width:"90%",style:{textAlign:"center"},children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:"smaller",whiteSpace:"nowrap",alignItems:"top",zIndex:9999},children:(0,e.jsx)(r.Button,{type:"tertiary",onClick:e=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},id:"btnFieldMgmt",children:(0,e.jsx)(r.Icon,{icon:C,size:"14",color:"#fff"})})}),(0,e.jsx)("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999},children:this.formatMessage("fieldColumnsColumnAvailable")}),(0,e.jsx)("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999},children:this.formatMessage("fieldColumnsColumnShow")})]})}),(0,e.jsx)("tbody",{children:a})]})})})}),(0,e.jsx)(r.FloatingPanel,{open:this.state.showFieldMgmt,reference:"btnFieldMgmt",placement:"left",onHeaderClose:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},toggle:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},defaultSize:{width:250,height:600},children:(0,e.jsx)("div",{style:{width:250,height:"100%",overflow:"auto"},children:this.renderFieldOrderList()})})]})},this.changeFieldOrder=(e,s)=>{if(""!==this.state.selectedService){let i=[];const r=(0,t.Immutable)(this.state.vmsServices),n=t.Immutable.asMutable(r,{deep:!0});n.forEach(t=>{if(t.name===this.state.selectedService.name){i=t.configuredSettings.displayInfo,i.sort(this._compare("order","desc"));let r=s;"up"===e?(r-=1,i[s].order=r,i[s-1].order=s):(r+=1,i[s].order=r,i[s+1].order=s)}}),this.setState({vmsServices:n},()=>{this._updateServicesToConfig()})}},this.changeServiceOrder=(e,s)=>{const i=(0,t.Immutable)(this.state.vmsServices),r=t.Immutable.asMutable(i,{deep:!0}),n=r.splice(s,1)[0];"up"===e?r.splice(s-1,0,n):r.splice(s+1,0,n),this.setState({vmsServices:r},()=>{this._updateServicesToConfig()})},this.changeFieldVisiblity=(e,s,i)=>{if(""!==this.state.selectedService){let r=[];const n=(0,t.Immutable)(this.state.vmsServices),a=t.Immutable.asMutable(n,{deep:!0});a.forEach(t=>{t.name===this.state.selectedService.name&&(r=t.configuredSettings.displayInfo,r.forEach(t=>{t.field===e&&(t[s]=i)}))}),this.setState({vmsServices:a},()=>{this._updateServicesToConfig()})}},this._compare=(e,t)=>function(s,i){let r=0;return"desc"===t?s[e]>i[e]?r=1:s[e]<i[e]&&(r=-1):s[e]<i[e]?r=1:s[e]>i[e]&&(r=-1),r},this.updateVMSInfo=(e,t)=>new Promise((s,i)=>{const r=Object.assign({},this.state.selectedService);"configured"===e?r[e]=t:r.configuredSettings[e]=t,this.setState({selectedService:r},()=>{const e=[...this.state.vmsServices];e.forEach(e=>{e.name===this.state.selectedService.name&&(e=this.state.selectedService)}),this.setState({vmsServices:e},()=>{s(!0)})})}),this.getServiceToken=e=>{var s;const i=t.urlUtils.getUrlHost(e.toLowerCase()),r=t.SessionManager.getInstance().getSessions(),n=r.filter(e=>e.portal.toLowerCase().indexOf(i)>-1);let a=null;return this.props.portalUrl.toLowerCase().includes(i)&&(a=null===(s=t.SessionManager.getInstance().getMainSession())||void 0===s?void 0:s.token),n.length>0?a=n[0].token:null===a&&r.map(e=>{if(e.hasOwnProperty("federatedServers")){for(const t in e.federatedServers)t.toLowerCase().includes(i)&&(a=e.federatedServers[t].token);return!0}if(e.hasOwnProperty("trustedServers")){for(const t in e.trustedServers)t.toLowerCase().includes(i)&&(a=e.trustedServers[t].token);return!0}return!0}),a},this.toggleDialogAction=(e,t)=>{this.setState({showFieldMgmt:!this.state.showFieldMgmt})},this.getStyle=e=>t.css`
      .simple-view-header{
        background: ${e.sys.color.secondary.main};
      }

    `,this.state={allVersionList:[],filteredVersionList:[],selectedVersion:{},selectedService:{},selectedWebMap:"",vmsServices:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("services")?this.props.config.versionConfig.services:[],showServiceSelector:!1,showSidePanel:!1,showWebMapSelector:!1,showFieldMgmt:!1,showAlert:!1,alertMessage:this.formatMessage("alertMessagesErrorAlert"),searchVersionText:"",intervalNumber:1,invalidInterval:!1,expandMode:!this.props.config.versionConfig||(!this.props.config.versionConfig.hasOwnProperty("expandMode")||this.props.config.versionConfig.expandMode),arrangementStyle:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("arrangement")?this.props.config.versionConfig.arrangement:"simple",configObject:t.Immutable.asMutable((0,t.Immutable)(this.props.config.versionConfig),{deep:!0})}}render(){const{theme:t}=this.props;return(0,e.jsxs)("div",{className:"widget-setting-demo",children:[(0,e.jsx)(n.SettingSection,{className:"map-selector-section",title:this.formatMessage("layoutStyleTitle"),children:(0,e.jsxs)(n.SettingRow,{children:[(0,e.jsx)(r.Tooltip,{title:this.formatMessage("layoutStyleBasic"),placement:"bottom",children:(0,e.jsxs)("div",{children:[(0,e.jsx)(r.Button,{onClick:()=>{this.arrangementHandler("simple")},icon:!0,size:"sm",type:"tertiary",active:"simple"===this.state.arrangementStyle,style:{backgroundColor:t.ref.palette.neutral[300],border:"simple"===this.state.arrangementStyle?"solid #00aabb":""},children:(0,e.jsx)(r.Icon,{width:95,height:95,icon:l(99473)})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:this.formatMessage("layoutStyleBasic")})]},"simpleMode")}),(0,e.jsx)("div",{style:{padding:"0 10px"}}),(0,e.jsx)(r.Tooltip,{title:this.formatMessage("layoutStyleAdvanced"),placement:"bottom",children:(0,e.jsxs)("div",{children:[(0,e.jsx)(r.Button,{onClick:()=>{this.arrangementHandler("management")},icon:!0,size:"sm",type:"tertiary",active:"management"===this.state.arrangementStyle,style:{backgroundColor:t.ref.palette.neutral[300],border:"management"===this.state.arrangementStyle?"solid #00aabb":""},children:(0,e.jsx)(r.Icon,{width:95,height:95,icon:l(10567)})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:this.formatMessage("layoutStyleAdvanced")})]},"advanceMode")})]})}),this.renderServiceSelector(),this.renderGeneralSection(),this.state.showSidePanel&&this.renderConfigSlideout()]})}}function V(e){l.p=e}})(),c})())}}});