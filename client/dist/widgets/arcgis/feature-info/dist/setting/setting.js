System.register(["jimu-core/emotion","jimu-core","jimu-ui","jimu-ui/basic/color-picker","jimu-ui/advanced/setting-components","jimu-for-builder","jimu-ui/advanced/data-source-selector","jimu-arcgis","jimu-ui/advanced/style-setting-components","jimu-ui/basic/list-tree"],function(e,t){var s={},a={},i={},o={},n={},r={},l={},d={},c={},p={};return{setters:[function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){a.AllDataSourceTypes=e.AllDataSourceTypes,a.DataSourceComponent=e.DataSourceComponent,a.DataSourceManager=e.DataSourceManager,a.FormattedMessage=e.FormattedMessage,a.Immutable=e.Immutable,a.JSAPILayerTypes=e.JSAPILayerTypes,a.React=e.React,a.css=e.css,a.getAppStore=e.getAppStore,a.polished=e.polished,a.uuidv1=e.uuidv1},function(e){i.Alert=e.Alert,i.Button=e.Button,i.ButtonGroup=e.ButtonGroup,i.Checkbox=e.Checkbox,i.DistanceUnits=e.DistanceUnits,i.Dropdown=e.Dropdown,i.DropdownButton=e.DropdownButton,i.DropdownItem=e.DropdownItem,i.DropdownMenu=e.DropdownMenu,i.Label=e.Label,i.Radio=e.Radio,i.Select=e.Select,i.Switch=e.Switch,i.TextArea=e.TextArea,i.TextInput=e.TextInput,i.defaultMessages=e.defaultMessages},function(e){o.ThemeColorPicker=e.ThemeColorPicker},function(e){n.MapWidgetSelector=e.MapWidgetSelector,n.SettingRow=e.SettingRow,n.SettingSection=e.SettingSection,n.SidePopper=e.SidePopper},function(e){r.builderAppSync=e.builderAppSync},function(e){l.DataSourceSelector=e.DataSourceSelector},function(e){d.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){c.InputUnit=e.InputUnit},function(e){p.List=e.List,p.TreeItemActionType=e.TreeItemActionType}],execute:function(){e((()=>{var e={4108:e=>{"use strict";e.exports=r},13089:e=>{"use strict";e.exports=l},14321:e=>{"use strict";e.exports=i},15562:e=>{"use strict";e.exports=c},54337:e=>{"use strict";e.exports=o},62686:e=>{"use strict";e.exports=d},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},67386:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=a},79298:e=>{"use strict";e.exports=n},98640:e=>{"use strict";e.exports=p}},t={};function u(s){var a=t[s];if(void 0!==a)return a.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,u),i.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var s in t)u.o(t,s)&&!u.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var h={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(h),u.d(h,{__set_webpack_public_path__:()=>I,default:()=>x});var e,t,s=u(67386),a=u(79244),i=u(14321),o=u(54337),n=u(79298),r=u(4108);!function(e){e.syncWithTheme="syncWithTheme",e.usePopupDefined="usePopupDefined",e.custom="custom"}(e||(e={})),function(e){e.auto="auto",e.custom="custom"}(t||(t={}));const l={sourceLabel:"Source",sourceDescription:"A web map or web scene, or any combination of the two.",detailOptions:"Details options",content:"Content",media:"Media",attachments:"Attachments",lastEditInfo:"Last edit info",maxFeaturesDisplayed:"Maximum features displayed",noDataMessageDefaultText:"No data found.",textSize:"Text size",widgetTitle:"Widget title",placeholderOfEditTitleHere:"Edit title here",placeholderOfEditDesHere:"Edit description here",syncWithTheme:"Sync with experience theme",respectTheSource:"Respect the source",usePopupDefined:"Use popup defined",dsNavigator:"Data navigation",featureNavigator:"Feature navigation",contentConfiguration:"Content configuration",displayAttachAs:"Display attachments as",selectMapWidgetStr:"Select a Map widget",showIndexInHeader:"Show index",showCountInHeader:"Show count",showCountTips:"For large data, unchecking this option can reduce data index query and enhance data loading performance.",addStandAlongDataStr:"Select data"};var d=u(13089),c=u(62686),p=function(e,t,s,a){return new(s||(s=Promise))(function(i,o){function n(e){try{l(a.next(e))}catch(e){o(e)}}function r(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(n,r)}l((a=a.apply(e,t||[])).next())})};const g=(0,a.Immutable)([a.AllDataSourceTypes.FeatureLayer,a.AllDataSourceTypes.SceneLayer,a.AllDataSourceTypes.BuildingComponentSubLayer,a.AllDataSourceTypes.OrientedImageryLayer,a.AllDataSourceTypes.ImageryLayer,a.AllDataSourceTypes.SubtypeSublayer]),S=((0,a.Immutable)([a.JSAPILayerTypes.FeatureLayer,a.JSAPILayerTypes.SceneLayer,a.JSAPILayerTypes.BuildingComponentSublayer,a.JSAPILayerTypes.OrientedImageryLayer,a.JSAPILayerTypes.ImageryLayer,a.JSAPILayerTypes.SubtypeSublayer]),(0,a.Immutable)([a.AllDataSourceTypes.FeatureLayer,a.AllDataSourceTypes.SceneLayer,a.AllDataSourceTypes.WebMap,a.AllDataSourceTypes.WebScene,a.AllDataSourceTypes.MapService,a.AllDataSourceTypes.FeatureService,a.AllDataSourceTypes.SceneService,a.AllDataSourceTypes.GroupLayer,a.AllDataSourceTypes.BuildingComponentSubLayer,a.AllDataSourceTypes.BuildingGroupSubLayer,a.AllDataSourceTypes.BuildingSceneLayer,a.AllDataSourceTypes.OrientedImageryLayer,a.AllDataSourceTypes.ImageryLayer,a.AllDataSourceTypes.SubtypeGroupLayer,a.AllDataSourceTypes.SubtypeSublayer]),(0,a.Immutable)([a.AllDataSourceTypes.WebMap,a.AllDataSourceTypes.WebScene,a.AllDataSourceTypes.MapService,a.AllDataSourceTypes.FeatureService,a.AllDataSourceTypes.SceneService,a.AllDataSourceTypes.GroupLayer,a.AllDataSourceTypes.BuildingGroupSubLayer,a.AllDataSourceTypes.BuildingSceneLayer,a.AllDataSourceTypes.SubtypeGroupLayer]));class m extends a.React.PureComponent{constructor(e){var t;super(e),this.onLabelType=e=>{this.setState({label:e.target.value})},this.onDataSourceCreated=e=>{(function(e){return p(this,void 0,void 0,function*(){return yield(0,c.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer"]).then(t=>{const[s]=t;let a;return a=e.layer?e.layer:e.itemId?new s({portalItem:{id:e.itemId,portal:{url:e.portalUrl}}}):new s({url:e.url}),a.load().then(()=>p(this,void 0,void 0,function*(){return yield Promise.resolve(a)}))}).catch(e=>(console.warn(e),null))})})(e).then(e=>{var t,s,a,i,o;const n=null===(t=null==e?void 0:e.popupTemplate)||void 0===t?void 0:t.content;let r=!1,l=!1,d=!1,c=!!(null===(s=null==e?void 0:e.popupTemplate)||void 0===s?void 0:s.title),p=null===(a=null==e?void 0:e.popupTemplate)||void 0===a?void 0:a.lastEditInfoEnabled;n&&n.length?n.forEach(e=>{switch(e.type){case"text":r=!0;break;case"media":l=!0;break;case"attachments":d=!0}}):(r=!0,c=!0,l=!1,d=!1,p=!1);const u=null===(o=null===(i=null==e?void 0:e.capabilities)||void 0===i?void 0:i.data)||void 0===o?void 0:o.supportsAttachment,h=!(!(null==e?void 0:e.editingInfo)||!(null==e?void 0:e.editFieldsInfo));this.setState({popupHasTextContent:r,popupHasMediaContent:l,popupHasAttachmentsContent:d,popupHasTitle:c,popupHasChangeTracking:p,layerHasAttachment:u,layerHasChangeTracking:h})})},this.getDetailsOptionsContent=()=>{var e,t,a,o,r;return(0,s.jsx)(n.SettingSection,{title:this.props.i18nMessage("detailOptions"),"aria-label":this.props.i18nMessage("detailOptions"),role:"group",children:(0,s.jsxs)("div",{className:"featureInfo-options-part",children:[(0,s.jsx)(n.SettingRow,{label:this.props.i18nMessage("title","Title"),children:(0,s.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsTitle,checked:!!(null===(e=this.props.dsConfig)||void 0===e?void 0:e.contentConfig.title),"data-key":"title",onChange:e=>{var t;this.props.onContentOptionsChanged(null===(t=this.props.dsConfig)||void 0===t?void 0:t.id,e.target.checked,"title")},"aria-label":this.props.i18nMessage("title")})}),(0,s.jsx)(n.SettingRow,{label:this.props.i18nMessage("content"),children:(0,s.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.props.dsConfig,checked:!!(null===(t=this.props.dsConfig)||void 0===t?void 0:t.contentConfig.fields),"data-key":"content",onChange:e=>{var t;this.props.onContentOptionsChanged(null===(t=this.props.dsConfig)||void 0===t?void 0:t.id,e.target.checked,"fields")},"aria-label":this.props.i18nMessage("content")})}),(0,s.jsx)(n.SettingRow,{label:this.props.i18nMessage("media"),children:(0,s.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsMedia,checked:!!(null===(a=this.props.dsConfig)||void 0===a?void 0:a.contentConfig.media),"data-key":"media",onChange:e=>{var t;this.props.onContentOptionsChanged(null===(t=this.props.dsConfig)||void 0===t?void 0:t.id,e.target.checked,"media")},"aria-label":this.props.i18nMessage("media")})}),(0,s.jsx)(n.SettingRow,{label:this.props.i18nMessage("attachments"),children:(0,s.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsAttachment,checked:!!(null===(o=this.props.dsConfig)||void 0===o?void 0:o.contentConfig.attachments),"data-key":"attachments",onChange:e=>{var t;this.props.onContentOptionsChanged(null===(t=this.props.dsConfig)||void 0===t?void 0:t.id,e.target.checked,"attachments")},"aria-label":this.props.i18nMessage("attachments")})}),(0,s.jsx)(n.SettingRow,{label:this.props.i18nMessage("lastEditInfo"),children:(0,s.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsChangeTracking,checked:!!(null===(r=this.props.dsConfig)||void 0===r?void 0:r.contentConfig.lastEditInfo),"data-key":"lastEditInfo",onChange:e=>{var t;this.props.onContentOptionsChanged(null===(t=this.props.dsConfig)||void 0===t?void 0:t.id,e.target.checked,"lastEditInfo")},"aria-label":this.props.i18nMessage("lastEditInfo")})})]})})},this.getLabelContent=()=>(0,s.jsx)(n.SettingSection,{title:this.props.i18nMessage("label"),children:(0,s.jsx)(n.SettingRow,{children:(0,s.jsx)(i.TextInput,{type:"text",size:"sm",className:"w-100",value:this.state.label,onChange:this.onLabelType,onAcceptValue:e=>{var t,s;e!==(null===(t=this.props.dsConfig)||void 0===t?void 0:t.label)&&this.props.onLabelChange(null===(s=this.props.dsConfig)||void 0===s?void 0:s.id,e)},"aria-label":this.props.i18nMessage("label")})})}),this.onFilterDs=e=>{let t=!1;if(S.includes(e.type)){const s=a.DataSourceManager.getInstance().getDataSource(e.id),i=s.isDataSourceSet()?s.getAllChildDataSources():[];0===(null==i?void 0:i.length)&&(t=!0)}return t},this.onDataSourceChange=e=>{this.props.onDataSourceChange(e)},this.getDSSelectorContent=()=>{var e;let t=null;const i=this.props.getUseDataSourceById(null===(e=this.props.dsConfig)||void 0===e?void 0:e.useDataSourceId);return i&&i.dataSourceId&&(t=(0,s.jsx)(a.DataSourceComponent,{useDataSource:(0,a.Immutable)(i),onDataSourceCreated:this.onDataSourceCreated,query:null})),(0,s.jsx)(n.SettingSection,{title:this.props.i18nMessage("data"),children:(0,s.jsxs)(n.SettingRow,{children:[(0,s.jsx)(d.DataSourceSelector,{types:g,disableRemove:()=>!0,useDataSourcesEnabled:!0,mustUseDataSource:!0,useDataSources:i?(0,a.Immutable)([i]):(0,a.Immutable)([]),onChange:this.onDataSourceChange,widgetId:this.props.widgetId,closeDataSourceListOnChange:!0,hideDs:this.onFilterDs,isMultiple:this.props.newAddFlag,isBatched:!0}),t]})})},this.state={popupHasTextContent:!0,popupHasMediaContent:!1,popupHasAttachmentsContent:!1,popupHasTitle:!1,popupHasChangeTracking:!1,layerHasAttachment:!1,layerHasChangeTracking:!1,label:(null===(t=this.props.dsConfig)||void 0===t?void 0:t.label)||""}}componentDidUpdate(e){var t,s,a;(null===(t=e.dsConfig)||void 0===t?void 0:t.label)!==(null===(s=this.props.dsConfig)||void 0===s?void 0:s.label)&&this.setState({label:(null===(a=this.props.dsConfig)||void 0===a?void 0:a.label)||""})}getCapabilities(){return{supportsTitle:this.state.popupHasTitle,supportsMedia:this.state.popupHasMediaContent,supportsAttachment:this.state.popupHasAttachmentsContent&&this.state.layerHasAttachment,supportsChangeTracking:this.state.popupHasChangeTracking&&this.state.layerHasChangeTracking}}render(){const e=this.getDSSelectorContent(),t=this.getLabelContent(),a=this.getDetailsOptionsContent();return(0,s.jsxs)("div",{children:[e,t,a]})}}var f=u(15562),C=u(98640),y=u(62838),D=u.n(y);const v=Object.assign({},l,i.defaultMessages);class b extends a.React.PureComponent{static getFullConfig(s){return(0,a.Immutable)({useMapWidget:!0,limitGraphics:!1,maxGraphics:0,noDataMessage:"",styleType:e.usePopupDefined,style:{textColor:"",fontSizeType:t.auto,fontSize:{distance:14,unit:i.DistanceUnits.PIXEL},backgroundColor:""},dsNavigator:!0,featureNavigator:!0,showCount:!0,clearSelection:!0,dsConfigs:[],dsConfigsOfMapWidget:[]}).merge(s,{deep:!0})}constructor(d){super(d),this.addDataBtnRef=a.React.createRef(),this.dsListContentRef=a.React.createRef(),this.getPortUrl=()=>(0,a.getAppStore)().getState().portalUrl,this.onRadioChange=e=>{this.setState({useMapWidget:e}),this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("useMapWidget",e),useDataSources:e?null:this.getUseDataSourcesByDSConfig()})},this.onPropertyChange=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set(e,t)})},this.onContentOptionsChanged=(e,t,s)=>{if(!e)return;let a=this.getDSConfigs().asMutable({deep:!0});a=a.map(a=>(a.id===e&&(a.contentConfig[s]=t),a)),this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("dsConfigs",a)})},this.onLabelChange=(e,t)=>{if(!e)return;let s=this.getDSConfigs().asMutable({deep:!0});s=s.map(s=>(s.id===e&&(s.label=t),s)),this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("dsConfigs",s)})},this.onStyleTypeChanged=e=>{const t=e.target.value;this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("styleType",t)})},this.onStyleChanged=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.setIn(["style",e],t)})},this.onSelectAutoFontSizeType=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.setIn(["style","fontSizeType"],t.auto)})},this.onSelectCustomFontSizeType=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.setIn(["style","fontSizeType"],t.custom)})},this.onFontSizeChanged=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.setIn(["style","fontSize"],e)})},this.onRemoveDSConfig=e=>{if(!e)return;const t=[];this.getDSConfigs().forEach(s=>{s.id!==e&&t.push(s)}),this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("dsConfigs",t),useDataSources:this.getUseDataSourcesByDSConfig(t)})},this.onDataSourceOrderChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("dsConfigs",e)})},this.onDataSourceChange=e=>{if(!e||0===e.length||e[0].dataSourceId===this.state.currentDSConfigId)return;let t=this.getDSConfigs().asMutable({deep:!0});if(this.state.currentDSConfigId){let s=this.getDSConfigById(this.state.currentDSConfigId);s=s.asMutable({deep:!0}),s.useDataSourceId=e[0].dataSourceId,s.label=this.getDSLabel(e[0].dataSourceId)||s.id,t=t.map(e=>e.id===s.id?s:e)}else{let s;e.map(e=>a.DataSourceManager.getInstance().getDataSource(e.dataSourceId)).forEach((e,i)=>{var o;if(!(null===(o=null==e?void 0:e.getDataSourceJson())||void 0===o?void 0:o.isHidden)){const o=function(e,t){const s=a.DataSourceManager.getInstance().getDataSource(e);return{id:(0,a.uuidv1)(),label:t||(null==s?void 0:s.getLabel())||e,useDataSourceId:e,contentConfig:{title:!0,fields:!0,media:!0,attachments:!0,lastEditInfo:!0}}}(e.id);0===i&&(s=o),t.push(o)}}),s&&(this.setState({currentDSConfigId:s.id,showSidePanelForNew:!1}),r.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"currentDSConfigId",value:s.id}))}this.props.onSettingChange({id:this.props.id,config:this.props.savedConfig.set("dsConfigs",t),useDataSources:this.getUseDataSourcesByDSConfig(t)})},this.getUseDataSourcesByDSConfig=e=>{const t=[];return(e||this.getDSConfigs()).forEach(e=>{var s,i;if(!t.find(t=>t.dataSourceId===e.useDataSourceId)){const o=a.DataSourceManager.getInstance().getDataSource(e.useDataSourceId);t.push({dataSourceId:o.id,mainDataSourceId:null===(s=o.getMainDataSource())||void 0===s?void 0:s.id,dataViewId:o.dataViewId,rootDataSourceId:null===(i=o.getRootDataSource())||void 0===i?void 0:i.id,useFieldsInPopupInfo:!0})}}),t},this.i18nMessage=(e,t)=>{const{intl:s}=this.props;return s?s.formatMessage({id:e,defaultMessage:t||v[e]}):""},this.getAdvancedActionMap=()=>({overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:C.TreeItemActionType.RenderOverrideItem,children:[{name:C.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:C.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:C.TreeItemActionType.RenderOverrideItemBody,children:[{name:C.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:C.TreeItemActionType.RenderOverrideItemDragHandle},{name:C.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:C.TreeItemActionType.RenderOverrideItemTitle},{name:C.TreeItemActionType.RenderOverrideItemDetailToggle},{name:C.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})}),this.onShowSidePanel=(e=!1,t)=>{this.setState({currentDSConfigId:t,focusDSConfigId:e?"":t,showSidePanel:!0,showSidePanelForNew:e})},this.onCloseSidePanel=()=>{this.setState({currentDSConfigId:"",showSidePanel:!1,showSidePanelForNew:!1})},this.onMapWidgetSelected=e=>{this.props.onSettingChange({id:this.props.id,useMapWidgetIds:e})},this.getDSLabel=e=>{const t=a.DataSourceManager.getInstance().getDataSource(e);return(null==t?void 0:t.getLabel())||""},this.getDSConfigs=()=>(this.props.config.dsConfigs||(0,a.Immutable)([])).map(e=>{if(null===e.label||void 0===e.label){const t=a.DataSourceManager.getInstance().getDataSource(e.useDataSourceId);return e.set("label",(null==t?void 0:t.getLabel())||"")}return e}),this.getDSConfigById=e=>this.getDSConfigs().find(t=>t.id===e),this.getUseDataSourceById=e=>(this.props.useDataSources||(0,a.Immutable)([])).find(t=>t.dataSourceId===e),this.isDataSourceAccessible=e=>{var t;return!!(null===(t=this.props.useDataSources)||void 0===t?void 0:t.find(t=>e===t.dataSourceId))},this.getDSListContent=()=>{const e=this.getDSConfigs(),t=e.length,a=this.getAdvancedActionMap();return(0,s.jsx)(n.SettingSection,{className:`pt-0 ${t>0?"":"pb-0"} border-0`,children:(0,s.jsxs)("div",{className:"setting-ui-unit-list",ref:this.dsListContentRef,children:[!!t&&(0,s.jsx)(C.List,Object.assign({className:"data-source-list",itemsJson:Array.from(e).map((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`,itemStateChecked:this.state.showSidePanel&&this.state.currentDSConfigId===e.id,itemStateTitle:e.label,itemStateCommands:[{label:this.i18nMessage("remove"),iconProps:()=>({icon:D(),size:12}),action:()=>{this.onRemoveDSConfig(e.id)}}]})),dndEnabled:!0,renderOverrideItemDetailToggle:(e,t)=>{const{itemJsons:[a]}=t.props,o=a.itemStateDetailContent.useDataSourceId;return this.isDataSourceAccessible(o)?"":(0,s.jsx)(i.Alert,{buttonType:"tertiary",form:"tooltip",size:"small",type:"error",text:this.i18nMessage("dataSourceCreateError")})},onUpdateItem:(e,t)=>{var s;const{itemJsons:a,updateType:i}=e;if(i===C.TreeItemActionType.HandleDidDrop){const e=null===(s=a[1])||void 0===s?void 0:s.map(e=>e.itemStateDetailContent);this.onDataSourceOrderChange(e)}},onClickItemBody:(e,t)=>{const{itemJsons:[s]}=t.props,a=s.itemStateDetailContent.id,i=s.itemStateDetailContent.useDataSourceId;this.isDataSourceAccessible(i)&&(this.onShowSidePanel(!1,a),r.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"currentDSConfigId",value:a}))}},a)),this.state.showSidePanel&&this.state.showSidePanelForNew&&(0,s.jsx)(C.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:[{name:"......"}].map((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`,itemStateChecked:!0,itemStateTitle:e.name,itemStateCommands:[]})),dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},a))]})})},this.getStyleContent=()=>{var r;let d,c;const p=(0,s.jsxs)(i.Select,{size:"sm",value:null===(r=this.props.config)||void 0===r?void 0:r.styleType,onChange:this.onStyleTypeChanged,className:"",children:[(0,s.jsx)("option",{value:e.usePopupDefined,children:(0,s.jsx)(a.FormattedMessage,{id:"respectTheSource",defaultMessage:l.respectTheSource})},2),(0,s.jsx)("option",{value:e.custom,children:(0,s.jsx)(a.FormattedMessage,{id:"custom",defaultMessage:"abc"})},3)]});return"custom"===this.props.config.styleType&&(d=this.props.config.style.fontSizeType===t.custom?(0,s.jsx)(f.InputUnit,{style:{width:"6.5rem"},units:[i.DistanceUnits.PIXEL,i.DistanceUnits.PERCENTAGE],className:"item",min:1,value:this.getStyleConfig().fontSize,onChange:this.onFontSizeChanged}):(0,s.jsx)(i.Button,{style:{width:"6.5rem"},disabled:!0,size:"sm",children:(0,s.jsx)(a.FormattedMessage,{id:"auto",defaultMessage:"Auto"})}),c=(0,s.jsxs)("div",{children:[(0,s.jsx)(n.SettingRow,{className:"mt-4",label:(0,s.jsx)(a.FormattedMessage,{id:"textSize",defaultMessage:l.textSize}),"aria-label":this.i18nMessage("textSize"),role:"group",children:(0,s.jsxs)(i.ButtonGroup,{children:[(0,s.jsxs)(i.Dropdown,{activeIcon:!0,className:"dropdown",children:[(0,s.jsx)(i.DropdownButton,{size:"sm",style:{width:"auto",right:"1px"},icon:!0,"aria-haspopup":"menu"}),(0,s.jsxs)(i.DropdownMenu,{className:"dropdown-menu",zIndex:55,alignment:"start",children:[(0,s.jsx)(i.DropdownItem,{active:this.props.config.style.fontSizeType===t.auto,onClick:this.onSelectAutoFontSizeType,children:(0,s.jsx)(a.FormattedMessage,{id:"auto",defaultMessage:"Auto"})},1),(0,s.jsx)(i.DropdownItem,{active:this.props.config.style.fontSizeType===t.custom,onClick:this.onSelectCustomFontSizeType,children:(0,s.jsx)(a.FormattedMessage,{id:"custom",defaultMessage:"Custom"})},2)]})]}),d]})}),(0,s.jsx)(n.SettingRow,{label:(0,s.jsx)(a.FormattedMessage,{id:"textColor",defaultMessage:"Text color"}),children:(0,s.jsx)(o.ThemeColorPicker,{specificTheme:this.props.theme2,value:this.getStyleConfig().textColor,onChange:e=>{this.onStyleChanged("textColor",e)},"aria-label":this.i18nMessage("textColor")})})]})),(0,s.jsxs)(n.SettingSection,{title:this.i18nMessage("style"),"aria-label":this.i18nMessage("style"),role:"group",children:[p,c]})},this.getDSSelectionContent=()=>(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)(n.SettingRow,{children:[(0,s.jsx)(i.Radio,{id:"map-view",style:{cursor:"pointer"},name:"source-option",onChange:e=>{this.onRadioChange(!1)},checked:!this.state.useMapWidget}),(0,s.jsx)(i.Label,{style:{cursor:"pointer"},for:"map-view",className:"ml-1",children:this.i18nMessage("addStandAlongDataStr")})]}),(0,s.jsxs)(n.SettingRow,{children:[(0,s.jsx)(i.Radio,{id:"map-data",style:{cursor:"pointer"},name:"source-option",onChange:e=>{this.onRadioChange(!0)},checked:this.state.useMapWidget}),(0,s.jsx)(i.Label,{style:{cursor:"pointer"},for:"map-data",className:"ml-1",children:this.i18nMessage("interactWithMap")})]})]}),this.getMapSelectorContent=()=>(0,s.jsx)("div",{className:"map-selector-section",children:(0,s.jsx)(n.SettingRow,{children:(0,s.jsx)(n.MapWidgetSelector,{onSelect:this.onMapWidgetSelected,useMapWidgetIds:this.props.useMapWidgetIds})})}),this.getAddDataContent=()=>(0,s.jsx)(n.SettingRow,{children:(0,s.jsx)(i.Button,{className:"w-100 text-default add-table-btn",type:"primary",onClick:()=>{this.onShowSidePanel(!0)},"aria-label":this.i18nMessage("addData"),"aria-describedby":"table-blank-msg",ref:this.addDataBtnRef,children:(0,s.jsx)("div",{className:"w-100 px-2 text-truncate",children:this.i18nMessage("addData")})})}),this.getDSContent=()=>(0,s.jsxs)(n.SettingSection,{className:"p-0 m-0",children:[(0,s.jsx)("div",{children:(0,s.jsxs)(n.SettingSection,{className:"border-0",title:this.i18nMessage("sourceLabel"),role:"group","aria-label":this.i18nMessage("sourceLabel"),children:[this.getDSSelectionContent(),this.state.useMapWidget?this.getMapSelectorContent():this.getAddDataContent()]})}),!this.state.useMapWidget&&this.getDSListContent()]}),this.getGeneralContent=()=>{var e,t,o,r,d,c;const p=`${this.i18nMessage("general")} ${this.i18nMessage("tools")}`;return(0,s.jsxs)(n.SettingSection,{title:this.i18nMessage("general"),"aria-label":p,role:"group",children:[(0,s.jsx)(n.SettingRow,{tag:"label",label:this.i18nMessage("tools")}),(0,s.jsx)(n.SettingRow,{tag:"label",label:this.i18nMessage("dsNavigator"),children:(0,s.jsx)(i.Switch,{className:"can-x-switch",disabled:!this.state.useMapWidget&&(null===(e=this.getDSConfigs())||void 0===e?void 0:e.length)<=1,checked:null===(t=this.props.config)||void 0===t?void 0:t.dsNavigator,"data-key":"dsNavigator",onChange:e=>{this.onPropertyChange("dsNavigator",e.target.checked)}})}),(0,s.jsx)(n.SettingRow,{tag:"label",label:this.i18nMessage("featureNavigator"),children:(0,s.jsx)(i.Switch,{className:"can-x-switch",checked:null===(o=this.props.config)||void 0===o?void 0:o.featureNavigator,"data-key":"featureNavigator",onChange:e=>{this.onPropertyChange("featureNavigator",e.target.checked)}})}),(null===(r=this.props.config)||void 0===r?void 0:r.featureNavigator)&&(0,s.jsx)(n.SettingRow,{children:(0,s.jsxs)(i.Label,{className:"ml-4",children:[(0,s.jsx)(i.Checkbox,{checked:null===(d=this.props.config)||void 0===d?void 0:d.showCount,className:"mr-1",onChange:e=>{this.onPropertyChange("showCount",e.target.checked)}}),(0,s.jsx)(a.FormattedMessage,{id:"showIndexInHeader",defaultMessage:l.showIndexInHeader})]})}),(0,s.jsx)(n.SettingRow,{tag:"label",label:this.i18nMessage("clearSelection"),children:(0,s.jsx)(i.Switch,{className:"can-x-switch",checked:null===(c=this.props.config)||void 0===c?void 0:c.clearSelection,"data-key":"clearSelection",onChange:e=>{this.onPropertyChange("clearSelection",e.target.checked)}})}),(0,s.jsx)("label",{className:"second-header no-data-message",children:(0,s.jsx)(a.FormattedMessage,{id:"noDataMessage",defaultMessage:i.defaultMessages.noDataMessage})}),(0,s.jsx)(i.TextArea,{"aria-label":this.i18nMessage("noDataMessage"),className:"w-100",name:"text",id:"noDataMessageDefaultText",defaultValue:this.props.config.noDataMessage||this.i18nMessage("noDataMessageDefaultText"),onBlur:e=>{this.onPropertyChange("noDataMessage",e.target.value)}})]})},this.getFocusNodeForBackSidePopper=()=>{let e=null;const t=this.getDSConfigs().findIndex(e=>e.id===this.state.focusDSConfigId);return e=t>=0&&this.dsListContentRef.current?this.dsListContentRef.current.getElementsByClassName("jimu-tree-item__body")[t]:this.addDataBtnRef.current,e},this.getDSConfigContent=()=>(0,s.jsx)(n.SidePopper,{position:"right",title:this.i18nMessage("contentConfiguration"),isOpen:this.state.showSidePanel,toggle:this.onCloseSidePanel,trigger:null,backToFocusNode:this.getFocusNodeForBackSidePopper(),children:(0,s.jsx)(m,{dsConfig:this.getDSConfigById(this.state.currentDSConfigId),i18nMessage:this.i18nMessage,widgetId:this.props.id,onDataSourceChange:this.onDataSourceChange,onContentOptionsChanged:this.onContentOptionsChanged,onLabelChange:this.onLabelChange,getUseDataSourceById:this.getUseDataSourceById,newAddFlag:this.state.showSidePanelForNew})}),this.state={useMapWidget:this.props.config.useMapWidget||!1,showSidePanel:!1,showSidePanelForNew:!1,currentDSConfigId:"",focusDSConfigId:""}}getStyleConfig(){return this.props.config.style?this.props.config.style:{textColor:"",fontSize:{distance:0,unit:i.DistanceUnits.PIXEL},backgroundColor:""}}render(){return(0,s.jsx)("div",{css:(e=this.props.theme,a.css`
    .widget-setting-featureInfo{
      font-weight: lighter;
      font-size: 13px;

      .second-header {
        color: ${e.ref.palette.neutral[1e3]};
      }

      .no-data-message {
        margin-top: 25px;
      }

      .webmap-thumbnail{
        cursor: auto;
        width: 100%;
        height: 120px;
        overflow: hidden;
        padding: 1px;
        border: ${a.polished.rem(2)} solid initial;
        img, div{
          width: 100%;
          height: 100%;
        }
      }

      .featureInfo-options-part{
        background-color: ${e.ref.palette.neutral[300]};
        padding: 0.5rem;
      }

      .featureInfo-options{
        .featureInfo-options-item{
          display: flex;
          justify-content: space-between;
          /* margin-bottom: 8px; */
        }
      }

      .data-source-list {
        .jimu-tree-item {
          cursor: pointer;
        }
      }
    }
  `),children:(0,s.jsxs)("div",{className:"widget-setting-featureInfo",children:[this.getDSContent(),this.getStyleContent(),this.getGeneralContent(),this.getDSConfigContent()]})});var e}}b.mapExtraStateProps=e=>({dsJsons:e.appStateInBuilder.appConfig.dataSources});const x=b;function I(e){u.p=e}})(),h})())}}});