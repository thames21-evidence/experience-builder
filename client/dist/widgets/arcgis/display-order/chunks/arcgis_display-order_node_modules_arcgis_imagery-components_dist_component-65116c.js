/*! For license information please see arcgis_display-order_node_modules_arcgis_imagery-components_dist_component-65116c.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_display-order_node_modules_arcgis_imagery-components_dist_component-65116c"],{9644:(t,s,e)=>{e.r(s),e.d(s,{ArcgisImageryItemThumbnail:()=>A});var i=e(9399),r=e(9722),h=e(5695),a=e(3455);const n=Symbol();class o{get taskComplete(){return this.t||(1===this.i?this.t=new Promise((t,s)=>{this.o=t,this.h=s}):3===this.i?this.t=Promise.reject(this.l):this.t=Promise.resolve(this.u)),this.t}constructor(t,s,e){this.p=0,this.i=0,(this._=t).addController(this);const i="object"==typeof s?s:{task:s,args:e};this.v=i.task,this.j=i.args,this.m=i.argsEqual??c,this.k=i.onComplete,this.A=i.onError,this.autoRun=i.autoRun??!0,"initialValue"in i&&(this.u=i.initialValue,this.i=2,this.O=this.T?.())}hostUpdate(){!0===this.autoRun&&this.S()}hostUpdated(){"afterUpdate"===this.autoRun&&this.S()}T(){if(void 0===this.j)return;const t=this.j();if(!Array.isArray(t))throw Error("The args function must return an array");return t}async S(){const t=this.T(),s=this.O;this.O=t,t===s||void 0===t||void 0!==s&&this.m(s,t)||await this.run(t)}async run(t){let s,e;t??=this.T(),this.O=t,1===this.i?this.q?.abort():(this.t=void 0,this.o=void 0,this.h=void 0),this.i=1,"afterUpdate"===this.autoRun?queueMicrotask(()=>this._.requestUpdate()):this._.requestUpdate();const i=++this.p;this.q=new AbortController;let r=!1;try{s=await this.v(t,{signal:this.q.signal})}catch(t){r=!0,e=t}if(this.p===i){if(s===n)this.i=0;else{if(!1===r){try{this.k?.(s)}catch{}this.i=2,this.o?.(s)}else{try{this.A?.(e)}catch{}this.i=3,this.h?.(e)}this.u=s,this.l=e}this._.requestUpdate()}}abort(t){1===this.i&&this.q?.abort(t)}get value(){return this.u}get error(){return this.l}get status(){return this.i}render(t){switch(this.i){case 0:return t.initial?.();case 1:return t.pending?.();case 2:return t.complete?.(this.value);case 3:return t.error?.(this.error);default:throw Error("Unexpected status: "+this.i)}}}const c=(t,s)=>t===s||t.length===s.length&&t.every((t,e)=>!(0,a.Ec)(t,s[e]));var l=e(9728);const u=r.AH`.image-item-thumbnail-wrapper{display:flex;width:200px;height:200px;align-items:center;justify-content:center}.image-item-thumbnail-wrapper img{display:flex;width:100%;height:100%;border:solid 1px var(--calcite-color-border-3)}`;class A extends h.WF{constructor(){super(...arguments),this.fetchImageItemThumbnailTask=new o(this,async([t])=>t?await l.t.fetchOrGet(t):"",()=>[this.thumbnailUrlToFetch])}static{this.properties={thumbnailUrlToFetch:1,messages:0}}static{this.styles=u}render(){return this.fetchImageItemThumbnailTask.render({pending:()=>r.qy`<div class="image-item-thumbnail-wrapper"><calcite-loader .label=${this.messages.loading} scale=s></calcite-loader></div>`,complete:t=>r.qy`<div class="image-item-thumbnail-wrapper"><img src=${t??h.s6}></div>`})}}(0,i.c)("arcgis-imagery-item-thumbnail",A)},9728:(t,s,e)=>{e.d(s,{t:()=>r});var i=e(4345);const r=new class{constructor(){this.cache=new Map,this.inflightJobs=new Map,this.queue=[],this.processing=!1}add(t,s){const e=this.cache.get(t);e&&e!==s&&URL.revokeObjectURL(e),this.cache.set(t,s)}clear(){for(const t of this.cache.values())URL.revokeObjectURL(t);this.cache.clear()}fetchOrGet(t){const s=this.cache.get(t);if(s)return Promise.resolve(s);const e=this.inflightJobs.get(t);if(e)return e;const r=new Promise(s=>{this.queue.push(async()=>{try{const e=await(0,i.default)(t,{responseType:"blob"});if(e?.data){const i=URL.createObjectURL(e.data);this.add(t,i),s(i)}else s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8Xw8AAoMBgF6k6XkAAAAASUVORK5CYII=")}catch{s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8Xw8AAoMBgF6k6XkAAAAASUVORK5CYII=")}finally{this.inflightJobs.delete(t)}}),this.processQueue()});return this.inflightJobs.set(t,r),r}async processQueue(){if(!this.processing){for(this.processing=!0;this.queue.length>0;)await this.queue.shift()();this.processing=!1}}}}}]);