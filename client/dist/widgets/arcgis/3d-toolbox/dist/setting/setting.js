System.register(["jimu-core/emotion","jimu-core","jimu-theme","jimu-ui","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/basic/list-tree","jimu-arcgis","jimu-ui/advanced/map","esri/analysis/SlicePlane","esri/analysis/SliceAnalysis","esri/Viewpoint","esri/core/reactiveUtils"],function(e,t){var a={},i={},n={},o={},l={},s={},r={},c={},d={},u={},g={},p={},m={};return{setters:[function(e){a.jsx=e.jsx,a.jsxs=e.jsxs},function(e){i.APP_FRAME_NAME_IN_BUILDER=e.APP_FRAME_NAME_IN_BUILDER,i.Immutable=e.Immutable,i.LayoutType=e.LayoutType,i.React=e.React,i.ReactRedux=e.ReactRedux,i.classNames=e.classNames,i.css=e.css,i.getAppStore=e.getAppStore,i.hooks=e.hooks,i.polished=e.polished},function(e){n.useTheme=e.useTheme},function(e){o.Button=e.Button,o.FloatingPanel=e.FloatingPanel,o.Icon=e.Icon,o.Label=e.Label,o.NumericInput=e.NumericInput,o.Radio=e.Radio,o.Select=e.Select,o.Switch=e.Switch,o.defaultMessages=e.defaultMessages},function(e){l.getAppConfigAction=e.getAppConfigAction},function(e){s.DirectionSelector=e.DirectionSelector,s.MapWidgetSelector=e.MapWidgetSelector,s.SettingCollapse=e.SettingCollapse,s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection,s.SidePopper=e.SidePopper},function(e){r.List=e.List,r.TreeItemActionType=e.TreeItemActionType},function(e){c.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){d.JimuMap=e.JimuMap},function(e){u.default=e.default},function(e){g.default=e.default},function(e){p.default=e.default},function(e){m.whenOnce=e.whenOnce}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=n},4108:e=>{"use strict";e.exports=l},5338:e=>{"use strict";e.exports=u},5739:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTIiIGhlaWdodD0iNTYiIHZpZXdCb3g9IjAgMCA5MiA1NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHdpZHRoPSI5MiIgaGVpZ2h0PSI1NiIgZmlsbD0iIzI4MjgyOCIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSIxNCIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSIyOCIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSI0MiIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjEyIiB3aWR0aD0iMjciIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjI2IiB3aWR0aD0iNDIiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjQwIiB3aWR0aD0iNTMiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPC9zdmc+DQo="},11526:e=>{"use strict";e.exports=g},12046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},14321:e=>{"use strict";e.exports=o},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},48993:e=>{"use strict";e.exports=d},54948:e=>{"use strict";e.exports=p},62243:e=>{"use strict";e.exports=m},62686:e=>{"use strict";e.exports=c},67386:e=>{"use strict";e.exports=a},79244:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=s},91130:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjcyIiB2aWV3Qm94PSIwIDAgMTA4IDcyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iMjMiIHk9IjI2IiB3aWR0aD0iNjIiIGhlaWdodD0iMjAiIGZpbGw9IiMyODI4MjgiLz4NCjxyZWN0IHg9IjMyIiB5PSIzMCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iNDgiIHk9IjMwIiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHJ4PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI2NCIgeT0iMzAiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjYiIGZpbGw9IiM2QTZBNkEiLz4NCjwvc3ZnPg0K"},93303:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},98640:e=>{"use strict";e.exports=r}},t={};function h(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,h),n.exports}h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},h.d=(e,t)=>{for(var a in t)h.o(t,a)&&!h.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="";var f={};return h.p=window.jimuConfig.baseUrl,(()=>{"use strict";h.r(f),h.d(f,{__set_webpack_public_path__:()=>ie,default:()=>ae});var e=h(67386),t=h(79244),a=h(1888),i=h(14321),n=h(4108),o=h(79298);const l={arrangementStyle:"Arrangement style",activedOnLoad:"Active tool when widget load",timezoneSelector:"Timezone selector",timeSliderSteps:"Time slider steps",dateSelector:"Date selector",defaultSeason:"Default season",syncedWithMap:"Synchronized with map",spring:"Spring",summer:"Summer",fall:"Fall",winter:"Winter",autoYearlyPlay:"Auto yearly play",daytimePlaySpeed:"Daytime play speed",shadowOption:"Shadow option",dateTimeOption:"Date time option",defaultWeather:"Default weather",sunny:"Sunny",cloudy:"Cloudy",rainy:"Rainy",snowy:"Snowy",foggy:"Foggy",defaultValues:"Default values",cloudCover:"Cloud cover",precipitation:"Precipitation",sunnyDay:"Sunny day",cloudyDay:"Cloudy day",rainyDay:"Rainy day",snowyDay:"Snowy day",snowCover:"Snow cover",foggyDay:"Foggy day",fogStrength:"Fog density",defaultAnalysisType:"Default analysis type",threshold:"Above threshold",duration:"Total duration",discreteShadow:"Discrete shadow",colorSchema:"Color schema",observePoint:"Observe Point",markIntersections:"Mark Intersections",markPoint:"Mark Point",excludeGroundSurface:"Allow excluding ground",tiltEnabled:"Allow slice place tilt",defaultSlice:"Default slice",setDefaultSlice:"Set default slice",savePopper:"Save",savedState:"Saved",yesBtn:"Yes",closePopper:"Close",confirmInfo:"You have unsaved changes, do you want to close?"};function s(e){const a=e.ref.palette.neutral[300];return t.css`
      font-size: 13px;
      font-weight: lighter;

      .jimu-widget-setting--section {
        padding: 18px 16px;
      }

      /* ToolsContainer */
      .jimu-tree {
        .jimu-tree-item {
          .jimu-tree-item__content {
            .jimu-tree-item__body {
              background-color: transparent;

              .jimu-tree-item__title-text {
                /* for Safari ,#9889 */
                -webkit-line-clamp: 1;
                word-break: keep-all;
              }
            }
          }
        }
      }

      /* Arrangement ui-mode */
      .ui-mode-setting {
        display: flex;
      }

      .ui-mode-card-chooser{

        .ui-mode-card-wapper {
          width: calc((100% - ${10}px - ${8}px) / 2);
        }

        .ui-mode-card-separator {
          width: ${10}px
        }
        .ui-mode-card {
          flex: 1;
          width: 100%;
          background: ${a};
          border: ${2}px solid ${a};
          margin: 0 0 0.5rem 0;

          .jimu-icon {
            margin: 0
          }
        }
        .ui-mode-card.active {
          border: ${2}px solid #00D8ED;
          background-color: ${a} !important;
        }
        .ui-mode-label {
          overflow: hidden;
          text-align: center;
        }
      }

      .placeholder-container{
        height: calc(100% - 180px);

        .placeholder-icon{
          color: var(--ref-palette-neutral-800);
        }
        .placeholder-hint{
          font-size: ${t.polished.rem(14)};
          font-weight: 500;
          color: var(--ref-palette-neutral-1000);
          max-width: ${t.polished.rem(160)};
        }
      }
  `}var r,c,d,u,g,p,m;!function(e){e.Daylight="daylight",e.Weather="weather",e.ShadowCast="shadowcast",e.LineOfSight="lineofsight",e.Slice="slice"}(r||(r={})),function(e){e.Date="date",e.Season="season"}(c||(c={})),function(e){e.SyncedWithMap="syncedWithMap",e.Spring="spring",e.Summer="summer",e.Fall="fall",e.Winter="winter"}(d||(d={})),function(e){e.Sunny="sunny",e.Cloudy="cloudy",e.Rainy="rainy",e.Snowy="snowy",e.Foggy="foggy"}(u||(u={})),function(e){e.Threshold="threshold",e.Duration="duration",e.Discrete="discrete"}(g||(g={})),function(e){e.List="list",e.Icon="icon"}(p||(p={})),function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(m||(m={}));var S=h(98640),x=h(93303),y=h.n(x);const j=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),s=a.onSidePopperToggle,c=t.React.useCallback((e,t)=>{s(e.id,t.event.target)},[s]),d=t.React.useCallback(e=>(null==e?void 0:e.map(e=>{const t=e.enable,a=[{label:n("edit"),iconProps:()=>({icon:y()}),action:t=>{c(e,t)}}];return{itemKey:e.id,itemStateTitle:n(e.id),itemStateChecked:t,itemStateCommands:e.id!==r.LineOfSight?a:[]}})).asMutable(),[c,n]),[u,g]=t.React.useState(()=>d(a.tools));return t.React.useEffect(()=>{g(d(a.tools))},[a.tools,d]),(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(o.SettingSection,{title:n("tools"),role:"group","aria-label":n("tools"),children:(0,e.jsx)(o.SettingRow,{children:(0,e.jsx)("div",{className:"w-100",children:(0,e.jsx)(S.List,{className:"w-100 py-1 pl-0 pr-1",itemsJson:u,isMultiSelection:!0,dndEnabled:!0,disableDoubleClickTitle:!0,onUpdateItem:(e,i)=>{const[,n]=e.itemJsons,o=[...n],l=[];e.updateType===S.TreeItemActionType.HandleCheckboxChanged?a.tools.forEach(e=>{o.forEach(t=>{const a=t.itemKey;e.id===a&&(e=e.setIn(["enable"],t.itemStateChecked),l.push(e))})}):e.updateType===S.TreeItemActionType.HandleDidDrop&&o.forEach(e=>{const t=e.itemKey,i=a.tools.findIndex(e=>e.id===t);i>-1&&l.push(a.tools[i])}),a.onToolsConfigChanged((0,t.Immutable)(l))}})})})})})});function v(e){return t.css`
    .side-popper-container{
      padding-top: 0;

      .side-popper {
        .numeric-input {
          width: 56px; /* ,#10453 */
        }

        .first-setting-section {
          padding-top: 0;
        }

        .jimu-widget-setting--section {
          padding-left: 0;
          padding-right: 0;
        }
      }

      /* Shadow cast */
      .shadow-cast-radios {
        color: ${e.ref.palette.neutral[1100]}
      }
    }
  `}const C=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),s=a.onAcitvedChanged,r=t.React.useCallback(e=>{s(e)},[s]);return(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(o.SettingSection,{children:(0,e.jsx)(o.SettingRow,{tag:"label",label:n("activedOnLoad"),children:(0,e.jsx)(i.Switch,{checked:a.toolConfig.activedOnLoad,onChange:e=>{r(e.target.checked)}})})})})}),w=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),s=t.React.useMemo(()=>({timeSliderStepsDefault:5,timeSliderStepsMax:120,timeSliderStepsMin:1,speedDefault:1,speedMax:10,speedMin:.1}),[]),{onSettingChanged:r,hanldeToolSettingChanged:u}=a,g=a.toolConfig.config,p=t.React.useCallback((e,t)=>{r(u(a.toolConfig,e,t))},[a.toolConfig,r,u]),m=t.React.useCallback((e,t)=>{t&&p({dateOrSeason:e})},[p]),h=t.React.useCallback(e=>{let t={playButtons:e};!e&&g.dateTimeAutoPlay&&(t=Object.assign(Object.assign({},t),{dateTimeAutoPlay:!1})),p(t)},[p,g.dateTimeAutoPlay]),f=[d.SyncedWithMap,d.Spring,d.Summer,d.Fall,d.Winter];return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsxs)(o.SettingSection,{className:"first-setting-section",children:[(0,e.jsx)(o.SettingRow,{tag:"label",label:n("timezoneSelector"),children:(0,e.jsx)(i.Switch,{checked:g.timezone,onChange:e=>{p({timezone:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{label:n("timeSliderSteps"),children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:g.timeSliderSteps,defaultValue:s.timeSliderStepsDefault,min:s.timeSliderStepsMin,max:s.timeSliderStepsMax,step:1,precision:0,onChange:e=>{p({timeSliderSteps:e})},required:!0,"aria-label":n("timeSliderSteps")})}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("dateSelector"),children:(0,e.jsx)(i.Switch,{checked:g.datePicker,onChange:e=>{p({datePicker:e.target.checked})}})}),g.datePicker&&(0,e.jsx)(o.SettingRow,{role:"group","aria-label":n("dateSelector"),children:(0,e.jsxs)("div",{className:"d-block",children:[(0,e.jsx)("div",{className:"d-flex align-items-center mb-2",children:(0,e.jsxs)(i.Label,{className:"d-flex align-items-center",children:[(0,e.jsx)(i.Radio,{name:"dateOrSeason",className:"mr-2",checked:g.dateOrSeason===c.Date,onChange:(e,t)=>{m(c.Date,t)}}),n("date")]})}),(0,e.jsx)("div",{className:"d-flex align-items-center",children:(0,e.jsxs)(i.Label,{className:"d-flex align-items-center",children:[(0,e.jsx)(i.Radio,{name:"dateOrSeason",className:"mr-2",checked:g.dateOrSeason===c.Season,onChange:(e,t)=>{m(c.Season,t)}}),n("season")]})})]})}),g.dateOrSeason===c.Season&&(0,e.jsxs)("div",{role:"group","aria-label":n("defaultSeason"),className:"my-4",children:[(0,e.jsx)(o.SettingRow,{label:n("defaultSeason")}),(0,e.jsx)(o.SettingRow,{children:(0,e.jsx)(i.Select,{size:"sm",value:g.currentSeason,onChange:e=>{p({currentSeason:e.target.value})},className:"",children:f.map((t,a)=>{const i=n(t);return(0,e.jsx)("option",{value:t,children:i},a)})})})]}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("enablePlayControl"),children:(0,e.jsx)(i.Switch,{checked:g.playButtons,onChange:e=>{h(e.target.checked)}})}),g.playButtons&&g.dateOrSeason===c.Date&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(o.SettingRow,{tag:"label",label:n("autoPlay"),children:(0,e.jsx)(i.Switch,{checked:g.dateTimeAutoPlay,onChange:e=>{p({dateTimeAutoPlay:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{label:n("daytimePlaySpeed"),children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:g.playSpeedMultiplier,defaultValue:s.speedDefault,min:s.speedMin,max:s.speedMax,step:.5,onChange:e=>{p({playSpeedMultiplier:e})},required:!0,"aria-label":n("daytimePlaySpeed")})})]}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("dateTimeOption"),children:(0,e.jsx)(i.Switch,{checked:g.dateTimeToggle,onChange:e=>{p({dateTimeToggle:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("shadowOption"),children:(0,e.jsx)(i.Switch,{checked:g.isShowShadows,onChange:e=>{p({isShowShadows:e.target.checked})}})})]}),(0,e.jsx)(C,{toolConfig:a.toolConfig,onAcitvedChanged:e=>{p(null,e)}})]})}),b=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),{onSettingChanged:s,hanldeToolSettingChanged:r}=a,c=t.React.useCallback((e,t)=>{s(r(a.toolConfig,e,t))},[a.toolConfig,s,r]),[d,g]=t.React.useState(!1),p=()=>{g(!d)},[m,h]=t.React.useState(!1),f=()=>{h(!m)},[S,x]=t.React.useState(!1),y=()=>{x(!S)},[j,v]=t.React.useState(!1),w=()=>{v(!j)},[b,I]=t.React.useState(!1),R=()=>{I(!b)},N=[u.Sunny,u.Cloudy,u.Rainy,u.Snowy,u.Foggy],M=a.toolConfig.config;return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsxs)(o.SettingSection,{className:"first-setting-section",role:"group","aria-label":n("defaultWeather"),children:[(0,e.jsx)(o.SettingRow,{label:n("defaultWeather")}),(0,e.jsx)(o.SettingRow,{children:(0,e.jsx)(i.Select,{size:"sm",value:M.weatherType,onChange:e=>{c({weatherType:e.target.value})},className:"",children:N.map((t,a)=>(0,e.jsx)("option",{value:t,children:n(t)},a))})})]}),(0,e.jsxs)(o.SettingSection,{children:[(0,e.jsx)(o.SettingRow,{label:n("defaultValues")}),(0,e.jsx)(o.SettingCollapse,{label:n("sunnyDay"),role:"group","aria-label":n("sunnyDay"),isOpen:d,onRequestOpen:p,onRequestClose:p,className:"my-4",children:(0,e.jsx)(o.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.sunnyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({sunnyConfig:{cloudCover:e}})},required:!0,"aria-label":n("cloudCover")})})}),(0,e.jsx)(o.SettingCollapse,{label:n("cloudyDay"),role:"group","aria-label":n("cloudyDay"),isOpen:m,onRequestOpen:f,onRequestClose:f,className:"my-4",children:(0,e.jsx)(o.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.cloudyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({cloudyConfig:{cloudCover:e}})},required:!0,"aria-label":n("cloudCover")})})}),(0,e.jsx)(o.SettingCollapse,{label:n("rainyDay"),role:"group","aria-label":n("rainyDay"),isOpen:S,onRequestOpen:y,onRequestClose:y,className:"my-4",children:(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(o.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.rainyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({rainyConfig:Object.assign(Object.assign({},M.rainyConfig),{cloudCover:e})})},required:!0,"aria-label":n("cloudCover")})}),(0,e.jsx)(o.SettingRow,{label:n("precipitation"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.rainyConfig.precipitation,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({rainyConfig:Object.assign(Object.assign({},M.rainyConfig),{precipitation:e})})},required:!0,"aria-label":n("precipitation")})})]})}),(0,e.jsx)(o.SettingCollapse,{label:n("snowyDay"),role:"group","aria-label":n("snowyDay"),isOpen:j,onRequestOpen:w,onRequestClose:w,className:"my-4",children:(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(o.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.snowyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({snowyConfig:Object.assign(Object.assign({},M.snowyConfig),{cloudCover:e})})},required:!0,"aria-label":n("cloudCover")})}),(0,e.jsx)(o.SettingRow,{label:n("precipitation"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.snowyConfig.precipitation,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({snowyConfig:Object.assign(Object.assign({},M.snowyConfig),{precipitation:e})})},required:!0,"aria-label":n("precipitation")})})]})}),(0,e.jsx)(o.SettingCollapse,{label:n("foggyDay"),role:"group","aria-label":n("foggyDay"),isOpen:b,onRequestOpen:R,onRequestClose:R,className:"my-4",children:(0,e.jsx)(o.SettingRow,{label:n("fogStrength"),className:"mx-1 my-2",children:(0,e.jsx)(i.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:M.foggyConfig.fogStrength,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{c({foggyConfig:{fogStrength:e}})},required:!0,"aria-label":n("fogStrength")})})})]}),(0,e.jsx)(C,{toolConfig:a.toolConfig,onAcitvedChanged:e=>{c(null,e)}})]})}),I=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),{onSettingChanged:s,hanldeToolSettingChanged:r}=a,c=t.React.useCallback((e,t)=>{s(r(a.toolConfig,e,t))},[a.toolConfig,s,r]),d=t.React.useCallback((e,t)=>{t&&c(Object.assign(Object.assign({},a.toolConfig.config),{visType:e}))},[c,a.toolConfig]),u=a.toolConfig.config;return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsxs)(o.SettingSection,{className:"first-setting-section",children:[(0,e.jsxs)("div",{role:"group","aria-label":n("defaultAnalysisType"),className:"mb-4",children:[(0,e.jsx)(o.SettingRow,{label:n("defaultAnalysisType")}),(0,e.jsx)(o.SettingRow,{children:(0,e.jsxs)("div",{className:"d-block shadow-cast-radios",children:[(0,e.jsx)("div",{className:"d-flex align-items-center mb-2",children:(0,e.jsxs)(i.Label,{className:"d-flex align-items-center",children:[(0,e.jsx)(i.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:u.visType===g.Threshold,onChange:(e,t)=>{d(g.Threshold,t)}}),n(g.Threshold)]})}),(0,e.jsx)("div",{className:"d-flex align-items-center mb-2",children:(0,e.jsxs)(i.Label,{className:"d-flex align-items-center",children:[(0,e.jsx)(i.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:u.visType===g.Duration,onChange:(e,t)=>{d(g.Duration,t)}}),n(g.Duration)]})}),(0,e.jsx)("div",{className:"d-flex align-items-center",children:(0,e.jsxs)(i.Label,{check:!0,className:"d-flex align-items-center",children:[(0,e.jsx)(i.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:u.visType===g.Discrete,onChange:(e,t)=>{d(g.Discrete,t)}}),n("discreteShadow")]})})]})})]}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("timezoneSelector"),children:(0,e.jsx)(i.Switch,{checked:u.timezone,onChange:e=>{c({timezone:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("dateSelector"),children:(0,e.jsx)(i.Switch,{checked:u.datePicker,onChange:e=>{c({datePicker:e.target.checked})}})})]}),(0,e.jsx)(C,{toolConfig:a.toolConfig,onAcitvedChanged:e=>{c(null,e)}})]})}),R=t.React.memo(a=>{const{onSettingChanged:i,hanldeToolSettingChanged:n}=a,l=t.React.useCallback((e,t)=>{i(n(a.toolConfig,e,t))},[a.toolConfig,i,n]);return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(o.SettingSection,{className:"first-setting-section",children:(0,e.jsx)(o.SettingRow,{})}),(0,e.jsx)(C,{toolConfig:a.toolConfig,onAcitvedChanged:e=>{l(null,e)}})]})});var N=h(62686),M=h(48993);function k(e){return t.css`
    .panel-header {
      background:${e.ref.palette.neutral[400]};
      color:${e.ref.palette.neutral[1e3]};
      height: 50px;
      flex-shrink: 0;
      font-size: 1rem;
      font-weight: 500;
      .jimu-btn {
        color: ${e.ref.palette.neutral[1e3]} !important;
      }
      & >.actions >.jimu-btn.action-close :hover {
        color: ${e.ref.palette.black} !important;
      }
    }
  `}function P(e){return t.css`
      .popper-content {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;

        .popper-header {
          width: 100%;
          flex-shrink: 0;
          flex-grow: 0;
          cursor: move;
        }
        .map-container {
          width: 800px;
          height: 800px;
          background-color: gray;
          display: contents;
        }
        .popper-footer {
          display: flex;
          background:${e.ref.palette.neutral[400]};
          color:${e.ref.palette.neutral[1e3]};
          padding: ${t.polished.rem(10)} ${t.polished.rem(20)};

          .left-tool {
            min-height: 32px;
          }
          .right-tools{
            height: 45px;
            padding: 6px 2px;
            margin-left: auto;

            .jimu-btn {
              min-width: 80px;
            }
          }
        }
      }
  `}var D=h(5338),O=h(11526),T=h(54948),A=h(62243),z=function(e,t,a,i){return new(a||(a=Promise))(function(n,o){function l(e){try{r(i.next(e))}catch(e){o(e)}}function s(e){try{r(i.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(l,s)}r((i=i.apply(e,t||[])).next())})};var W=h(28996),B=h.n(W),V=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};const L=a=>{const i=window.SVG,{className:n}=a,o=V(a,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",n);return i?(0,e.jsx)(i,Object.assign({className:l,src:B()},o)):(0,e.jsx)("svg",Object.assign({className:l},o))},F=t.React.memo(n=>{const o=(0,a.useTheme)(),s=t.hooks.useTranslation(l,i.defaultMessages),r=s("confirmInfo"),c=s("yesBtn"),d=s("commonModalCancel");return(0,e.jsx)("div",{css:t.css`
        position: absolute;
        z-index: 11;
        top: 0;
        left: 0;
        background-color: ${t.polished.rgba(o.sys.color.secondary.main,.65)};
        width: ${n.innerSize.width}px;
        height: ${n.innerSize.height}px;
        .real-container{
          background-color: ${o.sys.color.secondary.light};
          border: 1px solid ${o.sys.color.secondary.dark};
          background-clip: padding-box;
          width: 480px;
          position: relative;
          top: 50%;
          margin: -60px auto 0;
        }
        .confirm-header {
          border-bottom: 1px solid ${o.ref.palette.neutral[700]};
          padding: 16px 20px;
        }
        .confirm-context {
          padding: ${t.polished.rem(20)} ${t.polished.rem(20)} 0 ${t.polished.rem(20)};

          .title-icon {
            padding: 0 6px;
          }
          .message {
            margin-top: 1rem;
          }
        }
        .confirm-footer {
          display: flex;
          justify-content: flex-end;
          padding: ${t.polished.rem(20)};
          button {
            cursor: pointer;
            margin-left: ${t.polished.rem(8)};
            min-width: ${t.polished.rem(100)};
          }
        }
      `,children:(0,e.jsxs)("div",{className:"real-container",children:[(0,e.jsx)("div",{className:"confirm-context",children:(0,e.jsxs)("div",{className:"message d-flex",children:[(0,e.jsx)("div",{className:"title-icon",children:(0,e.jsx)(L,{size:"l",color:"var(--sys-color-warning-main)"})}),(0,e.jsx)("div",{css:t.css`color: var(--ref-palette-neutral-1100);`,"data-testid":"confirmInfo",children:r})]})}),(0,e.jsxs)("div",{className:"confirm-footer",children:[(0,e.jsx)(i.Button,{type:"primary",onClick:n.onConfirmWinYes,children:c}),(0,e.jsx)(i.Button,{type:"secondary",onClick:n.onConfirmWinCancel,children:d})]})]})})}),E=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),{jimuMapViewState:o,apiLoadedState:s,getSliceViewModel:r,isSavedFlagState:c,setIsSavedFlagState:d,resetSliceWidget:u,onPresetAnalysisChange:g,setPresetAnalysisInConfig:p,clearPresetAnalysisInConfig:m}=a,h=t.React.useCallback(()=>{let e=null;const t=r();"sliced"===t.state&&t.shape&&(e=t.shape.toJSON());let a="";e&&(a=JSON.stringify(e));const i=o.view.viewpoint.toJSON(),n={analysis:a,mapViewId:o.dataSourceId,viewpoint:i};let l;d(!0),l=e?p(n):m(),g(l)},[o,r,d,g,p,m]),f=t.React.useCallback(()=>{d(!1),u(!1)},[d,u]);return(0,e.jsxs)("div",{className:"right-tools",children:[(0,e.jsx)(i.Button,{type:"primary",className:"mx-1",onClick:h,disabled:!s||!!c,children:n(c?"savedState":"savePopper")}),(0,e.jsx)(i.Button,{type:"secondary",className:"mx-1",onClick:f,disabled:!s,children:n("clear")})]})}),Z=e=>{const a=(e=>{var a;const i=document.querySelector(`iframe[name="${t.APP_FRAME_NAME_IN_BUILDER}"]`);if(i)return(null!==(a=i.contentDocument)&&void 0!==a?a:i.contentWindow.document).querySelector(e);return null})(`div.widget-renderer[data-widgetid="${e}"]`),i=document.querySelector("#default")?document.querySelector("#default").clientHeight-20:1080;let n={width:770,height:850},o={width:770,height:770};if(a){const e=a.getBoundingClientRect();let t=e.width/e.height;t=t>0?t:1;let l=1.1*e.width,s=1.1*e.height+111,r=1.1*e.width,c=1.1*e.height;l<770?(l=770,s=770/t+111,r=770,c=770/t):l>1080&&(l=1080,s=1080/t+111,r=1080,c=1080/t),s>i&&(s=i,l=(i-111)*t>770?(i-111)*t:770),c>i-111&&(c=i-111,r=(i-111)*t),n={width:l,height:s},o={width:r-2,height:c}}return{innerSize:n,innerMapSize:o}},H=e=>{const a=(0,t.getAppStore)().getState().appStateInBuilder.appContext.isRTL;let i={x:500,y:50};const{innerSize:n}=Z(e);return i={x:a?518:document.body.clientWidth-n.width-518,y:50},i},q=t.React.memo(n=>{const o=(0,a.useTheme)(),s=t.hooks.useTranslation(l,i.defaultMessages),r=t.React.useRef(null),c=t.React.useRef(null),d=t.React.useRef(null),u=t.React.useRef(null),g=t.React.useRef(null),p=t.React.useRef(null),m=t.React.useRef(null),[h,f]=t.React.useState(null),[S,x]=t.React.useState(!1),[y,j]=t.React.useState(!1),[v,C]=t.React.useState(!1),[w,b]=t.React.useState(!0),{getAnalysisFromConfig:I,setPresetAnalysisInConfig:R,clearPresetAnalysisInConfig:W,hasPresetAnalysisForThisMap:B,addAnalysesToView:V,removeAnalysesFromView:L}=(e=>{var a,i,n,o;const l=t.React.useCallback(()=>{var t;let a=null===(t=e.sliceConfig.analyses)||void 0===t?void 0:t.find(t=>{var a;return t.mapViewId===(null===(a=e.jimuMapView)||void 0===a?void 0:a.dataSourceId)});return a||(a=null),a},[e.sliceConfig,e.jimuMapView]),s=t.React.useCallback(()=>{let t=!1;return t=!(!e.sliceConfig.analyses||!l()),t},[e.sliceConfig,l]),r=t.React.useCallback(()=>{var e;const t=null===(e=l())||void 0===e?void 0:e.mapViewId;return(null==t?void 0:t.startsWith("3d-toolbox-map-popper-"))?t.replace("3d-toolbox-map-popper-",""):t},[l]),c=t.React.useCallback(()=>{var e;const t=null===(e=l())||void 0===e?void 0:e.viewpoint;return T.default.fromJSON(t)},[l]),d=t.React.useCallback(t=>{let a=e.sliceConfig.analyses.filter(t=>t.mapViewId!==e.jimuMapView.dataSourceId);return a=a.concat(t),{analyses:a}},[null===(a=e.jimuMapView)||void 0===a?void 0:a.dataSourceId,e.sliceConfig.analyses]),u=t.React.useCallback(()=>({analyses:e.sliceConfig.analyses.filter(t=>t.mapViewId!==e.jimuMapView.dataSourceId)}),[null===(i=e.jimuMapView)||void 0===i?void 0:i.dataSourceId,e.sliceConfig.analyses]),g=t.React.useCallback(e=>{let t=!1;return t=e===r(),t},[r]),p=t.React.useCallback(e=>s()&&g(e),[s,g]),m=t.React.useCallback(()=>{var e;let t=s(),a={},i=null;if(t){try{a=JSON.parse(null===(e=l())||void 0===e?void 0:e.analysis)}catch(e){t=!1,console.error(a)}const n=D.default.fromJSON(a);i=new O.default({shape:n})}return i},[s,l]),h=t.React.useCallback((t,a,i)=>z(void 0,void 0,void 0,function*(){var n,o;const l=null===(n=e.jimuMapView)||void 0===n?void 0:n.view;yield A.whenOnce(()=>!l.updating);const s=i===r();if(l&&"3d"===(null==l?void 0:l.type)&&s&&t&&l.analyses.add(a),s&&t){const t=c();t&&(null===(o=e.jimuMapView)||void 0===o||o.view.goTo(t))}}),[null===(n=e.jimuMapView)||void 0===n?void 0:n.view,r,c]),f=t.React.useCallback(t=>{var a,i;const n=null===(a=e.jimuMapView)||void 0===a?void 0:a.view;n&&t&&(null===(i=n.analyses)||void 0===i||i.remove(t),t.destroy(),t=null)},[null===(o=e.jimuMapView)||void 0===o?void 0:o.view]);return{hasPresetAnalysisForThisMap:p,getPresetMapViewIdInConfig:r,getPresetViewpointInConfig:c,setPresetAnalysisInConfig:d,clearPresetAnalysisInConfig:u,getAnalysisFromConfig:m,addAnalysesToView:h,removeAnalysesFromView:f}})({jimuMapView:h,sliceConfig:n.toolConfig.config});t.React.useEffect(()=>{S||(0,N.loadArcGISJSAPIModules)(["esri/core/reactiveUtils","esri/widgets/Slice","esri/widgets/Slice/SliceViewModel","esri/analysis/SlicePlane","esri/analysis/SliceAnalysis"]).then(e=>{[r.current,c.current,d.current,u.current,g.current]=e,x(!0)})},[S,x]);const q=t.React.useRef(null),G=t.React.useRef(null),$=t.React.useCallback(()=>{(null==q?void 0:q.current)&&(null==q||q.current.remove()),(null==G?void 0:G.current)&&(null==G||G.current.remove())},[]),_=t.React.useCallback(e=>{q.current=null==r?void 0:r.current.watch(()=>"slicing"===(null==p?void 0:p.current.viewModel.state),()=>{b(!1)});let t=!0;G.current=null==r?void 0:r.current.watch(()=>"sliced"===(null==p?void 0:p.current.viewModel.state),()=>{let a=!1;e&&t&&(a=!0),t=!1,a||b(!1)})},[]),J=t.React.useCallback(e=>{$(),L(m.current),m.current=null,p.current&&p.current.destroy();const t=null==h?void 0:h.view,a={view:t,tiltEnabled:n.toolConfig.config.tiltEnabled,excludeGroundSurface:n.toolConfig.config.excludeGroundSurface},i=e&&B(null==h?void 0:h.dataSourceId);i&&(m.current=I(),a.analysis=m.current),p.current=new c.current({view:t,viewModel:new d.current(a)}),p.current.when(()=>{i?V(i,m.current,null==h?void 0:h.dataSourceId):p.current.viewModel.start(),_(i)})},[null==h?void 0:h.dataSourceId,null==h?void 0:h.view,n.toolConfig.config,$,_,B,I,V,L]);t.React.useEffect(()=>{h&&S&&y&&J(!0)},[h,S,y,J]);const{onShowMapPopperChange:Q}=n,Y=t.React.useCallback(()=>{w?Q(!1):C(!0)},[Q,w]);t.hooks.useUnmount(()=>{$(),p.current&&p.current.destroy()});const K=n.useMapWidgetIds&&n.useMapWidgetIds[0],U=(0,t.getAppStore)().getState().appStateInBuilder.appConfig;if(!U.widgets[K])return null;const X=U.widgets[K].useDataSources,ee=(0,t.Immutable)({}).set("toolConfig",{canZoom:!0,canHome:!0,canCompass:!0,canLayers:!0});return(0,e.jsx)("div",{className:"w-100",children:n.isShowMapPopper&&(0,e.jsx)(i.FloatingPanel,{onHeaderClose:Y,defaultPosition:H(n.useMapWidgetIds[0]),headerTitle:s("setDefaultSlice"),size:Z(n.useMapWidgetIds[0]).innerSize,minSize:{width:770,height:850},disableResize:!0,css:k(o),className:"surface-2",disableActivateOverlay:!0,dragBounds:"body",autoFocus:!1,children:(0,e.jsx)("div",{className:"rounded-1 w-100 h-100",css:P,children:(0,e.jsxs)("div",{className:"popper-content",children:[(0,e.jsx)("div",{className:"map-container",style:{height:"600px",width:"700px"},children:(0,e.jsx)(M.JimuMap,{id:n.specifiedJimuMapId,useDataSources:X,jimuMapConfig:ee,onActiveViewChange:e=>{var t;e!==h&&("3d"===(null===(t=e.view)||void 0===t?void 0:t.type)?j(!0):j(!1)),f(e)},onViewGroupCreate:e=>{}})}),v&&(0,e.jsx)(F,{innerSize:Z(n.useMapWidgetIds[0]).innerSize,onConfirmWinYes:()=>{Q(!1)},onConfirmWinCancel:()=>{C(!1)}}),(0,e.jsx)("div",{className:"popper-footer d-flex",children:(0,e.jsx)(E,{jimuMapViewState:h,apiLoadedState:S,getSliceViewModel:()=>p.current.viewModel,isSavedFlagState:w,setIsSavedFlagState:b,resetSliceWidget:J,setPresetAnalysisInConfig:R,clearPresetAnalysisInConfig:W,onPresetAnalysisChange:n.onPresetAnalysisChange})})]})})})})});var G=h(12046),$=h.n(G),_=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};const J=a=>{const i=window.SVG,{className:n}=a,o=_(a,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",n);return i?(0,e.jsx)(i,Object.assign({className:l,src:$()},o)):(0,e.jsx)("svg",Object.assign({className:l},o))},Q=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),{onSettingChanged:s,hanldeToolSettingChanged:r}=a,c=a.toolConfig.config,d=t.React.useCallback((e,t)=>{s(r(a.toolConfig,e,t))},[a.toolConfig,s,r]),[u,g]=t.React.useState(!1);t.hooks.useUnmount(()=>{g(!1)});const p=t.React.useCallback(e=>{g(e)},[]);return(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsxs)(o.SettingSection,{className:"first-setting-section",children:[(0,e.jsx)(o.SettingRow,{tag:"label",label:n("tiltEnabled"),role:"group","aria-label":n("tiltEnabled"),children:(0,e.jsx)(i.Switch,{checked:c.tiltEnabled,onChange:e=>{d({tiltEnabled:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{tag:"label",label:n("excludeGroundSurface"),role:"group","aria-label":n("excludeGroundSurface"),children:(0,e.jsx)(i.Switch,{checked:c.excludeGroundSurface,onChange:e=>{d({excludeGroundSurface:e.target.checked})}})}),(0,e.jsx)(o.SettingRow,{label:n("defaultSlice"),role:"group","aria-label":n("defaultSlice"),children:(0,e.jsx)(i.Button,{type:"tertiary",icon:!0,onClick:()=>{g(!0)},"aria-label":n("defaultSlice"),children:(0,e.jsx)(J,{})})}),u&&(0,e.jsx)(q,{isShowMapPopper:u,onShowMapPopperChange:p,useDataSources:a.useDataSources,useMapWidgetIds:a.useMapWidgetIds,specifiedJimuMapId:"3d-toolbox-map-popper",toolConfig:a.toolConfig,onPresetAnalysisChange:e=>{d(e)}})]}),(0,e.jsx)(C,{toolConfig:a.toolConfig,onAcitvedChanged:e=>{d(null,e)}})]})}),Y=t.React.memo(n=>{const s=(0,a.useTheme)(),c=t.hooks.useTranslation(l,i.defaultMessages),d=t.React.useCallback(e=>{const t=n.toolsConfig.find(t=>t.id===e);return t&&t.config?t:null},[n.toolsConfig]),u=t.React.useCallback((e,t,a)=>{const i=Object.assign({},e);return t&&(i.config=Object.assign(Object.assign({},i.config),t)),void 0!==a&&(i.activedOnLoad=a),i},[]),g=n.onSettingChanged,p=t.React.useCallback((e,a)=>{const i=n.toolsConfig.findIndex(t=>t.id===e);if(i>-1){const e=t.Immutable.setIn(n.toolsConfig,[i.toString()],a);g(e)}},[g,n.toolsConfig]),m=c(n.shownMode?n.shownMode:"tools");return(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(o.SidePopper,{title:m,css:v(s),isOpen:null!==n.shownMode,toggle:()=>{n.onSidePopperClose()},trigger:n.triggerFor508.current,position:"right",children:(0,e.jsx)(o.SettingSection,{className:"side-popper-container",children:(0,e.jsxs)("div",{className:"side-popper",children:[n.shownMode===r.Daylight&&(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(w,{toolConfig:d(r.Daylight),hanldeToolSettingChanged:u,onSettingChanged:e=>{p(r.Daylight,e)}})}),n.shownMode===r.Weather&&(0,e.jsx)(b,{toolConfig:d(r.Weather),hanldeToolSettingChanged:u,onSettingChanged:e=>{p(r.Weather,e)}}),n.shownMode===r.ShadowCast&&(0,e.jsx)(I,{toolConfig:d(r.ShadowCast),hanldeToolSettingChanged:u,onSettingChanged:e=>{p(r.ShadowCast,e)}}),n.shownMode===r.LineOfSight&&(0,e.jsx)(R,{toolConfig:d(r.LineOfSight),hanldeToolSettingChanged:u,onSettingChanged:e=>{p(r.LineOfSight,e)}}),n.shownMode===r.Slice&&(0,e.jsx)(Q,{toolConfig:d(r.Slice),hanldeToolSettingChanged:u,onSettingChanged:e=>{p(r.Slice,e)},useMapWidgetIds:n.useMapWidgetIds,useDataSources:n.useDataSources})]})})})})}),K=t.React.memo(a=>{const n=t.hooks.useTranslation(l,i.defaultMessages),s=a.onChange,r=t.React.useCallback(e=>{s(Object.assign(Object.assign({},a.arrangement),{style:e}))},[s,a.arrangement]),c=t.React.useCallback(e=>{s(Object.assign(Object.assign({},a.arrangement),{direction:e?m.Vertical:m.Horizontal}))},[s,a.arrangement]),d=n("arrangementStyle"),u=a.widgetId+"-uimode-description",g=a.widgetId+"-uimode-0",f=a.widgetId+"-uimode-1",S=n("listMode"),x=n("iconMode");return(0,e.jsx)(t.React.Fragment,{children:(0,e.jsxs)(o.SettingSection,{title:d,role:"group","aria-label":d,children:[(0,e.jsx)(o.SettingRow,{children:(0,e.jsxs)("div",{className:"ui-mode-card-chooser d-flex align-items-center justify-content-between w-100",children:[(0,e.jsxs)(i.Label,{className:"d-flex flex-column ui-mode-card-wapper",children:[(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",className:(0,t.classNames)("ui-mode-card",{active:a.arrangement.style===p.List}),disableHoverEffect:!0,disableRipple:!0,onClick:()=>{r(p.List)},title:S,"aria-label":S,"aria-labelledby":g,"aria-describedby":u,children:(0,e.jsx)(i.Icon,{width:92,height:56,icon:h(5739),autoFlip:!0})}),(0,e.jsx)("div",{id:g,className:"mx-1 text-break ui-mode-label",children:S})]}),(0,e.jsx)("div",{className:"ui-mode-card-separator"}),(0,e.jsxs)(i.Label,{className:"d-flex flex-column ui-mode-card-wapper",children:[(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",className:(0,t.classNames)("ui-mode-card",{active:a.arrangement.style===p.Icon}),disableHoverEffect:!0,disableRipple:!0,onClick:()=>{r(p.Icon)},title:x,"aria-label":x,"aria-labelledby":f,"aria-describedby":u,children:(0,e.jsx)(i.Icon,{width:92,height:56,icon:h(91130),autoFlip:!0})}),(0,e.jsx)("div",{id:f,className:"mx-1 text-break ui-mode-label",children:x})]})]})}),a.arrangement.style===p.Icon&&(0,e.jsx)(o.SettingRow,{label:n("direction"),children:(0,e.jsx)(o.DirectionSelector,{"aria-label":n("direction"),vertical:a.arrangement.direction===m.Vertical,onChange:c})})]})})});var U=h(31027),X=h.n(U),ee=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(a[i[n]]=e[i[n]])}return a};const te=a=>{const i=window.SVG,{className:n}=a,o=ee(a,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",n);return i?(0,e.jsx)(i,Object.assign({className:l,src:X()},o)):(0,e.jsx)("svg",Object.assign({className:l},o))},ae=r=>{const c=(0,a.useTheme)(),d=t.hooks.useTranslation(l,i.defaultMessages),u=t.ReactRedux.useSelector(e=>{var t,a;let i;return i=window.jimuConfig.isBuilder?e.appStateInBuilder.appConfig:e.appConfig,{appConfig:i,layoutInfo:null===(a=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[r.id])||void 0===a?void 0:a.layoutInfo}}),g=t.React.useMemo(()=>{var e;return(null===(e=r.useMapWidgetIds)||void 0===e?void 0:e.length)>0},[r.useMapWidgetIds]),h={w:382,h:290},f={w:170,h:42},S={w:42,h:170},[x,y]=t.React.useState(null),v=(e,t)=>{t&&(C.current=t),y(e)},C=t.React.useRef(null);return(0,e.jsxs)("div",{className:"widget-setting-directions jimu-widget-setting",css:s(c),children:[(0,e.jsx)(o.SettingSection,{title:d("selectMapWidget"),className:(0,t.classNames)({"border-0":!g}),children:(0,e.jsx)(o.SettingRow,{children:(0,e.jsx)(o.MapWidgetSelector,{onSelect:e=>{r.onSettingChange({id:r.id,useMapWidgetIds:e})},useMapWidgetIds:r.useMapWidgetIds})})}),!g&&(0,e.jsx)("div",{className:"d-flex justify-content-center align-items-center placeholder-container",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)(te,{size:48,className:"d-inline-block placeholder-icon mb-2"}),(0,e.jsx)("p",{className:"placeholder-hint",children:d("selectMapHint")})]})}),g&&(0,e.jsxs)(t.React.Fragment,{children:[(0,e.jsx)(j,{tools:r.config.tools,onToolsConfigChanged:e=>{r.onSettingChange({id:r.id,config:r.config.setIn(["tools"],e)})},onSidePopperToggle:v}),(0,e.jsx)(K,{widgetId:r.id,arrangement:r.config.arrangement,onChange:e=>{var a,i,o,l;let s=h;const{style:c,direction:d}=e;c===p.List?s=h:c===p.Icon&&d===m.Horizontal?s=f:c===p.Icon&&d===m.Vertical&&(s=S);const g=null===(a=u.layoutInfo)||void 0===a?void 0:a.layoutId,x=null===(l=null===(o=null===(i=u.appConfig)||void 0===i?void 0:i.layouts)||void 0===o?void 0:o[g])||void 0===l?void 0:l.type;g&&x===t.LayoutType.FixedLayout&&(0,n.getAppConfigAction)().editLayoutItemSize(u.layoutInfo,s.w,s.h).exec(),c===p.Icon?(0,n.getAppConfigAction)().editWidgetProperty(r.id,"offPanel",!0).exec():(0,n.getAppConfigAction)().editWidgetProperty(r.id,"offPanel",!1).exec(),r.onSettingChange({id:r.id,config:r.config.setIn(["arrangement"],e)})}}),(0,e.jsx)(t.React.Fragment,{children:(0,e.jsx)(Y,{toolsConfig:r.config.tools,shownMode:x,onSidePopperClose:()=>{v(null)},onSettingChanged:e=>{r.onSettingChange({id:r.id,config:r.config.setIn(["tools"],e)})},useMapWidgetIds:r.useMapWidgetIds,useDataSources:r.useDataSources,triggerFor508:C})})]})]})};function ie(e){h.p=e}})(),f})())}}});