System.register(["jimu-core/emotion","esri/core/reactiveUtils","esri/widgets/OrientedImageryViewer","calcite-components","jimu-arcgis","jimu-core","jimu-core/react","esri/core/maybe","jimu-ui"],function(e,t){var i={},l={},a={},o={},r={},n={},s={},d={},c={};return{setters:[function(e){i.jsx=e.jsx,i.jsxs=e.jsxs},function(e){l.once=e.once,l.watch=e.watch},function(e){a.default=e.default},function(e){o.CalciteButton=e.CalciteButton,o.CalciteOption=e.CalciteOption,o.CalciteSelect=e.CalciteSelect,o.CalciteTooltip=e.CalciteTooltip},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.WidgetState=e.WidgetState,n.css=e.css,n.utils=e.utils},function(e){s.memo=e.memo,s.useCallback=e.useCallback,s.useEffect=e.useEffect,s.useMemo=e.useMemo,s.useState=e.useState},function(e){d.abortMaybe=e.abortMaybe,d.destroyMaybe=e.destroyMaybe},function(e){c.Paper=e.Paper}],execute:function(){e((()=>{var e={14321:e=>{"use strict";e.exports=c},62243:e=>{"use strict";e.exports=l},62686:e=>{"use strict";e.exports=r},67386:e=>{"use strict";e.exports=i},68972:e=>{"use strict";e.exports=s},71155:e=>{"use strict";e.exports=d},79244:e=>{"use strict";e.exports=n},98357:e=>{"use strict";e.exports=a},99037:e=>{"use strict";e.exports=o}},t={};function u(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,u),a.exports}u.d=(e,t)=>{for(var i in t)u.o(t,i)&&!u.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var v={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(v),u.d(v,{__set_webpack_public_path__:()=>b,default:()=>p});var e=u(67386),t=u(62243),i=u(98357),l=u(99037),a=u(62686),o=u(79244),r=u(68972);var n=u(71155);const s=e=>{var t,i,l,a,o;const r=e.viewModel;r._updateFootprintTask=(0,n.abortMaybe)(r._updateFootprintTask),r._clickTask=(0,n.abortMaybe)(r._clickTask),null===(t=r.coverageFrustums)||void 0===t||t.destroy(),null===(i=r.coveragePolygons)||void 0===i||i.destroy(),null===(l=r.pointSources)||void 0===l||l.destroy(),null===(a=r.additionalFootprints)||void 0===a||a.destroy(),null===(o=r.additionalCameraLocations)||void 0===o||o.destroy(),r.bestFeatureFootprint=(0,n.destroyMaybe)(r.bestFeatureFootprint),r.bestFeatureCurrentFootprint=(0,n.destroyMaybe)(r.bestFeatureCurrentFootprint),r._crossSymbol=(0,n.destroyMaybe)(r._crossSymbol),r._referencePointOnGround=(0,n.destroyMaybe)(r._referencePointOnGround),r._referencePointOnImage=(0,n.destroyMaybe)(r._referencePointOnImage),r._overlays&&r._overlays.graphics.removeAll(),e.viewModel.resetImage(),r.resetVideo()},d={_widgetLabel:"Oriented Imagery Viewer",noOiLayersError:"No Oriented Imagery Layer in the selected map.",noMapSelectedError:"No Map selected.",defaultError:"Failed to load the widget.",enableViewer:"Enable viewer",disableViewer:"Disable viewer",oiLayerSelector:"Oriented Imagery Layer Selector"};var c=u(14321);function m(n){var u;const{state:v,config:m,intl:p}=n,[b,y]=(0,r.useState)(null),[g,f]=(0,r.useState)(null),[E,x]=(0,r.useState)([]),[w,h]=(0,r.useState)(!0),[C,S]=(0,r.useState)(null),j=!b||!(null==E?void 0:E.length),M=(0,r.useMemo)(()=>`oi-viewer-container-${n.id}-${o.utils.getUUID()}`,[n.id]),T=(0,r.useCallback)(e=>{if(e){const t=document.getElementById(M);f(null),t&&(t.innerHTML=""),s(e)}},[M]),O=(0,r.useCallback)((e,t=null)=>{const l=new i.default({view:e,disabled:!1,container:M,layer:t});l.visibleElements.title=!1,l.visibleElements.closeButton=!1,l.visibleElements.viewerTools=!1,f(l)},[M]),_=(0,r.useCallback)(e=>e.filter(e=>"oriented-imagery"===e.type&&e.loaded).map(e=>({id:"type"in e.parent&&"group"===e.parent.type?`${e.parent.id}-${e.id}`:e.id,layer:e})).toArray(),[]),k=(0,r.useCallback)(e=>{var t,i;const l=_(e.map.allLayers);let a=C;l.map(e=>e.id).includes(null==C?void 0:C.id)||(a=l[0]),g?(s(g),V(g,"view",e),V(g,"layer",null!==(t=null==a?void 0:a.layer)&&void 0!==t?t:null)):O(e,null!==(i=null==a?void 0:a.layer)&&void 0!==i?i:null),x(l),S(a)},[C,g,O,_]);(0,r.useEffect)(()=>()=>{g&&s(g)},[g]),(0,r.useEffect)(()=>{if(b){const e=t.watch(()=>{var e,t;return null===(t=null===(e=b.map)||void 0===e?void 0:e.allLayers)||void 0===t?void 0:t.filter(e=>"oriented-imagery"===e.type&&e.loaded).length},()=>{k(b)});return()=>{e.remove()}}},[b,k]),(0,r.useEffect)(()=>{!b||v&&v!==o.WidgetState.Opened?v===o.WidgetState.Closed&&g&&V(g,"disabled",!0):g&&V(g,"disabled",!w)},[b,v,g,w]),(0,r.useEffect)(()=>{b?C&&b&&(m.navigateToExtentEnabled||void 0===m.navigateToExtentEnabled)&&((null==C?void 0:C.layer.loaded)?b.goTo(null==C?void 0:C.layer.fullExtent):t.once(()=>null==C?void 0:C.layer.loaded).then(()=>{b.goTo(null==C?void 0:C.layer.fullExtent)})):T(g)},[C,b,g,T,m.navigateToExtentEnabled]),(0,r.useEffect)(()=>{var e,t;if(g){const i=g;i.visibleElements.imageGallery=m.imageGalleryEnabled,i.visibleElements.imageEnhancement=m.imageEnahncementEnabled,i.visibleElements.navigationTool=m.navigationToolEnabled,i.visibleElements.directionalNavigation=null!==(e=m.directionalNavigationEnabled)&&void 0!==e&&e,i.visibleElements.sequentialNavigation=null!==(t=m.sequentialNavigationEnabled)&&void 0!==t&&t,i.visibleElements.coverageMenu=m.viewerToolsEnabled,i.visibleElements.mapImageConversionTool=m.mapImageConversionToolEnabled,i.visibleElements.showPopupsAction=m.showPopupsActionEnabled,i.visibleElements.measurementTools=m.measurementToolsEnabled,i.visibleElements.imageOverlays=m.imageOverlaysEnabled,i.dataCaptureEnabled=m.dataCaptureEnabled,f(i)}},[g,m]);const P=e=>p?p.formatMessage({id:e,defaultMessage:d[e]}):e,V=(e,t,i)=>{e[t]=i,f(e)},N=e=>{const t=e.target.selectedOption.value,i=E.find(e=>e.id===t);S(i),V(g,"layer",i.layer),s(g)},F=()=>{h(e=>!e)},I=()=>(0,e.jsx)(l.CalciteSelect,{label:P("oiLayerSelector"),"aria-label":P("oiLayerSelector"),"data-select-id":"imagery-layer-selector",className:"mb-1",value:null==C?void 0:C.id,onCalciteSelectChange:N,children:null==E?void 0:E.map(t=>(0,e.jsx)(l.CalciteOption,{value:t.id,selected:C.id===t.id,children:t.layer.title},t.id))});return(0,e.jsxs)(c.Paper,{css:o.css`
    --calcite-color-brand: var(--sys-color-primary-main);
    --calcite-color-brand-press: var(--sys-color-primary-dark);
    --calcite-color-brand-hover: var(--sys-color-primary-light);
    --calcite-color-text-inverse: var(--sys-color-primary-text)};
  `,className:"jimu-widget overflow-auto p-2",shape:"none",children:[(0,e.jsx)(a.JimuMapViewComponent,{useMapWidgetId:null===(u=n.useMapWidgetIds)||void 0===u?void 0:u[0],onActiveViewChange:e=>{if(e){const t=e.view;y(t),k(t)}else y(null),x([]),S(null)}}),(0,e.jsxs)("div",{className:"h-100 w-100 flex-column "+(j?"d-none":"d-flex"),children:[(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)("div",{className:"mr-1",children:g?(0,e.jsxs)("div",{children:[(0,e.jsx)(l.CalciteButton,{appearance:"solid",kind:"brand",label:P(w?"disableViewer":"enableViewer"),iconStart:w?"view-visible":"view-hide",id:`oi-viewer-toggle-${n.id}`,onClick:F}),(0,e.jsx)(l.CalciteTooltip,{"aria-label":P(w?"disableViewer":"enableViewer"),id:`oi-viewer-toggle-tooltip-${n.id}`,referenceElement:`oi-viewer-toggle-${n.id}`,children:P(w?"disableViewer":"enableViewer")})]}):null}),(0,e.jsx)("div",{className:"flex-grow-1",children:I()})]}),(0,e.jsx)("div",{className:"d-flex flex-grow-1 justify-content-center",id:M})]}),(()=>{if(!j)return null;let t=P("defaultError");return b?(null==E?void 0:E.length)||(t=P("noOiLayersError")):t=P("noMapSelectedError"),(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center w-100 h-100 px-3 text-center",children:(0,e.jsx)("div",{children:t})})})()]})}m.mapExtraStateProps=(e,t)=>({locale:e.appContext.locale});const p=(0,r.memo)(m);function b(e){u.p=e}})(),v})())}}});