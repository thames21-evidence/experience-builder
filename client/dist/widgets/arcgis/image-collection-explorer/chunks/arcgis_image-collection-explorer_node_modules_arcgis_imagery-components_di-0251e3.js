/*! For license information please see arcgis_image-collection-explorer_node_modules_arcgis_imagery-components_di-0251e3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_image-collection-explorer_node_modules_arcgis_imagery-components_di-0251e3"],{8338:(e,t,n)=>{n.r(t),n.d(t,{ArcgisImageryMultidimensionalVariableInfo:()=>m});var i=n(3074),r=n(9143),o=n(9903),a=n(2797),s=n(1925),c=n(4476),l=n(2288);const d=s.AH`:host{display:flex;flex:1 1 auto;.accordion-item-content,.accordion-item-header{--calcite-accordion-item-border: var(--calcite-color-transparent)}}.info-section-container{border:none;--calcite-color-border-2: var(--calcite-color-transparent)}.info-section{padding-bottom:.5rem;overflow-y:auto;--calcite-accordion-item-border: var(--calcite-color-transparent);background-color:var(--calcite-color-foreground-1)}.info-general{padding:10px 15px;background-color:var(--calcite-color-foreground-1)}.popover{--calcite-popover-z-index: 100}.table{width:100%;background-color:var(--calcite-color-foreground-1);border-collapse:collapse;border-spacing:0;border:1px solid var(--calcite-color-border-1);text-align:left;overflow:auto;font-size:var(--calcite-font-size--2);color:var(--calcite-color-text-1);line-height:1.5rem;caption{text-align:left;margin-top:5px}td{display:table-cell;vertical-align:inherit;&:first-child{width:30%}}th,td{font-weight:300;padding:2px 5px;text-align:left}tr:nth-child(odd){background-color:var(--calcite-color-background)}&.table-bordered{tr{border-bottom:1px solid var(--calcite-color-border-1);&:last-child{border-bottom:none}td{&:first-child{border-right:1px solid var(--calcite-color-border-1)}}}}&.table-borderless{border:none}}:dir(rtl){.table{&.table-bordered{tr{td:first-child{border-left:1px solid var(--calcite-color-border-1);border-right:none}}}}}`;class m extends l.WF{constructor(){super(...arguments),this.dimensionNode=(0,c._)(),this.panelElement=(0,c._)(),this.popoverNode=(0,c._)(),this.showStatistics=!1,this.showDimensionSummary=!1,this.open=!1,this.arcgisClose=(0,l.lh)()}static{this.properties={activeDimensionName:16,variableInfo:0,popoverProps:0,showStatistics:5,showDimensionSummary:5,messages:0,open:5}}static{this.styles=d}async reposition(){this.popoverNode.value?.reposition()}async setFocus(e){"dismiss-button"!==e?this.el.focus():await(this.panelElement.value?.setFocus())}async load(){this.unitMessages=await a.fetchMessageBundle("esri/core/t9n/Units")}willUpdate(e){if(this.hasUpdated&&e.has("variableInfo")){const t=e.get("variableInfo");if(t&&this.dimensionNode.value){const e=this.dimensionNode.value.querySelector("calcite-accordion-item[expanded]");if(e){const n=e.dataset.dimensionIndex,i=t.dimensions[Number(n)];this.activeDimensionName=i.name}else this.activeDimensionName=void 0}else this.activeDimensionName=void 0}}_formatStats(e){return e.map(e=>a.formatNumber(e)).join("; ")}_formatUnit(e){if(e){const t=e.replace("esri","");e=t.toLowerCase(),e=this.messages.time[e]??this.unitMessages.units[e]?.plural??t}return e??""}render(){const{popoverProps:e,variableInfo:t}=this,n=`${e.refElement.getBoundingClientRect().width}px`,i=t.unit?`${t.name} (${t.unit})`:t.name,r=this.showDimensionSummary?t.dimensions.map(e=>`${e.name}: ${e.values?.length??""}`).join(", "):void 0;return s.qy`<calcite-popover .placement=${e.placement??"leading-start"} .open=${this.open} pointer-disabled .referenceElement=${e.refElement} .offsetDistance=${e.offsetDistance??0} .offsetSkidding=${e.offsetSkidding??0} trigger-disabled .label=${i} class="popover" style=${(0,l.zl)({width:n})} ${(0,c.K)(this.popoverNode)}><calcite-panel .heading=${i} style=${(0,l.zl)({width:`${e.popoverWidth}px`})} .description=${r} class="panel" closable @calcitePanelClose=${()=>this.arcgisClose.emit()} ${(0,c.K)(this.panelElement)}>${this.renderGeneralInfo()}${this.renderVariableInfoBlock()}</calcite-panel></calcite-popover>`}renderVariableInfoBlock(){return s.qy`<calcite-accordion class="info-section-container" selection-mode=single ${(0,c.K)(this.dimensionNode)}>${this.showStatistics&&this.renderStatistics()||""}${this.renderDimensions()}</calcite-accordion>`}renderGeneralInfo(){const{multidimensionalInfo:e}=this.messages,{unit:t,description:n}=this.variableInfo,i="colormap"in this.variableInfo&&!!this.variableInfo.colormap;return this.renderInfoSection([{name:e.description,description:n||e.none},{name:e.unit,description:t||e.none},{name:e.colormap,description:i?e.present:e.none}],void 0,"info-general")}renderInfoSection(e,t,n){return s.qy`<div class=${(0,l.CP)(n)}><table class="table table-bordered">${t&&s.qy`<caption>${t}</caption>`||""}${e.map(({name:e,description:t})=>s.qy`<tr><td>${e}</td><td>${t}</td></tr>`)}</table></div>`}renderStatistics(){const{statistics:e}=this.variableInfo;if(!e?.length)return null;const{multidimensionalInfo:t}=this.messages,n=this._formatStats(e.map(({min:e})=>e)),i=this._formatStats(e.map(({max:e})=>e)),r=e.map(({avg:e})=>e),o=e.map(({stddev:e})=>e),a=r.some(e=>null==e)?"":this._formatStats(r),c=o.some(e=>null==e)?"":this._formatStats(o);return s.qy`<calcite-accordion-item .heading=${t.statistics} class="info-section">${this.renderInfoSection([{name:t.minimum,description:n},{name:t.maximum,description:i},{name:t.mean,description:a},{name:t.stddev,description:c}])}</calcite-accordion-item>`}renderDimensions(){const{multidimensionalInfo:e}=this.messages,{name:t,dimensions:n}=this.variableInfo;return n.map((n,i)=>{const{name:c,values:l,interval:d,intervalUnit:m,hasRegularIntervals:u,extent:h}=n;let f="StdTime"===c?e.stdTimeDimension:"StdZ"===c?e.stdZDimension:e.generalDimension.replace("${dimensionName}",c);f+=l?` (${l.length})`:"";const p=m?this._formatUnit(m):"",g=d?`${d} (${u?e.regular:e.irregular})`:"",v=`${h?(0,o.f)(h[0],n,{intl:a}):""} - ${h?(0,o.f)(h[1],n,{intl:a}):""}`;return(0,r.D)(`${t}-${c}`,s.qy`<calcite-accordion-item .expanded=${c===this.activeDimensionName} .heading=${f} data-dimension-index=${i??s.s6} class="info-section">${this.renderInfoSection([{name:e.interval,description:g},{name:e.intervalUnit,description:p},{name:e.extent,description:v}])}</calcite-accordion-item>`)})}}(0,i.c)("arcgis-imagery-multidimensional-variable-info",m)},9143:(e,t,n)=>{n.d(t,{D:()=>a});var i=n(9684),r=n(4448),o=n(284);const a=(0,r.u$)(class extends r.WL{constructor(){super(...arguments),this.key=i.s6}render(e,t){return this.key=e,t}update(e,[t,n]){return t!==this.key&&((0,o.mY)(e),this.key=t),n}})},9903:(e,t,n)=>{n.d(t,{a:()=>h,b:()=>g,c:()=>m,d:()=>f,e:()=>d,f:()=>s,g:()=>u,h:()=>l,i:()=>p,m:()=>i,u:()=>r});const i=10.9,r=Number.MAX_VALUE-1;function o(e,t){const n=new Date(e),{useFriendlyIsoFormat:i,intl:r,format:o}=t;if(i&&r)return r.formatDate(n,{...r.convertDateFormatToIntlOptions(o??"short-date-long-time"),timeZone:"UTC"});let a=new Date(e).toISOString();return a=`${a.slice(0,a.indexOf("."))}Z`,a}function a(e,t,n="long"){const i=new Date(2022,9,10);return i.setMonth(e-1),t.formatDate(i,{month:n})}function s(e,t,n={}){if(null==e)return"";const{intl:i,useRecurringTimeLabel:r}=n;if(r&&i&&!Array.isArray(e)){const n=t.unit?.toLowerCase().trim();if(function(e){return"StdTime"===e.name&&!!e.recurring}(t)&&("months"===n||"quarters"===n))return"months"===n?a(e,i):function(e,t){return`${a(3*(e-1)+1,t,"short")} - ${a(3*e,t,"short")}`}(e,i)}const s=t.values?.[t.values.length-1];return n.useStartOrEndForRangedValue&&Array.isArray(e)&&2===e.length&&Array.isArray(s)&&(e=e.join("-")===s.join("-")?e[1]:e[0]),h(t)?(n.useFriendlyIsoFormat&&!n.format&&(n={format:c(t),...n}),Array.isArray(e)?e.map(e=>o(e,n)).join(" - "):o(e,n)):Array.isArray(e)?e.map(e=>i?.formatNumber(e)??String(e)).join(" - "):i?.formatNumber(e)??String(e)}function c(e){let t=e.intervalUnit?.toLowerCase().trim()??"";const{extent:n}=e,i=e.interval??0,r=e.values?.length;if(!["years","months","days","hours"].includes(t)&&n?.length&&r){const e=(n[1]-n[0])/r,i=864e5;t=e>=365*i?"years":e>=28*i?"months":t}switch(t){case"months":t=i>11?"years":t;break;case"days":t=i>364?"years":i>27?"months":t;break;case"hours":t="days"}return"years"===t?"year":"months"===t?"short-month-year":"short-date"}function l(e,t){const n=t?.dimensions?.find(({name:t})=>t===e.name);if(!n?.extent)return e;const i=[...n.extent],{values:r}=e;if(r?.length){const t=r.filter(e=>Array.isArray(e)?null==i[1]||i[0]===i[1]?e[0]===i[0]:e[0]>=i[0]&&e[0]<=i[1]&&e[1]>=i[0]&&e[1]<=i[1]:e>=i[0]&&e<=i[1]);if(0===t.length){const e=r[r.length-1];Array.isArray(e)&&e[1]===i[0]&&t.push(e)}return{...e,extent:i,values:t}}return{...e,extent:i}}function d(e){const{values:t,extent:n,name:i}=e;let r=t?.[0]??n?.[0];return"stdz"===i.toLowerCase()&&!e.hasRanges&&n&&Math.abs(n[1])<=Math.abs(n[0])&&(r=t?.length?t[t.length-1]:n[1]),r}function m(e){return"imagery-tile"===e.type||"wcs"===e.type?e.multidimensionalDefinition:(e.mosaicRule??e.defaultMosaicRule)?.multidimensionalDefinition}async function u(e,t=!1){if("imagery-tile"===e.type||"wcs"===e.type)return e.serviceRasterInfo?.multidimensionalInfo;const{rasterFunction:n,version:i}=e;return t||i<=10.9||!n||"none"===n.functionName?.toLowerCase()?e.serviceRasterInfo.multidimensionalInfo:(await e.generateRasterInfo(e.rasterFunction).catch(()=>e.serviceRasterInfo)).multidimensionalInfo}function h(e,t=!1){return"StdTime"===e.name&&(t||!e.recurring)}function f(e,t,n){t=l(t,n);const i=s(e.values[0],t);if(!t.values?.some(e=>i===s(e,t))){const n=d(t);e.values=null!=n?[n]:[]}}function p(e){return Array.isArray(e[0])}function g(e){return e.variables.map(({name:e,unit:t,description:n})=>({name:e,label:t?`${e} (${t})`:e,description:n}))}}}]);