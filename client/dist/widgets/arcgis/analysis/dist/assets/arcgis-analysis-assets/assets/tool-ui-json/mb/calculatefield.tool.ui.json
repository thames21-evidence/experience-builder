{
  "toolName": "CalculateField",
  "version": "0.1.0",
  "rules": [
    {
      "ruleType": "set",
      "value": "$[Component].inputTable.selectedLayers",
      "destination": "field",
      "property": "mapLayer"
    },
    {
      "ruleType": "set",
      "value": "$[Component].inputTable.selectedLayers",
      "destination": "whereClause",
      "property": "layer"
    },
    {
      "ruleType": "set",
      "value": "$[Component].inputTable.selectedLayers",
      "destination": "fieldCalcExpression",
      "property": "layer"
    },
    {
      "ruleType": "set",
      "value": "$[Component].field.selectedFields.name",
      "destination": "fieldCalcExpression",
      "property": "fieldName"
    },
    {
      "ruleType": "set",
      "value": "$[Data].whereClause",
      "destination": "fieldCalcExpression",
      "property": "whereClause"
    },
    {
      "ruleType": "expression",
      "expression": "$[Data].field = null",
      "destination": "fieldCalcExpression",
      "effectParams": {
        "disabledTooltip": "$noFieldSpecified"
      }
    }
  ],
  "UIparameters": [
    {
      "label": "$inputDatasetGroupLabel",
      "componentName": "analysis-block",
      "UIparameters": [
        {
          "name": "inputTable",
          "label": "$inputDataset",
          "componentName": "analysis-gp-composite",
          "required": true,
          "UIparameterInfos": [
            {
              "name": "layer",
              "label": "$layer",
              "dataType": "GPFeatureRecordSetLayer",
              "layerFilterType": ["feature"],
              "hideAddToMap": true
            },
            {
              "name": "table",
              "label": "$table",
              "dataType": "GPRecordSet",
              "layerFilterType": ["table"],
              "hideAddToMap": true
            }
          ]
        },
        {
          "label": "$whereClause",
          "name": "whereClause",
          "required": false,
          "componentName": "analysis-query-input",
          "mode": "sql",
          "recordsTerm": "records",
          "disabledTooltip": "$addDataToQueryTooltip"
        }
      ]
    },
    {
      "label": "$fieldCalculationGroupLabel",
      "componentName": "analysis-block",
      "UIparameters": [
        {
          "name": "field",
          "label": "$fieldToCalculate",
          "componentName": "analysis-field-input",
          "allowCreateNewFields": true,
          "fieldTypes": [
            "double",
            "integer",
            "small-integer",
            "big-integer",
            "single",
            "string",
            "date",
            "date-only",
            "time-only",
            "long"
          ],
          "required": true,
          "placeholderText": "$fieldPlaceholderText"
        },
        {
          "name": "fieldCalcExpression",
          "label": "$fieldCalcExpression",
          "componentName": "analysis-calculation-expression",
          "required": true,
          "language": "sql",
          "skipFeatureLayerValidate": true,
          "editorOptions": {
            "hiddenFieldTypes": ["timestamp-offset"],
            "hiddenFunctions": ["CURRENT_USER"]
          }
        }
      ]
    },
    {
      "label": "$resultLayerGroupLabel",
      "componentName": "analysis-block",
      "summaryText": "$outputSectionText",
      "UIparameters": [
        {
          "name": "outputName",
          "label": "$outputName",
          "placeholderText": "$outputNamePlaceholderText",
          "componentName": "analysis-output-name",
          "required": true
        },
        {
          "name": "saveResultIn",
          "label": "$saveResultIn",
          "componentName": "analysis-folder-input"
        }
      ]
    }
  ],
  "outputParameters": [
    {
      "label": "$calculateFieldResult",
      "name": "outputTable"
    }
  ]
}
