/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c304d5.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c304d5"],{931:(e,t,i)=>{i.d(t,{l:()=>s});var n=i(93814);const s=async(e,t)=>(await n.e.exports.loadModules(e,t)).map(e=>e.__esModule&&e.default?e.default:e)},4429:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>h,c:()=>a,d:()=>l,e:()=>s,f:()=>n,g:()=>u,i:()=>p,m:()=>o,t:()=>r,u:()=>d});const n=(e,t)=>{let i,n="idle";const s=(...s)=>new Promise(a=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),a(e(...s))):a(null);break;case"invoked":clearTimeout(i),n="idle",a(e(...s));break;case"cancelled":clearTimeout(i),n="idle",a(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout(()=>(n="idle",a(e(...s))),t)}});return s.flush=function(...e){return n="flushed",s(...e)},s.invoke=function(...e){return n="invoked",s(...e)},s.cancel=function(...e){return n="cancelled",s(...e)},s.getStatus=function(){return n},s};function s(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(e){return null!=e}async function o(e,t){return await Promise.all([e,r(t)]),e}function r(e){return new Promise(t=>setTimeout(t,e))}const c=(e,t)=>Object.fromEntries((e||[]).map(e=>{const{key:i,data:n}=t(e);return[i,n]})),l=(e,t)=>e.length===t.length&&e.reduce((e,i)=>e&&t.indexOf(i)>-1,!0);function d(e,t){const i=[],n={};return e.forEach(e=>{const s=t(e);null==n[s]&&(n[s]=e,i.push(e))}),i}function h(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter(e=>{let n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}const u=(e,t)=>[...Array(Math.ceil(e.length/t))].map((i,n)=>e.slice(t*n,t+t*n)),p=(e,t)=>e.includes(t)},12192:(e,t,i)=>{i.d(t,{a:()=>o,g:()=>l});var n=i(15332),s=i(94984),a=i(87849);function o(e){var t,i,a;const o=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(a=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===a?void 0:a.documentElement,r=((null==o?void 0:o.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(r)?s.l.get(r):s.l.has(r.slice(0,2))?s.l.get(r.slice(0,2)):"en"}const r={};function c(e,t){const i=`${e}${t}`;return r[i]||(r[i]=function(e,t){return new Promise((i,n)=>{fetch((0,a.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then(e=>{e.ok?i(e.json()):n()},()=>n())})}(e,t)),r[i]}async function l(e,t){const i=t||e.tagName.toLowerCase(),a=o(e),r=function(e){var t,i,a;const o=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(a=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===a?void 0:a.documentElement,r=((null==o?void 0:o.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(r)?s.l.get(r):s.l.has(r.slice(0,2))?r:"en"}(e);let l;try{l=await c(i,a)}catch(e){console.warn(`no locale for ${i} (${a}) loading default locale en.`),l=await c(i,"en")}return[l,a,r]}},54251:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(59317);function s(e){var t,i,s,a;return null!=e||(e=null===n.c||void 0===n.c?void 0:n.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(s=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===s?void 0:s.token)||(null===(a=null==e?void 0:e.portalUser)||void 0===a?void 0:a.token)||""}},60958:(e,t,i)=>{i.d(t,{r:()=>s});var n=i(83692);const s=async(e,t,i={})=>{const{body:s,usePost:a,addTokenManually:o,customToken:r}=i,c=new URLSearchParams;s&&Object.entries(s).forEach(([e,t])=>{void 0!==t&&c.append(e,t)});const l=new URL(e);if(l.searchParams.append("f","json"),r)l.searchParams.append("token",r);else{const e=!1===o?null:await(0,n.g)(t);e&&l.searchParams.append("token",e)}const d=await fetch(l.toString(),{body:a?c:void 0,method:a?"POST":"GET"}),h=await d.json(),u=h.error;if(u)throw"string"==typeof u?new Error(u):u;return h}},80386:(e,t,i)=>{i.r(t),i.d(t,{arcgis_custom_login_editor:()=>f,arcgis_custom_login_editor_authentication:()=>b,arcgis_custom_login_editor_persona:()=>g,arcgis_custom_login_editor_selection:()=>m});var n=i(87849),s=i(12192),a=i(60958),o=i(41473),r=i(15332),c=i(4429);i(94984),i(931),i(93814),i(83692),i(59317),i(37762),i(54251);async function l(e){try{return{result:await(0,a.r)(`${(0,o.g)(e)}portals/self/signinSettings`,e)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function d(e){try{return{result:await(0,a.r)(`${(0,o.g)(e)}portals/self/socialProviders`,e)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function h(e){try{return{result:await(0,a.r)(`${(0,o.g)(e)}portals/self/oidc`,e)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function u(e,t){try{return{result:await(0,a.r)(`${(0,o.g)(e)}portals/self/idp${t?"/federated":""}`,e)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function p(e,t){var i,n,s,r;let c=[],d=[];const{result:h}=await l(e);if(null==h?void 0:h.customOrgLoginPersonas)try{const e=JSON.parse(h.customOrgLoginPersonas);c=e.signInPersonas||[],d=e.signInPersonaIdsInUse||[]}catch(e){console.error("Error parsing 'customOrgLoginPersonas':",e)}const u=null!==(i=e.subscriptionInfo)&&void 0!==i?i:null===(n=e.sourceJSON)||void 0===n?void 0:n.subscriptionInfo,p=null===(r=null===(s=null==u?void 0:u.companionOrganizations)||void 0===s?void 0:s[0])||void 0===r?void 0:r.organizationUrl;if(p){const{result:t}=await async function(e,t){const i=`https://${t}.${e.customBaseUrl||e.portalHostname}`;try{return{result:await(0,a.r)(`${i}/sharing/rest/portals/self/signinSettings`,e)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}(e,p.split(".")[0]);if(null==t?void 0:t.customOrgLoginPersonas)try{const e=JSON.parse(t.customOrgLoginPersonas);c=c.concat(e.signInPersonas||[]),d=d.concat(e.signInPersonaIdsInUse||[])}catch(e){console.error("Error parsing 'customOrgLoginPersonas from companion org':",e)}}if(t){const i=`${(0,o.g)(e)}oauth2/apps/${t}`;try{const{customAppLoginPersonas:t}=await(0,a.r)(i,e,{usePost:!0});if(c=c.map(e=>(e.fromOrg=!0,e)),!t)return{personas:c,personasInUse:d};{const e=JSON.parse(t);if(e.signInPersonas)return{personas:c.concat(e.signInPersonas),personasInUse:e.signInPersonaIdsInUse||[]}}}catch(e){console.error(e)}}return{personas:c,personasInUse:d}}function v(e){const t=(0,r.a)(e).replace(/[<>]/g,"");return 0===t.trim().length?"":t}const f=class{constructor(e){(0,n.r)(this,e),this.personaCreated=(0,n.c)(this,"personaCreated",7),this.personaEditorClose=(0,n.c)(this,"personaEditorClose",7),this.steps={SELECTION:1,DESCRIPTION:2,AUTHENTICATION:3},this.personas=[],this.preventClose=!0,this.portal=void 0,this.previewUrl=void 0,this.clientId=void 0,this.personaId=void 0,this.activeStep=this.steps.SELECTION,this.totalSteps=3,this.previousStepLabel=void 0,this.nextStepLabel=void 0,this.activePersona=void 0,this.dialogOpen=!0,this.alertOpen=!1,this.abandonDialogOpen=!1,this.alertMessage=""}async componentWillLoad(){const e=await(0,s.g)(this.el);this.numberFormatter=new Intl.NumberFormat(e[2]),this.i18n=e[0],this.nextStepLabel=this.i18n.buttons.next,this.signinOptions=await async function(e){var t,i,n,s;const a=null!==(t=e.sourceJSON)&&void 0!==t?t:e,[o,r,c,p]=await Promise.all([l(e),d(e),h(e),u(e)]),{logins:v,social:f}=(null===(i=o.result)||void 0===i?void 0:i.signinOptionsOrder)||{logins:["arcgis","saml","oidc_","social"],social:["github","facebook","google","apple"]},b=(null===(s=null===(n=r.result)||void 0===n?void 0:n.config)||void 0===s?void 0:s.providers)||[],g=v.filter(t=>{var i,n,s,o,r;return t.startsWith("oidc")?a.canSignInOIDC&&(null===(s=null===(n=null===(i=c.result)||void 0===i?void 0:i.oidcProviders)||void 0===n?void 0:n[0])||void 0===s?void 0:s.id)===t.split("_")[1]:t.startsWith("saml_")?a.canSignInIDP&&(null===(o=p.result)||void 0===o?void 0:o.id)&&t.split("_")[1]===e.id:"saml"===t?a.canSignInIDP&&Boolean(null===(r=p.result)||void 0===r?void 0:r.id):"social"===t?a.canSignInSocial&&Boolean(b.length):"arcgis"!==t||a.canSignInArcGIS}),m=g.indexOf("saml");m>-1&&(g[m]="saml_"+e.id);const w=f.filter(e=>b.includes(e));return Object.assign(Object.assign({},o.result),{signinOptionsOrder:{logins:g,social:w}})}(this.portal);const{personas:t}=await p(this.portal,this.clientId);this.personas=this.clientId&&!this.personaId?t.filter(e=>!("refId"in e)):t,this.activePersona=this.personaId?this.findPersona():this.createNewPersona(),this.personaId&&(this.activeStep=this.steps.DESCRIPTION,this.totalSteps="refId"in this.activePersona?2:3,this.nextStepLabel="refId"in this.activePersona?this.i18n.buttons.editCategory:this.i18n.buttons.next)}handlePersonaUpdated(e){var t;const{persona:i,type:n}=e.detail;switch(n&&(this.totalSteps="byRef"===n?2:3),n){case"new":this.activePersona=this.createNewPersona();break;case"default":this.activePersona=this.createDefaultPersona();break;case"byRef":this.activePersona=this.createRefPersona(i);break;default:this.activePersona=Object.assign(Object.assign({},i),{id:this.activePersona.id})}null===(t=this.frameEl.contentWindow)||void 0===t||t.postMessage({type:"update",persona:this.activePersona,target:this.clientId?"app":"org",step:this.activeStep},"*")}finishPersonaEditor(e=!1){!e&&this.personaCreated.emit(this.activePersona),this.dialogOpen=!1,this.personaEditorClose.emit()}getNextId(){return`${this.clientId||this.portal.id}_${Date.now().toString(36)}`}createDefaultPersona(){var e,t;return{id:(null===(e=this.activePersona)||void 0===e?void 0:e.id)||this.getNextId(),label:"",description:"",signInOptions:this.signinOptions.signinOptionsOrder.logins.map(e=>Object.assign({provider:e,label:this.i18n.authenticationMethods[e.split("_")[0]].label},"social"===e&&{type:[...this.signinOptions.signinOptionsOrder.social]})),showCreateAccountLink:this.signinOptions.enableArcGISAutoSignups,showNotAMemberLink:!(null===(t=this.portal)||void 0===t?void 0:t.isPortal)}}createRefPersona(e){var t;return{id:(null===(t=this.activePersona)||void 0===t?void 0:t.id)||this.getNextId(),label:e.label,description:e.description,refId:e.id}}createNewPersona(){var e;return{id:(null===(e=this.activePersona)||void 0===e?void 0:e.id)||this.getNextId(),label:"",description:""}}findPersona(){const e=this.personas.find(e=>e.id===this.personaId);return e||(console.error(`Persona with id ${this.personaId} not found`),this.personaId=void 0,this.createDefaultPersona())}formatProgress(){let e=this.activeStep,t=this.totalSteps;if(this.personaId){if("refId"in this.activePersona)return"";e-=1,t-=1}return`${this.numberFormatter.format(e)}/${this.numberFormatter.format(t)}`}advanceEditor(){if(this.activeStep===this.steps.DESCRIPTION&&0===this.activePersona.label.length)return this.alertOpen=!0,void(this.alertMessage=this.i18n.errors.nameRequired);const e=this.activePersona.signInOptions;if(this.activeStep===this.steps.AUTHENTICATION){let t=!0;if(e&&0!==(null==e?void 0:e.length)?e.some(e=>{var t,i;return"social"===e.provider&&(!((null===(t=e.type)||void 0===t?void 0:t.length)>0)||(null===(i=e.type)||void 0===i?void 0:i.some(e=>!this.signinOptions.signinOptionsOrder.social.includes(e))))})&&(this.alertMessage=this.i18n.errors.socialProviderRequired,t=!1):(this.alertMessage=this.i18n.errors.authenticationMethodsRequired,t=!1),!t)return void(this.alertOpen=!0)}if(this.activeStep===this.steps.AUTHENTICATION&&"signInOptions"in this.activePersona){const e=this.activePersona.signInOptions.filter(e=>!(e.provider.startsWith("oidc")||e.provider.startsWith("saml")||e.label&&0!==e.label.length)).map(e=>this.i18n.authenticationMethods[e.provider.split("_")[0]].required);if(e.length>0)return this.alertMessage=e.join("<br>"),void(this.alertOpen=!0)}if(this.activeStep===this.totalSteps)return this.preventClose=!1,void this.finishPersonaEditor();this.activeStep++,this.setLabels(),this.handlePersonaUpdated(new CustomEvent("personaUpdated",{detail:{persona:this.activePersona}}))}reverseEditor(){this.activeStep>this.steps.SELECTION&&this.activeStep--,this.handlePersonaUpdated(new CustomEvent("personaUpdated",{detail:{persona:this.activePersona}})),this.setLabels()}setLabels(){const{buttons:e}=this.i18n,t=[e.next,this.personaId?e.editCategory:e.createCategory],i=[void 0,e.back];this.totalSteps>2&&(t.unshift(e.next),i.push(e.back)),this.nextStepLabel=t[this.activeStep-1],this.previousStepLabel=this.activeStep===this.steps.DESCRIPTION&&this.personaId?void 0:i[this.activeStep-1]}async initializePreview(){var e;await(0,c.t)(150),null===(e=this.frameEl.contentWindow)||void 0===e||e.postMessage({type:"initialize"},"*"),this.personaId&&this.activePersona&&this.handlePersonaUpdated(new CustomEvent("personaUpdated",{detail:{persona:this.activePersona}}))}renderStepContent(){var e;switch(this.activeStep){case this.steps.SELECTION:return(0,n.h)("arcgis-custom-login-editor-selection",{personas:this.personas,persona:this.activePersona});case this.steps.DESCRIPTION:return(0,n.h)("arcgis-custom-login-editor-persona",{persona:this.activePersona,numberFormatter:this.numberFormatter});case this.steps.AUTHENTICATION:return(0,n.h)("arcgis-custom-login-editor-authentication",{authenticationOptions:this.signinOptions.signinOptionsOrder,persona:this.activePersona,preventCreateAccount:!this.signinOptions.enableArcGISAutoSignups,preventSwitchAccount:this.signinOptions.hideCrossOrgSigninLink||(null===(e=this.portal)||void 0===e?void 0:e.isPortal),numberFormatter:this.numberFormatter})}}render(){const{heading:e,steps:t}=this.i18n;return(0,n.h)(n.F,{key:"a10b82ff16e6dce30e8b83995f4024c46c81efc8"},(0,n.h)("calcite-dialog",{key:"25fa099dc2a03b19ffdcbfb6e54ff23d6fe29100",open:this.dialogOpen,modal:!0,placement:"cover",heading:e,headingLevel:3,onCalciteDialogBeforeClose:e=>{e.target.open=this.preventClose,this.abandonDialogOpen=this.preventClose}},this.previousStepLabel&&(0,n.h)("calcite-button",{key:"475da95e6705cdebcbc9c389f206801b98d91451",slot:"footer-start",kind:"neutral",onClick:()=>{this.reverseEditor()}},this.previousStepLabel),this.activeStep===this.totalSteps&&!this.personaId&&(0,n.h)("calcite-label",{key:"bd562028a06668dd326294fa00d0c4424a6dd619",layout:"inline",slot:"footer-end",class:"visibility-label"},(0,n.h)("calcite-checkbox",{key:"5e9f95fcc6339d718592b98b1c64b8e5112c5c3f",checked:!0,onCalciteCheckboxChange:e=>{this.activePersona.visible=e.target.checked,this.handlePersonaUpdated(new CustomEvent("personaUpdated",{detail:{persona:this.activePersona}}))}}),this.i18n.showOnTriage),this.nextStepLabel&&(0,n.h)("calcite-button",{key:"ce413fc8ef70d55104c7dff891aa092bb126f48d",slot:"footer-end",onClick:()=>{this.advanceEditor()}},this.nextStepLabel),(0,n.h)("calcite-alert",{key:"77ab8dfaee8cf14943b53d616ce6e3786e8382f0",open:this.alertOpen,onCalciteAlertClose:()=>{this.alertOpen=!1},kind:"danger",label:this.i18n.errorLabel,icon:"exclamation-mark-triangle",slot:"alerts"},(0,n.h)("p",{key:"3a1665fba15e18df35483f05ac94ff2a9bc0abe9",slot:"message",innerHTML:this.alertMessage})),(0,n.h)("div",{key:"7a6453b925cbd7c1d96e04fb38eeba2227344c33",class:"editor-content"},(0,n.h)("div",{key:"cfa8f3d89120016b7b2c8ebca4fcc09eed14b29d",class:"editor-panel"},(0,n.h)("header",{key:"73be70f54eb5fbc863fb6007812f0a5a2e1c49dc",class:"editor-header"},(0,n.h)("h3",{key:"7bc802fb46fa6a7a72e32ac7a8ee18bf54eb7a34",class:"editor-header-heading"},t[this.activeStep].title),(0,n.h)("p",{key:"cdce8a5e6ca5c03770b9f87f3c086fef3e18a604",class:"editor-header-progress"},this.formatProgress())),(0,n.h)("p",{key:"d8749dfdf0edd5dc24d124103a4a4df1c234bf37",class:"editor-step-description"},t[this.activeStep].description),(0,n.h)("div",{key:"dbf039f264f62e6724219ddee3f6134d1401d790",class:"editor-step-content"},this.renderStepContent())),(0,n.h)("div",{key:"f7c9ffa2ddbcb01390a689b7ba45a8c69bddd4c3",class:"editor-preview"},(0,n.h)("calcite-notice",{key:"908f8ff256a6dc6fd83df5bbcae456ad38189278",class:"editor-preview-notice",kind:"info",width:"full",open:!0},(0,n.h)("p",{key:"30e2c33b4050725de97946827fecc1b960db296b",slot:"title",class:"notice-title"},this.i18n.preview)),(0,n.h)("iframe",{key:"4c2882357145e30c7a502e00e7b9853c9a3fda8f",class:"editor-preview-content",src:this.previewUrl,ref:e=>{this.frameEl=e},width:"100%",height:"100%",onLoad:()=>{this.initializePreview()}}),"refId"in this.activePersona&&this.activeStep===this.steps.DESCRIPTION&&(0,n.h)("calcite-notice",{key:"071175e77215dedd0e39355f2aba69b36ebc5f7d",class:"editor-preview-restriction",kind:"info",icon:!0,open:!0},(0,n.h)("div",{key:"5f43b26f9765de74a7f6f75e78b3fa62033edbce",slot:"message"},this.i18n.restrictions))))),(0,n.h)("calcite-dialog",{key:"e0fe9bc038feb04170f41f5f859db19589dcd4ef",modal:!0,heading:this.i18n.confirmLeave.title,headingLevel:4,width:"s",open:this.abandonDialogOpen,onCalciteDialogClose:()=>{this.abandonDialogOpen=!1}},(0,n.h)("p",{key:"24f73055c4a2ca10132b689cc983a7665117f5c8"},this.i18n.confirmLeave.message),(0,n.h)("calcite-button",{key:"ff5e74b96a8933aec089d8ccd8358047b12b6990",slot:"footer-end",kind:"neutral",onClick:()=>{this.preventClose=!1,this.abandonDialogOpen=!1,this.finishPersonaEditor(!0)}},this.i18n.confirmLeave.leave),(0,n.h)("calcite-button",{key:"e43d468bf30b11a09954c3dd3540f97f635ffcc6",slot:"footer-end",onClick:()=>{this.abandonDialogOpen=!1}},this.i18n.confirmLeave.remain)))}get el(){return(0,n.a)(this)}};f.style=".editor-content{display:flex;height:88vh;width:100%;overflow-y:hidden}.editor-preview{display:none;width:100%;flex-direction:column;overflow-x:hidden}@media (min-width: 864px){.editor-preview{display:flex}}.editor-preview-content{height:100%}.editor-preview-notice{--calcite-notice-background-color:var(--calcite-color-foreground-3)}.editor-preview-restriction{position:sticky;bottom:0.5rem;width:80%}.editor-panel{overflow-y:auto;padding-left:1.25rem;padding-right:1.25rem}@media (min-width: 864px){.editor-panel{width:500px;flex:none}}.editor-header{display:flex;align-items:center;justify-content:space-between}.editor-header-heading{font-size:1rem;font-weight:500}.editor-header-progress{font-size:0.75rem}.editor-step-description{border-width:0px;border-style:solid;border-top-color:var(--calcite-color-border-3);border-bottom-color:var(--calcite-color-border-3);padding-top:1.25rem;padding-bottom:1.25rem;font-size:0.875rem;border-block-width:1px}.editor-step-content{padding-top:1.25rem;padding-bottom:1.25rem}.notice-title{text-align:center}.visibility-label{margin-inline-end:0.5rem;align-self:flex-end}p{margin:0px}";const b=class{constructor(e){(0,n.r)(this,e),this.personaUpdated=(0,n.c)(this,"personaUpdated",7),this.MAX_NAME_LENGTH=60,this.persona=void 0,this.authenticationOptions=void 0,this.preventCreateAccount=void 0,this.preventSwitchAccount=void 0,this.numberFormatter=void 0,this.activeOptions={arcgis:!1,saml:!1,oidc:!1,social:!1},this.activeSocials={},this.arcgisLabel=void 0,this.samlLabel=void 0,this.oidcLabel=void 0,this.socialLabel=void 0,this.showCreateLink=!1,this.showSwitchLink=!1,this.authOptions=void 0}async componentWillLoad(){var e,t,i;if(this.authOptions={logins:this.authenticationOptions.logins.map(e=>e.split("_")[0]),social:[...this.authenticationOptions.social]},this.activeSocials=this.authenticationOptions.social.reduce((e,t)=>(e[t]=!1,e),{}),this.persona&&"signInOptions"in this.persona){const{signInOptions:n}=this.persona,s=n.map(e=>e.provider.split("_")[0]),a=(null===(e=n.find(e=>"social"===e.provider))||void 0===e?void 0:e.type)||[],o=[...new Set(s.concat(this.authOptions.logins))],r=[...new Set(a.concat(this.authOptions.social))];this.authOptions={logins:o,social:r},n.forEach(({provider:e,type:t,label:i})=>{const n=e.split("_")[0];"social"===n&&t.forEach(e=>{this.activeSocials[e]=!0}),this.activeOptions[n]=!0,this[`${n}Label`]=i}),this.showCreateLink=null!==(t=this.persona.showCreateAccountLink)&&void 0!==t&&t,this.showSwitchLink=null!==(i=this.persona.showNotAMemberLink)&&void 0!==i&&i}const n=await(0,s.g)(this.el,"arcgis-custom-login-editor");this.i18n=n[0]}updatePersona(){const e=Object.assign(Object.assign({},this.persona),{showCreateAccountLink:this.showCreateLink,showNotAMemberLink:this.showSwitchLink,signInOptions:this.authOptions.logins.filter(e=>this.activeOptions[e]).map(e=>{const t={provider:e,label:this[`${e}Label`]};return"social"===e&&(t.type=this.authOptions.social.filter(e=>this.activeSocials[e])),"oidc"!==e&&"saml"!==e||(t.provider=this.authenticationOptions.logins.find(t=>t.startsWith(e))),t})});this.personaUpdated.emit({persona:e})}handleAuthMethodsReorder(e){const{dragEl:t,newIndex:i,oldIndex:n}=e.detail,s=[...this.authOptions.logins];s.splice(n,1),s.splice(i,0,t.getAttribute("data-value")),this.authOptions=Object.assign(Object.assign({},this.authOptions),{logins:s}),this.updatePersona()}handleSocialMethodsReorder(e){const{dragEl:t,newIndex:i,oldIndex:n}=e.detail,s=[...this.authOptions.social];s.splice(n,1),s.splice(i,0,t.value),this.authOptions=Object.assign(Object.assign({},this.authOptions),{social:s}),this.updatePersona()}charsEntered(e){var t;const i=this[`${e}Label`];return null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0}renderBlock(e){const t=this.i18n.authenticationMethods[e],i=-1===this.authenticationOptions.logins.findIndex(t=>t.startsWith(e));return(0,n.h)("calcite-block",{open:!0,heading:t.label,headingLevel:4,description:t.description,"data-value":e,key:e},(0,n.h)("calcite-switch",{slot:"actions-end",checked:this.activeOptions[e],disabled:i&&!this.activeOptions[e],onCalciteSwitchChange:t=>{this.activeOptions=Object.assign(Object.assign({},this.activeOptions),{[e]:t.target.checked}),this.updatePersona()}}),i&&(0,n.h)("calcite-notice",{kind:"warning",scale:"s",icon:!0,open:!0,class:"method-notice"},(0,n.h)("div",{slot:"message"},this.i18n.loginNotAvailable)),"social"===e&&this.activeOptions.social&&(0,n.h)("calcite-list",{dragEnabled:!0,selectionMode:"none",label:this.i18n.socialProviders,onCalciteListOrderChange:this.handleSocialMethodsReorder.bind(this)},this.authOptions.social.map(e=>(0,n.h)("calcite-list-item",{label:t[e],value:e,key:e},(0,n.h)("calcite-switch",{slot:"actions-end",onCalciteSwitchChange:t=>{this.activeSocials=Object.assign(Object.assign({},this.activeSocials),{[e]:t.target.checked}),this.updatePersona()},checked:this.activeSocials[e]}),!this.authenticationOptions.social.includes(e)&&(0,n.h)("calcite-label",{layout:"inline-space-between",scale:"s",slot:"content-bottom"},(0,n.h)("calcite-icon",{scale:"s",icon:"exclamation-mark-triangle",style:{"--calcite-icon-color":"var(--calcite-ui-warning)"}}),(0,n.h)("span",null,this.i18n.loginNotAvailable))))),(0,n.h)("div",{class:{"method-label":!0,hide:!this.activeOptions[e]}},(0,n.h)("calcite-label",null,this.i18n.name,(0,n.h)("calcite-input-text",{placeholder:this.i18n.enterTitle,maxLength:this.MAX_NAME_LENGTH,value:this[`${e}Label`],onCalciteInputTextInput:t=>{this[`${e}Label`]=t.target.value,this.updatePersona()},onCalciteInputTextChange:t=>{this[`${e}Label`]=v(t.target.value),this.updatePersona()}}),(0,n.h)("calcite-input-message",{scale:"l"},(0,n.h)("div",null,(0,n.h)("span",{class:"count"},this.numberFormatter.format(this.charsEntered(e))),"/",this.numberFormatter.format(this.MAX_NAME_LENGTH))))))}render(){const{createAccount:e,switchOrganization:t}=this.i18n;return(0,n.h)(n.H,{key:"9e580e9e90df4e31a7249c28a41b1a9f4b31cfe5"},(0,n.h)("calcite-block-group",{key:"c8454e35ccfae2de9216ae0433551d169bba336b",dragEnabled:!0,label:this.i18n.authenticationProviders,onCalciteBlockGroupOrderChange:this.handleAuthMethodsReorder.bind(this)},this.authOptions.logins.map(e=>this.renderBlock(e))),(0,n.h)("calcite-block-group",{key:"864e12b862275a8bc2bcd6a1951436ce35dbbc7b",label:"options"},(0,n.h)("calcite-block",{key:"49966a8c30376675229008e286abd17d44e6b8ea",open:!0,heading:e.label,headingLevel:4,description:e.description,class:{hide:this.preventCreateAccount}},(0,n.h)("calcite-switch",{key:"e66e30a0d2ec5daef4e438aa5dbd6955877cfea3",slot:"actions-end",checked:this.showCreateLink,onCalciteSwitchChange:e=>{this.showCreateLink=e.target.checked,this.updatePersona()}})),(0,n.h)("calcite-block",{key:"3413723cb0694d2a9a3ee4edf2de1a3df67da568",open:!0,heading:t.label,headingLevel:4,description:t.description,class:{hide:this.preventSwitchAccount}},(0,n.h)("calcite-switch",{key:"ed9f483731821286c550a3ca1965b7f8d7d965f5",slot:"actions-end",checked:this.showSwitchLink,onCalciteSwitchChange:e=>{this.showSwitchLink=e.target.checked,this.updatePersona()}}))))}get el(){return(0,n.a)(this)}};b.style="calcite-input-message{--calcite-color-text-1:var(--calcite-color-border-input);--calcite-input-message-spacing-value:0;flex-direction:column;align-items:flex-end}calcite-block>calcite-switch{align-content:center}calcite-list-item>calcite-switch{padding-inline-end:0.5rem}.method-label{margin-top:0.5rem;padding-bottom:0.75rem}.method-notice{margin-top:-1rem;margin-bottom:1rem}.hide{display:none}";const g=class{constructor(e){(0,n.r)(this,e),this.personaUpdated=(0,n.c)(this,"personaUpdated",7),this.personaVisibilityChangeInternal=(0,n.c)(this,"personaVisibilityChangeInternal",7),this.MAX_NAME_LENGTH=60,this.MAX_DESCRIPTION_LENGTH=100,this.WARNING_LENGTH=10,this.persona=void 0,this.numberFormatter=void 0}async componentWillLoad(){const e=await(0,s.g)(this.el,"arcgis-custom-login-editor");this.i18n=e[0]}nameCount(){var e,t,i;return null!==(i=null===(t=null===(e=this.persona)||void 0===e?void 0:e.label)||void 0===t?void 0:t.length)&&void 0!==i?i:0}descriptionCount(){var e,t,i;return null!==(i=null===(t=null===(e=this.persona)||void 0===e?void 0:e.description)||void 0===t?void 0:t.length)&&void 0!==i?i:0}async handleTextInput(e,t){const i=e.target,n=i.value;this.personaUpdated.emit({persona:Object.assign(Object.assign({},this.persona),{[t]:n})}),await(0,c.t)(20),i.setFocus()}handleTextChange(e,t){const i=v(e.target.value);this.personaUpdated.emit({persona:Object.assign(Object.assign({},this.persona),{[t]:i})})}render(){return(0,n.h)(n.H,{key:"c5d2f8b0b22c6ec5d1eed7d6744ae6c9b8abec8a"},(0,n.h)("calcite-label",{key:"277d4bf200c446d32f5d713095e5e5dbe441e08f"},this.i18n.name,(0,n.h)("calcite-input-text",{key:"2b8f6c81b9fcbf05276b79e2536811264b1c5310",placeholder:this.i18n.enterName,value:this.persona.label,maxLength:this.MAX_NAME_LENGTH,onCalciteInputTextInput:e=>{this.handleTextInput(e,"label")},onCalciteInputTextChange:e=>{this.handleTextChange(e,"label")}}),(0,n.h)("calcite-input-message",{key:"9fab35a85fbf85640543afc7db251378e13a5648",scale:"l",status:this.MAX_NAME_LENGTH-this.nameCount()<this.WARNING_LENGTH?"invalid":"idle"},(0,n.h)("div",{key:"255d3da218773269af48323c29042f6c57646ba7"},(0,n.h)("span",{key:"753a650757921fe2d5b837afa16b00caa869ff67",class:"count"},this.numberFormatter.format(this.nameCount())),"/",this.numberFormatter.format(this.MAX_NAME_LENGTH)))),(0,n.h)("calcite-label",{key:"01743fb5748207416dae2388c2b83ad47ff6f5af",for:"persona-description"},this.i18n.description,(0,n.h)("calcite-input-text",{key:"b87ca3ed5693e83da17bd55f205963731e392cb4",placeholder:this.i18n.enterDescription,value:this.persona.description,maxLength:this.MAX_DESCRIPTION_LENGTH,onCalciteInputTextInput:e=>{this.handleTextInput(e,"description")},onCalciteInputTextChange:e=>{this.handleTextChange(e,"description")}}),(0,n.h)("calcite-input-message",{key:"6a2c20ac489859bef31cbb32a58eb7673c9bfb27",scale:"l",status:this.MAX_DESCRIPTION_LENGTH-this.descriptionCount()<this.WARNING_LENGTH?"invalid":"idle"},(0,n.h)("div",{key:"caabe97ba19768f59a347e51dc4715fd455c0e10"},(0,n.h)("span",{key:"c98e154366d22ef75d4f6ef4930e7c03a1d5f023",class:"count"},this.numberFormatter.format(this.descriptionCount())),"/",this.numberFormatter.format(this.MAX_DESCRIPTION_LENGTH))),(0,n.h)("calcite-notice",{key:"ecae91acdab0cc1ddb83a1d57d6ffd16111da879",kind:"info",scale:"s",icon:!0,open:!0},(0,n.h)("div",{key:"6a2ebbbed563f45ffe1650abfff9b555db990401",slot:"message"},this.i18n.showOnTriageDescription))))}get el(){return(0,n.a)(this)}};g.style="calcite-input-message{--calcite-color-text-1:var(--calcite-color-border-input);--calcite-input-message-spacing-value:0;flex-direction:column;align-items:flex-end}calcite-input-message[status=invalid] .count{color:var(--calcite-color-status-danger)}";const m=class{constructor(e){(0,n.r)(this,e),this.personaUpdated=(0,n.c)(this,"personaUpdated",7),this.persona=void 0,this.personas=[]}async componentWillLoad(){const e=await(0,s.g)(this.el,"arcgis-custom-login-editor");this.i18n=e[0]}handlePersonaSelection(e){const t=e.target.selectedItems[0].getAttribute("data-value");if("new"!==t&&"default"!==t){const e=this.personas.find(e=>e.id===t);this.personaUpdated.emit({persona:e,type:e.fromOrg?"byRef":"existing"})}else this.personaUpdated.emit({persona:this.persona,type:t})}getDropdownInfo(){var e;if(this.persona.label)return{label:this.persona.label,value:this.persona.id};if("refId"in this.persona){const t=null===(e=this.personas)||void 0===e?void 0:e.find(e=>e.id===this.persona.refId);return{label:(null==t?void 0:t.label)||"",value:this.persona.id}}return"signInOptions"in this.persona?{label:this.i18n.orgDefaults,value:"default"}:{label:this.i18n.createNew,value:"new"}}render(){const{label:e,value:t}=this.getDropdownInfo();return(0,n.h)(n.H,{key:"e88b9cc6037655a2df9cbd43c8878c1eb4ff61e9"},(0,n.h)("calcite-label",{key:"b6d1897408ef8a693e2928a8279318f352afae43"},this.i18n.select,(0,n.h)("calcite-dropdown",{key:"0cc88179ab9b5d072b82c2273dad05b4cc7ee026",onCalciteDropdownSelect:this.handlePersonaSelection.bind(this)},(0,n.h)("calcite-button",{key:"47339686feb549cf7abbee03d5fe666e9ad880a7",slot:"trigger",width:"full",kind:"neutral",appearance:"outline",iconEnd:"chevron-down",alignment:"icon-end-space-between"},e),(0,n.h)("calcite-dropdown-group",{key:"743af4fc2ca6a279e28a0ece68c098d086c2b5a1",selectionMode:"single"},(0,n.h)("calcite-dropdown-item",{key:"22004d9cb421ebe3ebef5cbbb91b4808a6cf1391","data-value":"new",selected:"new"===t,label:this.i18n.createNew},this.i18n.createNew),(0,n.h)("calcite-dropdown-item",{key:"2456ab82a3595fb9a0a78200229d4adcb41bbcec","data-value":"default",selected:"default"===t,label:this.i18n.orgDefaults},this.i18n.orgDefaults),this.personas.map(t=>(0,n.h)("calcite-dropdown-item",{"data-value":t.id,key:t.id,iconEnd:t.fromOrg?"information":void 0,selected:e===t.label},t.label))))),"refId"in this.persona&&(0,n.h)("calcite-notice",{key:"089b36eb86ba2ddb8b8d40c9ff3133838901d3f9",kind:"info",scale:"s",icon:!0,open:!0},(0,n.h)("div",{key:"6753226c94d7cbd873e4627181e65295e7c312b6",slot:"message"},this.i18n.restrictions)))}get el(){return(0,n.a)(this)}}},83692:(e,t,i)=>{i.d(t,{a:()=>f,b:()=>v,c:()=>p,f:()=>h,g:()=>w,i:()=>u,p:()=>m,r:()=>b});var n=i(59317),s=i(4429),a=i(931),o=i(41473),r=i(54251);const c={},l={},d={};async function h(e,t,i,n){var s,a,o,r;const h=null===(a=null===(s=d[t])||void 0===s?void 0:s[i])||void 0===a?void 0:a.expireAt,u=!!h&&(new Date).getTime()>h;if((null===(o=c[t])||void 0===o?void 0:o[i])&&!u)return c[t][i];l[t]||(l[t]={}),l[t][i]&&!u||(l[t][i]=e());const p=await l[t][i];if(c[t]||(c[t]={}),d[t]||(d[t]={}),c[t][i]=p,n){const{expireAfter:e,getExpireAfterFromResult:s}=n,a=s||e?(new Date).getTime()+(null!==(r=null==s?void 0:s(p))&&void 0!==r?r:e):null;d[t][i]=Object.assign(Object.assign({},d[t][i]),{expireAt:a})}return p}function u(e,t){var i;return null===(i=null==c?void 0:c[e])||void 0===i?void 0:i[t]}const p=(e,t)=>{var i,n;t?(null===(i=c[e])||void 0===i||delete i[t],null===(n=l[e])||void 0===n||delete n[t]):(delete c[e],delete l[e])};function v(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}async function f(e,t,i={},n){const[s]=await(0,a.l)(["esri/request"]);e.includes("f=")||t.append("f","json");const o=(0,r.g)();return o&&!t.has("token")&&t.append("token",o),new Promise((a,o)=>{s(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:n||"auto"})).then(e=>{a(e.data)}).catch(e=>o(e))})}async function b(e,t={},i={},s,o){const[r]=await(0,a.l)(["esri/request"]),{api:c,portal:l}=n.c,{customToken:d,addTokenManually:h,addSSL:u,useProxy:p}=i,v=Object.assign({},t);if(e.includes("f=")||!0===(null==o?void 0:o.excludeJson)||(v.f="json"),d)v.token=d;else if(!1!==h){const e=await w(l);e&&(v.token=e)}const f=!1===u?e:function(e){var t;const{config:i}=n.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}(e);if(3===c){const e=Object.assign({url:f,content:v,timeout:i.timeout||0},null==o?void 0:o.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return r(e,"post"===s?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:v,method:s||"auto"},i),{timeout:i.timeout||0,useProxy:p}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await r(f,e)).data}}const g=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const m=async(e,t,i)=>{var n,a;const o=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],r=null!==(a=null==t?void 0:t.successStatuses)&&void 0!==a?a:["completed","Completed","COMPLETED"];let c=0;const l=async()=>{const n=await b(e,null==t?void 0:t.requestParams,{},i),a=n.status||n.jobStatus;if(o.includes(a))return await(0,s.t)((d=c++,1e3*g[d>-1&&d<g.length-1?d:g.length-1])),l();if(r.includes(a)||"failed"===a||"esriJobFailed"===a)return n;throw n;var d};try{return l()}catch(e){throw console.error(e),e}},w=async e=>{var t;if(!(null==e?void 0:e.isPortal)||!(0,o.i)(e))return(0,r.g)(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,o.i)(e))return;const{token:i}=await h(()=>y(e),"platformSelf",null!==(t=v(e.user))&&void 0!==t?t:e.id,{getExpireAfterFromResult:e=>e.expires_in});return i},y=async e=>{const t=await(async e=>{var t,i;const[n]=await(0,a.l)(["esri/identity/IdentityManager"]);return null!==(i=null===(t=(await h(()=>n.getCredential((0,o.g)(e),{oAuthPopupConfirmation:!1}),"credential",v(e.user))).oAuthState)||void 0===t?void 0:t.appId)&&void 0!==i?i:"arcgisonline"})(e),i={"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return b(`${(0,o.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:i,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:i}})}},94984:(e,t,i)=>{i.d(t,{C:()=>r,a:()=>h,b:()=>d,f:()=>c,g:()=>o,l:()=>a,s:()=>p});var n=i(15332),s=i(931);const a=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function o(e){return function(e,t,i){const s=(0,n.c)(e,`[${t}]`);return s?s.getAttribute(t):i}(e,"dir","ltr")}const r={rtl:"arcgis--rtl"};async function c(e,t){const{api:i,type:n,places:a}=t||{};if(3===i){const[i]=await(0,s.l)(["dojo/number"]);return i.format(e,{type:n,places:a,pattern:null==t?void 0:t.pattern})}const[o]=await(0,s.l)(["esri/intl"]),r=o.convertNumberFormatToIntlOptions({places:a,style:n,digitSeparator:!0});return o.formatNumber(e,Object.assign(Object.assign({},r),{style:n}))}const l={};function d(e,t){let i=document.documentElement.lang;const n="bs"===i;if(n&&(i="hr"),t){const t=`${i}-full`,n={dateStyle:"full",timeStyle:"long"};return l[t]||(l[t]=new Intl.DateTimeFormat(i,n)),l[t].format(e)}const s={year:"numeric",month:n?"numeric":"short",day:"numeric"};return l[i]||(l[i]=new Intl.DateTimeFormat(i,s)),l[i].format(e)}function h(e,t,i,n){const s=null!=e?e:"en";let a=t.unknown;return(1===i||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(s))&&(a=t.single),1!==i&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(s)&&(a=t.multiple),p(a,Object.assign(Object.assign({},n),{number:i}))}const u=/\$\{([^}]+)\}/g;function p(e,t,i=u){let n=e;try{n=e.replace(i,(e,i)=>function(e,t){const i=e.split(".").reduce((e,t)=>e[t],t);return"string"==typeof i||"number"==typeof i?i:e}(i,t).toString())}catch(e){console.error(e)}return n}}}]);