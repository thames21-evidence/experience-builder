/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-38441e.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-38441e"],{5589:(e,i,n)=>{n.d(i,{a:()=>t,b:()=>o,g:()=>r,s:()=>d});var s=n(5294),a=(n(52797),n(54312),n(44345),n(55448),n(34031),n(63438),n(5933),n(28927),n(83368),n(89704),n(66228)),l=(n(56451),n(31521),n(23054),n(5077),n(23795),n(17902),n(87420),n(30161),n(81734),n(1225));n(83552),n(77462),n(49403),n(66617),n(10628),n(59640),n(64451),n(6176),n(10454),n(29614),n(94916),n(52554),n(2156),n(4038),n(49851),n(75054),n(15223),n(70169),n(47207),n(70852),n(48103),n(39423),n(85681),n(18444),n(42411),n(9767),n(38218),n(91914),n(86605),n(68196),n(440),n(46547),n(6238),n(7299);function o(e){const{mapView:i}=e,n=(0,l.g)(e),s=n.authoringInfo,o="class-breaks"===n.type?n.classBreakInfos:n.uniqueValueInfos,t=(0,l.c)(n,"size"),r=(0,l.p)(n,"reference-size"),u=(0,l.p)(n,"spike"),c=!!t&&!(0,a.i)(t.minSize),f=!!t&&"number"==typeof t.minSize,m="above-and-below"===s?.univariateTheme;let z=2,p=20;if(r)r.referenceSizeScale&&d(e),[z,p]=[r.sizeStops[0].size,r.sizeStops[1].size];else if(u)[z,p]=[u.sizeStops[0].size,u.sizeStops[1].size];else if(t)if(m){const e=t.stops;[z,p]=[e[2].size,Math.max(e[0].size,e[4].size)]}else if(c){const e=t.stops;[z,p]=[e[0].size,e[e.length-1].size]}else if(f)[z,p]=[t.minSize,t.maxSize];else{const e=i.scale,n=t.minSize.stops,s=t.maxSize.stops;[z,p]=[n[n.length-1].size,s[s.length-1].size];for(let i=0;i<n.length;i++){const a=n[i],l=s[i];if(e<=a.value){if(i>0){const o=n[i-1],t=s[i-1],r=(e-o.value)/(a.value-o.value);[z,p]=[o.size+(a.size-o.size)*r,t.size+(l.size-t.size)*r]}else[z,p]=[n[0].size,s[0].size];break}}}else if(o){const e=o[0].symbol,i=o[o.length-1].symbol;[z,p]=[(0,l.w)(e),(0,l.w)(i)],z>p&&([z,p]=[p,z])}return[z,p]}function t(e,i){const{mapView:n}=e,t=(0,l.g)(e),r=(0,l.c)(t,"size");let d=i[0],u=(0,a.i)(i[1])?i[1]:d;if(r){const l="above-and-below"===t.authoringInfo?.univariateTheme,c=!!r&&!(0,a.i)(r.minSize),f=!!r&&"number"==typeof r.minSize,[m,z]=o(e),p=m>z;if(!p&&d>=z?d=z-.75:p&&d>=m&&(d=m-.75),!p&&m>=u?u=m+.75:p&&z>=u&&(u=z+.75),l){const e=r.stops,n=p?i[1]:i[0],s=p?i[0]:i[1],a=Math.max(...e.map(e=>e.value)),l=e[2].value,o=Math.min(...e.map(e=>e.value)),t=Math.abs(a-l),d=Math.abs(o-l),u=t>d?t:d,c=s-n;e.forEach(e=>{const{value:i}=e;e.size=Math.abs(i-l)/u*c+n})}else if(c){const e=r.stops;r.stops=null,r.minSize=d,r.maxSize=u,r.minDataValue=e[0].value,r.maxDataValue=e[e.length-1].value}else if(f)p?(r.maxSize=d,r.minSize=u):(r.minSize=d,r.maxSize=u);else{const e=n.scale;let i=s.clone(r.minSize.stops),a=s.clone(r.maxSize.stops);p&&([i,a]=[a,i]);let l=d/i[i.length-1].size,o=u/a[a.length-1].size;for(let n=0;n<i.length;n++){const s=i[n],t=a[n];if(e<=s.value){if(n>0){const r=i[n-1],c=a[n-1],f=(e-r.value)/(s.value-r.value),[m,z]=[r.size+(s.size-r.size)*f,c.size+(t.size-c.size)*f];l=d/m,o=u/z}else l=d/i[0].size,o=u/a[0].size;break}}i.forEach(e=>e.size=Math.round(l*e.size*10)/10),a.forEach(e=>e.size=Math.round(o*e.size*10)/10),p&&([i,a]=[a,i]),r.minSize.stops=i,r.maxSize.stops=a}}else{const e=t.classBreakInfos[0].symbol,i=t.classBreakInfos[t.classBreakInfos.length-1].symbol;let n=(0,l.w)(e),s=(0,l.w)(i),a=!1;n>s&&([n,s]=[s,n],a=!0),n!==s&&d>s&&(d=s-.75),n=d,n!==s&&n>u&&(u=n+.75),s=u;const o=s-n,r=1===t.classBreakInfos.length?1:o/(t.classBreakInfos.length-1);t.classBreakInfos.forEach((e,i)=>{const o=e.symbol;a?(0,l.u)(o,s-r*i):(0,l.u)(o,n+r*i)})}}function r(e,i){const n=e.stops,s=n.length-1,a=n[0].value,l=n[s].value;if(i<=a)return n[0].size;if(i>=l)return n[s].size;for(let e=0;e<=s;e++){const s=n[e],a=n[e+1];if(i>=s.value&&i<a.value){const e=a.value-s.value,n=s.size-a.size,l=(i-s.value)/e,o=s.size-n*l;return Math.round(100*o)/100}}return 1}function d(e){const{mapView:i}=e,n=(0,l.g)(e),s=(0,l.p)(n,"reference-size"),a=s.referenceSizeScale/i.scale;s.sizeStops.forEach(e=>e.size*=a),s.referenceSizeScale=i.scale}},87735:(e,i,n)=>{n.d(i,{a:()=>S,b:()=>h,c:()=>m,d:()=>c,e:()=>f,f:()=>d,g:()=>u,h:()=>p,i:()=>b,s:()=>z});var s=n(5294),a=n(94916),l=n(52554),o=n(1225),t=(n(54312),n(44345),n(55448),n(52797),n(34031),n(63438),n(5933),n(89704),n(66228)),r=(n(56451),n(31521),n(23054),n(5077),n(23795),n(17902),n(87420),n(30161),n(81734),n(5589));n(83552),n(77462),n(49403),n(66617),n(10628),n(59640),n(64451),n(6176),n(10454),n(29614),n(2156),n(4038),n(49851),n(75054),n(15223),n(70169),n(47207),n(70852),n(48103),n(39423),n(85681),n(18444),n(42411),n(9767),n(38218),n(91914),n(86605),n(68196),n(440),n(46547),n(28927),n(6238),n(7299);async function d(e,i){const{layer:n,useFeatureReduction:s,mapImageSublayer:l,mapView:r,supportsArcade:d}=e,u=n;if(l&&!d)return await async function(e,i){const{layer:n,useFeatureReduction:s,mapImageSublayer:l,mapView:r}=e,d=n;i=i||{};const u=(0,o.a)(e,(0,o.g)(e)),c=i.fieldInfos?.[0];return await a.createClassBreaksRenderer({layer:d,view:r,field:c?.field,valueExpression:c?.expression,valueExpressionTitle:c?.expressionTitle,normalizationField:void 0,classificationMethod:i.classificationMethod?i.classificationMethod:"natural-breaks",standardDeviationInterval:"standard-deviation"===i.classificationMethod?i.standardDeviationInterval?i.standardDeviationInterval:1:void 0,numClasses:i.numClasses?i.numClasses:4,outlineOptimizationEnabled:!l&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,o.o)(e)),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:s}).then(e=>((0,o.b)(u,e.renderer),e))}(e,i);const c=(0,o.g)(e),f=c.authoringInfo,m=(0,o.p)(c,"reference-size"),p=(0,o.p)(c,"spike"),b=(0,o.d)(e);i=i||{};const S=(0,o.a)(e,(0,o.g)(e)),h=i.fieldInfos?.[0],y=i.theme?i.theme:m?h?.field?"reference-size":"high-to-low":p?h?.field?"spike":"high-to-low":void 0,v={layer:u,view:r,field:h?.field,theme:y,valueExpression:h?.expression,valueExpressionTitle:h?.expressionTitle,normalizationField:i.normalizationField,outlineOptimizationEnabled:!l&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,o.o)(e)),sizeOptimizationEnabled:!l&&(!(0,t.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:s,referenceSizeOptions:i.theme&&"reference-size"!==i.theme||!h?.field?void 0:(0,t.i)(i.referenceSizeOptions)?i.referenceSizeOptions:m?{symbolStyle:m.referenceSizeSymbolStyle}:void 0,spikeOptions:i.theme&&"spike"!==i.theme||!h?.field?void 0:(0,t.i)(i.spikeOptions)?i.spikeOptions:p?{symbolStyle:p.spikeSymbolStyle}:void 0};return await a.createContinuousRenderer(v).then(n=>{const s=(0,o.p)(n.renderer,"reference-size"),a=(0,o.p)(n.renderer,"spike");if(a){const e=n.renderer.classBreakInfos[0].symbol,i=(0,o.C)(e);i?.color?.[3]&&(i.color[3]=255)}if(!i.noReuse&&z(e,i)&&["size","color-size","type-size","relationship-size"].includes(b)&&f&&"above-and-below"!==f.univariateTheme&&!(0,t.i)(s)&&!(0,t.i)(m)&&!(0,t.i)(a)&&!(0,t.i)(p)){const i=(0,o.g)(e).clone(),s=(0,o.c)(i,"size"),a=(0,o.p)(i,"size"),l=(0,o.c)(i,"size","outline");n.renderer.visualVariables=[s],l&&n.renderer.visualVariables.push(l),a&&(n.renderer.authoringInfo.visualVariables=[a]),(0,o.Q)(e,n.renderer)}return(0,o.b)(S,n.renderer),n})}async function u(e,i){const{layer:n,mapImageSublayer:s,mapView:l}=e,r=n,d=(0,o.g)(e).authoringInfo,u=(0,o.d)(e);i=i||{};const c=(0,o.a)(e,(0,o.g)(e)),f=i.fieldInfos?.[0],m=i.theme?i.theme:"high-to-low",p={layer:r,view:l,startTime:f?.field,endTime:new Date,theme:m,unit:void 0,outlineOptimizationEnabled:!s&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,o.o)(e)),sizeOptimizationEnabled:!0,legendOptions:i.legendOptions,defaultSymbolEnabled:!1};return await a.createAgeRenderer(p).then(n=>{if(z(e,i)&&["size-age","color-size-age","type-size-age"].includes(u)&&d&&"above-and-below"!==d?.univariateTheme){const i=(0,o.g)(e).clone(),s=(0,o.c)(i,"size"),a=(0,o.p)(i,"size"),l=(0,o.c)(i,"size","outline");n.renderer.visualVariables=[s],l&&n.renderer.visualVariables.push(l),a&&(n.renderer.authoringInfo.visualVariables=[a]),(0,o.Q)(e,n.renderer)}return(0,o.b)(c,n.renderer),n})}async function c(e,i){const{layer:n,useFeatureReduction:s,mapImageSublayer:l,mapView:r,supportsArcade:d}=e,u=n;if(l&&!d)return await m(e,i);i=i||{};const c=(0,o.g)(e),f=c.authoringInfo||{},z=(0,o.d)(e),p=(0,o.c)(c,"size"),b=(0,o.p)(c,"size"),S=(0,o.p)(c,"reference-size"),h=(0,o.p)(c,"spike"),y=(0,o.a)(e,c);let v;if(["type-size","relationship-size"].includes(z)){const i=(0,o.g)(e);v=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,o.e)(e,z)}else v=c.classBreakInfos?.length?c.classBreakInfos[c.classBreakInfos.length-1].symbol:(0,o.e)(e,z);const g=c.defaultSymbol,x=c.defaultLabel,I=c.backgroundFillSymbol,V=(0,t.i)(i.referenceSizeOptions)?"reference-size":(0,t.i)(i.spikeOptions)?"spike":i.theme?i.theme:!b||S||h?S?"reference-size":h?"spike":"high-to-low":b.theme;let k=!1;if(p)V===p.theme&&(k=p.minSize.stops?p.minSize.stops[0].size>p.maxSize.stops[0].size:p.minSize>p.maxSize);else if(!S&&!h){const e=c.classBreakInfos[0].symbol,i=c.classBreakInfos[c.classBreakInfos.length-1].symbol,n=(0,o.w)(e),s=(0,o.w)(i);k=n>s}if(i.fieldInfos?.[0]&&p&&i.fieldInfos?.[0].field===p.field&&i.fieldInfos?.[0].expression===p.valueExpression&&i.normalizationField===p.normalizationField&&(delete i.fieldInfos,(0,o.O)(i))){const e=c.clone();return e.visualVariables=(0,o.H)(c,"color"),{renderer:e}}const O=i.fieldInfos?.[0]?i.fieldInfos[0]:p?{field:p.field,expression:p.valueExpression,expressionTitle:p.valueExpressionTitle,simpleFieldType:o.J.NUMBER}:S?{field:S.field,simpleFieldType:o.J.NUMBER}:h?{field:h.field,simpleFieldType:o.J.NUMBER}:{field:c.field,expression:c.valueExpression,expressionTitle:c.valueExpressionTitle,simpleFieldType:o.J.NUMBER},E=null===i.normalizationField?void 0:i.normalizationField?i.normalizationField:p?p.normalizationField:S?S.normalizationField:h?h.normalizationField:c.normalizationField;let B=!1;(null===i.normalizationField||i.normalizationField||i.fieldInfos?.[0]||"manual"===f.classificationMethod&&!i.theme||"equal-interval"===f.classificationMethod)&&(B=!0);const w=i.discardMinMax?void 0:(0,t.i)(i.min)?i.min:B?void 0:p?b?.minSliderValue:S?S.minSliderValue:h?h.minSliderValue:c.classBreakInfos[0].minValue,F=i.discardMinMax?void 0:(0,t.i)(i.max)?i.max:B?void 0:p?b?.maxSliderValue:S?S.maxSliderValue:h?h.maxSliderValue:c.classBreakInfos[c.classBreakInfos.length-1].maxValue,M={layer:u,view:r,theme:V,field:O.field,valueExpression:O.expression,valueExpressionTitle:O.expressionTitle,normalizationField:E,minValue:w,maxValue:F,outlineOptimizationEnabled:!l&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!y.sizeOutlineVisVar),sizeOptimizationEnabled:!l&&(!p||((0,t.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:"object"==typeof p?.minSize)),legendOptions:i.legendOptions?.toJSON()||p?.legendOptions?.toJSON()||c.legendOptions?.toJSON(),defaultSymbolEnabled:(0,t.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!c.defaultSymbol,forBinning:s,referenceSizeOptions:i.theme&&"reference-size"!==i.theme?void 0:(0,t.i)(i.referenceSizeOptions)?i.referenceSizeOptions:S?{symbolStyle:S.referenceSizeSymbolStyle}:void 0,spikeOptions:i.theme&&"spike"!==i.theme?void 0:(0,t.i)(i.spikeOptions)?i.spikeOptions:h?{symbolStyle:h.spikeSymbolStyle}:void 0};return await a.createContinuousRenderer(M).then(n=>{const s=(0,o.p)(n.renderer,"reference-size");if(s){const i=s.sizeStops?.map(e=>e.size);if(!i||i[1]<i[0]||1===Math.round(i[1])){const{_messages:i}=e;return Promise.reject({message:i.themeButton.errors.invalidReferenceSizeStops,type:"warning"})}}const a=(0,o.p)(n.renderer,"spike");if(!h&&a){const e=n.renderer.classBreakInfos[0].symbol,i=(0,o.C)(e);i?.color?.[3]&&(i.color[3]=255)}const l=S?.referenceSizeSymbolStyle!==s?.referenceSizeSymbolStyle,t=h?.spikeSymbolStyle!==a?.spikeSymbolStyle;if(!i.referenceSizeOptions&&!S&&(n.renderer.authoringInfo.visualVariables=(0,o.P)(n.renderer,"reference-size")||[]),!i.spikeOptions&&!h&&(n.renderer.authoringInfo.visualVariables=(0,o.P)(n.renderer,"spike")||[]),i.discardMinMax&&!S&&!s&&!h&&!a){const e=(0,o.c)(c,"size"),i=(0,o.c)(n.renderer,"size");e.minDataValue=i.minDataValue,e.maxDataValue=i.maxDataValue}if(!i.fieldInfos&&void 0===i.normalizationField&&p&&!s&&!a&&V===p?.theme){const e=(0,o.c)(n.renderer,"size");e.minDataValue=p.minDataValue,e.maxDataValue=p.maxDataValue}if(!S&&s&&(n.renderer.defaultLabel=void 0,n.renderer.defaultSymbol=void 0,n.renderer.backgroundFillSymbol=void 0),["color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size","predominance-size"].includes(z)){if(l||t)return n;c.visualVariables=(0,o.H)(c,"size")||[],c.visualVariables=(0,o.H)(c,"size","outline")||[],c.authoringInfo.visualVariables=(0,o.P)(c,"size")||[],c.authoringInfo.visualVariables=(0,o.P)(c,"reference-size")||[];const i=(0,o.c)(n.renderer,"size");i&&c.visualVariables.push(i);const s=(0,o.c)(n.renderer,"size","outline");s&&c.visualVariables.push(s);const a=(0,o.p)(n.renderer,"size");return a&&c.authoringInfo.visualVariables.push(a),(0,o.Q)(e,c),n.renderer=c.clone(),n}if((0,o.b)(y,n.renderer),!l&&v&&n.renderer.classBreakInfos?.length&&!a&&!h&&(n.renderer.classBreakInfos[0].symbol=v),l&&v&&n.renderer.classBreakInfos?.length){const e=(0,o.i)(v);(0,o.y)(n.renderer.classBreakInfos[0].symbol,e)}if(g&&(!s||S)&&(n.renderer.defaultSymbol=g,n.renderer.defaultLabel=x),I&&(!s||S)&&(n.renderer.backgroundFillSymbol=I),k){const e=(0,o.c)(n.renderer,"size");if(e){const i=e.minSize;e.minSize=e.maxSize,e.maxSize=i}}return n})}async function f(e,i){const{layer:n,mapImageSublayer:s,mapView:l}=e,r=n;i=i||{};const d=(0,o.g)(e),u=(0,o.d)(e),c=(0,o.c)(d,"size"),f=(0,o.p)(d,"size"),m=(0,o.a)(e,d),z=i.startTime?i.startTime:f.startTime,p=i.endTime?i.endTime:f.endTime;let b;if(["type-size-age"].includes(u)){const i=(0,o.g)(e);b=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,o.e)(e,u)}else b=d.classBreakInfos?.length?d.classBreakInfos[0].symbol:(0,o.e)(e,u);const S=d.defaultSymbol,h=d.defaultLabel,y=d.backgroundFillSymbol;let v=!1;if(c)v=c.minSize.stops?c.minSize.stops[0].size>c.maxSize.stops[0].size:c.minSize>c.maxSize,"below"===f.theme&&(v=!v);else{const e=d.classBreakInfos[0].symbol,i=d.classBreakInfos[d.classBreakInfos.length-1].symbol,n=(0,o.w)(e),s=(0,o.w)(i);v=n>s}if(i.fieldInfos?.[0]&&c&&i.fieldInfos[0].field===c.field&&(delete i.fieldInfos,(0,o.O)(i))){const e=d.clone();return e.visualVariables=(0,o.H)(d,"color"),{renderer:e}}let g=!1;(i.startTime||i.endTime||i.units||i.fieldInfo||i.theme)&&(g=!0);const x=i.discardMinMax?void 0:(0,t.i)(i.min)?i.min:g?void 0:f?f.minSliderValue:d.classBreakInfos[0].minValue,I=i.discardMinMax?void 0:(0,t.i)(i.max)?i.max:g?void 0:f?f.maxSliderValue:d.classBreakInfos[d.classBreakInfos.length-1].maxValue,V={layer:r,view:l,theme:i.theme?i.theme:f?f.theme:"high-to-low",startTime:z,endTime:p,unit:i.units?i.units:f.units,minValue:x,maxValue:I,outlineOptimizationEnabled:!s&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!m.sizeOutlineVisVar),sizeOptimizationEnabled:!s&&(!c||((0,t.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:"object"==typeof c.minSize)),legendOptions:i.legendOptions?.toJSON()||c?.legendOptions?.toJSON()||d.legendOptions?.toJSON(),defaultSymbolEnabled:(0,t.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!d.defaultSymbol};return await a.createAgeRenderer(V).then(n=>{if(i.discardMinMax){const e=(0,o.c)(d,"size"),i=(0,o.c)(n.renderer,"size");e.minDataValue=i.minDataValue,e.maxDataValue=i.maxDataValue}if((0,o.p)(n.renderer,"size").field=f.field,!g){const e=(0,o.c)(n.renderer,"size");e.minDataValue=c.minDataValue,e.maxDataValue=c.maxDataValue}if(["color-size-age"].includes(u)){d.visualVariables=(0,o.H)(d,"size")||[],d.visualVariables=(0,o.H)(d,"size","outline")||[],d.authoringInfo.visualVariables=(0,o.P)(d,"size")||[];const i=(0,o.c)(n.renderer,"size");d.visualVariables.push(i);const s=(0,o.p)(n.renderer,"size");d.authoringInfo.visualVariables.push(s);const a=(0,o.c)(n.renderer,"size","outline");return a&&d.visualVariables.push(a),(0,o.Q)(e,d),n.renderer=d.clone(),n}if((0,o.b)(m,n.renderer),b&&n.renderer.classBreakInfos?.length&&(n.renderer.classBreakInfos[0].symbol=b),S&&(n.renderer.defaultSymbol=S,n.renderer.defaultLabel=h),y&&(n.renderer.backgroundFillSymbol=y),v){const e=(0,o.c)(n.renderer,"size"),i=e.minSize;e.minSize=e.maxSize,e.maxSize=i}return n})}async function m(e,i){const{layer:n,useFeatureReduction:s,mapImageSublayer:l,mapView:r}=e,d=n;i=i||{};const u=(0,o.g)(e),c=(0,o.d)(e),f=u.authoringInfo,m=(0,o.c)(u,"size"),z=(0,o.p)(u,"size"),p=(0,o.a)(e,u),b={field:u.field,expression:u.valueExpression,expressionTitle:u.valueExpressionTitle,simpleFieldType:o.J.NUMBER},S=i.fieldInfos?i.fieldInfos[0]:m?{field:m.field,expression:m.valueExpression,expressionTitle:m.valueExpressionTitle,simpleFieldType:o.J.NUMBER}:b,h=void 0!==i.normalizationField?i.normalizationField:m?m.normalizationField:u.normalizationField;let y;if(["type-size"].includes(c)){const i=(0,o.g)(e);y=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,o.e)(e,c)}else y=u.classBreakInfos?.length?u.classBreakInfos[0].symbol:(0,o.e)(e,c);const v=u.defaultSymbol,g=u.defaultLabel,x=u.backgroundFillSymbol;let I=!1;if(u.classBreakInfos.length>1){const e=u.classBreakInfos[0].symbol,i=u.classBreakInfos[1].symbol,n=(0,o.w)(e)||0,s=(0,o.w)(i)||0;I=n>s}if(!m&&f&&(0,o.N)(S,b)&&h===u.normalizationField&&(delete i.fieldInfos,(0,o.O)(i))){const e=u.clone();return e.visualVariables=(0,o.H)(u,"color"),{renderer:e}}const V=i.classificationMethod?i.classificationMethod:f?.classificationMethod&&"manual"!==f.classificationMethod?f.classificationMethod:"equal-interval",k="standard-deviation"===V?i.standardDeviationInterval?i.standardDeviationInterval:f?.standardDeviationInterval?f.standardDeviationInterval:1:void 0;let O=!0;i.classificationMethod&&i.classificationMethod!==f?.classificationMethod&&("standard-deviation"===i.classificationMethod||"standard-deviation"===f?.classificationMethod)&&(O=!1);let E=!1;(void 0!==i.normalizationField||!(0,o.N)(S,b)||"equal-interval"!==V||z?.minSliderValue||z?.maxSliderValue)&&(E=!0);const B=(0,t.i)(i.min)?i.min:E?void 0:z?z.minSliderValue:u.classBreakInfos[0].minValue,w=(0,t.i)(i.max)?i.max:E?void 0:z?z.maxSliderValue:u.classBreakInfos[u.classBreakInfos.length-1].maxValue;return await a.createClassBreaksRenderer({layer:d,view:r,field:S.field,valueExpression:S.expression,valueExpressionTitle:S.expressionTitle,normalizationField:h,classificationMethod:V,standardDeviationInterval:k,numClasses:(0,t.i)(i.numClasses)?i.numClasses:m||!O?4:u.classBreakInfos.length,minValue:B,maxValue:w,outlineOptimizationEnabled:!l&&((0,t.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!p.sizeOutlineVisVar),legendOptions:i.legendOptions||u.legendOptions,defaultSymbolEnabled:(0,t.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!u.defaultSymbol,forBinning:s}).then(e=>{if((0,o.b)(p,e.renderer),y&&e.renderer.classBreakInfos&&e.renderer.classBreakInfos.forEach(e=>{const i=y.clone();(0,o.u)(i,(0,o.w)(e.symbol)),e.symbol=i}),v&&(e.renderer.defaultSymbol=v,e.renderer.defaultLabel=g),x&&(e.renderer.backgroundFillSymbol=x),I){const i=(0,o.c)(e.renderer,"size"),n=i.minSize;i.minSize=i.maxSize,i.maxSize=n}return e})}function z(e,i){const n=(0,o.g)(e).clone(),s=(0,o.d)(e);if(["size","size-age","color-size","color-size-age","color-age-size","type-size","type-size-age","relationship-size"].includes(s)&&void 0===i.normalizationField){let e;const a=(0,o.c)(n,"size");if(e=a?["size-age","color-size-age","type-size-age"].includes(s)?{field:(0,o.p)(n,"size").field}:{field:a.field,expression:a.valueExpression,expressionTitle:a.valueExpressionTitle}:{field:n.field,expression:n.valueExpression,expressionTitle:n.valueExpressionTitle},(0,o.N)(i.fieldInfos?.[0],e))return!0}return!1}function p(e){const{mapView:i}=e,n=(0,o.g)(e),a=(0,o.c)(n,"size"),t=(0,o.p)(n,"reference-size"),d=(0,o.p)(n,"spike"),u=i.scale;let c;if(a?.stops)c=s.clone(a.stops);else if(t?.sizeStops)t.referenceSizeScale&&(0,r.s)(e),c=s.clone(t.sizeStops);else if(d?.sizeStops)c=s.clone(d.sizeStops);else{const{minSize:e,maxSize:i,minDataValue:n,maxDataValue:s}=a;let o,t;if("number"==typeof e)o=e,t=i;else{const n=e.stops.length-1;u>e.stops[n].value?(o=e.stops[n].size,t=i.stops[n].size):e.stops.forEach((e,n)=>{u<=e.value&&(o=e.size,t=i.stops[n].size)})}c=[new l.default({value:n,size:o}),new l.default({value:s,size:t})]}return c}function b(e){return(0,o.g)(e).classBreakInfos.map(e=>{const i=e.symbol;return{min:e.minValue,max:e.maxValue,size:(0,o.w)(i)}})}async function S(e,i){const{layer:n,useFeatureReduction:l,mapView:r}=e,d=(0,o.g)(e),u=(0,o.p)(d,"reference-size");i=i||{};const c={layer:n,view:r,renderer:d.clone(),field:u.field,normalizationField:u.normalizationField,sizeStops:i.sizeStops??s.clone(u.sizeStops),forBinning:l,sizeOptimizationEnabled:(0,t.i)(u.referenceSizeScale),referenceSizeOptions:i.referenceSizeOptions??{symbolStyle:u.referenceSizeSymbolStyle}};return await a.updateRendererWithReferenceSize(c).then(e=>e)}async function h(e,i){const{layer:n,useFeatureReduction:l,mapView:t}=e,r=(0,o.g)(e),d=(0,o.p)(r,"spike");i=i||{};const u={layer:n,view:t,renderer:r.clone(),field:d.field,normalizationField:d.normalizationField,sizeStops:i.sizeStops??s.clone(d.sizeStops),forBinning:l,spikeOptions:i.spikeOptions??{symbolStyle:d.spikeSymbolStyle}};return await a.updateRendererWithSpike(u).then(i=>{const n=(0,o.R)(e,i),s=(0,o.p)(i,"spike"),a=d.spikeSymbolStyle,l=s.spikeSymbolStyle;if("triangle-gradient-fill-open"===a&&"triangle-gradient-fill-open-outline"===l||"triangle-solid-fill-open"===a&&["triangle-solid-fill-open-outline","triangle-solid-fill-closed-outline"].includes(l))if(["type-size","relationship-size"].includes(n))i.uniqueValueInfos.forEach(e=>{const i=e.symbol;(0,o.C)(i).color=[255,255,255,255]});else{const e=i.classBreakInfos[0].symbol;(0,o.C)(e).color=[255,255,255,255]}return i})}}}]);