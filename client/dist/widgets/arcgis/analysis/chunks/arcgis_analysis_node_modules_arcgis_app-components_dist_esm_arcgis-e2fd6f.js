/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e2fd6f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e2fd6f"],{3826:(e,a,i)=>{i.d(a,{a:()=>r,b:()=>n,c:()=>o,d:()=>t});const t=(0,i(37762).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),r=t.state,n=t.state,o=t.state},6750:(e,a,i)=>{function t(e){var a,i;const{dataLayer:t,type:r,sourceDataLayer:n}=e,o=null!==(a=null==t?void 0:t.geometryType)&&void 0!==a?a:null===(i=null==t?void 0:t.layerInfo)||void 0===i?void 0:i.geometryType,l="table"===(null==n?void 0:n.type.toLowerCase()),s=null==t?void 0:t.type;if("Microsoft Excel"===r||"CSV"===r){if(("address"===t.locationType&&t.addressFields||"coordinates"===t.locationType)&&"esriGeometryPoint"===(null==n?void 0:n.geometryType))return null;if(!o||"none"===t.locationType||l)return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==n?void 0:n.geometryType)!==o)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else{if((null==n?void 0:n.geometryType)!==(null==t?void 0:t.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"};if(l&&"table"===s.toLowerCase())return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if(l)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}}function r(e,a,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==a?void 0:a.type)||("esriGeometryPoint"===(null==a?void 0:a.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==a?void 0:a.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==a?void 0:a.type)||(null==e?void 0:e.geometryType)===(null==a?void 0:a.geometryType)}i.d(a,{c:()=>r,v:()=>t})},44069:(e,a,i)=>{i.d(a,{A:()=>r,a:()=>n,b:()=>o,c:()=>s,d:()=>l,u:()=>t});const t=["esriFieldTypeOID","esriFieldTypeGlobalID"],r={"file geodatabase":"filegeodatabase",shapefile:"shapefile",geojson:"geojson",csv:"CSV","microsoft excel":"excel",geopackage:"geoPackage","service definition":"serviceDefinition"},n={Shapefile:"shapefile","File Geodatabase":"fileGeodatabase",CSV:"csv","Microsoft Excel":"excel",GeoJson:"geojson",GeoPackage:"geoPackage"},o={csv:"CSV",excel:"Microsoft Excel",shapefile:"Shapefile",fgdb:"File Geodatabase",geojson:"GeoJson",googlesheets:"Microsoft Excel"},l=["zip","csv","xls","xlsx","geojson","gpkg","json","sd"],s=["zip","csv","xls","xlsx"]},46904:(e,a,i)=>{i.d(a,{a:()=>o,b:()=>n,c:()=>d,d:()=>c,e:()=>u,f:()=>p,g:()=>y,i:()=>l,u:()=>s});i(93814);var t=i(41473);function r(e){var a;return!!(null===(a=e.owner)||void 0===a?void 0:a.toLowerCase().includes("esri"))}function n(e){var a;return r(e)&&!!(null===(a=e.typeKeywords)||void 0===a?void 0:a.includes("Requires Credits"))}function o(e){var a;return r(e)&&!!(null===(a=e.typeKeywords)||void 0===a?void 0:a.includes("Requires Subscription"))}function l(e,a){return e.owner===a.username}function s(e,a){return l(e,a)||function(e,a){var i;if(null!=e.isAdmin)return!!e.isAdmin;const t=e.owner,r="admin"===e.itemControl,n=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(i=e.portal)||void 0===i?void 0:i.isPortal)&&!l(e,a)&&r&&t.includes("esri_")&&!n.includes(t))return!1;return r}(e,a)}const d=(e,a)=>!!a.orgId&&e.every(e=>e.isOrgItem),c=(e,a)=>`${(0,t.a)(a)}item.html?id=${e}`,u=(e,a)=>`${(0,t.g)(a)}/content/users/${e}`,p=e=>e.reduce((e,a)=>(e[a.owner]=e[a.owner]?[...e[a.owner],a.id]:[a.id],e),{}),y=(e,a)=>`${(0,t.a)(a)}content/items/${e}`},54077:(e,a,i)=>{i.d(a,{a:()=>c,b:()=>h,c:()=>l,d:()=>v,e:()=>s,f:()=>p,g:()=>u,i:()=>m});var t=i(4429),r=i(1654),n=i(3826),o=i(10578);const l={WORLD:"World",EU:"Europe",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barth\xe9lemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CD:"Congo, the Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"C\xf4te d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin (French part)",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, the former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PS:"Palestine, State of",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten (Dutch part)",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan, Province of China",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela, Bolivarian Republic of",VG:"Virgin Islands, British",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Republic of Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};function s(e,a){const{sourceCountry:i,locationType:t,analyzeResults:r,candidateFieldsType:o,coordinateFieldType:l,type:s,standardizedFieldNames:u,selectedFields:p}=n.a,y=c(),g=a?n.a.backupLayerFields:Object.values(p),m=Object.assign(Object.assign({locationType:t||"address",sourceCountry:i,candidateFieldsType:o},"coordinates"===t&&function(e,a){return e.reduce((e,i)=>{switch(i.locationType){case"latitude":e.latitudeFieldName=i.name,a||(e.coordinateFieldType="LatitudeAndLongitude");break;case"longitude":e.longitudeFieldName=i.name,a||(e.coordinateFieldType="LatitudeAndLongitude");break;case"mgrs":"MGRS"===a&&(e.coordinateFieldName=i.name,a||(e.coordinateFieldType="MGRS"));break;case"usng":"USNG"===a&&(e.coordinateFieldName=i.name,a||(e.coordinateFieldType="USNG"))}return e},{coordinateFieldType:a})}(g,l)),"address"===t&&{addressFields:d(g,e,u)});let v;return v=a||"Microsoft Excel"!==s?Object.assign(Object.assign({},r.publishParameters),m):Object.assign(Object.assign({},r.publishParameters),{layers:[Object.assign(Object.assign({},y),m)],hasStaticData:!0,maxRecordCount:2e3,layerInfo:{capabilities:"Query"}}),"coordinates"===t&&["USNG","MGRS"].includes(l)&&(delete v.latitudeFieldName,delete v.longitudeFieldName),v}function d(e,a,i){if("Single"===a){const a=Object.keys(i)[0]||"Address",t=e.find(({locationType:e})=>e===a||"address"===(null==e?void 0:e.toLowerCase()));return{[a]:(null==t?void 0:t.name)||""}}return e.reduce((e,a)=>("unknown"!==a.locationType&&(e[a.locationType]=a.name),e),{})}function c(e,a){var i,t,r,o,l,s,d;const{type:c,analyzeResults:u=e,selectedSheet:p}=n.a,y=null==u?void 0:u.publishParameters;if(a)return"CSV"===c?null==y?void 0:y.layerInfo:null!==(t=null===(i=null==y?void 0:y.layers)||void 0===i?void 0:i[p])&&void 0!==t?t:null===(r=null==y?void 0:y.layers)||void 0===r?void 0:r[0];switch(c){case"Microsoft Excel":return null!==(l=null===(o=null==y?void 0:y.layers)||void 0===o?void 0:o[p])&&void 0!==l?l:null===(s=null==y?void 0:y.layers)||void 0===s?void 0:s[0];case"GeoJson":return null===(d=null==y?void 0:y.layers)||void 0===d?void 0:d[0];default:return null==y?void 0:y.layerInfo}}function u(e){switch(e){case"esriFieldTypeBigInteger":return["esriFieldTypeBigInteger","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSmallInteger":return["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeInteger":return["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSingle":return["esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDouble":return["esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDate":return["esriFieldTypeDate","esriFieldTypeString"];case"esriFieldTypeDateOnly":return["esriFieldTypeDateOnly","esriFieldTypeString"];case"esriFieldTypeTimeOnly":return["esriFieldTypeTimeOnly","esriFieldTypeString"];case"esriFieldTypeTimestampOffset":return["esriFieldTypeTimestampOffset","esriFieldTypeString"];case"esriFieldTypeOID":return["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeString"];default:return["esriFieldTypeString"]}}function p(e,a){const i=null==a?void 0:a.filter(a=>a.url===e);return(null==i?void 0:i.length)?i.shift():null}function y(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com.*\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi))}function g(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi))}function m(e){return!!e&&(g(e)||y(e))}function v(e,a,i){let t=i||e||a||"";return t="wo"===(null==t?void 0:t.toLowerCase())?"world":t,l[t.toUpperCase()]||(t="world"),t}function h(e,a,i){var n;let l=(0,o.m)(a)&&(0,o.o)(a);const s=function(e,a,i){return e.filter(e=>{const r=Object.assign({},e),n=g(null==r?void 0:r.url),o=y(null==r?void 0:r.url);return(n||o)&&((0,t.c)(r.name)?"Esri World Geocoder"!==r.name&&"ArcGIS Geocoding service"!==r.name||(r.name="ArcGIS Geocoding Service"):r.name="ArcGIS World Geocoding Service"),(!n||!i&&!a)&&((0,t.c)(r.batch)?!!r.batch:n||o)})}(e,!l,i),d=null===(n=s[0])||void 0===n?void 0:n.url;if(null==s?void 0:s.length){l=!0;const e=p(s[0].url,s),t=g(null==e?void 0:e.url),n=y(null==e?void 0:e.url),o=t||n;let c=o||!!e.batch;return{allowGeocode:(!(0,r.g)(a)||l)&&(!i&&c||i&&(!t||n)&&c),isAgoWorldGeocodeServer:t,isServiceProxyAgoWorldGeocodeServer:n,isWorldGeocodeServer:o,geocodeServers:s,geocodeServiceUrl:d}}return null}},64033:(e,a,i)=>{i.r(a),i.d(a,{arcgis_new_item_pages_append_select_layer:()=>c});var t=i(87849),r=i(59317),n=i(84454),o=i(3826),l=i(95878),s=i(6750),d=i(69280);i(37762),i(44069),i(54077),i(1654),i(46904),i(93814),i(41473),i(10578),i(29599),i(83692),i(931),i(54251),i(15912);const c=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,t.c)(this,"newItemPrevPage",7),this.newItemToggleNavigationEnabled=(0,t.c)(this,"newItemToggleNavigationEnabled",7),this.newItemSetButtonState=(0,t.c)(this,"newItemSetButtonState",7),this.dataLayers=[],this.searchTerm="",this.isSourceDataSelect=!1,this.ITEMS_PER_PAGE=6,this.layers=void 0,this.loading=void 0,this.loaderMessage=void 0,this.error=void 0,this.filteredLayers=[],this.pagination=void 0,this.currentStart=1,this.selected=void 0}async handleNext(){var e,a;let i="appendKeyPairSelect";if(this.isSourceDataSelect)o.a.sourceDataLayer=this.selected,i="appendUpload";else{o.a.selectedSheet=this.selected.excelSheetId||this.selected.id,await this.analyzeSelectedLayer(),o.a.dataLayer=null===(a=null===(e=o.a.analyzeResults)||void 0===e?void 0:e.publishParameters)||void 0===a?void 0:a.layers[o.a.selectedSheet];const t=(0,d.a)(o.a.type,o.a.dataLayer,o.a.sourceDataLayer);i="Microsoft Excel"!==o.a.type&&"CSV"!==o.a.type||"esriGeometryPoint"!==(null===o.a||void 0===o.a?void 0:o.a.sourceDataLayer.geometryType)||"Table"===(null===o.a||void 0===o.a?void 0:o.a.sourceDataLayer.type)?"add"!==o.a.addAppendSelectOption||(t||o.a.backupLayerFields.some(e=>"esriFieldTypeDate"===e.type))&&!this.isEnterprise?"appendKeyPairSelect":"appendMatchFields":"csvLocationFields"}this.newItemToggleNavigationEnabled.emit(!0),this.newItemUpdatePage.emit(i)}searchHandler(e){this.searchTerm=e.detail,this.fetchLayers(this.searchTerm)}async handlePrev(e){e.preventDefault(),this.loading||(o.a.id&&(o.a.dataLayer=null),this.newItemPrevPage.emit())}async componentWillLoad(){const{sourceDataLayer:e,existingItem:a,addAppendSelectOption:i,appendOptions:t}=o.a,n=a.layers||(null==t?void 0:t.layers);this.layers=n,this.isSourceDataSelect=this.layers.length>1&&!e,this.item=a,this.i18n=l.u.i18n.appendSelectLayer,this.isEnterprise=r.c.portal.isPortal,this.header=this.isSourceDataSelect?this.i18n.chooseServiceLayer:this.createHeaderText("Microsoft Excel"===o.a.type),this.isSourceDataSelect?(this.dataLayers=n,this.filteredLayers=n,this.selected=this.filteredLayers[0]):(this.addLayerInfo(),this.selected||"update"===i||(this.handleError(this.i18n.sameGeometryWarningTitle,this.i18n.sameGeometryWarningDescription,"warning"),this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!0}})))}async analyzeSelectedLayer(){this.newItemToggleNavigationEnabled.emit(!1),this.loading=!0,this.loaderMessage=l.u.i18n.appendUpload.analyzing;const{portal:e,user:a,config:i,lang:t}=r.c,{type:s}=o.a,{error:d}=await(0,n.a)({analyzeArgs:{type:"item",itemid:o.a.id,workflow:"append"},itemArgs:{itemType:s},configArgs:{portal:e,user:a,config:i,lang:t},initialize:!0});d&&this.handleError()}fetchLayers(e){const a=e.toLowerCase(),i=this.dataLayers.filter(e=>e.name.toLowerCase().includes(a,0));this.currentStart=1,this.filteredLayers=i}addLayerInfo(){var e;const a=(null===(e=o.a.analyzeResults)||void 0===e?void 0:e.publishParameters)?o.a.analyzeResults.publishParameters:{},i=function(e,a,i,t,r){var n,o,l;const s=t.portal,d=(null==a?void 0:a.serviceInfo)||(null===(n=null==r?void 0:r.appendOptions)||void 0===n?void 0:n.serviceInfo)||{},c=(null==a?void 0:a.adminServiceInfo)||(null===(o=null==r?void 0:r.appendOptions)||void 0===o?void 0:o.adminServiceInfo)||{},u=(!s.isPortal||a.isSDS||(null===(l=null==r?void 0:r.appendOptions)||void 0===l?void 0:l.isSDS)?c.capabilities.split(","):d.capabilities.split(",")).includes("ChangeTracking"),p=(null==d?void 0:d.syncEnabled)||!1,y="fileGeodatabase"===(r.analyzeResults&&r.analyzeResults.publishParameters||{}).type,g=p||u?i.filter(a=>e.some(e=>e.geometryType===a.geometryType||!a.geometryType||"esriGeometryPoint"===a.geometryType&&!y&&!e.geometryType)):i;return g&&g.length?e:null}((a.layers||[a.layerInfo]||0).map(e=>{const i=e.locationType||a.locationType||null;return e.geometryType=e.geometryType||("coordinates"===i?"esriGeometryPoint":null)||null,e.addressFields=e.addressFields||a.addressFields||("coordinates"===i?{longitudeFieldName:e.longitudeFieldName||a.longitudeFieldName,latitudeFieldName:e.latitudeFieldName||a.latitudeFieldName}:{}),e}),this.item,this.layers,{portal:r.c.portal},{analyzeResults:o.a.analyzeResults,appendOptions:o.a.appendOptions});i&&(this.dataLayers=i,this.filteredLayers=i,this.selected=this.filteredLayers.filter(e=>(0,s.c)(e,o.a.sourceDataLayer,o.a.type))[0])}async handleError(e,a,i){this.newItemToggleNavigationEnabled.emit(!0),this.loading=!1,this.error={title:e||l.u.i18n.publishSelect.error.title,description:a||l.u.i18n.publishSelect.error.description,kind:i}}renderPageNumberText(){const e=this.currentStart,a=this.filteredLayers.length,i=Math.min(e+this.ITEMS_PER_PAGE-1,a);return(0,t.h)("span",{class:"page-number"},this.i18n.paginationHeader.replace("${start}",`${e}`).replace("${end}",`${i}`).replace("${total}",`${a}`))}createHeaderText(e){var a,i;const t=this.item.layers||(null===(a=o.a.appendOptions)||void 0===a?void 0:a.layers);return(e?this.i18n.chooseSheet:this.i18n.chooseLayer).replace("${featureLayerName}",0===(null==t?void 0:t.length)?this.item.title:null===(i=o.a.sourceDataLayer)||void 0===i?void 0:i.name).replace("${uploadedFile}",o.a.originalFileName)}render(){const{error:e,filteredLayers:a,i18n:i,currentStart:r,ITEMS_PER_PAGE:n,loading:d,loaderMessage:c,header:u,isSourceDataSelect:p}=this,y=a.length>0,g=(null==a?void 0:a.length)>n,m=null==a?void 0:a.slice(r-1,r+n-1);return(0,t.h)(t.H,{key:"6316191261a18e87102ba9b1d695959bffb6904d"},(0,t.h)("arcgis-new-item-loader",{key:"5e02ea7a0880df2f4669a95ead846cfa9e648612",class:"loader-overlay",type:"indeterminate",active:d,text:c}),(0,t.h)("div",{key:"074c97ac6bb543cddf8a3ba196421eb96d72260e",class:"appendLayerBrowser"},(0,t.h)("div",{key:"5b3601b402c37bb229dcba6c4e07c85f1f14e70f",class:"search-bar"},(0,t.h)("calcite-icon",{key:"e3b3d3e8a3b9a3dbf281e84494b9d4f1db58fefd",icon:"search",scale:"s",class:"x"}),(0,t.h)("input",{key:"0cb7e9cf95a4cee3bfe816c3ecc71bb39c04771b",class:"input",value:this.searchTerm,placeholder:l.u.i18n.layerSearch.search,onInput:e=>{const a=e.currentTarget.value;this.fetchLayers(a)}})),(0,t.h)("div",{key:"e5236126052a8f0c1b6e11a0abd06d3f97ea878c",class:"cards-wrapper"},(0,t.h)("div",{key:"96682aca0e81553555f023e2abc5f5d099feae48",class:"heading"},u),y?(0,t.h)("calcite-label",null,(0,t.h)("div",{class:"pagination-range"},g&&this.renderPageNumberText()),(0,t.h)("div",{class:"layerCards"},(m||[]).map((e,a)=>(0,t.h)("arcgis-new-item-append-layer-card",{key:e.excelSheetId||a,isIncompatibleGeom:!p&&"update"!==o.a.addAppendSelectOption&&!(0,s.c)(e,o.a.sourceDataLayer,o.a.type),selected:this.selected===e,layer:e,onLayerCardSelect:e=>{this.selected=e.detail.item}})),g&&(0,t.h)("div",{class:"pagination-wrapper"},(0,t.h)("calcite-pagination",{class:"pagination-component",scale:"m",totalItems:this.filteredLayers.length,pageSize:n,startItem:this.currentStart,onCalcitePaginationChange:e=>{this.currentStart=e.target.startItem}})))):(0,t.h)("div",{class:"no-results-string"},i.noResults)),(0,t.h)("arcgis-new-item-alert",{key:"70c24c34ea0059693b8492d915ace10da6487890",heading:null==e?void 0:e.title,description:null==e?void 0:e.description,link:{href:null==e?void 0:e.link,title:null==e?void 0:e.linkText},active:!!e,kind:(null==e?void 0:e.kind)||"danger",onAlertDismiss:()=>this.error=null})))}get el(){return(0,t.a)(this)}};c.style=":host{position:relative;display:flex;height:100%;max-width:100%;flex-direction:column;background-color:var(--calcite-color-background)}.search-bar{margin-left:auto;margin-right:auto;display:flex;padding-right:1rem;padding-left:2rem;max-width:var(--item-browser-max-width)}.x{position:absolute;z-index:10;cursor:pointer;border-style:none;background-color:transparent;color:var(--calcite-color-text-1);outline:2px solid transparent;outline-offset:2px;margin-top:0.875rem}.input{position:relative;z-index:0;box-sizing:border-box;display:block;height:3rem;width:100%;border-style:none;background-color:transparent;padding-right:1rem;padding-left:1.5rem;font-size:0.875rem;color:var(--calcite-color-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;border-bottom:2px solid transparent;font-family:inherit}.input::-webkit-search-cancel-button{display:none}.input::-ms-clear{display:none}.input:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid transparent;outline-offset:2px;border-bottom-color:var(--calcite-color-brand)}.heading{margin-top:1.5rem;margin-left:1.5rem;margin-right:1.5rem;margin-bottom:0.5rem;font-size:1rem;color:var(--calcite-color-text-1)}.layerCards{margin-left:1.5rem;margin-right:1.5rem;font-size:0.875rem}.appendLayerBrowser{position:relative;display:block;background-color:var(--calcite-color-foreground-1)}.cards-wrapper{position:relative;display:flex;height:100%;min-width:0px;flex-direction:column;justify-content:space-between;background-color:var(--calcite-color-background);padding-bottom:1rem}.pagination-range{margin-left:1.5rem}.no-results-string{display:flex;justify-content:center;align-items:center}.pagination-wrapper{padding-top:0.5rem;padding-bottom:0.5rem}.pagination-component{display:flex;justify-content:center}"},69280:(e,a,i)=>{i.d(a,{a:()=>c,c:()=>s,g:()=>d,h:()=>u});var t=i(3826),r=i(54077),n=i(15912),o=i(95878),l=function(e,a){var i={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(i[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(t=Object.getOwnPropertySymbols(e);r<t.length;r++)a.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(i[t[r]]=e[t[r]])}return i};function s(e,a){var i;const t=(null==e?void 0:e.type)||null,r=(null==a?void 0:a.type)||null;return r&&(r===t||(null===(i={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[t])||void 0===i?void 0:i.includes(r)))}function d(e){var a;const{timezone:i,analyzeResults:s,type:d,fieldMappings:c,dataLayer:u,id:p,portal:y,uidPair:g,addAppendSelectOption:m,sourceDataLayer:v,attachmentsEnabled:h,insertAttachmentsEnabled:f,featureAttachmentOption:b}=e;let T,S;const{publishParameters:F}=s,w=l(s,["publishParameters"]),I="upsert"===m||"update"===m,G=function(e){const a=e.filter(e=>e.source!==`<${o.u.i18n.appendKeyValuePair.noneField}>`),i=a.map(({source:e,name:a})=>({source:e,name:a}));return i}(c),M=function(e){const a=e.map(e=>e.name);return a}(G),L={dateFieldsTimeReference:Object.assign(Object.assign({},(null==y?void 0:y.isPortal)?{timeZone:i||"UTC"}:{ianaTimeZone:i||"GMT"}),{respectsDaylightSaving:!0})},C={sourceTableName:u.name,fieldMappings:(null==G?void 0:G.length)?JSON.stringify(G):null,upsert:I,skipInserts:"update"===m,skipUpdates:!1,useGlobalIds:I&&"esriFieldTypeGlobalID"===(null==g?void 0:g.type),updateGeometry:!I||"attributeAndGeometry"===t.a.addAppendSelectUpdateTypeOption,appendFields:M.length?JSON.stringify(M):null,appendItemId:p,appendUploadFormat:n.a[t.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===v.type&&(F.locationType="none");const O=l(F,["layers"]);if("CSV"===d)F.layerInfo.dateFieldsTimeReference=L.dateFieldsTimeReference,S=Object.assign(Object.assign(Object.assign({},L),F),w);else if("Microsoft Excel"===d){const e=function(e,a){const i=Object.assign({},e);i.locationType=(null==a?void 0:a.locationType)||e.locationType,"address"===i.locationType?(i.addressFields=a.addressFields,i.sourceCountry=a.sourceCountry):"coordinates"===i.locationType&&(i.coordinateFieldType=a.coordinateFieldType,"LatitudeAndLongitude"===i.coordinateFieldType?(i.latitudeFieldName=a.latitudeFieldName,i.longitudeFieldName=a.longitudeFieldName):i.coordinateFieldName=a.coordinateFieldName);return i}((0,r.a)({},!0),O);e.dateFieldsTimeReference=L.dateFieldsTimeReference,O.name=u.name,S=Object.assign(Object.assign(Object.assign(Object.assign({},L),{layers:[e]}),O),w)}else S=Object.assign(Object.assign(Object.assign({},L),F),w);return T=Object.assign(Object.assign(Object.assign({},C),{appendSourceInfo:JSON.stringify(S)}),h&&function({insertAttachmentsEnabled:e}){return e?{skipAttachmentInserts:!1,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}:{skipAttachmentInserts:!0,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}}({appendType:m,insertAttachmentsEnabled:f,featureAttachmentOption:b})),"add"===m?T.upsertMatchingField=v.objectIdField||(null===(a=v.uniqueField)||void 0===a?void 0:a.name):I&&(null==g?void 0:g.isUniqueIndex)&&(T.upsertMatchingField=null==g?void 0:g.name),T}function c(e,a,i){return"File Geodatabase"===e&&i.hasAttachments&&a.hasAttachments}function u(e,a){const i=a.appendErrorMessages;let t=o.u.i18n.error,r=i.appendError;switch(e.code){case"invalidUniqueIdentifier":t=i.invalidUniqueIdentifier.title,r=i.invalidUniqueIdentifier.description;break;case"cannotAddNullData":t=i.cannotAddNullData.title,r=i.cannotAddNullData.description;break;case"exceededMaxFieldLength":t=i.exceededMaxFieldLength.title,r=i.exceededMaxFieldLength.description;break;case"invalidFieldType":t=i.invalidFieldType.title,r=i.invalidFieldType.description}return{title:t,description:r}}},84454:(e,a,i)=>{i.d(a,{a:()=>u,g:()=>c,s:()=>p});var t=i(3826),r=i(44069),n=i(54077),o=i(10578),l=i(41473),s=i(83692);function d(e,a,i,t){var r,n,o,l;const s=null!==(r=a.latitudeFieldName)&&void 0!==r?r:i.latitudeFieldName,d=null!==(n=a.longitudeFieldName)&&void 0!==n?n:i.longitudeFieldName,c=null!==(o=a.coordinateFieldName)&&void 0!==o?o:i.coordinateFieldName,u=null!==(l=a.coordinateFieldType)&&void 0!==l?l:i.coordinateFieldType;return t[e.name]?t[e.name]:e.name===c?null==u?void 0:u.toLowerCase():e.name===s?"latitude":e.name===d?"longitude":e.locationType||"unknown"}const c=(e,a)=>{if(!a)return e;const{layers:i,tables:t}=a;return"Map Service"===e&&!(null==i?void 0:i.length)&&(null==t?void 0:t.length)?"Feature Service":e};async function u({analyzeArgs:e,configArgs:a,itemArgs:i,initialize:c}){var u,g,m,v;const{config:h,lang:f,portal:b,user:T}=a,{itemType:S,ignoreV2FieldTypesVersion:F}=i;if(c&&(0,o.o)(T)){const e=(0,n.b)(null!==(g=null===(u=b.helperServices)||void 0===u?void 0:u.geocode)&&void 0!==g?g:[],T,b.isPortal);if(e&&(t.a.allowGeocode=e.allowGeocode,t.a.isAgoWorldGeocodeServer=e.isAgoWorldGeocodeServer,t.a.isServiceProxyAgoWorldGeocodeServer=e.isServiceProxyAgoWorldGeocodeServer,t.a.isWorldGeocodeServer=e.isWorldGeocodeServer,t.a.geocodeServers=e.geocodeServers,t.a.geocodeServiceUrl=e.geocodeServiceUrl),t.a.geocodeServers){t.a.sourceCountry=(0,n.d)(T.region,b.ipCntryCode);try{t.a.countryCodes=await async function(e,a,i){const t=(0,n.f)(e,i);let r;if(null==t?void 0:t.itemId){const e=`${a}/content/items/${t.itemId}`,i=await(0,s.r)(e),n=i.proxyFilter&&JSON.parse(i.proxyFilter).sourceCountry;n&&(r=n.split(",").map(e=>e.toLowerCase()),r.push("world"))}return Object.keys(n.c).map(e=>({label:n.c[e],value:e})).filter(({value:e})=>!r||r.includes(e.toLowerCase())).sort((e,a)=>e.label<a.label?-1:e.label>a.label?1:0)}(t.a.geocodeServiceUrl,h.restBaseUrl,t.a.geocodeServers),t.a.standardizedFieldNames=await y(t.a.geocodeServiceUrl,f)}catch(e){return console.error("Geocoder unavailable",e),{error:{code:"unavailableGeocoder"}}}}}const{locationType:w,isWorldGeocodeServer:I,geocodeServiceUrl:G,geocodeServers:M,isServiceProxyAgoWorldGeocodeServer:L,sourceCountry:C,analyzeResults:O,analyzedLocationTypes:P}=t.a,x=`${h.restBaseUrl}content/features/analyze`,{isPortal:A}=b;let k,D=!1;"item"===(null==e?void 0:e.type)&&"append"===e.workflow?(k=r.a[S],D=!0):k="Microsoft Excel"===S?"excel":S.toLowerCase();const N="file"===(null==e?void 0:e.type)&&e.analyze3DData;let E={filetype:k};switch(null==e?void 0:e.type){case"url":E.sourceUrl=e.sourceUrl;break;case"item":E.itemid=e.itemid;break;case"file":E=new FormData,E.append("file",e.file),E.append("filetype",N&&"File Geodatabase"===i.itemType?"fileGeodatabase":k);break;case"text":E.text=e.text}if(!N)if(A&&G||!A){const e={enableGlobalGeocoding:!0,sourceLocale:f,locationType:w,returnEstimatedRowCount:!0,returnSize:!0};if(F||(e.fieldTypesVersion="V2"),(A||!A&&(null==M?void 0:M.length))&&(e.geocodeServiceUrl=encodeURI(G)),O||A){const a="address"===w?"addressTypes":"locationTypes";-1===P.indexOf(a)&&P.push(a),e.locationType=w||"coordinates"}(!b.isPortal&&I||b.isPortal&&L)&&(e.sourceCountryHint=O?"":C.toLowerCase(),e.sourceCountry=O?C.toLowerCase():"");const a=JSON.stringify(e);E instanceof FormData?E.append("analyzeParameters",a):E.analyzeParameters=a}else F||(E instanceof FormData?E.append("analyzeParameters",JSON.stringify({fieldTypesVersion:"V2"})):E.analyzeParameters=JSON.stringify({fieldTypesVersion:"V2"}));try{const e=await(E instanceof FormData?(0,s.a)(x,E,{},"post"):(0,s.r)(x,E,{},"post"));if(N){if(!function(e){var a;const i=null==e?void 0:e.publishParameters,t=null===(a=null==i?void 0:i.layers)||void 0===a?void 0:a[0],r=null==t?void 0:t.infoFor3D,n="esriGeometryMultiPatch"===(null==t?void 0:t.geometryType);return r&&n}(e))return{error:{code:"invalid3DObjectFeatureClass"}}}else!async function({response:e,analyzeSelectedLayer:a,initialize:i,geocodeServiceUrl:r,lang:o,portal:c,itemType:u}){var y,g,m,v,h,f;const b=t.a,T=c.isPortal,S="Microsoft Excel"===u,F=S?null!==(g=null===(y=e.publishParameters.layers)||void 0===y?void 0:y[b.selectedSheet])&&void 0!==g?g:null===(m=e.publishParameters.layers)||void 0===m?void 0:m[0]:e.publishParameters;let w;if(!T&&b.isWorldGeocodeServer||T&&b.isServiceProxyAgoWorldGeocodeServer){const e=null!=F.sourceCountry;w=b.sourceCountry||F.sourceCountry||"world",w="wo"===w?"world":w,t.a.isWorldGeocodeServer=e,t.a.sourceCountry=w}b.allowGeocode||"address"!==F.locationType||(t.a.locationType="none");!function(e){var a,i,r,n,o,l;const{selectedSheet:s}=t.a,{publishParameters:c}=e,u=null!==(n=null!==(i=null===(a=c.layers)||void 0===a?void 0:a[s])&&void 0!==i?i:null===(r=c.layers)||void 0===r?void 0:r[0])&&void 0!==n?n:c.layerInfo;if(!u)return e;const p=null!==(l=null!==(o=u.addressFields)&&void 0!==o?o:c.addressFields)&&void 0!==l?l:{},y=Object.keys(p).reduce((e,a)=>Object.assign(Object.assign({},e),{[p[a]]:a}),{});u.fields=u.fields.map(e=>Object.assign(Object.assign({},e),{locationType:d(e,u,c,y)})),t.a.selectedFields&&(t.a.selectedFields=Object.keys(t.a.selectedFields).reduce((e,a)=>{const i=t.a.selectedFields[a];return e[a]=Object.assign(Object.assign({},i),{locationType:d(i,u,c,y)}),e},{}))}(e);const I=function(e){return function(e,a){var i,t,r,n;const{selectedFields:o,type:l,selectedSheet:s}=a;if(!o)return e;const d=e.publishParameters;let c=null==d?void 0:d.layerInfo;switch(l){case"Microsoft Excel":c=null!==(t=null===(i=null==d?void 0:d.layers)||void 0===i?void 0:i[s])&&void 0!==t?t:null===(r=null==d?void 0:d.layers)||void 0===r?void 0:r[0];break;case"GeoJson":c=null===(n=null==d?void 0:d.layers)||void 0===n?void 0:n[0]}return c.fields=c.fields.reduce((e,a)=>{const i=o[a.name];return i&&(a.alias=i.alias,e.push(a)),e},[]),e}(e,t.a)}(e);t.a.analyzeResults=I,(null===(v=null==I?void 0:I.publishParameters)||void 0===v?void 0:v.layers)&&(t.a.excelLayers=null===(h=null==I?void 0:I.publishParameters)||void 0===h?void 0:h.layers);const G=(0,n.a)(e,a);i?t.a.backupLayerFields=JSON.parse(JSON.stringify(G.fields)):F.standardizedFieldNames?t.a.standardizedFieldNames=F.standardizedFieldNames:p({lang:o,geocodeServiceUrl:r,locationType:t.a.locationType});"address"===t.a.locationType||"address"===G.locationType||"address"===(null===(f=null==e?void 0:e.publishParameters)||void 0===f?void 0:f.locationType)?t.a.geocodeCost=await(M=G.estimatedRecordCount,(0,s.r)(`${(0,l.g)()}portals/self/cost`,{geocodeCount:M})):t.a.geocodeCost=null;var M}({response:e,initialize:c,analyzeSelectedLayer:D,geocodeServiceUrl:G,lang:f,portal:b,itemType:S});return{}}catch(e){console.error(e);const a=(null==e?void 0:e.message)||e||"";switch(!0){case a.includes("specify data to be analyzed"):return{error:{code:"emptyFile"}};case a.includes("duplicate field names are not allowed"):return{error:{code:"duplicateFieldNames"}};case a.toLowerCase().includes("timeout"):return{error:{code:"timeout"}};case a.toLowerCase().includes("unable to analyze"):if(null===(v=null===(m=null==e?void 0:e.details)||void 0===m?void 0:m.messages[0])||void 0===v?void 0:v.toLowerCase().includes("file exceeds the max size allowed of 10mb."))return{error:{code:"exceedsFileSize"}};case a.toLowerCase().includes("error in analyzing filegeodatabase"):return{error:{code:"invalidFileGeodatabase"}}}return{error:{code:"unhandledError"}}}}async function p({lang:e,geocodeServiceUrl:a,locationType:i}){"address"===i&&(t.a.standardizedFieldNames=await y(a,e))}async function y(e,a){return(await(0,s.r)(e,{},{addTokenManually:!1})).addressFields.reduce((e,i)=>{var t;return"unknown"!==i.name&&(e[i.name]=(null===(t=null==i?void 0:i.localizedNames)||void 0===t?void 0:t[`${a}`])||i.alias||i.name),e},{})}},95878:(e,a,i)=>{i.d(a,{a:()=>t,u:()=>r});const t=(0,i(37762).c)({nextText:"next",cancelText:"cancel",workflow:"content",scale:"m",disableScroll:!1,onlyHosted:!1,featureFlags:{}}),r=t.state}}]);