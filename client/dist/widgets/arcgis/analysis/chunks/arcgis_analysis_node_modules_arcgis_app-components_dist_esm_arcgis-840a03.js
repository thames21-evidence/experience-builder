/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-840a03.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-840a03"],{10602:(e,t,s)=>{s.r(t),s.d(t,{arcgis_delete_items:()=>r});var i=s(87849),n=s(37762),l=s(51312),a=s(12192),o=s(59317);s(93814),s(52995),s(83692),s(931),s(41473),s(54251),s(46904),s(29599),s(60958),s(15332),s(94984);const r=class{constructor(e){var t;(0,i.r)(this,e),this.arcgisDeleteItemsDelete=(0,i.c)(this,"arcgisDeleteItemsDelete",7),this.arcgisDeleteItemsError=(0,i.c)(this,"arcgisDeleteItemsError",7),this.arcgisDeleteItemsClose=(0,i.c)(this,"arcgisDeleteItemsClose",7),this.arcgisDeleteItemsModeChange=(0,i.c)(this,"arcgisDeleteItemsModeChange",7),this.compositeItemsTotal=0,this.additionalCompositeItemsTotal=0,this.deletePrimaryAction="RECYCLE",this.headerTitle="",this.configurePermanentlyDeleteOverrideUI=()=>{var e;const{i18n:t}=this;this.headerTitle=t.permanentlyDelete,this.primaryButtonText=t.permanentlyDelete,this.deleteMode="UNRECYCLABLE",this.permanentDeleteOverrideEnabled=!0,null===(e=this.modalRef)||void 0===e||e.setFocus()},this.renderContent=()=>{var e,t;const{portal:s,items:n,inRecycleBin:l,deleteItemsBuckets:a,deleteMode:o,deletePrimaryAction:r,permanentDeleteOverrideEnabled:c,configurePermanentlyDeleteOverrideUI:d,showConfirmDeleteMessage:h,allowPermanentlyDeleteDeselect:m,baseUrl:u}=this;return(0,i.h)(i.F,null,(0,i.h)("slot",{name:"message"}),this.showCompositeDisclaimer?(0,i.h)("arcgis-delete-items-composite-disclaimer",{buckets:this.deleteItemsBuckets,additionalDependentItemsTotal:this.additionalCompositeItemsTotal,baseUrl:u}):(null!==(t=null===(e=s.sourceJSON)||void 0===e?void 0:e.recycleBinEnabled)&&void 0!==t?t:s.recycleBinEnabled)&&!l?(0,i.h)("arcgis-delete-items-recycle",{items:n,buckets:a,mode:o,primaryAction:r,primaryBucket:this.primaryBucket,allowPermanentlyDeleteDeselect:m,permanentlyDeleteOverridden:c,disableLinks:this.disableLinks,onArcgisDeleteItemsPermanentlyDeleteOverride:()=>{d()},onArcgisDeleteItemsPermanentlyDeleteBucketToggle:({detail:e})=>{this.preventNonRecyclableItemDelete=e},showSelectedItemsCount:this.showSelectedItemsCount,baseUrl:this.baseUrl}):h?(0,i.h)("arcgis-delete-items-permanent",{buckets:a,mode:o,disableLinks:this.disableLinks,baseUrl:this.baseUrl}):null)},this.handleDelete=async()=>{var e,t;this.isLoading=!0;const{unprotectedItems:s,unrecyclableItems:i}=this.deleteItemsBuckets,n=s.map(e=>e.item),a=i.map(e=>e.item);let o=[],r=[],c=[];const d=e=>e+this.compositeItemsTotal;try{const e=[...n];!this.preventNonRecyclableItemDelete&&e.push(...a),this.permanentDeleteOverrideEnabled||this.inRecycleBin?o=await this.deleteItems(e,!0):c=e.length>0?await this.deleteItems(e):[];for(const e of c)n.some(t=>t.id===e.itemId)?r.push(e):a.some(t=>t.id===e.itemId)&&o.push(e);const t=(0,l.s)({deletedItems:r,permanentlyDeletedItems:o}),s={deletedItems:[...t.successes.filter(e=>!e.permanentDelete)],permanentlyDeletedItems:[...t.successes.filter(e=>e.permanentDelete)],deletedItemsCount:r.length>0?d(r.length):0,permanentlyDeletedItemsCount:o.length>0?d(o.length):0};t.successes.length>0&&this.arcgisDeleteItemsDelete.emit(s);const{errors:i}=t;i.length>0&&this.arcgisDeleteItemsError.emit(i),this.closeOnConfirm&&(this.active=!1)}catch(s){this.arcgisDeleteItemsError.emit({messageCode:null!==(t=null===(e=s.details)||void 0===e?void 0:e.messageCode)&&void 0!==t?t:"unknown"}),this.isLoading=!1}},this.deleteItems=async(e,t=!1)=>1===e.length?[await(0,l.d)(e[0],this.portal,t)]:(await(0,l.a)(e,this.portal,t)).results,this.user=void 0,this.portal=void 0,this.items=[],this.inRecycleBin=void 0,this.active=void 0,this.showSelectedItemsCount=!0,this.showConfirmDeleteMessage=!0,this.allowPermanentlyDeleteDeselect=!0,this.disableLinks=void 0,this.primaryBucket="unrecyclableItems",this.closeOnConfirm=!0,this.allowDiscouraged=void 0,this.baseUrl=null===(t=null===o.c||void 0===o.c?void 0:o.c.config)||void 0===t?void 0:t.baseUrl,this.store=(0,n.c)({}),this.deleteItemsBuckets={unrecyclableItems:[],unprotectedItems:[],protectedItems:[],selectedCompositeItems:[]},this.permanentDeleteOverrideEnabled=!1,this.showCompositeDisclaimer=!1,this.isLoading=!1,this.preventNonRecyclableItemDelete=!1}async componentWillLoad(){const e=await(0,a.g)(this.el);this.i18n=e[0],this.store.state.i18n=this.i18n,this.store.state.portal=this.portal,this.store.state.locale=(0,a.a)(this.el),this.determineDeleteState()}async handleItemUpdate(){this.determineDeleteState({fetch:!0})}async determineDeleteState(e={fetch:!0}){const{fetch:t}=e;try{if(this.inRecycleBin)return this.deleteMode="UNRECYCLABLE",this.deletePrimaryAction="PERMANENTLY_DELETE",this.primaryButtonText=this.i18n.permanentlyDelete,this.headerTitle=this.i18n.permanentlyDelete,void(this.deleteItemsBuckets.unrecyclableItems=this.items.map(e=>({item:e})));t&&(this.isLoading=!0,this.deleteItemsBuckets=Object.assign({},await(0,l.b)(this.items,this.portal,this.allowDiscouraged)),this.compositeItemsTotal=this.countDependentItems(),this.additionalCompositeItemsTotal=this.compositeItemsTotal-this.deleteItemsBuckets.selectedCompositeItems.length,this.showCompositeDisclaimer=this.additionalCompositeItemsTotal>0,this.isLoading=!1),this.deleteMode=(0,l.c)(this.deleteItemsBuckets),this.arcgisDeleteItemsModeChange.emit(this.deleteMode),this.deletePrimaryAction=(0,l.e)(this.deleteMode),this.primaryButtonText=this.i18n["PERMANENTLY_DELETE"===this.deletePrimaryAction?"permanentlyDelete":"delete"],this.headerTitle=this.i18n["PERMANENTLY_DELETE"===this.deletePrimaryAction?"permanentlyDelete":(0,l.i)(this.deleteItemsBuckets.unprotectedItems)||1!==this.items.length?"deleteItems":"deleteItem"]}catch(e){console.error(e)}}countDependentItems(){const{unprotectedItems:e}=this.deleteItemsBuckets;return e.reduce((e,t)=>{var s,i,n,l;return e+(null!==(l=(null===(s=t.relatedItems)||void 0===s?void 0:s.isComposite)&&(null===(n=null===(i=t.relatedItems)||void 0===i?void 0:i.resultData)||void 0===n?void 0:n.count))&&void 0!==l?l:0)},0)}renderDeleteButton(){const{isLoading:e,i18n:t,primaryButtonText:s}=this;return(0,i.h)("calcite-button",{slot:"footer-end",appearance:"solid",kind:"danger","data-id":"nextButton",onClick:async()=>this.handleDelete(),disabled:e||"PROTECTED_UNRECYCLABLE"===this.deleteMode&&this.preventNonRecyclableItemDelete},null!=s?s:t.delete)}renderCompositeDisclaimerNextButton(){const{isLoading:e,i18n:t}=this;return(0,i.h)("calcite-button",{slot:"footer-end",appearance:"solid",kind:"brand","data-id":"nextButton",onClick:async()=>this.showCompositeDisclaimer=!1,disabled:e},t.next)}render(){const{i18n:e,active:t,isLoading:s,headerTitle:n,deletePrimaryAction:l,permanentDeleteOverrideEnabled:a,additionalCompositeItemsTotal:o,showCompositeDisclaimer:r,renderContent:c}=this,d=a||!r&&o>0;return(0,i.h)("calcite-dialog",{key:"ff78b3901a80492902a2f0812d7bfc150e26a095",modal:!0,open:t,widthScale:"s",kind:r?"info":"danger",outsideCloseDisabled:!0,ref:e=>this.modalRef=e,heading:n,onCalciteDialogClose:()=>{this.arcgisDeleteItemsClose.emit(),this.active=!1}},(0,i.h)("div",{key:"8013715c0159346a0e455878e06ab140c96de0f9",class:"content"},s?(0,i.h)("calcite-scrim",{loading:!0}):c()),!s&&(0,i.h)(i.F,{key:"c2719b4987a793ce12a334d3199c33e218760054"},(0,i.h)("div",{key:"8a8f8d6b08fb3d1e604e72604152979a3e7d9531",slot:"footer-start"},d&&(0,i.h)("calcite-button",{key:"198d7517ba83c27caeb0a654e5bcdafdf0b90bba",appearance:"outline-fill",kind:"neutral","data-id":"backButton",onClick:()=>{a?(this.permanentDeleteOverrideEnabled=!1,this.determineDeleteState({fetch:!1})):this.showCompositeDisclaimer=!0},disabled:s},e.back)),(0,i.h)("calcite-button",{key:"328baf79420d9ee88c93a51afe15aea549e7faec",slot:"footer-end",appearance:"outline-fill","data-id":"cancelButton",onClick:()=>{this.active=!1}},e.cancel),"NONE"!==l&&(this.showCompositeDisclaimer?this.renderCompositeDisclaimerNextButton():this.renderDeleteButton())))}get el(){return(0,i.a)(this)}static get watchers(){return{items:["handleItemUpdate"]}}};r.style=".content{display:flex;min-height:72px;flex-direction:column;justify-content:center}::slotted([slot=message]){margin-bottom:1rem}"},12192:(e,t,s)=>{s.d(t,{a:()=>a,g:()=>c});var i=s(15332),n=s(94984),l=s(87849);function a(e){var t,s,l;const a=null!==(t=(0,i.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(s=e.shadowRoot)||void 0===s?void 0:s.ownerDocument)||void 0===l?void 0:l.documentElement,o=((null==a?void 0:a.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return n.l.has(o)?n.l.get(o):n.l.has(o.slice(0,2))?n.l.get(o.slice(0,2)):"en"}const o={};function r(e,t){const s=`${e}${t}`;return o[s]||(o[s]=function(e,t){return new Promise((s,i)=>{fetch((0,l.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then(e=>{e.ok?s(e.json()):i()},()=>i())})}(e,t)),o[s]}async function c(e,t){const s=t||e.tagName.toLowerCase(),l=a(e),o=function(e){var t,s,l;const a=null!==(t=(0,i.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(s=e.shadowRoot)||void 0===s?void 0:s.ownerDocument)||void 0===l?void 0:l.documentElement,o=((null==a?void 0:a.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return n.l.has(o)?n.l.get(o):n.l.has(o.slice(0,2))?o:"en"}(e);let c;try{c=await r(s,l)}catch(e){console.warn(`no locale for ${s} (${l}) loading default locale en.`),c=await r(s,"en")}return[c,l,o]}},94984:(e,t,s)=>{s.d(t,{C:()=>o,a:()=>h,b:()=>d,f:()=>r,g:()=>a,l:()=>l,s:()=>u});var i=s(15332),n=s(931);const l=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function a(e){return function(e,t,s){const n=(0,i.c)(e,`[${t}]`);return n?n.getAttribute(t):s}(e,"dir","ltr")}const o={rtl:"arcgis--rtl"};async function r(e,t){const{api:s,type:i,places:l}=t||{};if(3===s){const[s]=await(0,n.l)(["dojo/number"]);return s.format(e,{type:i,places:l,pattern:null==t?void 0:t.pattern})}const[a]=await(0,n.l)(["esri/intl"]),o=a.convertNumberFormatToIntlOptions({places:l,style:i,digitSeparator:!0});return a.formatNumber(e,Object.assign(Object.assign({},o),{style:i}))}const c={};function d(e,t){let s=document.documentElement.lang;const i="bs"===s;if(i&&(s="hr"),t){const t=`${s}-full`,i={dateStyle:"full",timeStyle:"long"};return c[t]||(c[t]=new Intl.DateTimeFormat(s,i)),c[t].format(e)}const n={year:"numeric",month:i?"numeric":"short",day:"numeric"};return c[s]||(c[s]=new Intl.DateTimeFormat(s,n)),c[s].format(e)}function h(e,t,s,i){const n=null!=e?e:"en";let l=t.unknown;return(1===s||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(n))&&(l=t.single),1!==s&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(n)&&(l=t.multiple),u(l,Object.assign(Object.assign({},i),{number:s}))}const m=/\$\{([^}]+)\}/g;function u(e,t,s=m){let i=e;try{i=e.replace(s,(e,s)=>function(e,t){const s=e.split(".").reduce((e,t)=>e[t],t);return"string"==typeof s||"number"==typeof s?s:e}(s,t).toString())}catch(e){console.error(e)}return i}}}]);