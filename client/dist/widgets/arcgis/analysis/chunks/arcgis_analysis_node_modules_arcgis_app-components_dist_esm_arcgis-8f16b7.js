/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-8f16b7.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-8f16b7"],{20259:(e,l,r)=>{r.r(l),r.d(l,{arcgis_new_item_pages_tile_layer_from_existing:()=>y});var s=r(87849),t=r(52995),a=r(59317),o=r(41473),i=r(74695),n=r(68466),c=r(3826),u=r(95878),d=r(88863),v=r(33547);r(83692),r(931),r(93814),r(54251),r(46904),r(29599),r(60958),r(37762),r(88878),r(24869),r(15912),r(72257),r(86562),r(15332),r(27137),r(76246),r(58573),r(1536),r(32478),r(82149),r(90079),r(62645);const y=class{constructor(e){(0,s.r)(this,e),this.newItemUpdatePage=(0,s.c)(this,"newItemUpdatePage",7),this.selectedItem=void 0,this.error=void 0,this.isProcessing=!1}async handleNext(){var e;if("3dTiles"===c.a.tileLayerPublishType)return;this.error=null;const{selectedItem:l}=this;if(!l)return(0,v.f)("No layer selected"),void(this.error="noLayerSelected");const{id:r,url:s,title:u}=l;try{const v=c.a.tileLayerPublishType;this.isProcessing=!0;const y=a.c.portal,[{layers:m,tables:g,serviceInfo:p},{total:b,relatedItems:h}]=await Promise.all([(0,i.o)({serviceUrl:s,restBaseUrl:(0,o.g)(y),forceAddToken:!0}),(0,t.c)(r,y,{relationshipType:"Service2Service"})]),{result:w}=await(0,n.f)({itemId:r,itemUrl:s,publishType:"vectorTiles"===c.a.tileLayerPublishType?"vector":"raster",portal:y,fullLayers:m});if(b>0&&("vectorTiles"===v&&h.some(e=>"Vector Tile Service"===e.type)||"tiles"===v&&h.some(e=>"Map Service"===e.type)))return void(this.error="tileLayerAlreadyExist");const f=e=>(null!=e?e:[]).some(e=>{var l,r;const{drawingInfo:s,fields:t,layerDefinition:a}=e,o=null==a?void 0:a.drawingInfo,i=null!==(l=null==o?void 0:o.renderer)&&void 0!==l?l:null==s?void 0:s.renderer;return i&&t?!(0,n.c)(i,e.geometryType,t)||(0,n.l)(e):null!==(r=(0,n.l)(e))&&void 0!==r&&r});if(f(m)||f(w.layers))return void(this.error="badRenderer");const S=e=>(0,n.a)(e,!0);if(!m.some(S)||(null===(e=null==w?void 0:w.layers)||void 0===e?void 0:e.length)>0&&!w.layers.some(S))return void(this.error="badLayer");c.a.sourceTitle=u,(0,d.s)(l),c.a.tileAutoCreation=!y.isPortal,c.a.tileLayerBasemapType="standard",c.a.tileLayerBasemapUrl="",c.a.tileLayerFromFeatureLayer=!0,c.a.tileLayerLayers=m,c.a.tileLayerTables=g,c.a.tileLayerServiceInfo=p,c.a.tileLayerData=w,c.a.item=l,this.isProcessing=!1,this.newItemUpdatePage.emit("tileLayerSettings")}catch(e){console.error(e)}}onError(){this.isProcessing=!1}componentWillLoad(){c.a.serviceInfo=null,c.a.selectedServiceInfoLayersNames=null,this.i18n=u.u.i18n.tileLayerFromExisting}render(){var e,l;const{error:r,i18n:t,isProcessing:a}=this;return(0,s.h)(s.H,{key:"e9ee5dde9e43e90256cc6c93b7281e9019b292be"},(0,s.h)("arcgis-new-item-loader",{key:"ddbfb8faef7ed467e3b94b5dd696ed11365cc7e1",active:a}),(0,s.h)("arcgis-new-item-feature-layer-browser",{key:"9f6b606c1a2ef8003ab3a27f7fc1b97a6af1458c",itemBrowserBucket:["my"],onItemSelected:({detail:e})=>this.selectedItem=e,query:'type:"Feature Service" AND typekeywords:"Hosted Service" NOT typekeywords:"Spatiotemporal"'}),(0,s.h)("arcgis-new-item-alert",{key:"d47789ee0b8c4c14eb7547ec11f6a3294e9e4d08",heading:"badLayer"===r?t.error.tileLayerAlreadyExist.title:null===(e=t.error[r])||void 0===e?void 0:e.title,description:"badLayer"===r||null===(l=t.error[r])||void 0===l?void 0:l.description,active:null!=r,onAlertDismiss:()=>{this.error=null}}))}static get watchers(){return{error:["onError"]}}}},52995:(e,l,r)=>{r.d(l,{a:()=>f,b:()=>d,c:()=>v,d:()=>y,e:()=>m,f:()=>u,g:()=>g,l:()=>S});var s=r(83692),t=r(71467),a=r(46904),o=r(931),i=r(41473),n=r(29599),c=r(60958);const u=async(e,l,r)=>{const{owningSystemUrl:t}=await(0,s.f)(async()=>(0,n.a)(e),"portalInfo",e.id);return(await Promise.all(l.map(async e=>{try{const{owningSystemUrl:l}=await(0,n.g)(e,r);return{owningSystemUrl:l,url:e}}catch(l){return console.error(l),{owningSystemUrl:null,url:e}}}))).filter(({owningSystemUrl:e})=>e===t).map(({url:e})=>e)},d=async(e,l,r)=>{var t;try{return{result:await(0,s.r)(e,l,Object.assign({addTokenManually:!1},r))}}catch(e){const l="token required";return(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase().includes(l))?{error:{code:"tokenRequired"}}:(console.error(e),{error:{code:"unhandledError"}})}};async function v(e,l,r){var t;const{relationshipType:a,direction:o}=r,n=`${(0,i.g)(l)}content/items/${e}/relatedItems`,c=await(0,s.r)(n,{relationshipType:a,direction:o,includeRecycleBin:!0});return(null===(t=null==c?void 0:c.relatedItems)||void 0===t?void 0:t.length)&&(c.relatedItems=c.relatedItems.filter(l=>(null==l?void 0:l.id)!==e)),c}const y=async(e,l,r)=>{const t=!!r,a=(0,i.g)(l),o=t?`${a}/content/groups/${r.id}/search`:`${a}/search`;try{return{result:(await(0,s.r)(o,{filter:`id:(${e.join(" OR ")})`,num:100})).results}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},m=async(e,l)=>{try{const[r]=await(0,o.l)(["esri/portal/PortalItem"]);return{result:await Promise.all(e.map(e=>new r({id:e,portal:l}).load()))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},g=async(e,l,r,t)=>{try{const a=[],o=[],i=[];await Promise.all(e.map(async e=>{const{result:c,error:u}=await(0,s.f)(()=>d(e,l,t),"itemMetadata",`${e}--no-token`);if("tokenRequired"!==(null==u?void 0:u.code))if(p(c))a.push(b(c,e));else try{const l=await(0,n.g)(e,r);i.push(Object.assign(Object.assign({},c),{owningSystemUrl:l.owningSystemUrl}))}catch(u){console.warn(u)}else o.push(e)}));const v=await u(l,o,r),y=(await Promise.all(v.map(async e=>({response:await(0,c.r)(e,l,Object.assign({addTokenManually:!0},t)),owningSystemUrl:(await(0,n.g)(e,r)).owningSystemUrl,url:e})))).reduce((e,{response:l,url:r,owningSystemUrl:s})=>p(l)?(a.push(b(l,r)),e):[...e,Object.assign(Object.assign({},l),{owningSystemUrl:s})],[]),m=await Promise.all([...i,...y].map(async({serviceItemId:e,owningSystemUrl:l})=>{if(!e)return null;const{result:r}=await w({itemId:e,owningSystemUrl:l});return{item:r,owningSystemUrl:l}})),{result:h}=a.length<=0?{result:[]}:await g(a,l,r,t);return{result:[...m.filter(e=>!!e),...h]}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},p=e=>!!(null==e?void 0:e.sources),b=(e,l)=>{var r;const s=null===(r=Object.values(e.sources)[0])||void 0===r?void 0:r.url;return s?s.includes("..")?(0,i.t)({url:l,path:s}):s:null},h=e=>`${e}/sharing/rest`,w=async({itemId:e,owningSystemUrl:l,requestOptions:r})=>{try{const t=(0,a.g)(e,h(l));return{result:await(0,s.r)(t,{},Object.assign(Object.assign({},r),{addTokenManually:!1}))}}catch(e){return console.error(e),(0,t.b)(e)&&e.message.toLocaleLowerCase().includes("invalid token")?{error:{code:"invalidToken"}}:{error:{code:"unhandledError"}}}},f=async({itemId:e,owningSystemUrl:l,requestOptions:r})=>{try{const t=`${(0,a.g)(e,h(l))}/data`;return{result:await(0,s.r)(t,{},Object.assign(Object.assign({},r),{addTokenManually:!1}))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},S=async(e,l)=>{try{const[r]=await(0,o.l)(["esri/portal/PortalItem"]),s=new r({id:e,portal:l});return await s.load(),{result:s}}catch(e){return console.error("Fail to reload item",e),{error:{code:"unhandledError"}}}}},82149:(e,l,r)=>{r.d(l,{D:()=>a,T:()=>i,a:()=>u,b:()=>v,c:()=>y,d:()=>o,e:()=>n,f:()=>s,g:()=>c,p:()=>d,t:()=>t});const s=["standard","custom"],t=["IntegratedMesh","3DObject","GaussianSplat"],a=t[0],o=["vector","raster"],i=147914382,n=0,c=[{level:0,label:"1:591,657,528",scale:591657527.591555},{level:1,label:"1:295,828,764",scale:295828763.795777},{level:2,label:"1:147,914,382",scale:147914381.897889},{level:3,label:"1:73,957,191",scale:73957190.948944},{level:4,label:"1:36,978,595",scale:36978595.474472},{level:5,label:"1:18,489,298",scale:18489297.737236},{level:6,label:"1:9,244,649",scale:9244648.868618},{level:7,label:"1:4,622,324",scale:4622324.434309},{level:8,label:"1:2,311,162",scale:2311162.217155},{level:9,label:"1:1,155,581",scale:1155581.108577},{level:10,label:"1:577,791",scale:577790.554289},{level:11,label:"1:288,895",scale:288895.277144},{level:12,label:"1:144,448",scale:144447.638572},{level:13,label:"1:72,224",scale:72223.819286},{level:14,label:"1:36,112",scale:36111.909643},{level:15,label:"1:18,056",scale:18055.954822},{level:16,label:"1:9,028",scale:9027.977411},{level:17,label:"1:4,514",scale:4513.988705},{level:18,label:"1:2,257",scale:2256.994353},{level:19,label:"1:1,128",scale:1128.497176},{level:20,label:"1:564",scale:564.248588},{level:21,label:"1:282",scale:282.124294},{level:22,label:"1:141",scale:141.062147}],u={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:256,cols:256,dpi:96,preciseDpi:96,lods:[{level:0,resolution:156543.033928,scale:591657527.591555},{level:1,resolution:78271.5169639999,scale:295828763.795777},{level:2,resolution:39135.7584820001,scale:147914381.897889},{level:3,resolution:19567.8792409999,scale:73957190.948944},{level:4,resolution:9783.93962049996,scale:36978595.474472},{level:5,resolution:4891.96981024998,scale:18489297.737236},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147}]},d={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:512,cols:512,dpi:96,preciseDpi:96,lods:[{level:0,resolution:78271.51696399994,scale:295828763.795777},{level:1,resolution:39135.75848200009,scale:147914381.897889},{level:2,resolution:19567.87924099992,scale:73957190.948944},{level:3,resolution:9783.93962049996,scale:36978595.474472},{level:4,resolution:4891.96981024998,scale:18489297.737236},{level:5,resolution:2445.98490512499,scale:9244648.868618},{level:6,resolution:1222.992452562495,scale:4622324.434309},{level:7,resolution:611.4962262813797,scale:2311162.217155},{level:8,resolution:305.74811314055756,scale:1155581.108577},{level:9,resolution:152.87405657041106,scale:577790.554289},{level:10,resolution:76.43702828507324,scale:288895.277144},{level:11,resolution:38.21851414253662,scale:144447.638572},{level:12,resolution:19.10925707126831,scale:72223.819286},{level:13,resolution:9.554628535634155,scale:36111.909643},{level:14,resolution:4.77731426794937,scale:18055.954822},{level:15,resolution:2.388657133974685,scale:9027.977411},{level:16,resolution:1.1943285668550503,scale:4513.988705},{level:17,resolution:.5971642835598172,scale:2256.994353},{level:18,resolution:.29858214164761665,scale:1128.497176},{level:19,resolution:.14929107082380833,scale:564.248588},{level:20,resolution:.07464553541190416,scale:282.124294},{level:21,resolution:.03732276770595208,scale:141.062147},{level:22,resolution:.01866138385297604,scale:70.5310735},{level:23,resolution:.009330691929342804,scale:35.265536760789715}]},v={format:"indexedVector",compressionQuality:0,antialiasing:!1},y={format:"PNG32",compressionQuality:0,antialiasing:!0}}}]);