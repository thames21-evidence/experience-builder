/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-982d21.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-982d21"],{19080:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigLayerViewCreate:()=>m});var i=s(73679),r=s(4395),a=s(2801),o=(s(13661),s(21255),s(59102),s(2924),s(33752),s(44345),s(83552)),c=s(85643),l=s(73801);const n="info",d="footer",g="footer-top",h=r.AH`.panel{height:100%}.info{display:grid;grid-template-columns:repeat(1,minmax(0px,1fr));gap:.5rem;padding:1rem .75rem}.footer{width:100%}.footer-top{display:flex}`;class m extends l.WF{constructor(){super(),this._direction=(0,o.jH)(),this.panelNode=(0,c._)(),this.backButtonNode=(0,c._)(),this.titleInputNode=(0,c._)(),this.folderPickerNode=(0,c._)(),this.categoriesPickerNode=(0,c._)(),this.tagsPickerNode=(0,c._)(),this.summaryInputNode=(0,c._)(),this.reRender=!1,this.loading=!1,this.arcgisCreateCancel=(0,l.lh)(),this.arcgisCreateDone=(0,l.lh)(),this.arcgisCreateOngoing=(0,l.lh)(),this.arcgisStatusChange=(0,l.lh)(),this.listen("arcgisMsgClosed",this.arcgisMsgClosedHandler)}static{this.properties={reRender:16,loading:16,itemTitle:16,props:0}}static{this.styles=h}async load(){const{props:e}=this;this.itemTitle=await(0,a.n)(e)}loaded(){requestAnimationFrame(()=>this.backButtonNode.value?.setFocus())}arcgisMsgClosedHandler(){this.msgNode&&(this.msgNode.remove(),this.msgNode=void 0),clearTimeout(this.timeoutHndl),this.timeoutHndl=void 0,this.viewItemId&&this.arcgisCreateDone.emit(this.viewItemId)}goBack(){const{props:e}=this;e.savedItemProps={title:this.titleInputNode.value.itemTitle,tags:this.tagsPickerNode.value.activeTags,summary:this.summaryInputNode.value.summary,categories:this.categoriesPickerNode.value.categories,folder:this.folderPickerNode.value.folder},this.arcgisStatusChange.emit({status:a.f.OVERVIEW})}async goCreate(){const{props:e}=this;e.savedItemProps={title:this.titleInputNode.value.itemTitle,tags:this.tagsPickerNode.value.activeTags,summary:this.summaryInputNode.value.summary,categories:this.categoriesPickerNode.value.categories,folder:this.folderPickerNode.value.folder};const t={title:this.titleInputNode.value.itemTitle,tags:this.tagsPickerNode.value.activeTags,summary:this.summaryInputNode.value.summary,categories:this.categoriesPickerNode.value.categories,folder:this.folderPickerNode.value.folder};this.loading=!0,this.arcgisCreateOngoing.emit(!0);try{this.viewItemId=await(0,a.o)(e,t),this.showMsg("success")}catch(e){this.showMsg("error",e)}}goCancel(){this.arcgisCreateCancel.emit()}showMsg(e,t){const{props:s,panelNode:{value:i},el:a}=this,{_messages:o}=s;this.loading=!1,this.arcgisCreateOngoing.emit(!1),"success"!==e&&console.error("could not create view",t),this.msgNode=(0,l.dN)(r.qy`<arcgis-map-config-layer-view-msg .props=${s} .flowItemElement=${i} .message=${"success"===e?o.msg.created:(t.message,o.msg.createFailed)} .isError=${"success"!==e} @arcgisMsgClosed=${()=>{clearTimeout(this.timeoutHndl),this.removeMsg(e)}}></arcgis-map-config-layer-view-msg>`),a.shadowRoot.appendChild(this.msgNode),clearTimeout(this.timeoutHndl),this.timeoutHndl=setTimeout(()=>this.removeMsg(e),7e3)}removeMsg(e){this.timeoutHndl=void 0,this.msgNode&&(this.msgNode.remove(),this.msgNode=void 0,"success"===e&&this.arcgisCreateDone.emit(this.viewItemId))}render(){const{props:e,loading:t}=this,{viewItem:s,layerItem:i,_messages:a}=e;return this.el.classList.add("calcite-match-height"),r.qy`<calcite-panel .heading=${a.createView.create} .description=${s?.title||i?.title||""} .loading=${t} class="panel" ${(0,c.K)(this.panelNode)}>${this.renderFooterButtons()}${this.renderInfo()}</calcite-panel>`}renderFooterButtons(){return r.qy`<div slot=footer class=${(0,l.CP)(d)}><div class=${(0,l.CP)(g)}>${this.renderBack()}${this.renderCreate()}</div>${this.renderCancel()}</div>`}renderBack(){const{props:e}=this,{_messages:t}=e,s="rtl"===this._direction;return r.qy`<calcite-button @click=${this.goBack} appearance=outline-fill width=half .iconStart=${s?"arrow-right":"arrow-left"} .label=${t.general.back} ${(0,c.K)(this.backButtonNode)}>${t.general.back}</calcite-button>`}renderCreate(){const{props:e,itemTitle:t,titleError:s,summaryError:i}=this,{layer:a,layerIds:o,_messages:c}=e,l=a?.loaded&&o.length&&t&&!s&&!i;return r.qy`<calcite-button .disabled=${!l} @click=${l?this.goCreate:void 0} appearance=solid width=half icon-start=plus-square .label=${c.createView.create}>${c.createView.create}</calcite-button>`}renderCancel(){const{props:e}=this,{layer:t,layerIds:s,_messages:i}=e,a=t?.loaded&&s.length;return r.qy`<calcite-button .disabled=${!a} @click=${a?this.goCancel:void 0} appearance=transparent width=full .label=${i.general.cancel}>${i.general.cancel}</calcite-button>`}renderInfo(){const{props:e,itemTitle:t}=this,{layer:s,layerItemOwner:i,savedItemProps:a}=e,{portalItem:o}=s,{portal:d}=o,g=d.user,h={portal:d,user:g,api:4};return r.qy`<div class=${(0,l.CP)(n)}><arcgis-item-properties .portal=${d} .user=${g} .api=${4} .config=${h} .type=${"Feature Service"} .scale=${"s"}><arcgis-title-input .itemTitle=${a?a.title:t} .enablePublishing=${!0} @arcgisTitleInputChange=${async e=>{const t=await e.target.validateTitle();(!this.titleError&&t||this.titleError&&!t)&&(this.reRender=!this.reRender),this.titleError=t}} ${(0,c.K)(this.titleInputNode)}></arcgis-title-input><arcgis-folder-picker .folder=${a?a.folder:o.ownerFolder&&{id:o.ownerFolder,username:o.owner}} .user=${i} ${(0,c.K)(this.folderPickerNode)}></arcgis-folder-picker><arcgis-categories-picker .categories=${a?a.categories:o.categories} ${(0,c.K)(this.categoriesPickerNode)}></arcgis-categories-picker><arcgis-tags-picker .activeTags=${a?a.tags:o.tags} ${(0,c.K)(this.tagsPickerNode)}></arcgis-tags-picker><arcgis-summary-input .summary=${(a?a.summary:o.snippet)||""} @arcgisSummaryInputChange=${async e=>{const t=await e.target.getErrorMessage();(!this.summaryError&&t||this.summaryError&&!t)&&(this.reRender=!this.reRender),this.summaryError=t}} ${(0,c.K)(this.summaryInputNode)}></arcgis-summary-input></arcgis-item-properties></div>`}}(0,i.c)("arcgis-map-config-layer-view-create",m)}}]);