/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-181bac.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-181bac"],{4265:(e,i,a)=>{a.d(i,{a:()=>t,d:()=>n,t:()=>r});const n=(e,i)=>{let a,n="idle";const t=async(...t)=>await new Promise(r=>{switch(n){case"flushed":n="idle",a?(clearTimeout(a),r(e(...t))):r(null);break;case"invoked":clearTimeout(a),n="idle",r(e(...t));break;case"cancelled":clearTimeout(a),n="idle",r(null);break;default:a&&clearTimeout(a),n="pending",a=setTimeout(()=>{n="idle",r(e(...t))},i)}});return t.flush=async function(...e){return n="flushed",await t(...e)},t.invoke=async function(...e){return n="invoked",await t(...e)},t.cancel=async function(...e){return n="cancelled",await t(...e)},t.getStatus=function(){return n},t},t=(e,i)=>{let a;return async(...n)=>await new Promise(t=>{a||(a=setTimeout(()=>{clearTimeout(a),a=void 0,t(e(...n))},i))})};function r(e){return new Promise(i=>setTimeout(i,e))}},13494:(e,i,a)=>{a.d(i,{a:()=>l,c:()=>o});var n=a(5294),t=a(70169),r=a(1225),s=(a(54312),a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(89704),a(66228));a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(83552),a(77462),a(49403),a(10281),a(83930),a(66617),a(10628),a(59640),a(64451),a(6176),a(10454),a(29614),a(94916),a(52554),a(2156),a(4038),a(49851),a(75054),a(15223),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(28927),a(6238),a(7299);async function l(e,i){const{layer:a,useFeatureReduction:l,mapView:o,selectedFields:u}=e,c=a;i=i||{};const m=(0,r.a)(e,(0,r.g)(e)),h=!!(0,s.i)(i.includeSizeVariable)&&i.includeSizeVariable;return await t.createRenderer({layer:c,view:o,attributes:d(e,i.fieldInfos),pieChartScheme:i.pieChartScheme||(0,r.a3)(e),includeSizeVariable:h,outlineOptimizationEnabled:(0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,r.o)(e)&&h,sizeOptimizationEnabled:!(0,s.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled,legendOptions:i.legendOptions,forBinning:l}).then(i=>{(0,r.b)(m,i.renderer,{notOpacity:!0});const a=(0,r.d)(e);if(["chart","chart-size"].includes(a)){const a=(0,r._)(e),t=u.map(e=>e.field),s=a.map(e=>e.field),l=t.toString()===s.toString(),o=n.clone(t),d=n.clone(s);o.sort(),d.sort(),o.toString()===d.toString()&&(i.renderer.attributes=(0,r.g)(e).attributes,l||i.renderer.attributes.sort((e,i)=>t.indexOf(e.field)-t.indexOf(i.field)),i.renderer.othersCategory=(0,r.g)(e).othersCategory,i.renderer.holePercentage=(0,r.g)(e).holePercentage)}return i})}async function o(e,i){const{layer:a,useFeatureReduction:n,mapView:l}=e,o=a;i=i||{};const u=(0,r.g)(e),c=(0,r.c)(u,"size"),m=(0,r.p)(u,"size"),h=(0,r.a)(e,u),p=i.fieldInfos?i.fieldInfos:u.attributes.map(e=>({field:e.field,simpleFieldType:r.J.NUMBER}));let g,f=!0;if(i.fieldInfos&&(u.attributes.forEach((e,a)=>{e.field!==i.fieldInfos[a].field&&(f=!1)}),f&&(delete i.fieldInfos,(0,r.O)(i))))return{renderer:u.clone()};f&&(g=u.attributes.map(e=>e.field));const b=(0,r.g)(e),z=b.attributes?.length?b.attributes[0].color:null,S=u.backgroundFillSymbol;let v=!1;c&&(v=c.minSize.stops?c.minSize.stops[0].size>c.maxSize.stops[0].size:c.minSize>c.maxSize);const V=p[0];return p[0]=p[1],p[1]=V,await t.createRenderer({layer:o,view:l,attributes:d(e,p),pieChartScheme:i.pieChartScheme||(0,r.a3)(e),includeSizeVariable:(0,s.i)(i.includeSizeVariable)?i.includeSizeVariable:!!c,outlineOptimizationEnabled:(0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!h.sizeOutlineVisVar,sizeOptimizationEnabled:(0,s.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:!!h.sizeAutoVisVar,legendOptions:void 0,forBinning:n}).then(e=>{if(!i.fieldInfos&&c){const i=(0,r.c)(e.renderer,"size");if(i.minDataValue=c.minDataValue,i.maxDataValue=c.maxDataValue,m){const i=(0,r.p)(e.renderer,"size");i.minSliderValue=m.minSliderValue,i.maxSliderValue=m.maxSliderValue}}if(f&&h.opacityVisVar&&h.authOpacityVisVar&&(e.renderer.visualVariables=(0,r.H)(e.renderer,"opacity"),e.renderer.authoringInfo.visualVariables=(0,r.P)(e.renderer,"opacity"),e.renderer.visualVariables.push(h.opacityVisVar),e.renderer.authoringInfo.visualVariables=e.renderer.authoringInfo.visualVariables||[],e.renderer.authoringInfo.visualVariables.push(h.authOpacityVisVar)),(0,r.b)(h,e.renderer,{notOpacity:!0}),g&&e.renderer.attributes.sort((e,i)=>{const a=g.indexOf(e.field),n=g.indexOf(i.field);return a>-1&&n>-1&&a<n?-1:a>-1&&n>-1&&a>n?1:a>-1?-1:n>-1?1:0}),f&&e.renderer.attributes.forEach((e,i)=>{e.label=u.attributes[i].label}),e.renderer.size=u.size,e.renderer.holePercentage=u.holePercentage,e.renderer.othersCategory=u.othersCategory,z&&e.renderer.attributes?.length&&e.renderer.attributes.forEach((e,i)=>{f&&(e.color=u.attributes[i].color)}),S&&(e.renderer.backgroundFillSymbol=S),v){const i=(0,r.c)(e.renderer,"size"),a=i.minSize;i.minSize=i.maxSize,i.maxSize=a}return e})}function d(e,i){return i.map(i=>({field:i.field,label:u(e,i.field)}))}function u(e,i){const a=e.fields.filter(e=>e.layerField.name===i);return a.length?a[0].label:""}},18383:(e,i,a)=>{a.d(i,{a:()=>l,c:()=>o,g:()=>d});var n=a(75054),t=a(15223),r=a(1225),s=(a(54312),a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(89704),a(5294),a(66228));a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(83552),a(77462),a(49403),a(66617),a(10628),a(59640),a(64451),a(6176),a(10454),a(29614),a(94916),a(52554),a(2156),a(4038),a(49851),a(70169),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(28927),a(6238),a(7299);async function l(e,i){const{layer:a,useFeatureReduction:t,mapImageSublayer:l,mapView:o,selectedFields:d}=e,c=a;i=i||{};const m=(0,r.a)(e,(0,r.g)(e));return await n.createRenderer({layer:c,view:o,fields:u(e,i.fieldInfos),predominanceScheme:i.predominanceScheme||(0,r.X)(e),includeOpacityVariable:!(0,s.i)(i.includeOpacityVariable)||(0,s.i)(i.includeOpacityVariable),includeSizeVariable:!!(0,s.i)(i.includeSizeVariable)&&i.includeSizeVariable,outlineOptimizationEnabled:!l&&((0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,r.o)(e)),sizeOptimizationEnabled:!l&&(!(0,s.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:t}).then(a=>{(0,r.b)(m,a.renderer,{notOpacity:!0});const n=(0,r.d)(e);if(!(0,s.i)(i.includeOpacityVariable)&&["predominance","predominance-size"].includes(n)){const n=(0,r._)(e),t=d.map(e=>e.field).sort(),s=n.map(e=>e.field).sort();if(t.toString()===s.toString()){const n=(0,r.c)((0,r.g)(e),"opacity"),t=(0,r.p)((0,r.g)(e),"opacity");a.renderer.visualVariables=(0,r.H)(a.renderer,"opacity")||[],n&&a.renderer.visualVariables.push(n),a.renderer.authoringInfo.visualVariables=(0,r.P)(a.renderer,"opacity")||[],t&&a.renderer.authoringInfo.visualVariables.push(t);const s=a.renderer.uniqueValueInfos[0].symbol.clone();a.renderer.uniqueValueInfos=(0,r.g)(e).uniqueValueInfos,(0,r.o)(e)&&("predominance-size"===(0,r.d)(e)&&!0!==i.includeSizeVariable?(0,r.Y)(a.renderer,s):"predominance"===(0,r.d)(e)&&!0===i.includeSizeVariable&&(0,r.Z)(a.renderer,s))}}return a})}async function o(e,i){const{layer:a,useFeatureReduction:t,mapImageSublayer:l,mapView:o}=e,d=a;i=i||{};const c=(0,r.g)(e),m=(0,r.c)(c,"size"),h=(0,r.p)(c,"size"),p=(0,r.a)(e,c),g=i.fieldInfos?i.fieldInfos:c.uniqueValueGroups[0].classes.map(e=>({field:e.values[0].value,simpleFieldType:r.J.NUMBER}));let f,b=!0;if(i.fieldInfos&&(c.uniqueValueGroups[0].classes.forEach((e,a)=>{e.values[0].value!==i.fieldInfos[a].field&&(b=!1)}),b&&(delete i.fieldInfos,(0,r.O)(i))))return{renderer:c.clone()};b&&(f=c.uniqueValueInfos.map(e=>e.value),p.opacityVisVar=(0,r.c)(c,"opacity"),p.authOpacityVisVar=(0,r.p)(c,"opacity"));const z=(0,r.g)(e),S=z.uniqueValueInfos?.length?z.uniqueValueInfos[0].symbol:null,v=c.defaultSymbol,V=c.defaultLabel,y=c.backgroundFillSymbol;let x=!1;m&&(x=m.minSize.stops?m.minSize.stops[0].size>m.maxSize.stops[0].size:m.minSize>m.maxSize);const N=(0,s.i)(i.includeSizeVariable)?i.includeSizeVariable:!!m,R=g[0];return g[0]=g[1],g[1]=R,await n.createRenderer({layer:d,view:o,fields:u(e,g),predominanceScheme:i.predominanceScheme||(0,r.X)(e),includeOpacityVariable:(0,s.i)(i.includeOpacityVariable)?i.includeOpacityVariable:!!p.opacityVisVar,includeSizeVariable:N,outlineOptimizationEnabled:!l&&((0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!p.sizeOutlineVisVar),sizeOptimizationEnabled:(0,s.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:!!p.sizeAutoVisVar,legendOptions:void 0,defaultSymbolEnabled:(0,s.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!v,forBinning:t}).then(a=>{const n=a.renderer.uniqueValueInfos[0].symbol.clone();if(!i.fieldInfos&&m){const e=(0,r.c)(a.renderer,"size");if(e.minDataValue=m.minDataValue,e.maxDataValue=m.maxDataValue,h){const e=(0,r.p)(a.renderer,"size");e.minSliderValue=h.minSliderValue,e.maxSliderValue=h.maxSliderValue}}if(!(0,s.i)(i.includeOpacityVariable)&&b&&p.opacityVisVar&&p.authOpacityVisVar&&(a.renderer.visualVariables=(0,r.H)(a.renderer,"opacity"),a.renderer.authoringInfo.visualVariables=(0,r.P)(a.renderer,"opacity"),a.renderer.visualVariables.push(p.opacityVisVar),a.renderer.authoringInfo.visualVariables=a.renderer.authoringInfo.visualVariables||[],a.renderer.authoringInfo.visualVariables.push(p.authOpacityVisVar)),(0,r.b)(p,a.renderer,{notOpacity:!0}),f&&a.renderer.uniqueValueInfos.sort((e,i)=>{const a=f.indexOf(e.value),n=f.indexOf(i.value);return a>-1&&n>-1&&a<n?-1:a>-1&&n>-1&&a>n?1:a>-1?-1:n>-1?1:0}),b&&a.renderer.uniqueValueInfos.forEach((e,i)=>{e.label=c.uniqueValueInfos[i].label}),S&&a.renderer.uniqueValueInfos?.length){const i=a.renderer.uniqueValueInfos.slice();i.forEach((e,i)=>{let a;b?a=c.uniqueValueInfos[i].symbol:(a=S.clone(),(0,r.y)(a,(0,r.i)(e.symbol))),e.symbol=a}),a.renderer.uniqueValueInfos=i,(0,r.o)(e)&&("predominance-size"!==(0,r.d)(e)||N?"predominance"===(0,r.d)(e)&&N&&(0,r.Z)(a.renderer,n):(0,r.Y)(a.renderer,n))}if(v&&(a.renderer.defaultSymbol=v,a.renderer.defaultLabel=V),y&&(a.renderer.backgroundFillSymbol=y),x){const e=(0,r.c)(a.renderer,"size"),i=e.minSize;e.minSize=e.maxSize,e.maxSize=i}return a})}async function d(e,i){const{layer:a,useFeatureReduction:n,mapView:r}=e,s=a;return i=i||{},await(0,t.default)({layer:s,view:r,fields:i.fieldInfos.map(e=>e.field),forBinning:n})}function u(e,i){return i.map(i=>({name:i.field,label:c(e,i.field)}))}function c(e,i){const a=e.fields.filter(e=>e.layerField.name===i);return a.length?a[0].label:""}},27155:(e,i,a)=>{a.d(i,{i:()=>t});var n=a(12762);function t(e){if(!e)return;let i=n.default.assetsPath;i.endsWith("/")||(i+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${i}esri/themes/light/main.css" />`)}},65595:(e,i,a)=>{a.d(i,{c:()=>s,u:()=>l});var n=a(20936),t=a(1225),r=(a(54312),a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(28927),a(83368),a(89704),a(5294),a(18423),a(96086),a(91813),a(21255),a(13078),a(21303),a(12627),a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(75698),a(10628),a(59640),a(64451),a(6176),a(83552));a(77462),a(49403),a(10281),a(83930),a(66617),a(10454),a(29614),a(94916),a(52554),a(2156),a(4038),a(49851),a(75054),a(15223),a(70169),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(6238),a(7299);function s(e){e.selectedFields=[],e.layerFields=void 0,e.fields=void 0,e.hideLayerTitle=!1,e.supportsArcade=!1,e.stringFieldsCount=-1,e.dateFieldsCount=-1,e.numberFieldsCount=-1,e.containsFlow=!0,e.oneFeatureResponseStatus=t.s.MISSING,e.selectedAttribute=void 0,e.selectedAttributeText=void 0,e.selectedTypeValue=void 0,e.selectedValue=void 0,e.lastDefault=void 0,e.lastDefaults=void 0,e.dotColorSelected=void 0,e.backgroundStyleSelected=void 0,e.lastSettings=void 0,e.classedSymbolSelectedIdx=void 0,e.allUniqueValues=void 0,e.useFeatureReduction=void 0,e.symbolStylerConfig={},e.allowTimeSeriesConfiguration=!1,e.rasterInfo=void 0}function l(){const e=(0,r.Gk)(),i=e;e.manager.onLoad(()=>{i.smartMappingState=function(e,i){const a=o.get(e);if(a)return a;const t=(0,n.el)(e,i);return t&&"store"in t?(o.set(e,t.store),t.store):null}(e.el,"arcgis-map-config-smart-mapping")})}const o=new WeakMap},71062:(e,i,a)=>{a.r(i),a.d(i,{ArcgisMapConfigSmartMappingSizeRangeSlider:()=>v});var n=a(73679),t=a(4395),r=a(54312),s=a(86421),l=a(1225),o=(a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(28927),a(83368),a(75518)),d=(a(89704),a(5294),a(18423),a(96086),a(91813),a(21255),a(13078),a(21303),a(12627),a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(5589)),u=a(65595),c=(a(77462),a(49403),a(10281),a(83930),a(66617),a(10628),a(59640),a(64451),a(6176),a(10454),a(29614),a(87735)),m=(a(2156),a(4038),a(49851),a(18383)),h=a(13494),p=(a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(6238),a(7299),a(27155)),g=a(85643),f=a(73801),b=a(20936),z=a(4265);const S=t.AH`.size-range-block{border-bottom:1px solid #e0e0e0}.range-slider{height:40px;background-color:transparent;position:relative;width:95%;margin:15px auto 0}.size-range{display:flex;justify-content:space-between;margin-bottom:15px}.size-range-item{width:48%;display:flex;flex-flow:column;justify-content:space-between}.esri-slider__label{text-decoration:underline}.esri-slider__label:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.top-bottom-margin-small{margin:10px 0}`;class v extends f.WF{constructor(){super(),this.adjustSizeNode=(0,g._)(),this.smartMappingState=(0,u.u)(),this.arcgisSmartMappingSizeRangeSliderError=(0,f.lh)(),this.listenOn(window,"arcgisSmartMappingAuthRefSizeVisVarChange",this.arcgisSmartMappingAuthRefSizeVisVarChangeHandler)}static{this.styles=S}async syncSliderValues(){queueMicrotask(()=>{const e=Number.parseInt(this.minRangeNode.value),i=Number.parseInt(this.maxRangeNode.value);this.rangeSliderNode.values=e===i?[e]:[e,i]})}loaded(){(0,p.i)(this.el.shadowRoot),this.flowItemNode=(0,b.el)(this.el,"calcite-flow-item")}disconnectedCallback(){super.disconnectedCallback(),clearTimeout(this.minWatchHandle),clearTimeout(this.maxWatchHandle),this.scaleWatchHandle?.remove()}arcgisSmartMappingAuthRefSizeVisVarChangeHandler({detail:e}){const i=this.rangeSliderNode.values,a=Math.min(...i)*e,n=Math.max(...i)*e;this.rangeSliderNode.values=[a,n],this.minRangeNode.value=`${Math.round(this.rangeSliderNode.values[0])}`,this.maxRangeNode.value=`${Math.round(this.rangeSliderNode.values[1])}`}sizeRangeDivRefHandler(e){if(e)if(this.rangeSliderNode.container)e.append(this.rangeSliderNode.container);else{const i=document.createElement("div");e.append(i),this.rangeSliderNode.container=i,this.createRangeSliderChangeEvents()}}sizeRangeMinInputRefHandler(e){e&&(this.minRangeNode=e)}sizeRangeMaxInputRefHandler(e){e&&(this.maxRangeNode=e)}async handleSizeRangeValuesChange(e){const{smartMappingState:i}=this,a=(0,l.g)(i),n=(0,l.c)(a,"size"),t=a.classBreakInfos,r=(0,l.p)(a,"reference-size"),s=(0,l.p)(a,"spike");if(r){r.sizeStops[0].size=e[0],r.sizeStops[1].size=e[1];const a=await(0,c.a)(i);return void(0,l.a4)(i,a)}if(s){s.sizeStops[0].size=e[0],s.sizeStops[1].size=e[1];const a=await(0,c.b)(i);return void(0,l.a4)(i,a)}const o=n?n.minSize/.75:t[0].symbol.size/.75,u=n?n.maxSize/.75:t[t.length-1].symbol.size/.75,m=e[0]/.75,h=e[1]?e[1]/.75:e[0]/.75;o===m&&u===h||((0,d.a)(i,e),e.length>1&&(this.maxRangeNode.min=m+Number.parseInt(this.maxRangeNode.step),this.minRangeNode.max=h-Number.parseInt(this.minRangeNode.step)),(0,l.a4)(i))}createRangeSliderChangeEvents(){const{smartMappingState:e}=this,{mapView:i}=e;this.rangeSliderNode&&(this.rangeSliderNode.on("thumb-change",e=>{const i=this.rangeSliderNode.values;0===e.index?i[1]&&i[0]>=i[1]&&(i[0]=e.oldValue):1===e.index&&i[1]<=i[0]&&(i[1]=e.oldValue),this.minRangeNode.value=`${Math.round(i[0])}`,this.maxRangeNode.value=`${Math.round(i[1]??i[0])}`;const a=i[1]?[.75*i[0],.75*i[1]]:[.75*i[0]];this.handleSizeRangeValuesChange(a)}),this.rangeSliderNode.on("thumb-drag",(0,z.d)(i=>{const a=(0,l.g)(e),n=(0,l.p)(a,"reference-size"),t=(0,l.p)(a,"spike");if((n||t)&&["start","drag"].includes(i.state))return;const r=this.rangeSliderNode.values;if(0===i.index){if(r[1]&&r[0]>=r[1])return void(r[0]-=1)}else if(1===i.index&&r[1]<=r[0])return void(r[1]+=1);this.minRangeNode.value=`${Math.round(r[0])}`,this.maxRangeNode.value=`${Math.round(r[1]??r[0])}`;const s=r[1]?[.75*r[0],.75*r[1]]:[.75*r[0]];this.handleSizeRangeValuesChange(s)},10)),this.rangeSliderNode.on("segment-drag",(0,z.d)(()=>{const e=this.rangeSliderNode.values;this.minRangeNode.value=`${Math.round(e[0])}`,this.maxRangeNode.value=`${Math.round(e[1]??e[0])}`;const i=e[1]?[.75*e[0],.75*e[1]]:[.75*e[0]];this.handleSizeRangeValuesChange(i)},10)),this.scaleWatchHandle?.remove(),this.scaleWatchHandle=r.watch(()=>i?.scale,()=>{const i=(0,l.g)(e);if((0,l.c)(i,"size")){let[i,a]=(0,d.b)(e);[i,a]=[Math.round(i/.75),Math.round(a/.75)],i>a&&([i,a]=[a,i]),this.rangeSliderNode?.set({values:i===a?[i]:[i,a],min:Math.max(1,Math.min(1,i-10)),max:Math.min(a+10,100)}),this.minRangeNode.value=`${Math.round(this.rangeSliderNode.values[0])}`,this.maxRangeNode.value=Math.round(this.rangeSliderNode.values[1]??this.rangeSliderNode.values[0]).toString()}}))}async handleSizeRangeChange(e){const{smartMappingState:i}=this,a=(0,l.g)(i),n=(0,l.c)(a,"size"),t=(0,l.p)(a,"reference-size"),r=(0,l.p)(a,"spike");if("fixed"===e){if(!n.minSize.stops)return;[n.minSize,n.maxSize]=(0,d.b)(i),(0,l.a4)(i),this.requestUpdate()}else{const e=(0,l.d)(i);let a=c.d;"predominance-size"===e?a=m.c:"chart-size"===e?a=h.c:["size-age","color-size-age","type-size-age"].includes(e)&&(a=c.e),(0,o.r)(a(i,{sizeOptimizationEnabled:!0}),this.flowItemNode).then(async e=>{if(t){const a=(0,l.p)(e.renderer,"reference-size");t.sizeStops.forEach((e,i)=>e.size=a.sizeStops[i].size);const n=await(0,c.a)(i,{sizeOptimizationEnabled:!0,sizeStops:t.sizeStops});(0,l.a4)(i,n)}else if(r){const a=(0,l.p)(e.renderer,"spike");r.sizeStops.forEach((e,i)=>e.size=a.sizeStops[i].size);const n=await(0,c.b)(i,{sizeOptimizationEnabled:!0,sizeStops:r.sizeStops});(0,l.a4)(i,n)}else(0,l.a4)(i,e.renderer);this.requestUpdate()},e=>{this.adjustSizeNode.value&&(this.adjustSizeNode.value.checked=!1),this.arcgisSmartMappingSizeRangeSliderError.emit(e)})}}render(){const{smartMappingState:e}=this,{mapImageSublayer:i,_messages:a}=e,n=(0,l.g)(e),r=n.authoringInfo,o=(0,l.c)(n,"size"),u=(0,l.p)(n,"reference-size"),c=(0,l.p)(n,"spike"),m="above-and-below"===r?.univariateTheme,h=!!o&&!(0,l.V)(o.minSize),p=!!o&&"number"==typeof o.minSize,f=!h&&!p;let[b,z]=(0,d.b)(e);if([b,z]=[Math.round(b/.75),Math.round(z/.75)],b>z&&([b,z]=[z,b]),!this.rangeSliderNode){const e={min:Math.max(1,Math.min(1,b-10)),max:Math.min(z+10,u||c?Number.POSITIVE_INFINITY:100),values:b===z?[b]:[b,z],visibleElements:{labels:!0},precision:0,labelInputsEnabled:!0,labelFormatFunction:e=>e.toFixed(0)};this.rangeSliderNode=new s.default(e)}return t.qy`<div class="size-range-block"><calcite-label>${a.sizeRangeSlider.sizeRange}</calcite-label><div class="range-slider range-slider-bottom-label" ${(0,g.K)(this.sizeRangeDivRefHandler)}></div><div dir=ltr class="size-range"><div class="size-range-item"><calcite-input-number .value=${`${b}`} min=1 .max=${u||c?void 0:100} step=1 scale=s .suffixText=${a.sizeRangeSlider.px} @calciteInputNumberInput=${()=>{clearTimeout(this.minWatchHandle);const e=this.rangeSliderNode.values,i=Number.parseInt(this.minRangeNode.value);if(this.minRangeNode.value&&i>=this.minRangeNode.min&&(!e[1]||i<e[1])){const a=Math.min(i,100);this.minRangeNode.value=`${a}`,e[1]||(this.maxRangeNode.value=`${a}`);const n=e[1]?[.75*a,.75*e[1]]:[.75*a];this.rangeSliderNode.values=e[1]?[Number.parseInt(this.minRangeNode.value),e[1]]:[Number.parseInt(this.minRangeNode.value)],this.handleSizeRangeValuesChange(n)}else this.minWatchHandle=setTimeout(()=>{const i=this.rangeSliderNode.values;this.minRangeNode.value=`${i[0]}`,e[1]||(this.maxRangeNode.value=`${i[0]}`);const a=i[1]?[.75*i[0],.75*i[1]]:[.75*i[0]];this.handleSizeRangeValuesChange(a)},3e3)}} .label=${a.sizeRangeSlider.min} ${(0,g.K)(this.sizeRangeMinInputRefHandler)}></calcite-input-number></div><div class="size-range-item"><calcite-input-number .value=${`${z}`} min=1 .max=${u||c?void 0:100} step=1 scale=s .suffixText=${a.sizeRangeSlider.px} @calciteInputNumberInput=${()=>{clearTimeout(this.maxWatchHandle);const e=this.rangeSliderNode.values,i=Number.parseInt(this.maxRangeNode.value);if(this.maxRangeNode.value&&(!e[1]||i>e[0])&&(i<101||u||c)){const a=u||c?i:Math.min(i,100);this.maxRangeNode.value=`${a}`,e[1]||(this.minRangeNode.value=`${a}`);const n=e[1]?[.75*e[0],.75*a]:[.75*a];this.rangeSliderNode.values=e[1]?[e[0],Number.parseInt(this.maxRangeNode.value)]:[Number.parseInt(this.maxRangeNode.value)],this.handleSizeRangeValuesChange(n)}else this.maxWatchHandle=setTimeout(()=>{const e=this.rangeSliderNode.values;this.maxRangeNode.value=`${e[1]??e[0]}`,e[1]||(this.minRangeNode.value=`${e[0]}`);const i=e[1]?[.75*e[0],.75*e[1]]:[.75*e[0]];this.handleSizeRangeValuesChange(i)},3e3)}} .label=${a.sizeRangeSlider.min} ${(0,g.K)(this.sizeRangeMaxInputRefHandler)}></calcite-input-number></div></div>${o&&!m&&!i&&t.qy`<calcite-label scale=s layout=inline class="size-range-bottom-border"><calcite-checkbox scale=s .checked=${f} @calciteCheckboxChange=${e=>this.handleSizeRangeChange(e.target.checked?"automatic":"fixed")} ${(0,g.K)(this.adjustSizeNode)}></calcite-checkbox>${a.sizeRangeSlider.adjustSizeAutomatically}</calcite-label>`||""}</div>`}}(0,n.c)("arcgis-map-config-smart-mapping-size-range-slider",v)},75518:(e,i,a)=>{let n,t;function r(e){e.loading=!1}async function s(e,i){return function(e){e.loading=!0,t=!1,n&&clearTimeout(n),n=setTimeout(()=>{r(e),t=!0},6e4)}(i),await e.then(e=>{if(r(i),t)throw new Error("timeout");return e}).catch(e=>{throw r(i),e})}a.d(i,{r:()=>s})}}]);