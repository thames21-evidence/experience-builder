/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81380a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81380a"],{12192:(i,t,a)=>{a.d(t,{a:()=>r,g:()=>c});var e=a(15332),s=a(94984),n=a(87849);function r(i){var t,a,n;const r=null!==(t=(0,e.c)(i,"[lang]"))&&void 0!==t?t:null===(n=null===(a=i.shadowRoot)||void 0===a?void 0:a.ownerDocument)||void 0===n?void 0:n.documentElement,o=((null==r?void 0:r.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(o)?s.l.get(o):s.l.has(o.slice(0,2))?s.l.get(o.slice(0,2)):"en"}const o={};function l(i,t){const a=`${i}${t}`;return o[a]||(o[a]=function(i,t){return new Promise((a,e)=>{fetch((0,n.d)(`../arcgis-app-assets/i18n/${i}.i18n.${t}.json`)).then(i=>{i.ok?a(i.json()):e()},()=>e())})}(i,t)),o[a]}async function c(i,t){const a=t||i.tagName.toLowerCase(),n=r(i),o=function(i){var t,a,n;const r=null!==(t=(0,e.c)(i,"[lang]"))&&void 0!==t?t:null===(n=null===(a=i.shadowRoot)||void 0===a?void 0:a.ownerDocument)||void 0===n?void 0:n.documentElement,o=((null==r?void 0:r.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return s.l.has(o)?s.l.get(o):s.l.has(o.slice(0,2))?o:"en"}(i);let c;try{c=await l(a,n)}catch(i){console.warn(`no locale for ${a} (${n}) loading default locale en.`),c=await l(a,"en")}return[c,n,o]}},85640:(i,t,a)=>{a.r(t),a.d(t,{arcgis_item_classification:()=>l});var e=a(87849),s=a(12192),n=a(6591),r=a(59317),o=a(41473);a(15332),a(94984),a(931),a(93814),a(83692),a(54251),a(37762);const l=class{constructor(i){(0,e.r)(this,i),this.retrieveClassificationSchema=async()=>{const i=`${r.c.config.restBaseUrl}portals/self/classification/classificationSchema`,{result:t,error:a}=await(0,n.r)(i);t?(n.i.itemClassificationSchema=t,t.attributeCategories&&this.setAttributeCategory(t.attributeCategories[0]),this.primaryAttribute=t.classificationMetadata.primaryAttribute,this.retrieveFavoriteClassifications(),this.retrieveItemClassificationValue()):this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:null==a?void 0:a.message})},this.retrieveFavoriteClassifications=async()=>{const i=`${(0,o.g)(r.c.portal)}community/users/${r.c.user.username}/resources/classification_favorites`,{result:t,error:a}=await(0,n.a)(i);if(a){if("COM_1177"===a.code)return;this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:this.i18n.retrieveClassificationFavoriteError})}else n.i.favoriteClassifications=null==t?void 0:t.favorites},this.retrieveItemClassificationValue=async()=>{const{itemClassificationSchema:i}=n.i,t=`${(0,o.g)(r.c.portal)}content/items/${this.itemId}`,{result:a,error:e}=await(0,n.b)(t);if(e)console.error(e),this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:null==e?void 0:e.message});else{if(null==a?void 0:a.banner){const{error:i}=await(0,n.v)(a);i&&this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:i.details.raw.messages.join(", ")})}n.i.itemClassificationValueWithDefaults=(0,n.d)(a,this.primaryAttribute,i),n.i.itemClassificationValue=(0,n.c)(a,this.primaryAttribute,i)}},this.generateBannerText=async()=>{const{itemClassificationSchema:i,itemClassificationValue:t}=n.i;if(!(null==t?void 0:t.banner)&&!this.hasCreatedBannerForDefaultValues)return this.hasCreatedBannerForDefaultValues=!0,void this.displayClassificationVal("NOCLASSIFICATION");const a=await(0,n.g)(i,t);n.i.itemClassificationValue.banner=a,this.displayClassificationVal(a)},this.setAttributeCategory=i=>{this.attributeCategory=i},this.closeClassificationEditModal=i=>{"cancel"===i&&(n.i.classificationErrors={requiredError:[],conflictsError:[]},this.hasCreatedBannerForDefaultValues=!1,this.retrieveClassificationSchema()),this.setIsDisplayModal(!1)},this.saveEditInfo=i=>{const t=structuredClone(i),a=r.c.user.username,e=Date.now();t.lastEditedUser=a,t.lastEditedDate=e;const{createdUser:s,createdDate:n}=t;return s||n||(t.createdUser=a,t.createdDate=e),t},this.handleItemClassificationChange=async()=>{const{itemClassificationSchema:i,itemClassificationValueWithDefaults:t,classificationErrors:a,activeAttributeId:e}=n.i;this.currSelectionText=await(0,n.e)(i,"UNCLASSIFIED"===t[this.primaryAttribute]?Object.assign(Object.assign({},t),{[this.primaryAttribute]:i.classificationMetadata.defaultValue}):t),n.i.currSelectionText=this.currSelectionText,this.generateBannerText(),this.isEnableAttribute=await(0,n.f)(i,t);const s=await(0,n.h)(i,t,a,e);n.i.classificationErrors.conflictsError=s;const r=(0,n.j)({isEnableAttribute:this.isEnableAttribute,i18n:this.i18n,itemClassificationSchema:i,itemClassificationValue:t,classificationErrors:a,activeAttributeId:e});n.i.classificationErrors.requiredError=r,this.hasError=!!s.length||!!r.length},this.saveItemClassificationValue=async()=>{const{itemClassificationSchema:i,itemClassificationValueWithDefaults:t,classificationErrors:a}=n.i,e=(0,n.k)(this.isEnableAttribute,this.i18n,i,t,a);let s=await(0,n.l)(i,t);if(e){this.isSaving=!0,this.hasError=!1;const t=`${r.c.config.restBaseUrl}content/users/${this.itemOwner}/items/${this.itemId}/update`;s=this.saveEditInfo(s),s.banner=await(0,n.g)(i,s);const{error:a}=await(0,n.s)(t,s);a?(this.isSaving=!1,this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:a.details.join(", ")})):(this.isSaving=!1,this.handleDisplayNotificationModal({alertIndicatorActive:!0,alertIndicatorType:"success",alertIndicatorIcon:"check-circle",alertIndicatorInfo:this.i18n.classificationValueSaved}),this.closeClassificationEditModal("save"),this.retrieveClassificationSchema())}else this.isSaving=!1,this.hasError=!0},this.resetClassificationValue=()=>{const{itemClassificationSchema:i}=n.i,t=i.classificationMetadata.defaultValue;this.setItemClassificationValue(t)},this.setItemClassificationValue=i=>{const{itemClassificationSchema:t}=n.i,a=(0,n.m)(i,n.i.itemClassificationValueWithDefaults,this.primaryAttribute);n.i.itemClassificationValueWithDefaults=(0,n.n)(t,a),n.i.itemClassificationValue=a},this.renderHeader=()=>{var i,t;const a=null===(i=n.i.itemClassificationSchema)||void 0===i?void 0:i.helpUrl,s=null===(t=n.i.itemClassificationSchema)||void 0===t?void 0:t.helpTooltip;return(0,e.h)(e.F,null,(0,e.h)("div",{slot:"header-actions-end"},!!s&&(0,e.h)("arcgis-item-classification-header-help-tooltip",{helpUrl:a,helpTooltip:s})))},this.renderContent=()=>{const{itemClassificationSchema:i,itemClassificationValue:t,itemClassificationValueWithDefaults:a}=n.i;return(0,e.h)("div",{class:"portal-item-classification-content"},(0,e.h)("item-classification-info",{i18n:this.i18n,primaryAttribute:this.primaryAttribute,currSelectionText:this.currSelectionText}),!!i&&!!a&&(0,e.h)("item-classification-content",{i18n:this.i18n,primaryAttribute:this.primaryAttribute,currSelectionText:this.currSelectionText,itemClassificationValue:t,itemClassificationValueWithDefaults:a,attributeCategory:this.attributeCategory,onAttributeCategoryChange:i=>{this.setAttributeCategory(i.detail)},onArcgisItemClassificationContentDisplayNotification:i=>this.handleDisplayNotificationModal(i.detail),hasError:this.hasError,isSaving:this.isSaving}))},this.renderFooter=()=>{var i;const{i18n:t}=this,a=this.isSaving;return(0,e.h)(e.F,null,(0,e.h)("calcite-button",{"aria-label":t.reset,scale:"l",slot:"footer-start",appearance:"outline",disabled:a,onClick:()=>this.resetClassificationValue()},this.isResetting?(0,e.h)("div",{class:"reset-indicator"},(0,e.h)("calcite-loader",{label:"resettingClassification",scale:"m",inline:!0}),(0,e.h)("span",{class:"reset-indicator"},t.resetting)):(0,e.h)("div",null,t.reset)),(0,e.h)("calcite-button",{"aria-label":t.save,scale:"l",slot:"footer-end",disabled:this.hasError||!(null===(i=null===n.i||void 0===n.i?void 0:n.i.itemClassificationValueWithDefaults)||void 0===i?void 0:i.classification),onClick:()=>this.saveItemClassificationValue()},a?(0,e.h)("div",{class:"save-indicator"},(0,e.h)("calcite-loader",{label:"savingClassification",scale:"m",inline:!0}),(0,e.h)("span",{class:"saving-indicator"},t.saving)):(0,e.h)("div",null,t.save)),(0,e.h)("calcite-button",{"aria-label":t.cancel,scale:"l",slot:"footer-end",appearance:"outline",onClick:()=>this.closeClassificationEditModal("cancel"),disabled:a},(0,e.h)("div",null,t.cancel)))},this.renderModal=()=>(0,e.h)(e.F,null,this.renderHeader(),this.renderContent(),this.renderFooter()),this.handleDisplayNotificationModal=i=>{this.alertIndicator=i,this.isNotificationModalActive=!0},this.handleCloseNotificationModal=()=>this.isNotificationModalActive=!1,this.itemId=void 0,this.itemOwner=void 0,this.user=void 0,this.config=void 0,this.isDisplayModal=void 0,this.setIsDisplayModal=void 0,this.displayClassificationVal=void 0,this.api=void 0,this.attributeCategory=void 0,this.primaryAttribute=void 0,this.currSelectionText=void 0,this.isEnableAttribute=[],this.hasError=!1,this.isSaving=!1,this.isResetting=!1,this.isNotificationModalActive=!1,this.hasCreatedBannerForDefaultValues=!1,this.alertIndicator={alertIndicatorActive:!1,alertIndicatorType:"danger",alertIndicatorIcon:"exclamation-mark-triangle",alertIndicatorInfo:""}}async componentWillLoad(){var i,t;const a=await(0,s.g)(this.el);null!==(i=r.c.user)&&void 0!==i||(r.c.user=this.user),null!==(t=r.c.config)&&void 0!==t||(r.c.config=this.config),this.i18n=a[0],this.retrieveClassificationSchema(),n.o.onChange("itemClassificationValue",()=>{this.handleItemClassificationChange()})}async handleSelectedFavoriteClassificationChange(i){const t=i.detail[this.primaryAttribute];n.i.selectedFavoriteClassificationName=i.detail.name,n.i.itemClassificationValueWithDefaults=(0,n.d)(t,this.primaryAttribute,n.i.itemClassificationSchema),n.i.itemClassificationValue=(0,n.c)(t,this.primaryAttribute,n.i.itemClassificationSchema),(0,n.k)(this.isEnableAttribute,this.i18n,n.i.itemClassificationSchema,n.i.itemClassificationValueWithDefaults,n.i.classificationErrors)}async handleFavoriteClassificationChange(i){n.i.favoriteClassifications=i.detail}async handleAttributeValueChange(i){const t=i.detail;n.i.activeAttributeId=t.attributeId,t.attributeId!==this.primaryAttribute?(n.i.itemClassificationValueWithDefaults=t.classificationWithDefaults,n.i.itemClassificationValue=t.classification):this.setItemClassificationValue(t.classification[this.primaryAttribute])}render(){return(0,e.h)(e.F,{key:"b03310227df376c02748d5959af0803f189ff7b1"},(0,e.h)("calcite-dialog",{key:"db0ea8c8b2cf4d8fd190e487612ce4af466be754",class:"portal-item-classification-viewer",overlayPositioning:"fixed",heading:this.i18n.itemClassificationEditLabel,open:this.isDisplayModal,modal:!0,placement:"center",scale:"m",outsideCloseDisabled:!0,onCalciteDialogClose:()=>this.closeClassificationEditModal("cancel")},this.renderModal()),this.isNotificationModalActive&&(0,e.h)("item-classification-notification",{key:"b9e68986b205649783ab31315ea87b9afdcafe65",i18n:this.i18n,alertIndicator:this.alertIndicator,onArcgisItemClassificationNotificationClose:()=>{this.handleCloseNotificationModal()}}))}get el(){return(0,e.a)(this)}};l.style='.portal-item-classification-viewer{--calcite-dialog-content-space:0;--calcite-dialog-background-color:"var(--calcite-color-foreground-2)"}.save-indicator{display:inline-flex;width:100%;align-items:center;justify-content:center}.saving-indicator{margin:0 10px}.portal-item-classification-content{margin:1rem}'},94984:(i,t,a)=>{a.d(t,{C:()=>o,a:()=>d,b:()=>h,f:()=>l,g:()=>r,l:()=>n,s:()=>f});var e=a(15332),s=a(931);const n=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function r(i){return function(i,t,a){const s=(0,e.c)(i,`[${t}]`);return s?s.getAttribute(t):a}(i,"dir","ltr")}const o={rtl:"arcgis--rtl"};async function l(i,t){const{api:a,type:e,places:n}=t||{};if(3===a){const[a]=await(0,s.l)(["dojo/number"]);return a.format(i,{type:e,places:n,pattern:null==t?void 0:t.pattern})}const[r]=await(0,s.l)(["esri/intl"]),o=r.convertNumberFormatToIntlOptions({places:n,style:e,digitSeparator:!0});return r.formatNumber(i,Object.assign(Object.assign({},o),{style:e}))}const c={};function h(i,t){let a=document.documentElement.lang;const e="bs"===a;if(e&&(a="hr"),t){const t=`${a}-full`,e={dateStyle:"full",timeStyle:"long"};return c[t]||(c[t]=new Intl.DateTimeFormat(a,e)),c[t].format(i)}const s={year:"numeric",month:e?"numeric":"short",day:"numeric"};return c[a]||(c[a]=new Intl.DateTimeFormat(a,s)),c[a].format(i)}function d(i,t,a,e){const s=null!=i?i:"en";let n=t.unknown;return(1===a||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(s))&&(n=t.single),1!==a&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(s)&&(n=t.multiple),f(n,Object.assign(Object.assign({},e),{number:a}))}const u=/\$\{([^}]+)\}/g;function f(i,t,a=u){let e=i;try{e=i.replace(a,(i,a)=>function(i,t){const a=i.split(".").reduce((i,t)=>i[t],t);return"string"==typeof a||"number"==typeof a?a:i}(a,t).toString())}catch(i){console.error(i)}return e}}}]);