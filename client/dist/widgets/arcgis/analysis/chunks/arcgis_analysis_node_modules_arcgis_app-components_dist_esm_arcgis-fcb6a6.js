/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-fcb6a6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-fcb6a6"],{22407:(e,t,i)=>{i.d(t,{a:()=>a,g:()=>o});var r=i(4429),s=i(80729);function o(e,t){if(function(e,t){return null==t?void 0:t.some(t=>t.title===e)}(e,t))return{error:"folderAlreadyExists"};if(!e||0===e.trim().length)return{error:"noName"};const i=(0,s.a)(e);return(null==i?void 0:i.length)>0?{error:"invalidCharacters",invalidCharacters:(0,r.b)(i)}:null}function a(e){const{folderId:t,currentUsername:i,selectedFolderId:r}=e;switch(t){case"all":return"folders";case i:return"home";case"recycle":return"recycle-bin";default:return t===r?"folder-open":"folder"}}},24869:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>c,g:()=>n,s:()=>a,v:()=>l});var r=i(15912),s=i(46227);function o(e,t){const i=/(?:\.([^.]+))?$/;let r=null==e?void 0:e.replace(/^.*(\\|\/|:)/,""),o=r&&i.exec(r)[1]?i.exec(r)[1].toLowerCase():"",a="";if((null==r?void 0:r.indexOf(".rft."))>-1){const[e,t]=r.split(".rft.");o=`rft.${t}`,a=e}return r&&!a&&(a=-1===r.lastIndexOf(".")?r:r.substring(0,r.lastIndexOf("."))),a=a.replace(/\.|-/g,"_"),t&&(a=function(e){return`${e}_${(0,s.g)()}`}(a),r=`${a}.${o}`),{title:a,fileName:r,extension:o}}function a(e,t){return o(e.name,!!t)}function l(e,t){let i=e;const r=e.lastIndexOf("\\");return r>-1&&(i=i.substring(r+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function n(e){return r.a[e]?r.a[e]:r.a[Object.keys(r.a).find(t=>r.a[t].type===e)]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},28830:(e,t,i)=>{i.d(t,{g:()=>o});const r=document.createElement("canvas").getContext("2d"),s={};function o({text:e,font:t}){if(s[t]=s[t]||{},s[t][e])return s[t][e];r.font=t||"14px 'Avenir Next'";const i=r.measureText(e);return s[t][e]=i.width,s[t][e]}},36891:(e,t,i)=>{function r({geometry:e,type:t}){switch(t){case"Utility Network Layer":return{icon:"utility-network-layer",type:"utility network",isGeometry:!1};case"Catalog Layer":return{icon:"catalog-dataset",type:"catalog",isGeometry:!1};case"Parcel Layer":return{icon:"parcel-layer",type:"parcel",isGeometry:!1};case"Oriented Imagery Layer":return{icon:"oriented-imagery-layer",type:"oriented imagery",isGeometry:!1};case"Table":return{icon:"table",type:"table",isGeometry:!0}}switch(e){case"point":case"esriGeometryPoint":return{type:"point",icon:"point",isGeometry:!0};case"esriGeometryMultipoint":case"multipoint":return{type:"multipoint",icon:"layer-points",isGeometry:!0};case"line":case"polyline":case"esriGeometryPolyline":return{type:"line",icon:"line",isGeometry:!0};case"polygon":case"esriGeometryPolygon":return{type:"polygon",icon:"polygon",isGeometry:!0};case"multipatch":case"esriGeometryMultiPatch":return{type:"multipatch",icon:"cube",isGeometry:!0};default:return{type:"table",icon:"table",isGeometry:!0}}}i.d(t,{g:()=>r})},37362:(e,t,i)=>{i.d(t,{U:()=>r,a:()=>o,b:()=>s,g:()=>a});const r="/Categories",s=(e,t,i=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function o(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||r}const a=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},37378:(e,t,i)=>{function r(e){const t=e;return!(!(null==t?void 0:t.item)||!t.sublayer)}function s(e){const t=e;return!(!(null==t?void 0:t.item)||!t.task)}function o({item:e,sublayer:t,task:i,selectedItem:o}){var a,l,n;return s(o)&&i?(null==e?void 0:e.id)===(null===(a=o.item)||void 0===a?void 0:a.id)&&i===o.task:r(o)&&t?(null==e?void 0:e.id)===(null===(l=o.item)||void 0===l?void 0:l.id)&&t.id===(null===(n=o.sublayer)||void 0===n?void 0:n.id):(null==e?void 0:e.id)===o.id}function a({item:e,sublayer:t,task:i,selectedItems:r}){return(r||[]).some(r=>o({item:e,sublayer:t,task:i,selectedItem:r}))}function l({item:e,sublayer:t,task:i,selectedItems:r}){return(r||[]).filter(r=>!o({item:e,sublayer:t,task:i,selectedItem:r}))}function n({item:e,sublayer:t,task:i,selectedItems:r}){const s=i?{item:e,task:i}:t?{item:e,sublayer:t}:e;return a({item:e,sublayer:t,task:i,selectedItems:r})?[...r]:[...r,s]}function c({item:e,selectedItems:t}){return t.filter(t=>{var i;return(null===(i=t.item)||void 0===i?void 0:i.id)===(null==e?void 0:e.id)})}function d(e){return s(e)||r(e)?e.item:e}function h({selectedItems:e,items:t}){let i=!1;const o=e.map(e=>{const o=d(e),a=t.find(e=>e.id===o.id);return a&&(i=!0),function(e,t){return s(t)||r(t)?Object.assign(Object.assign({},t),{item:e}):e}(a,e)});return i?o:e}i.d(t,{a:()=>s,b:()=>r,d:()=>l,f:()=>c,g:()=>d,i:()=>a,s:()=>n,u:()=>h})},46227:(e,t,i)=>{i.d(t,{g:()=>r});const r=()=>[2,1,1,1,3].map(e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}).join("-")},50315:(e,t,i)=>{i.d(t,{a:()=>m,b:()=>h,c:()=>p,d:()=>v,e:()=>u,f:()=>d,g:()=>c,u:()=>g});var r=i(83692),s=i(37362),o=i(59317),a=i(26262),l=i(41473),n=i(1654);const c=async({portal:e,user:t,group:i,useCache:r=!1})=>{var s;try{const o=await(i?h(i.id,e,r):d(e,t,r));return{result:null!==(s=null==o?void 0:o.categorySchema)&&void 0!==s?s:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function d(e,t,i=!0){if(null!=e||(e=o.c.portal),null!=t||(t=o.c.user),!(null==e?void 0:e.id)||t&&(0,n.b)(t))return null;const s=()=>(0,r.r)(`${(0,l.g)(e)}portals/${e.id}/categorySchema`);return i?(0,r.f)(s,"categorySchema",e.id):s()}async function h(e,t,i=!0){if(null!=t||(t=null===o.c||void 0===o.c?void 0:o.c.portal),!e||!t)return null;const s=()=>(0,r.r)(`${(0,a.a)(t,{id:e})}categorySchema`);return i?(0,r.f)(s,"categorySchema",e):s()}const u=async({user:e,portal:t,useCache:i=!1})=>{var r;const s=await p(t,e,i);return{result:null!==(r=null==s?void 0:s.memberCategorySchema)&&void 0!==r?r:null}};async function p(e,t,i=!0){if(null!=e||(e=o.c.portal),null!=t||(t=o.c.user),!(null==e?void 0:e.id)||t&&(0,n.b)(t))return null;const s=()=>(0,r.r)(`${(0,l.g)(e)}portals/${e.id}/memberCategorySchema`);return i?(0,r.f)(s,"memberCategorySchema",e.id):s()}async function m(e,t,i=!0){const s=()=>async function(e,t){var i;const s=(0,l.g)(e),o=(0,l.b)(e),n=await(0,r.r)(`${s}portals/self?culture=${o}`),c=await(0,r.r)(`${s}community/groups?q=${n.contentCategorySetsGroupQuery}`),d=null===(i=null==c?void 0:c.results)||void 0===i?void 0:i[0],h=(await(0,r.r)((0,a.g)(e,d),{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${s}content/items/${h.id}/data`)}(e,t);return i?(0,r.f)(s,"categorySchema",t):s()}async function g({categories:e,itemIds:t,portal:i,group:s}){try{const o=`${(0,l.g)(i)}/content/${s?`groups/${s.id}/updateCategories`:"updateItems"}`,a=JSON.stringify(t.map(t=>{const i=Array.isArray(e)?e:e[t];return{[t]:s?i:{categories:i}}}));return{result:await(0,r.r)(o,{items:a},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const v=async({path:e,portal:t,group:i,updateInfo:r})=>{try{const o=(await b({category:e,portal:t,group:i,num:1})).total;if(0===o)return console.warn(`No items found with category ${e} when updating schema`),{};const a=100,l=Math.ceil(o/a),n=[];for(let o=0;o<l;o++)n.push(b({category:e,portal:t,group:i,start:o*a,num:a}).then(({results:t})=>{const o={};return t.forEach(t=>{var a;const l=null!==(a=i?t.groupCategories:t.categories)&&void 0!==a?a:[],n="change-title"===r.type?l.map(t=>{const i=(0,s.g)(e,r.newTitle);return t===e?i:t.replace(`${e}/`,`${i}/`)}):l.filter(t=>!t.startsWith(e));o[t.id]=n}),o}));const c=await Promise.all(n);return await Promise.all(c.map(e=>g({categories:e,itemIds:Object.keys(e),portal:t,group:i}))),{}}catch(t){return console.error(`Error ${r.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},b=({category:e,num:t=100,start:i=0,portal:s,group:o})=>{const n={start:i,num:t,categories:JSON.stringify([e])},c=o?(0,a.g)(s,o):`${(0,l.g)(s)}search`;return(0,r.r)(c,Object.assign(Object.assign({},n),{q:o?void 0:`orgid: ${s.id}`}))}},51867:(e,t,i)=>{i.d(t,{a:()=>f,b:()=>y,c:()=>w,g:()=>g,i:()=>v});var r=i(46904),s=i(1654),o=i(15912),a=i(31581);const l=["3DInsetMap","3DScene","3DViz","AttachmentViewer","CapacityAnalysis","Compare/storytelling_compare","Compare/storytelling_tabbed","Compare/storytelling_sidepanel","Compare/Multiviewer","Compare/Search","Compare/Configure","Compare/SideBySideViewer_Configure","Compare3d","CompareAnalysis","CompareMaps","Directions","Edit","Editor","Elevations","ElevationsProfile","Filter","FilterGallery","GeoList","GeoTour","HeaderFooter","Identify","ImageInterpretation","ImageryViewer","ImpactSummary","InformationLookup","InteractiveFilter","InteractiveLegend","LayerShowcase","Legend","LiveMaps","LocalPerspective","MapAndAppGallery","MapCarousel","MapTools","Media","MinimalGallery","Minimalist","Nearby","OnePane","Panels","PanelsLegend","Profile","PublicGallery","PublicInformation","ServiceLookup","SimpleMapViewer","SimpleViewer","SocialMedia","Solutions/s2.html?app=apps2/FindEditFilter","Solutions/s2.html?app=apps2/Finder","StorytellingTextLegend","StoryMapBasic","Styler","SummaryViewer","Time","TimeAware","TwoPane","Viewer","ZoneLookup","Compare","CrowdsourceManager","CrowdsourcePolling","CrowdsourceReporter","Embed","GeoForm","ImageMask","ImageVisit","MobileViewer","View"];function n(e,t){var i;return(null==t?void 0:t.isPortal)&&"Web Mapping Application"===e.type&&(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Story Map"))}function c(e){var t;return"Data Store"===e.type&&(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("bigDataFileShare"))}function d(e,t){var i;return(null==t?void 0:t.isPortal)&&"Web Mapping Application"===e.type&&(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Web AppBuilder"))}function h(e,t){return(null==t?void 0:t.isPortal)&&"AppBuilder Extension"===e.type}function u(e,t){const i=l.some(t=>{var i;const r=t.includes(".html"),s=`/apps/${t}${r?"":"/"}`;return null===(i=e.url)||void 0===i?void 0:i.includes(s)});return(null==t?void 0:t.isPortal)&&"Web Mapping Application"===e.type&&e.url&&i}function p(e,t){return(null==t?void 0:t.isPortal)&&["Insights Workbook","Insights Page","Insights Model","Insights Theme","Insights Workbook Package","Kernel Gateway Connection","Insights Script","Insights Data Engineering Workbook","Insights Data Engineering Model","Relational Database Connection"].includes(e.type)}const m=(e,t)=>d(e,t)||h(e,t)||u(e,t)||p(e,t);function g(e){var t;return(null==e?void 0:e.contentStatus)||(null===(t=null==e?void 0:e.sourceJSON)||void 0===t?void 0:t.contentStatus)}function v(e){return"public_authoritative"===g(e)}function b(e,t){return!(null==t?void 0:t.isPortal)&&["Insights Workbook","Insights Page","Insights Model","Insights Theme","Insights Workbook Package"].includes(null==e?void 0:e.type)}function f(e,t,i){var s,a,l,d,h,u,p,f;const y=[],w=null===(a=e.groupDesignations||(null===(s=e.sourceJSON)||void 0===s?void 0:s.groupDesignations))||void 0===a?void 0:a.split(", "),I=(k=e.type,o.r.includes(k)||n(e,t)||c(e)||m(e,t));var k;if((function(e){return"org_authoritative"===g(e)}(e)||v(e))&&y.push("Authoritative"),("deprecated"===g(e)||b(e,t))&&y.push("Deprecated"),"Solution"===e.type&&(null===(l=e.typeKeywords)||void 0===l?void 0:l.includes("ArcGIS Solution"))&&y.push("Solution"),(null===(d=e.typeKeywords)||void 0===d?void 0:d.includes("Public Data Collection"))&&i&&y.push("Public Data Collection"),I&&y.push("Retired"),(null==w?void 0:w.includes("livingatlas"))&&y.push("Living Atlas"),w&&w.includes("opendata")&&y.push("Open Data"),(0,r.b)(e)&&y.push("Premium"),(0,r.a)(e)&&y.push("Subscriber"),(e.origin||(null===(h=e.sourceJSON)||void 0===h?void 0:h.origin))&&y.push("Collaboration"),"esri_apps"===e.owner||!e.listed&&!(null===(u=e.sourceJSON)||void 0===u?void 0:u.listed)||(null==t?void 0:t.isPortal)||y.push("Marketplace"),null===(p=e.typeKeywords)||void 0===p?void 0:p.includes("Registered App")){const i=null==t?void 0:t.isPortal;if("API Key"!==e.type&&(!i||"esri_apps"!==e.owner)){const t=e.typeKeywords;(null==t?void 0:t.includes("APIToken"))?y.push((null==t?void 0:t.includes("Personal API Token"))&&!i?"Registered API Key Credentials (Personal)":"Registered API Key Credentials (Standard)"):y.push((null==t?void 0:t.includes("Personal API Token"))&&!i?"Registered OAuth 2.0 Credentials (Personal)":"Registered OAuth 2.0 Credentials (Standard)")}}return(null===(f=e.typeKeywords)||void 0===f?void 0:f.includes("hasReplacementItem"))&&y.push("Has Replacement"),y}function y({badgeType:e,i18n:t,item:i,portal:r}){const s=null==r?void 0:r.isPortal,o=t["Registered API Key Credentials (Standard)"].title,a=t["Registered OAuth 2.0 Credentials (Standard)"].title;switch(e){case"Registered API Key Credentials (Standard)":return s?o.enterprise:o.online;case"Registered OAuth 2.0 Credentials (Standard)":return s?a.enterprise:a.online;case"Deprecated":return b(i,r)?t.DeprecatedItem.title:t.Deprecated.title;default:return t[e].title}}async function w({badgeType:e,i18n:t,item:i,locale:r,portal:o,user:l,useProduction:m}){const v=!l||(0,s.b)(l);switch(e){case"Authoritative":if(i&&"public_authoritative"===g(i)){const e=await(0,a.f)(i,r,o),s=(null==o?void 0:o.isPortal)&&!m?null==o?void 0:o.name:null==e?void 0:e.name;return t.Authoritative.tooltip.public.replace("${name}",s)}return t.Authoritative.tooltip.org;case"Retired":const s=t.Retired.tooltip;return i?n(i,o)?s.storyMap:function(e){return"CityEngine Web Scene"===e.type}(i)?s.cityEngine:d(i,o)||h(i,o)?s.webAppBuilder:u(i,o)?s.app:p(i,o)?s.insights:function(e){return"Big Data File Share"===e.type||c(e)}(i)?s.bdfs:s.general:s.general;case"Subscriber":return v?t.Subscriber.tooltip.public:t.Subscriber.tooltip.org;case"Premium":return v?t.Premium.tooltip.public:t.Premium.tooltip.org;case"Registered":return(null==o?void 0:o.isPortal)?t.Registered.tooltip.enterprise:t.Registered.tooltip.online;case"Personal credential":return t["Personal credential"].tooltip;case"Has Replacement":return t["Has Replacement"][window.location.href.includes("item.html")?"itemPageTooltip":"tooltip"];default:return t[e].tooltip}}},54077:(e,t,i)=>{i.d(t,{a:()=>d,b:()=>b,c:()=>l,d:()=>v,e:()=>n,f:()=>u,g:()=>h,i:()=>g});var r=i(4429),s=i(1654),o=i(3826),a=i(10578);const l={WORLD:"World",EU:"Europe",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barth\xe9lemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CD:"Congo, the Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"C\xf4te d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin (French part)",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, the former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PS:"Palestine, State of",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten (Dutch part)",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan, Province of China",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela, Bolivarian Republic of",VG:"Virgin Islands, British",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Republic of Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};function n(e,t){const{sourceCountry:i,locationType:r,analyzeResults:s,candidateFieldsType:a,coordinateFieldType:l,type:n,standardizedFieldNames:h,selectedFields:u}=o.a,p=d(),m=t?o.a.backupLayerFields:Object.values(u),g=Object.assign(Object.assign({locationType:r||"address",sourceCountry:i,candidateFieldsType:a},"coordinates"===r&&function(e,t){return e.reduce((e,i)=>{switch(i.locationType){case"latitude":e.latitudeFieldName=i.name,t||(e.coordinateFieldType="LatitudeAndLongitude");break;case"longitude":e.longitudeFieldName=i.name,t||(e.coordinateFieldType="LatitudeAndLongitude");break;case"mgrs":"MGRS"===t&&(e.coordinateFieldName=i.name,t||(e.coordinateFieldType="MGRS"));break;case"usng":"USNG"===t&&(e.coordinateFieldName=i.name,t||(e.coordinateFieldType="USNG"))}return e},{coordinateFieldType:t})}(m,l)),"address"===r&&{addressFields:c(m,e,h)});let v;return v=t||"Microsoft Excel"!==n?Object.assign(Object.assign({},s.publishParameters),g):Object.assign(Object.assign({},s.publishParameters),{layers:[Object.assign(Object.assign({},p),g)],hasStaticData:!0,maxRecordCount:2e3,layerInfo:{capabilities:"Query"}}),"coordinates"===r&&["USNG","MGRS"].includes(l)&&(delete v.latitudeFieldName,delete v.longitudeFieldName),v}function c(e,t,i){if("Single"===t){const t=Object.keys(i)[0]||"Address",r=e.find(({locationType:e})=>e===t||"address"===(null==e?void 0:e.toLowerCase()));return{[t]:(null==r?void 0:r.name)||""}}return e.reduce((e,t)=>("unknown"!==t.locationType&&(e[t.locationType]=t.name),e),{})}function d(e,t){var i,r,s,a,l,n,c;const{type:d,analyzeResults:h=e,selectedSheet:u}=o.a,p=null==h?void 0:h.publishParameters;if(t)return"CSV"===d?null==p?void 0:p.layerInfo:null!==(r=null===(i=null==p?void 0:p.layers)||void 0===i?void 0:i[u])&&void 0!==r?r:null===(s=null==p?void 0:p.layers)||void 0===s?void 0:s[0];switch(d){case"Microsoft Excel":return null!==(l=null===(a=null==p?void 0:p.layers)||void 0===a?void 0:a[u])&&void 0!==l?l:null===(n=null==p?void 0:p.layers)||void 0===n?void 0:n[0];case"GeoJson":return null===(c=null==p?void 0:p.layers)||void 0===c?void 0:c[0];default:return null==p?void 0:p.layerInfo}}function h(e){switch(e){case"esriFieldTypeBigInteger":return["esriFieldTypeBigInteger","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSmallInteger":return["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeInteger":return["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSingle":return["esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDouble":return["esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDate":return["esriFieldTypeDate","esriFieldTypeString"];case"esriFieldTypeDateOnly":return["esriFieldTypeDateOnly","esriFieldTypeString"];case"esriFieldTypeTimeOnly":return["esriFieldTypeTimeOnly","esriFieldTypeString"];case"esriFieldTypeTimestampOffset":return["esriFieldTypeTimestampOffset","esriFieldTypeString"];case"esriFieldTypeOID":return["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeString"];default:return["esriFieldTypeString"]}}function u(e,t){const i=null==t?void 0:t.filter(t=>t.url===e);return(null==i?void 0:i.length)?i.shift():null}function p(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com.*\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi))}function m(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi))}function g(e){return!!e&&(m(e)||p(e))}function v(e,t,i){let r=i||e||t||"";return r="wo"===(null==r?void 0:r.toLowerCase())?"world":r,l[r.toUpperCase()]||(r="world"),r}function b(e,t,i){var o;let l=(0,a.m)(t)&&(0,a.o)(t);const n=function(e,t,i){return e.filter(e=>{const s=Object.assign({},e),o=m(null==s?void 0:s.url),a=p(null==s?void 0:s.url);return(o||a)&&((0,r.c)(s.name)?"Esri World Geocoder"!==s.name&&"ArcGIS Geocoding service"!==s.name||(s.name="ArcGIS Geocoding Service"):s.name="ArcGIS World Geocoding Service"),(!o||!i&&!t)&&((0,r.c)(s.batch)?!!s.batch:o||a)})}(e,!l,i),c=null===(o=n[0])||void 0===o?void 0:o.url;if(null==n?void 0:n.length){l=!0;const e=u(n[0].url,n),r=m(null==e?void 0:e.url),o=p(null==e?void 0:e.url),a=r||o;let d=a||!!e.batch;return{allowGeocode:(!(0,s.g)(t)||l)&&(!i&&d||i&&(!r||o)&&d),isAgoWorldGeocodeServer:r,isServiceProxyAgoWorldGeocodeServer:o,isWorldGeocodeServer:a,geocodeServers:n,geocodeServiceUrl:c}}return null}},76301:(e,t,i)=>{i.r(t),i.d(t,{arcgis_item_browser:()=>J,arcgis_item_browser_actions:()=>Z,arcgis_item_browser_bucket_select:()=>te,arcgis_item_browser_card:()=>ie,arcgis_item_browser_card_sublayer_select:()=>re,arcgis_item_browser_card_thumbnail:()=>se,arcgis_item_browser_content:()=>oe,arcgis_item_browser_filter_categories:()=>ae,arcgis_item_browser_filter_collaborations:()=>le,arcgis_item_browser_filter_content_status:()=>ne,arcgis_item_browser_filter_date:()=>ce,arcgis_item_browser_filter_extent:()=>de,arcgis_item_browser_filter_folder:()=>he,arcgis_item_browser_filter_group:()=>ue,arcgis_item_browser_filter_industry:()=>me,arcgis_item_browser_filter_item_type:()=>ge,arcgis_item_browser_filter_location:()=>fe,arcgis_item_browser_filter_region:()=>ye,arcgis_item_browser_filter_sharing:()=>we,arcgis_item_browser_filter_tags:()=>Ie,arcgis_item_browser_filters:()=>ke,arcgis_item_browser_pagination:()=>Se,arcgis_item_browser_preview:()=>xe,arcgis_item_browser_preview_copy:()=>Fe,arcgis_item_browser_preview_field_details:()=>Ce,arcgis_item_browser_search:()=>_e,arcgis_item_browser_sort:()=>Te,arcgis_item_browser_table:()=>Oe,arcgis_item_browser_table_row:()=>Pe,arcgis_item_browser_top_bar:()=>Le,arcgis_item_browser_view:()=>De});var r=i(87849),s=i(37762),o=i(93814),a=i(59317),l=i(15332),n=i(24869),c=i(4429),d=i(12192),h=i(5157),u=i(44388),p=i(3470),m=i(14270),g=i(37378),v=i(78242),b=i(80619),f=i(1654),y=i(29599),w=i(10578),I=i(88878),k=i(83692),S=i(41473),x=i(1536),F=i(5821),C=i(79321),_=i(94984),B=i(31106),T=i(931),E=i(50315),A=i(37362),O=i(74174),P=i(7449),L=i(22407),D=i(54077),M=i(51867),R=i(36891),U=i(46227),G=i(79238),$=i(28890),j=i(28830),z=i(89209),N=i(58573),H=(i(15912),i(54251),i(31581),i(52995),i(46904),i(60958),i(94737),i(63263),i(18944),i(72257),i(86562),i(3826),i(95878),i(26262),i(76246),{exports:{}});!function(e,t){var i="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",a="[object Function]",l="[object Object]",n=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[s]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d[a]=d["[object Map]"]=d["[object Number]"]=d[l]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1;var h="object"==typeof o.c&&o.c&&o.c.Object===Object&&o.c,u="object"==typeof self&&self&&self.Object===Object&&self,p=h||u||Function("return this")(),m=t&&!t.nodeType&&t,g=m&&e&&!e.nodeType&&e,v=g&&g.exports===m,b=v&&h.process,f=function(){try{var e=g&&g.require&&g.require("util").types;return e||b&&b.binding&&b.binding("util")}catch(e){}}(),y=f&&f.isTypedArray;var w,I,k,S=Array.prototype,x=Function.prototype,F=Object.prototype,C=p["__core-js_shared__"],_=x.toString,B=F.hasOwnProperty,T=(w=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",E=F.toString,A=_.call(Object),O=RegExp("^"+_.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=v?p.Buffer:void 0,L=p.Symbol,D=p.Uint8Array,M=P?P.allocUnsafe:void 0,R=(I=Object.getPrototypeOf,k=Object,function(e){return I(k(e))}),U=Object.create,G=F.propertyIsEnumerable,$=S.splice,j=L?L.toStringTag:void 0,z=function(){try{var e=me(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),N=P?P.isBuffer:void 0,H=Math.max,W=Date.now,V=me(p,"Map"),K=me(Object,"create"),q=function(){function e(){}return function(t){if(!Ce(t))return{};if(U)return U(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function J(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Z(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Q(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Y(e){var t=this.__data__=new Z(e);this.size=t.size}function X(e,t){var i=Ie(e),r=!i&&we(e),s=!i&&!r&&Se(e),o=!i&&!r&&!s&&Be(e),a=i||r||s||o,l=a?function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}(e.length,String):[],n=l.length;for(var c in e)!t&&!B.call(e,c)||a&&("length"==c||s&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ge(c,n))||l.push(c);return l}function ee(e,t,i){(void 0!==i&&!ye(e[t],i)||void 0===i&&!(t in e))&&re(e,t,i)}function te(e,t,i){var r=e[t];B.call(e,t)&&ye(r,i)&&(void 0!==i||t in e)||re(e,t,i)}function ie(e,t){for(var i=e.length;i--;)if(ye(e[i][0],t))return i;return-1}function re(e,t,i){"__proto__"==t&&z?z(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}J.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},J.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},J.prototype.get=function(e){var t=this.__data__;if(K){var r=t[e];return r===i?void 0:r}return B.call(t,e)?t[e]:void 0},J.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:B.call(t,e)},J.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=K&&void 0===t?i:t,this},Z.prototype.clear=function(){this.__data__=[],this.size=0},Z.prototype.delete=function(e){var t=this.__data__,i=ie(t,e);return!(i<0)&&(i==t.length-1?t.pop():$.call(t,i,1),--this.size,!0)},Z.prototype.get=function(e){var t=this.__data__,i=ie(t,e);return i<0?void 0:t[i][1]},Z.prototype.has=function(e){return ie(this.__data__,e)>-1},Z.prototype.set=function(e,t){var i=this.__data__,r=ie(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this},Q.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(V||Z),string:new J}},Q.prototype.delete=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t},Q.prototype.get=function(e){return pe(this,e).get(e)},Q.prototype.has=function(e){return pe(this,e).has(e)},Q.prototype.set=function(e,t){var i=pe(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this},Y.prototype.clear=function(){this.__data__=new Z,this.size=0},Y.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Y.prototype.get=function(e){return this.__data__.get(e)},Y.prototype.has=function(e){return this.__data__.has(e)},Y.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Z){var r=i.__data__;if(!V||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new Q(r)}return i.set(e,t),this.size=i.size,this};var se,oe=function(e,t,i){for(var r=-1,s=Object(e),o=i(e),a=o.length;a--;){var l=o[se?a:++r];if(!1===t(s[l],l,s))break}return e};function ae(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":j&&j in Object(e)?function(e){var t=B.call(e,j),i=e[j];try{e[j]=void 0;var r=!0}catch(e){}var s=E.call(e);r&&(t?e[j]=i:delete e[j]);return s}(e):function(e){return E.call(e)}(e)}function le(e){return _e(e)&&ae(e)==s}function ne(e){return!(!Ce(e)||function(e){return!!T&&T in e}(e))&&(xe(e)?O:n).test(function(e){if(null!=e){try{return _.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function ce(e){if(!Ce(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=ve(e),i=[];for(var r in e)("constructor"!=r||!t&&B.call(e,r))&&i.push(r);return i}function de(e,t,i,r,s){e!==t&&oe(t,function(o,a){if(s||(s=new Y),Ce(o))!function(e,t,i,r,s,o,a){var n=be(e,i),c=be(t,i),d=a.get(c);if(d)return void ee(e,i,d);var h=o?o(n,c,i+"",e,t,a):void 0,u=void 0===h;if(u){var p=Ie(c),m=!p&&Se(c),g=!p&&!m&&Be(c);h=c,p||m||g?Ie(n)?h=n:_e(w=n)&&ke(w)?h=function(e,t){var i=-1,r=e.length;t||(t=Array(r));for(;++i<r;)t[i]=e[i];return t}(n):m?(u=!1,h=function(e,t){if(t)return e.slice();var i=e.length,r=M?M(i):new e.constructor(i);return e.copy(r),r}(c,!0)):g?(u=!1,v=c,b=!0?(f=v.buffer,y=new f.constructor(f.byteLength),new D(y).set(new D(f)),y):v.buffer,h=new v.constructor(b,v.byteOffset,v.length)):h=[]:function(e){if(!_e(e)||ae(e)!=l)return!1;var t=R(e);if(null===t)return!0;var i=B.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&_.call(i)==A}(c)||we(c)?(h=n,we(n)?h=function(e){return function(e,t,i,r){var s=!i;i||(i={});var o=-1,a=t.length;for(;++o<a;){var l=t[o],n=r?r(i[l],e[l],l,i,e):void 0;void 0===n&&(n=e[l]),s?re(i,l,n):te(i,l,n)}return i}(e,Te(e))}(n):Ce(n)&&!xe(n)||(h=function(e){return"function"!=typeof e.constructor||ve(e)?{}:q(R(e))}(c))):u=!1}var v,b,f,y;var w;u&&(a.set(c,h),s(h,c,r,o,a),a.delete(c));ee(e,i,h)}(e,t,a,i,de,r,s);else{var n=r?r(be(e,a),o,a+"",e,t,s):void 0;void 0===n&&(n=o),ee(e,a,n)}},Te)}function he(e,t){return fe(function(e,t,i){return t=H(void 0===t?e.length-1:t,0),function(){for(var r=arguments,s=-1,o=H(r.length-t,0),a=Array(o);++s<o;)a[s]=r[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=r[s];return l[t]=i(a),function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}(e,this,l)}}(e,t,Oe),e+"")}var ue=z?function(e,t){return z(e,"toString",{configurable:!0,enumerable:!1,value:(i=t,function(){return i}),writable:!0});var i}:Oe;function pe(e,t){var i,r,s=e.__data__;return("string"==(r=typeof(i=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?s["string"==typeof t?"string":"hash"]:s.map}function me(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return ne(i)?i:void 0}function ge(e,t){var i=typeof e;return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&c.test(e))&&e>-1&&e%1==0&&e<t}function ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||F)}function be(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var fe=function(e){var t=0,i=0;return function(){var r=W(),s=16-(r-i);if(i=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ue);function ye(e,t){return e===t||e!=e&&t!=t}var we=le(function(){return arguments}())?le:function(e){return _e(e)&&B.call(e,"callee")&&!G.call(e,"callee")},Ie=Array.isArray;function ke(e){return null!=e&&Fe(e.length)&&!xe(e)}var Se=N||function(){return!1};function xe(e){if(!Ce(e))return!1;var t=ae(e);return t==a||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Fe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function Ce(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function _e(e){return null!=e&&"object"==typeof e}var Be=y?function(e){return function(t){return e(t)}}(y):function(e){return _e(e)&&Fe(e.length)&&!!d[ae(e)]};function Te(e){return ke(e)?X(e,!0):ce(e)}var Ee,Ae=(Ee=function(e,t,i){de(e,t,i)},he(function(e,t){var i=-1,r=t.length,s=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(s=Ee.length>3&&"function"==typeof s?(r--,s):void 0,o&&function(e,t,i){if(!Ce(i))return!1;var r=typeof t;return!!("number"==r?ke(i)&&ge(t,i.length):"string"==r&&t in i)&&ye(i[t],e)}(t[0],t[1],o)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var a=t[i];a&&Ee(e,a,i,s)}return e}));function Oe(e){return e}e.exports=Ae}(H,H.exports);const W=H.exports;function V(e){return{point:"point",polyline:"line",polygon:"polygon",nonspatial:"table",multipoint:"layer-points"}[e]||"table"}const K={esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultipoint:"multipoint",none:"nonspatial",table:"nonspatial"};function q(e){const{description:t,geometryType:i,fieldAliases:r,title:s,id:o,sourceJSON:a}=e;return{description:t,fieldAliases:Array.isArray(r)?r.join(","):r,geometryType:K[i]||"nonspatial",id:o,title:s,sourceJSON:a}}const J=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserUpdate=(0,r.c)(this,"arcgisItemBrowserUpdate",7),this.arcgisItemBrowserLoading=(0,r.c)(this,"arcgisItemBrowserLoading",7),this.arcgisItemBrowserSelect=(0,r.c)(this,"arcgisItemBrowserSelect",7),this.arcgisItemBrowserPreview=(0,r.c)(this,"arcgisItemBrowserPreview",7),this.arcgisItemBrowserShareUpdate=(0,r.c)(this,"arcgisItemBrowserShareUpdate",7),this.arcgisItemBrowserSublayerPreview=(0,r.c)(this,"arcgisItemBrowserSublayerPreview",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.liveRegionUpdate=(0,r.c)(this,"liveRegionUpdate",7),this.arcgisItemBrowserCardSelectError=(0,r.c)(this,"arcgisItemBrowserCardSelectError",7),this.allowFetch=!1,this.currentResults=[],this.updateFiltersEmpty=()=>{var e;this.store.state.filtersEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="filters"]'))},this.updateTopbarEmpty=()=>{var e;this.store.state.topbarEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="top-bar"]'))},this.updateSortEmpty=()=>{var e;this.store.state.sortEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="sort"]'))},this.filterMutationObserver=new MutationObserver(this.updateFiltersEmpty),this.topbarMutationObserver=new MutationObserver(this.updateTopbarEmpty),this.sortMutationObserver=new MutationObserver(this.updateSortEmpty),this.fetchItems=(0,c.f)(async e=>{var t,i,r;if(e||(this.loading=!0,this.arcgisItemBrowserLoading.emit()),this.currentResults=[],this.store.state.preview=null,!this.portal||!this.allowFetch)return;let s=this.getQuery();this.preflight&&(s=await this.preflight(s));const{response:o,error:l}=await(0,c.m)(this.queryItems(s),e?0:500);if(l||!(null==o?void 0:o.results))return;0===(null===(t=null==o?void 0:o.results)||void 0===t?void 0:t.length)&&o.start>o.total&&o.total>0&&this.updatePage({start:1,total:o.total,num:o.num});const n=await(0,m.a)(this.portal,this.store.state.userContentGroups,null==o?void 0:o.results);n.result&&(this.store.state.groupSharing=Object.assign({},n.result));const{selectedItems:d}=this,h=e?(0,g.u)({selectedItems:d,items:o.results}):d;this.arcgisItemBrowserUpdate.emit(Object.assign(Object.assign(Object.assign({},o),{selectedItems:h,filters:(0,m.c)({user:a.c.user,filters:Object.assign({},this.store.state.filters),bucket:this.bucket}),searchTerm:this.searchTerm,recycleBin:this.store.state.recycleBin}),this.sort)),this.store.state.activeFocus=[0,0],h!==d&&(this.selectedItems=h,this.arcgisItemBrowserSelect.emit(h)),this.currentResponse=o,this.currentResults=o.results,this.store.state.knownTags=(0,m.g)(o,this.store.state.knownTags,null===(r=null===(i=this.store.state.filters)||void 0===i?void 0:i.tags)||void 0===r?void 0:r.tags),this.store.state.highlights=(0,m.b)(o,a.c.config),await(0,c.t)(100),this.loading=!1},150),this.resize=()=>{var e,t;const i=this.el.clientWidth||(null===(e=this.el.parentElement)||void 0===e?void 0:e.clientWidth)||0,r=this.el.clientHeight||(null===(t=this.el.parentElement)||void 0===t?void 0:t.clientHeight)||0;this.formFactor=i>h.b.md?"large":"small";const s=this.store.state.width>h.b.md?"large":"small";"large"===s&&"small"===this.formFactor&&(this.store.state.panel=this.usePanelLayout,this.store.state.filtersExpanded=!1),"small"===s&&"large"===this.formFactor&&(this.store.state.panel=!1,this.store.state.filtersExpanded=!0),this.store.state.width=i,this.store.state.height=r},this.renderSelectedItem=e=>{var t;const i=(0,g.a)(e),s=(0,g.g)(e).id,o=null===(t=this.disabledItems)||void 0===t?void 0:t.some(e=>e.id===s);if(i){const t=e.task;return(0,r.h)("arcgis-selected-item",{key:s,heading:t,onArcgisSelectedItemRemove:()=>{this.selectedItems=(0,g.d)({item:l,task:t,selectedItems:this.selectedItems}),this.arcgisItemBrowserSelect.emit(this.selectedItems)}},(0,r.h)("calcite-icon",{slot:"content-start",icon:"pushpin",scale:"s"}))}const a=(0,g.b)(e),l=a?e.item:e,n=a?e.sublayer:null,c=a?n.title:null;return(0,r.h)("arcgis-selected-item",{heading:l.title,description:c,key:s,disabled:o,onArcgisSelectedItemRemove:()=>{this.selectedItems=(0,g.d)({item:l,sublayer:n,selectedItems:this.selectedItems}),this.arcgisItemBrowserSelect.emit(this.selectedItems),this.arcgisItemBrowserInternalUIAction.emit({category:"deselect",attribute:"selection dropdown"})}},a?(0,r.h)("calcite-icon",{slot:"content-start",icon:V(e.sublayer.geometryType),scale:"s"}):(0,r.h)("arcgis-item-type",{slot:"content-start",item:l,portal:this.portal,scale:"s",showText:!1}))},this.rangeFormatter=async({start:e,end:t,total:i,results:r})=>{const{recycleBin:s,bucket:o,lang:l,contentUser:c}=this.store.state,{portal:d,user:h}=a.c,{i18n:p}=this,g="org"===o,v=null!=c?c:h,b=s&&d&&(v||g)?await(0,m.e)({portal:d,user:v,forOrg:g}):null;if(this.store.state.findOnPageTermEntered){const{items:e}=r;return[p.itemBrowser.foundOnPage.replace("${total}",e),p.itemBrowser.foundOnPage.replace("${total}",e)]}if("en"===l){const r=b&&b>0?` (${p.itemBrowser.totalSize.replace("${totalSize}",(0,n.f)(b))})`:"";return[`${e}-${t} of ${i}${r}`,`${e}-${t} of ${i} item${"1"===i?"":"s"}${r}`]}const f=r=>(0,u.r)(r,{start:e,end:t,total:i}).replace("${recycleBinSize}",(0,n.f)(b));return[f(p.itemBrowser[s?"pageRangeWithRecycleBin":"pageRange"]),f(p.itemBrowser[s?"pageRangeAriaWithRecycleBin":"pageRangeAria"])]},this.api=void 0,this.portal=void 0,this.user=void 0,this.contentUser=void 0,this.subscriptionInfo=void 0,this.userLicensedItems=void 0,this.config=void 0,this.groupId=void 0,this.selection="none",this.retainSelection=void 0,this.selectedItems=[],this.allowedGeometries=void 0,this.allowedSubscriptionContentTypes=void 0,this.view="list",this.bucket=void 0,this.num=20,this.q="",this.filter="",this.vector=void 0,this.linkHandler=void 0,this.externalLinkHandler=void 0,this.height="full",this.preflight=void 0,this.fetch=void 0,this.showFieldStatistics=!1,this.store=(0,s.c)({filters:{},type:"item-browser"}),this.hidePreviewFooters=!1,this.hideContentTop=!1,this.contentPaddedBottom=!1,this.usePanelLayout=void 0,this.baseUrls={},this.messageOverrides={},this.showHiddenItems=void 0,this.disabledItems=void 0,this.searchTerm="",this.sort=void 0,this.page={num:this.num,start:1,nextStart:-1},this.loading=!0,this.formFactor=void 0,this.previewItem=void 0,this.currentResponse=void 0,this.selectedSizeForRecycleBin=0,this.showHosted=void 0,this.previousSort=void 0}async refresh(e){this.fetchItems(e)}async refreshSharing(e){const t=(await(0,m.f)(this.portal,e)).result,i=await(0,m.a)(this.portal,this.store.state.userContentGroups,t);this.store.state.groupSharing=Object.assign(Object.assign({},this.store.state.groupSharing),e.reduce((e,t)=>{var r;return Object.assign(Object.assign({},e),{[t]:(null===(r=i.result)||void 0===r?void 0:r[t])||[]})},{}));const r=Object.assign(Object.assign({},this.currentResponse),{results:this.currentResults.map(e=>t.find(t=>t.id===e.id)||e)});this.arcgisItemBrowserUpdate.emit(Object.assign(Object.assign(Object.assign({},r),{selectedItems:this.selectedItems,filters:this.store.state.filters,searchTerm:this.searchTerm,recycleBin:this.store.state.recycleBin}),this.sort)),this.currentResponse=r,this.currentResults=r.results}async componentWillLoad(){var e,t;const{el:i,groupId:r,view:s,bucket:o,allowedGeometries:a,selectedItems:n,showFieldStatistics:c,allowedSubscriptionContentTypes:h,disabledItems:u}=this,p=await(0,d.g)(i),m=W(p[0],this.messageOverrides);this.i18n=m,o&&(this.store.state.bucket=o),this.store.state.contentUser=this.contentUser,r&&(this.store.state.groupId=r),this.store.state.linkHandler=this.linkHandler,this.store.state.externalLinkHandler=this.externalLinkHandler,this.store.state.i18n=m,this.store.state.lang=p[1],this.store.state.view=s,this.store.state.selection=this.selection,this.store.state.selectedItems=n,this.store.state.allowedGeometries=a,this.store.state.allowedSubscriptionContentTypes=h,this.store.state.showFieldStatistics=c,this.store.state.interaction="keyboard",this.initializeConfig(),this.store.state.width=(null===(e=this.el.parentElement)||void 0===e?void 0:e.offsetWidth)||420,this.store.state.filtersExpanded=!1,this.store.state.disabledItems=u,this.store.state.hiddenFilters=b.I,this.formFactor="small",this.filterMutationObserver.observe(i,{childList:!0}),this.topbarMutationObserver.observe(i,{childList:!0}),this.sortMutationObserver.observe(i,{childList:!0}),this.updateUserGroups(),this.updateFiltersEmpty(),this.updateTopbarEmpty(),this.updateSortEmpty(),this.resize(),this.resizeHandler=()=>requestAnimationFrame(this.resize),window.addEventListener("resize",this.resizeHandler);const g=(0,l.c)(this.el,"calcite-shell-panel, calcite-dialog"),f=null!==(t=this.usePanelLayout)&&void 0!==t?t:"CALCITE-SHELL-PANEL"===(null==g?void 0:g.tagName);f&&(this.store.state.filtersExpanded=!1),this.store.state.panel=f,this.calculateSelectedSizeForRecycleBin(),(0,v.o)(this.store,this.calculateSelectedSizeForRecycleBin.bind(this)),(0,v.a)(this.store,this.calculateSelectedSizeForRecycleBin.bind(this))}disconnectedCallback(){var e;null===(e=this.store.state.resizeObserver)||void 0===e||e.unobserve(this.el),this.filterMutationObserver.disconnect(),this.topbarMutationObserver.disconnect(),this.sortMutationObserver.disconnect(),this.filterClearHandler(!1),window.removeEventListener("resize",this.resizeHandler)}async updateI18n(e){const t=await(0,d.g)(this.el),i=W(t[0],e);this.i18n=i,this.store.state.i18n=i}updateLoading(e){this.store.state.loading=e}updateUser(e){var t;null!==(t=a.c.user)&&void 0!==t||(a.c.user=e),this.updateUserGroups()}updateContentUser(e){var t,i;null!==(t=(i=this.store.state).contentUser)&&void 0!==t||(i.contentUser=e),this.updateUserGroups()}updateUserLicensedItems(e){var t;null!==(t=a.c.userLicensedItems)&&void 0!==t||(a.c.userLicensedItems=e)}updateSubscriptionInfo(e){var t;null!==(t=a.c.subscriptionInfo)&&void 0!==t||(a.c.subscriptionInfo=e)}updatePortal(e){var t;null!==(t=a.c.portal)&&void 0!==t||(a.c.portal=e),this.updateUserGroups()}updateConfig(e){var t;null!==(t=a.c.config)&&void 0!==t||(a.c.config=e)}updateSelection(e){this.store.state.selection=e}updateGroupID(e){this.store.state.groupId=e}updateSublayerSelectionGeometryTypes(e){this.store.state.allowedGeometries=e}updateSelectedItems(e){this.store.state.selectedItems=e}updateFieldStatistics(e){this.store.state.showFieldStatistics=e}updateView(e){this.store.state.view=e}updateBucket(e,t){var i,r,s,o;this.store.state.bucket=e,this.store.state.filters=(0,m.c)({user:a.c.user,bucket:e,oldBucket:t,filters:this.store.state.filters,keepSpecialFilters:!0,switchingBucket:!0});const l="my"===e&&"recycle"===(null===(r=null===(i=this.store.state.filters)||void 0===i?void 0:i.folder)||void 0===r?void 0:r.folder),n="org"===e&&"recycle"===(null===(o=null===(s=this.store.state.filters)||void 0===s?void 0:s.contentType)||void 0===o?void 0:o.contentType);this.store.state.recycleBin=l||n,this.retainSelection||(this.selectedItems=[],this.arcgisItemBrowserSelect.emit(this.selectedItems)),this.resetPagination(),this.fetchItems()}updateQ(){this.resetPagination(),this.fetchItems()}updateDisabledItems(e){this.store.state.disabledItems=e}async componentDidLoad(){this.resize(),this.initializeConfig(),await(0,c.t)(1200),this.allowFetch=!0,a.c.portal?this.fetchItems():(0,a.o)("portal",()=>{this.initializeConfig(),this.fetchItems()})}filterHandler(e){var t,i;this.loading=!0;const r=Object.assign(Object.assign({},this.store.state.filters),{[e.detail.id]:e.detail});if(e.detail.value){const t=Object.keys((0,m.c)({user:a.c.user,filters:r,bucket:this.bucket}));this.allowFetch&&this.arcgisItemBrowserInternalUIAction.emit({category:"filter",action:e.detail.id,attribute:t.join(","),count:t.length})}else delete r[e.detail.id];"folder"===(null===(t=e.detail)||void 0===t?void 0:t.id)&&"my"===this.store.state.bucket&&(this.store.state.recycleBin="recycle"===e.detail.folder),"contentType"===(null===(i=e.detail)||void 0===i?void 0:i.id)&&"org"===this.store.state.bucket&&(this.store.state.recycleBin="recycle"===e.detail.contentType),this.store.state.recycleBin&&((0,v.r)(r),this.searchTerm=""),this.store.state.filters=r,this.resetPagination(),this.fetchItems()}filterRemoveHandler(e){if(!e.detail)return;this.loading=!0;const t=Object.assign({},this.store.state.filters);delete t[e.detail],this.store.state.filters=t,this.resetPagination(),this.fetchItems()}filterClearHandler(e=!0){this.loading=e;const t={},i=this.store.state.filters;"my"===this.bucket&&(null==i?void 0:i.folder)&&(t.folder=i.folder),"group"===this.bucket&&(null==i?void 0:i.group)&&(t.group=i.group),this.store.state.filters=t,this.resetPagination(),e&&this.fetchItems()}genericFilterClearHandler(){this.filterClearHandler()}searchHandler(e){this.arcgisItemBrowserInternalUIAction.emit({category:"search",label:e.detail}),this.loading=!0;const t=this.searchTerm,i=e.detail;this.searchTerm=i;return!(this.searchTerm&&this.store.state.recycleBin)&&this.resetPagination(),!t&&i&&this.sort&&!this.store.state.recycleBin?(this.previousSort=this.sort,void this.updateSort({sortField:"relevance",sortOrder:"desc"})):t&&!i&&this.previousSort?(this.updateSort(this.previousSort),void(this.previousSort=null)):void(i?this.fetchItems():this.fetchItems.invoke())}bucketHandler(e){var t;const i=this.catalog,r=this.bucket;this.loading=!0,this.store.state.bucket=e.detail,this.catalog=e.target.catalog,this.bucket=e.detail,r===this.bucket&&(null==i?void 0:i.id)!==(null===(t=this.catalog)||void 0===t?void 0:t.id)&&(this.resetPagination(),this.fetchItems())}sortHandler(e){this.updateSort(e.detail),this.previousSort&&(this.previousSort=e.detail)}viewHandler(e){this.view=e.detail,this.store.state.view=e.detail}async pageHandler(e){this.updatePage(e.detail)}selectHandler(e){const t=this.selectedItems,{selected:i,item:r,task:s,sublayer:o}=e.detail;switch(i||this.arcgisItemBrowserInternalUIAction.emit({category:"deselect",attribute:"item card"}),this.selection){case"single":case"single-sublayer":this.selectedItems=(0,g.s)({item:r,sublayer:o,task:s,selectedItems:[]});break;case"multiple":case"multiple-sublayer":this.selectedItems=i?(0,g.s)({item:r,sublayer:o,task:s,selectedItems:t}):(0,g.d)({item:r,sublayer:o,task:s,selectedItems:t})}this.arcgisItemBrowserSelect.emit(this.selectedItems)}async togglePreview({detail:e,target:t}){this.store.state.filtersExpanded=!1,this.store.state.recycleBin||(e&&this.store.state.preview!==e.id?(t.showItemTypeHosted&&(this.showHosted=!0),this.restoreFocusElement=document.activeElement,this.store.state.preview=e.id,this.previewItem=Object.assign({},e),this.arcgisItemBrowserPreview.emit(Object.assign({},e))):(this.store.state.preview=null,this.previewItem=null,this.arcgisItemBrowserPreview.emit(),this.arcgisItemBrowserSublayerPreview.emit(),this.arcgisItemBrowserCardSelectError.emit(),this.restoreFocus()),this.arcgisItemBrowserInternalUIAction.emit({action:this.previewItem?"open panel":"close panel",category:"card action"}))}tileSelectHandler(e){const{item:t}=e.detail;this.arcgisItemBrowserSelect.emit([t])}columnUpdateHandler(e){this.store.state.columns=e.detail}async sharingUpdateHandler({detail:e}){this.arcgisItemBrowserShareUpdate.emit(e)}handleMove(){this.store.state.interaction="mouse"}handleTouch(){this.store.state.interaction="touch"}handleKey(){this.store.state.interaction="keyboard"}calculateSelectedSizeForRecycleBin(){var e;this.store.state.selectedItems=this.selectedItems,this.selectedSizeForRecycleBin=this.store.state.recycleBin?null===(e=this.selectedItems)||void 0===e?void 0:e.reduce((e,t)=>e+("size"in t?t.size:0),0):void 0}updateSort(e){this.loading=!0,this.sort=e,this.store.state.sort=e,this.fetchItems()}async initializeConfig(){var e,t,i,r;null!==(e=a.c.user)&&void 0!==e||(a.c.user=this.user),null!==(t=a.c.portal)&&void 0!==t||(a.c.portal=this.portal),null!==(i=a.c.config)&&void 0!==i||(a.c.config=this.config),null!==(r=a.c.subscriptionInfo)&&void 0!==r||(a.c.subscriptionInfo=this.subscriptionInfo)}async updatePage(e){var t;this.page=e,this.allowFetch&&(await this.fetchItems(),await(0,c.t)(400),null===(t=this.browser)||void 0===t||t.scrollToTop())}resetPagination(){this.page.start=1,this.page.total=0}getQuery(){return Object.assign(Object.assign({filters:this.store.state.filters,searchTerm:this.searchTerm,baseQuery:this.q,baseFilter:this.filter,bucket:this.bucket,allowedGeometries:this.allowedGeometries},this.sort),this.page)}async queryItems(e){var t,i;let r;if(this.fetch)r=await this.fetch(e);else{const{portal:t,user:i,catalog:s,contentUser:o,store:a,groupId:l,config:n,showHiddenItems:c,vector:d}=this;try{r=await(0,m.q)({portal:t,query:e,user:i,vector:d,contentUser:o,store:a,catalog:s,groupId:l,config:n,userContentGroups:this.store.state.userContentGroups,showHiddenItems:c})}catch(e){return{error:e}}}return await(0,m.i)(this.portal,null===(t=this.store)||void 0===t?void 0:t.state.bucket)&&(null===(i=null==r?void 0:r.results)||void 0===i||i.forEach(({id:e})=>{this.baseUrls[e]="arcgis.com"})),{response:r}}restoreFocus(){if(this.restoreFocusElement){const e=this.restoreFocusElement;e.restoreFocus?e.restoreFocus():e.setFocus?e.setFocus():e.focus&&e.focus()}}async updateUserGroups(){var e,t;const i=(null===(e=this.contentUser)||void 0===e?void 0:e.username)||(null===(t=this.user)||void 0===t?void 0:t.username),r=this.portal||a.c.portal;if(!i||!r)return;const s=await(0,p.f)(i,r);this.store.state.userContentGroups=s.groups}renderSelected(){var e,t,i,s,o,a;const l=(null===(e=this.currentResults)||void 0===e?void 0:e.length)&&(null===(t=this.currentResults)||void 0===t?void 0:t.every(e=>(0,g.i)({item:e,selectedItems:this.selectedItems}))),c=null===(i=this.selectedItems)||void 0===i?void 0:i.length,d=this.selectedSizeForRecycleBin,u=this.store.state.width<h.b.md;return(0,r.h)("arcgis-selected",{slot:"selection",loading:this.loading,total:null===(s=this.currentResults)||void 0===s?void 0:s.length,totalSelected:null===(o=this.store.state.selectedItems)||void 0===o?void 0:o.length,hideSelectedText:this.store.state.width<960,heading:"multiple-sublayer"===this.selection?this.i18n.itemBrowser.selectedLayers:this.i18n.itemBrowser.selectedItems,emptyText:"multiple-sublayer"===this.selection?this.i18n.itemBrowser.noSelectedLayers:this.i18n.itemBrowser.noSelectedItems,selectedText:d?this.i18n.itemBrowser[u?"selectedMultipleWithSizeSmall":"selectedMultipleWithSize"].replace("${totalSize}",(0,n.f)(d)).replace("${num}",`${c}`):void 0,checked:l,indeterminate:!l&&!!c,hideCheckbox:"multiple-sublayer"===this.selection,onArcgisSelectedDeselectAll:()=>{this.selectedItems=[],this.arcgisItemBrowserSelect.emit(this.selectedItems)},onArcgisSelectedSelectPage:()=>{var e;let t=[...this.selectedItems];null===(e=this.currentResults)||void 0===e||e.forEach(e=>{t=(0,g.s)({item:e,selectedItems:t})}),this.selectedItems=t,this.arcgisItemBrowserSelect.emit(this.selectedItems)}},(0,r.h)("div",{class:"selected-items-container--in-dialog"},null===(a=this.store.state.selectedItems)||void 0===a?void 0:a.map(this.renderSelectedItem)))}renderSlot(e,t){return(0,r.h)("div",{slot:e},(0,r.h)("slot",{name:e},t))}renderEmptyTextSlot(e,t){return(0,r.h)("div",{slot:e,class:"empty-text-slot"},(0,r.h)("slot",{name:e},(0,r.h)("p",{class:"empty-text-slot__default"},t)))}render(){var e,t,i,s;const{previewItem:o,loading:a,hideContentTop:l,i18n:n,selectedItems:c,selection:d,currentResponse:h,store:u,api:p,renderSlot:m,renderEmptyTextSlot:g,searchTerm:v,formFactor:b,view:f,height:y}=this;return(0,r.h)(r.H,{key:"222c101484825534b9665e298f61b1bda456a4d1"},(0,r.h)("arcgis-browser",{key:"a14d2bb26c8a24d2f43a43bda9ad43fc1fe25208",ref:e=>this.browser=e,preview:!!o,loading:a,hideContentTop:l,selected:c,alwaysShowSelection:null==d?void 0:d.includes("multiple"),alwaysShowContent:"table"===f,alwaysShowPagination:null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.recycleBin,hideFilters:"subscription content"===(null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.bucket),response:h,store:u,api:p,formFactor:b,searchTerm:v,height:y,onAriaUpdate:e=>this.liveRegionUpdate.emit(e.detail),rangeFormatter:this.rangeFormatter},m("top-bar"),m("view"),m("sort"),this.store.state.preview&&(0,r.h)("arcgis-item-browser-preview",{slot:"preview",item:this.previewItem,portal:this.portal,user:this.user,key:this.store.state.preview,onArcgisItemBrowserPreviewClose:()=>{this.store.state.preview=null,this.arcgisItemBrowserPreview.emit(),this.arcgisItemBrowserSublayerPreview.emit(),this.restoreFocus()},showHosted:this.showHosted,onArcgisInternalItemBrowserSublayer:e=>{e.stopPropagation(),this.arcgisItemBrowserSublayerPreview.emit(e.detail)},hidePreviewFooters:this.hidePreviewFooters},(0,r.h)("div",{key:"c9284a2d8ab7fb867a5002f3a192bf94303f7342",slot:"summary-top"},(0,r.h)("slot",{key:"b1c635b9277585ce39bf44bace903466bfb3ae3e",name:"preview-summary-top"})),(0,r.h)("div",{key:"f985dac3f6d0b34ecda567017d5cd2c3d33bef94",slot:"footer"},(0,r.h)("slot",{key:"bcfae845fbbc9400a99088943d379683edcc747f",name:"preview-footer"})),(0,r.h)("div",{key:"93358dbf7c99962becc7f8a0da67d8614389937c",slot:"sublayer-footer"},(0,r.h)("slot",{key:"f25f6c7591a8fdbb95e72eba612b610bf05d38c4",name:"sublayer-preview-footer"}))),this.renderSelected(),m("actions"),m("content-start"),(0,r.h)("div",{key:"6f7cb680bdc8d7e916788aa611eec5d62788f6f3",slot:"content",class:{"content--padded-bottom":this.contentPaddedBottom}},(0,r.h)("slot",{key:"b2cd7af188f12b023c8eabb6e140bbfbf5ed9524",name:"content"})),m("content-end"),m("pagination"),m("filters-top"),m("filters"),m("primary-filter"),m("scroll-end"),g("no-results",n.content.noResults),g("no-content",n.content.noContent)))}get el(){return(0,r.a)(this)}static get watchers(){return{messageOverrides:["updateI18n"],loading:["updateLoading"],user:["updateUser"],contentUser:["updateContentUser"],userLicensedItems:["updateUserLicensedItems"],subscriptionInfo:["updateSubscriptionInfo"],portal:["updatePortal"],config:["updateConfig"],selection:["updateSelection"],groupId:["updateGroupID"],allowedGeometries:["updateSublayerSelectionGeometryTypes"],selectedItems:["updateSelectedItems","calculateSelectedSizeForRecycleBin"],showFieldStatistics:["updateFieldStatistics"],view:["updateView"],bucket:["updateBucket"],q:["updateQ"],filter:["updateQ"],disabledItems:["updateDisabledItems"]}}};J.style=":host{position:relative;display:flex;height:100%;min-height:100%;width:100%;flex-direction:column;overflow-y:auto;overflow-x:hidden;background-color:var(--calcite-color-background);--item-browser-max-width:100%;--item-browser-pane-width:18.75rem;--item-browser-pane-z-index:11;--item-browser-top-bar-background:var(--calcite-color-foreground-1)}:host([height=auto]){display:flex;height:auto;flex-direction:column}arcgis-browser{--arcgis-browser-max-width:var(--item-browser-max-width);--arcgis-browser-pane-width:var(--item-browser-pane-width);--arcgis-browser-pane-z-index:var(--item-browser-pane-z-index);--arcgis-browser-top-bar-background:var(--item-browser-top-bar-background)}.content--padded-bottom{padding-bottom:1.5rem}::slotted([slot=no-results]){width:100%}::slotted([slot=no-content]){width:100%}.empty-text-slot{display:flex;height:100%;width:100%;justify-content:center}.empty-text-slot__default{margin-left:auto;margin-right:auto;max-width:32rem;padding-left:1.5rem;padding-right:1.5rem;padding-bottom:4rem;margin-top:min(8rem, 30vh)}.selected-items-container--in-dialog{max-height:var(--arcgis-browser-items-max-height, none)}@media screen and (max-width: 640px){:host{--item-browser-pane-width:100%}}";const Z=class{constructor(e){(0,r.r)(this,e),this.actions=[]}async restoreFocus(){var e;null===(e=this.actionsRef)||void 0===e||e.restoreFocus()}async componentWillLoad(){this.store=(0,v.g)(this.el)}render(){return(0,r.h)(r.H,{key:"ee0f11acc554785bde4ff54f5079c345b5d148fc"},(0,r.h)("arcgis-browser-actions",{key:"71df4062392719e8146a0a2ed0d282eb9558ee2a",ref:e=>this.actionsRef=e,actions:this.actions,selection:this.store.state.selectedItems,store:this.store}))}get el(){return(0,r.a)(this)}};function Q(e){return Boolean((null==e?void 0:e.source)&&(null==e?void 0:e.id)&&(null==e?void 0:e.title))}async function Y(e,t){var i,r,s;try{const o="string"==typeof e?await(0,x.b)(e,t):{result:e},a=null==o?void 0:o.result,l=null==a?void 0:a.id,n=await(0,x.p)(l,t),c=(null===(i=null==n?void 0:n.result)||void 0===i?void 0:i.catalogV2)||(null===(r=null==n?void 0:n.result)||void 0===r?void 0:r.catalog);if(!c)return null;const d=(0,m.u)(c);return(null===(s=null==d?void 0:d.scopes)||void 0===s?void 0:s.item)?{title:(null==a?void 0:a.title)||d.title,id:l,source:d}:null}catch(e){return null}}async function X({catalog:e,portal:t}){const i=await async function({catalog:e,portal:t}){const i="string"==typeof e?e:null==e?void 0:e.id,r=i?[await Y(i,t)]:[],s=await(0,I.e)(),o=r.filter(Q);if(!s)return o;const a=await(0,k.r)(`${(0,S.g)(t)}content/groups/${s}/search`,{start:1,num:100,q:'type:("Hub Site Application" OR "Hub Project" OR "Hub Initiative" OR "Discussion") OR typekeywords:hubSite'});if(!a.total)return o;const l=null==a?void 0:a.results.filter(e=>e.id!==i),n=await Promise.all(l.map(e=>Y(e,t)));return[...o,...n.filter(Q)].sort((e,t)=>e.title.localeCompare(t.title))}({catalog:e,portal:t}),r=((0,F.a)("ago_hub_catalogs",!0)||[]).filter(e=>Q(e)&&!i.find(t=>t.id===e.id)),s=await Promise.all(r.map(e=>async function(e,t){return Y({title:e.title,id:e.id},t)}(e,t))),o=[...s,...i].filter(Q);return(0,F.b)("ago_hub_catalogs",o,!0),o}async function ee(e,t,i,r,s){var o,a;if(!e)return[];const l=await(0,y.e)(e),n=null!==(o=(null==i?void 0:i.includes("subscription content"))&&await(0,m.d)(t,e))&&void 0!==o?o:[],c=null===(a=null==e?void 0:e.sourceJSON.livingAtlasGroupQuery)||void 0===a||a,d=t&&(null==n?void 0:n.length)&&(await(0,m.h)(e,t,r)).total>0;return i.filter(i=>t||"org"!==i?!(!t&&["my","favorites","group","org"].includes(i))&&(!(t&&!(0,w.m)(t)&&!(0,w.p)(t)&&"my"===i)&&((!t||!(0,f.b)(t)||"org"!==i)&&(!("subscription content"===i&&!d)&&(!(!(c||"living atlas"!==i&&"living atlas analysis"!==i)||!function(e,t,i){var r,s,o,a,l;return t.isPortal?null===(s=null===(r=null==e?void 0:e.portalConfigProperties)||void 0===r?void 0:r.searchArcGISOnlineEnabled)||void 0===s||s:!(i&&!(0,f.f)(i))||null===(l=null!==(a=null===(o=t.sourceJSON)||void 0===o?void 0:o.canSearchPublic)&&void 0!==a?a:t.canSearchPublic)||void 0===l||l}(l,e,t)&&"all"===i)&&!("catalog"===i&&!s))))):"public"===(null==e?void 0:e.access))}const te=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserBucketSelect=(0,r.c)(this,"arcgisItemBrowserBucketSelect",7),this.emitUpdate=e=>{const t=this.getCatalogFromId(this.catalog);this.catalog=t,this.arcgisItemBrowserBucketSelect.emit(e)},this.selectOption=e=>{var t;e!==this.bucket&&(this.bucket=e,this.validBucket=e,"catalog"===this.validBucket&&(null===(t=this.catalogs)||void 0===t?void 0:t.length)&&!this.catalog&&(this.catalog=this.catalogs[0]),this.emitUpdate(e),this.store.state.filtersExpanded=!1)},this.optionLabel=e=>{var t;return"org"!==e||a.c.user?this.i18n[e]:null===(t=a.c.portal)||void 0===t?void 0:t.name},this.options=["my","favorites","group","org","living atlas","all","catalog"],this.bucket="my",this.catalog=void 0,this.catalogs=void 0,this.validBucket=void 0,this.validOptions=void 0}updateOptions(e){this.updateValidOptions(e)}async updateValidOptions(e,t){var i,r,s,o;const l=this.validBucket,n=this.catalog,{user:c,portal:d}=a.c;if(this.validOptions=await ee(d,c,e,null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.allowedSubscriptionContentTypes,null===(s=this.store)||void 0===s?void 0:s.state.panel),this.validOptions.includes("catalog")&&!this.catalogs){if(this.catalogs=await X({portal:d,catalog:this.catalog}),this.catalog&&"string"==typeof this.catalog){const e=this.catalogs.find(e=>e.id===this.catalog);e&&(this.catalog=e)}!this.catalog&&"catalog"===this.bucket&&(null===(o=this.catalogs)||void 0===o?void 0:o.length)&&(this.catalog=this.catalogs[0])}this.validBucket=this.validOptions.includes(this.bucket)?this.bucket:this.validOptions[0],(l!==this.validBucket||n!==this.catalog||t)&&this.emitUpdate(this.validBucket)}getCatalogFromId(e){var t;return"string"!=typeof e?this.catalog:null===(t=this.catalogs)||void 0===t?void 0:t.find(t=>t.id===e)}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.bucketSelect,await this.updateValidOptions(this.options,!0),(0,a.o)("user",()=>{this.updateValidOptions(this.options)}),(0,a.o)("portal",()=>{this.updateValidOptions(this.options)})}render(){var e;const{validOptions:t,validBucket:i,selectOption:s,optionLabel:o}=this;return(0,r.h)(r.H,{key:"eea73bb6fc4158c82fdfb31bbd5402cfe3ed813e"},(0,r.h)("div",{key:"c9ff2a229fd7d7db4db257f38b1add7c6dbe66cc",class:{large:this.store.state.width>=h.b.sm}},(null==t?void 0:t.length)>0&&(0,r.h)("calcite-dropdown",{key:"673b8542ad493b5e59ab628327043276a2ec414b",placement:"bottom-start",scale:"m",widthScale:"m",type:"click"},(0,r.h)("calcite-button",{key:"33e6e085a0973a447d6fec584cd85af2f2365966",class:"button",kind:"neutral",appearance:"transparent","icon-end":"chevron-down",slot:"trigger"},o(i)),(0,r.h)("calcite-dropdown-group",{key:"cb4bd8cd6fe64c0d1cf35a70b4774fe7564a83e2",selectionMode:"single"},t.map(e=>(0,r.h)("calcite-dropdown-item",{selected:i===e,onCalciteDropdownItemSelect:()=>s(e)},o(e)))))),"catalog"===i&&Boolean(null===(e=this.catalogs)||void 0===e?void 0:e.length)&&(0,r.h)("div",{key:"35d6bcaf5121d3c6d7f8210f2688ff55b7c58f01",class:"catalog-container"},(0,r.h)("calcite-label",{key:"4abc3daed5fae6f953eaba9b4445e083cf441692"},this.i18n.catalogLabel,(0,r.h)("calcite-combobox",{key:"6ef10078cd39b1d66119e40495b9ac0b1aabe472",label:this.i18n.catalogLabel,selectionMode:"single-persist",clearDisabled:!0,onCalciteComboboxChange:e=>{var t,i,r;const s=null===(r=null===(i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset)||void 0===r?void 0:r.id;this.catalog=this.getCatalogFromId(s),this.emitUpdate("catalog")}},this.catalogs.map(({title:e,id:t})=>{var i;return(0,r.h)("calcite-combobox-item",{key:t,value:e,heading:e,"data-id":t,selected:t===(null===(i=this.getCatalogFromId(this.catalog))||void 0===i?void 0:i.id)})})))))}get el(){return(0,r.a)(this)}static get watchers(){return{options:["updateOptions"]}}};te.style=":host{display:block}.large{border-inline-end:1px solid var(--calcite-color-border-3)}.catalog-container{background-color:var(--calcite-color-background);padding:1rem;border-top:1px solid var(--calcite-color-border-3)}.button{padding:0.5rem;--calcite-font-weight-normal:500}";const ie=class{constructor(e){var t;(0,r.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.arcgisItemBrowserActionsOpen=(0,r.c)(this,"arcgisItemBrowserActionsOpen",7),this.arcgisItemBrowserCardSelect=(0,r.c)(this,"arcgisItemBrowserCardSelect",7),this.updateActionsStartEmpty=()=>{var e;this.actionsStartEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="actions-start"]'))},this.actionsStartMutationObserver=new MutationObserver(this.updateActionsStartEmpty),this.handleResizeEvent=e=>{e.stopPropagation(),this.width=e.detail.width},this.item=void 0,this.portal=void 0,this.user=void 0,this.api=void 0,this.baseUrl=null===(t=null===a.c||void 0===a.c?void 0:a.c.config)||void 0===t?void 0:t.baseUrl,this.link=void 0,this.newTab=void 0,this.selected=void 0,this.selection=void 0,this.name=void 0,this.preview=void 0,this.showOwner=!0,this.showDateUpdated=!0,this.showItemType=!0,this.showItemTypeHosted=!1,this.showSummary=!1,this.showBadges=!0,this.showAccess=void 0,this.allowSharing=void 0,this.showFavorite=void 0,this.showFavoriteInActionsMenu=void 0,this.showThumbnail=!0,this.disableSelection=void 0,this.actions=[],this.messageOverrides={},this.userPopupZIndex=void 0,this.hover=void 0,this.formFactor=void 0,this.updatedText="",this.shortUpdatedText="",this.loaded=void 0,this.noSpaceForDate=!0,this.width=void 0,this.actionsStartEmpty=!1}async restoreFocus(){this.link&&this.linkEl?this.linkEl.focus():"top"===this.preview&&this.sectionEl&&this.sectionEl.focus()}async componentWillLoad(){var e,t,i,r,s,o,l,n;this.store=(0,v.g)(this.el);const c=await(0,C.g)(this.el);this.i18n=null==c?void 0:c.card,null!==(e=this.formFactor)&&void 0!==e||(this.formFactor=(null===(t=this.store)||void 0===t?void 0:t.state.panel)?"xs":"lg"),(0,h.s)(this.store).observe(this.el),this.el.addEventListener("arcgisBrowserResize",this.handleResizeEvent),this.actionsStartMutationObserver.observe(this.el,{childList:!0}),this.updateActionsStartEmpty();const d=(0,_.b)(this.item.modified);this.updatedText=this.i18n.lastUpdated.replace("${date}",d),this.shortUpdatedText=d,this.portal=null!==(i=this.portal)&&void 0!==i?i:a.c.portal,this.user=null!==(r=this.user)&&void 0!==r?r:a.c.user,this.api=null!==(s=this.api)&&void 0!==s?s:a.c.api,this.disableSelection=null!==(o=this.disableSelection)&&void 0!==o?o:null===(n=null===(l=this.store)||void 0===l?void 0:l.state.disabledItems)||void 0===n?void 0:n.some(e=>this.item.id===e.id)}async componentDidLoad(){await(0,c.t)(100),this.loaded=!0}disconnectedCallback(){var e,t,i,r;null===(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.resizeObserver)||void 0===i||i.unobserve(this.el),this.actionsStartMutationObserver.disconnect(),null===(r=this.el)||void 0===r||r.removeEventListener("arcgisBrowserResize",this.handleResizeEvent)}render(){var e,t,i,s;const{item:o,baseUrl:a,user:l,portal:n,showDateUpdated:c,showFavorite:d,showFavoriteInActionsMenu:u,showItemType:p,showItemTypeHosted:m,showOwner:g,showBadges:v,showSummary:b,showThumbnail:f,link:y,newTab:w,showAccess:I,messageOverrides:k,actions:S}=this,x=(null===(e=this.store)||void 0===e?void 0:e.state)||{};return(0,r.h)(r.H,{key:"e5ede0fa3cbfd143a707d27eb93dbf18b9abf8a1"},(0,r.h)("arcgis-item-card",{key:"0727bb2c1862322f0e9f32d10514edecdacda379",style:{height:"100%"},item:o,portal:n,user:l,baseUrl:a,link:y,newTab:w,selection:x.selection,name:this.name,preview:this.preview,previewActive:x.preview===o.id,showOwner:g,messageOverrides:k,showDateUpdated:c,showItemType:p,showItemTypeHosted:m,showSummary:b,showBadges:v,showAccess:I,showFavorite:d,showFavoriteInActionsMenu:u,showThumbnail:f,useProduction:"all"===(null==x?void 0:x.bucket)&&(null==n?void 0:n.isPortal),actions:S,recycleBin:x.recycleBin,selectedItems:x.selectedItems,panel:x.panel,view:x.view,width:this.width,watchResize:!1,groups:null===(t=x.groupSharing)||void 0===t?void 0:t[o.id],userGroups:x.userContentGroups,allowSharingEdit:this.allowSharing,hideActionsStart:this.actionsStartEmpty,disableSelection:this.disableSelection,onArcgisItemCardInternalUIAction:e=>{e.stopPropagation(),this.arcgisItemBrowserInternalUIAction.emit(e.detail)},onArcgisItemCardActionsOpen:e=>{e.stopPropagation(),this.arcgisItemBrowserActionsOpen.emit(e.detail)},onArcgisItemCardSelect:e=>{e.stopPropagation(),this.arcgisItemBrowserCardSelect.emit(e.detail)},linkHandler:null==x?void 0:x.linkHandler,userPopupZIndex:this.userPopupZIndex},(0,r.h)("div",{key:"3fe4e0854429ae1aee59070a7d4def98421843f3",slot:"content-top"},(0,r.h)("slot",{key:"bda85cee26722729c10e07c0ff07e70ab78cd622",name:"content-top"})),(0,r.h)("div",{key:"332a7399eb6a65724b1c730ef187557a72cff42b",slot:"content-end"},(0,r.h)("slot",{key:"b949bbfe91bf66e35c5eaec7e2fb696b091b2fb2",name:"content-end"})),(0,r.h)("div",{key:"39c75c5bf0c15af687c129c91010917bc6893521",slot:"actions-start"},(0,r.h)("slot",{key:"44b999102e2e2081ac5b315ee1301c8049a034f6",name:"actions-start"})),I&&(this.allowSharing?(0,r.h)("arcgis-item-share-summary-editable",{slot:"share-summary",item:o,class:"item-browser-card__access",scale:this.width<h.b.xxs?"s":"m",showText:!1,user:l,allowEdit:!0,groups:null===(i=x.groupSharing)||void 0===i?void 0:i[o.id],userGroups:x.userContentGroups,onClick:e=>{e.stopPropagation(),this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:"share"})}}):(0,r.h)("arcgis-item-share-summary",{slot:"share-summary",item:o,class:"item-browser-card__access",scale:this.width<h.b.xxs?"s":"m",showText:!1,user:l,groups:null===(s=x.groupSharing)||void 0===s?void 0:s[o.id],userGroups:x.userContentGroups})),(0,r.h)("div",{key:"56845793c34b22c7dc6972c80ddc8bb9f48f1404",slot:"actions-end"},(0,r.h)("slot",{key:"eed10dd8829d6c427ae9dd096d40f501a0d0fd59",name:"actions-end"}))))}get el(){return(0,r.a)(this)}};ie.style=":host{display:block;min-width:0px}";const re=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserCardSelect=(0,r.c)(this,"arcgisItemBrowserCardSelect",7),this.arcgisItemBrowserCardSelectError=(0,r.c)(this,"arcgisItemBrowserCardSelectError",7),this.ALERT_ANIMATION=300,this.renderSublayer=e=>{const{item:t,store:i}=this,s=!this.isAllowedGeometry(e.geometryType);return(0,r.h)("calcite-dropdown-item",Object.assign({iconStart:V(e.geometryType),selected:(0,g.i)({item:t,sublayer:e,selectedItems:i.state.selectedItems})},s?{ariaDisabled:!0,tabIndex:-1,className:"dropdown-item-disabled"}:{},{ref:e=>{s&&(e.tabIndex=-1)},onCalciteDropdownItemSelect:t=>{const i=t.currentTarget.selected,{item:r}=this;this.arcgisItemBrowserCardSelect.emit({item:r,sublayer:e,selected:"single"===this.selection||!i})}}),(0,r.h)("span",{class:"title"},e.title))},this.renderTask=e=>{const{item:t,store:i}=this;return(0,r.h)("calcite-dropdown-item",{selected:(0,g.i)({item:t,task:e,selectedItems:i.state.selectedItems}),onCalciteDropdownItemSelect:t=>{const i=t.currentTarget.selected,{item:r}=this;this.arcgisItemBrowserCardSelect.emit({item:r,task:e,selected:"single"===this.selection||!i})}},(0,r.h)("span",{class:"title"},e))},this.isAllowedGeometry=e=>{var t,i,r,s,o,a;return(null===(r=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.allowedGeometries)||void 0===r?void 0:r.includes(e))||!(null===(a=null===(o=null===(s=this.store)||void 0===s?void 0:s.state)||void 0===o?void 0:o.allowedGeometries)||void 0===a?void 0:a.length)},this.sortSublayers=(e,t)=>{const i=this.isAllowedGeometry(e.geometryType);return i===this.isAllowedGeometry(t.geometryType)?t.id-e.id:i?-1:1},this.renderSelectText=e=>{var t,i,r;const{selection:s,item:o,i18n:a}=this;if(this.isTask)return 1===(null==e?void 0:e.length)?null===(t=a.selectedTask)||void 0===t?void 0:t.replace("${task}",e[0].task):a.selectTask;const l="multiple"===s;if(o&&!o.sublayers)return(0,g.i)({item:o,selectedItems:null===(i=this.store)||void 0===i?void 0:i.state.selectedItems})?a.selectedSingle:a.select;if(0===(null==e?void 0:e.length))return l?a.selectLayers:a.select;if(l)return a.selectedLayers.replace("${num}",`${e.length}`);const n=e[0];return a.selectedName.replace("${name}",null===(r=n.sublayer)||void 0===r?void 0:r.title)},this.item=void 0,this.user=void 0,this.portal=void 0,this.width="auto",this.appearance="outline",this.selection=void 0,this.sublayers=void 0,this.tasks=void 0,this.loading=!1,this.fetched=!1,this.alertActive=!1,this.showErrors=!1}clearAlert(){this.closeAlert()}async componentWillLoad(){var e;this.store=(0,v.g)(this.el);const t=await(0,C.g)(this.el);if(this.i18n=null==t?void 0:t.cardSublayerSelect,this.errorBodyText=this.i18n.errorBody,this.sublayers=null===(e=this.item)||void 0===e?void 0:e.sublayers,this.item)if("Geoprocessing Service"!==this.item.type)if(this.item.sublayers)this.sublayers=this.item.sublayers;else{const e=(0,k.i)("serviceInfo",this.item.id);(null==e?void 0:e.result)&&this.processResponse(e)}else this.isTask=!0}async closeAlert(){this.showErrors&&(this.alertActive=!1,await(0,c.t)(this.ALERT_ANIMATION),this.showErrors=!1)}async fetchTasks(){var e;if(this.arcgisItemBrowserCardSelectError.emit(this.item.id),!this.tasks){this.loading=!0;try{const[t]=await(0,T.l)(["esri/request"]),i=await t(this.item.url,{query:{f:"json"}});let r=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.tasks;if(!r&&(null==i?void 0:i.data)&&"parameters"in i.data&&(r=[this.item.url.split("/GPServer/").pop()]),!r)throw new Error;1===(null==r?void 0:r.length)&&(this.arcgisItemBrowserCardSelect.emit({item:this.item,task:r[0],selected:!0}),this.dropdown&&(this.dropdown.open=!1,await(0,c.t)(200))),this.tasks=r}catch(e){await(0,c.t)(this.ALERT_ANIMATION),this.errorBodyText="OAUTH_0070"===e.details.messageCode?this.i18n.notebookErrorBody:this.i18n.errorBody,this.showErrors=!0,await(0,c.t)(this.ALERT_ANIMATION),this.alertActive=!0}this.loading=!1}}processResponse(e){var t;if(null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.sublayers){const t=e.result.sublayers.map(q).sort(this.sortSublayers);this.sublayers=t,this.item.sublayers=t,this.fetched=!0}else e.error&&(this.alertActive=!0)}async attemptLoad(){var e;this.loading=!0,this.alertActive=!1;const t=await(0,k.f)(()=>(0,B.f)({item:this.item,portal:this.portal,layers:null,isSecure:!1,allowLoginWindow:!0}),"serviceInfo",this.item.id);return this.processResponse(t),await(0,c.t)(100),this.dropdown&&(this.dropdown.open=!0),this.loading=!1,!!(null===(e=this.sublayers)||void 0===e?void 0:e.length)}render(){var e,t,i,s;const{store:o,width:a,appearance:l,loading:n,i18n:c,alertActive:d,isTask:h,item:u}=this;if(!o||!u)return null;const p=null==o?void 0:o.state.selectedItems,m=(0,g.f)({item:u,selectedItems:p}),v=(0,g.i)({item:u,selectedItems:p});return(0,r.h)(r.H,null,(null===(e=null==u?void 0:u.sublayers)||void 0===e?void 0:e.length)||h?(0,r.h)("calcite-dropdown",{class:"dropdown",widthScale:"l",placement:"solid"===l?"top":"bottom-end",scale:"m",closeOnSelectDisabled:!h,overlayPositioning:"fixed",ref:e=>this.dropdown=e},(0,r.h)("calcite-button",{loading:n,disabled:n,slot:"trigger",scale:"m",appearance:(null==m?void 0:m.length)||"solid"===l?"solid":"outline",kind:"neutral",iconEnd:"chevron-down",width:a,onClick:()=>{u.typeKeywords.includes("SubtypeGroupLayer")&&!this.fetched&&this.attemptLoad(),h&&!this.tasks&&this.fetchTasks()}},this.renderSelectText(m)),(0,r.h)("calcite-dropdown-group",{selectionMode:this.selection,class:"dropdown-group",groupTitle:!n&&this.isTask&&(null===(t=this.tasks)||void 0===t?void 0:t.length)?c.selectTaskFrom.replace("${title}",u.title):""},h?null===(i=this.tasks)||void 0===i?void 0:i.map(this.renderTask):null===(s=this.sublayers)||void 0===s?void 0:s.sort(this.sortSublayers).map(this.renderSublayer))):(0,r.h)("calcite-button",{loading:n,disabled:n||d,class:"dropdown",slot:"trigger",scale:"m",appearance:(null==m?void 0:m.length)?"solid":"outline",kind:"neutral",width:a,onClick:async()=>{if(this.item&&!this.sublayers&&"Image Service"!==this.item.type&&!this.fetched){if(await this.attemptLoad()||this.alertActive)return}this.arcgisItemBrowserCardSelect.emit({item:u,selected:!v})}},this.renderSelectText(m)),this.showErrors&&(0,r.h)("arcgis-tunnel",{reference:this.el},(0,r.h)("calcite-alert",{label:c.errorTitle,icon:!0,kind:"danger",onCalciteAlertClose:()=>{this.alertActive=!1},open:!!d,tabIndex:d?null:-1,style:{"--calcite-z-index-toast":"999",zIndex:"999"}},(0,r.h)("div",{slot:"title"},c.errorTitle),(0,r.h)("div",{slot:"message",class:"alert__message"},this.errorBodyText),!h&&(0,r.h)("calcite-link",{slot:"link",onClick:async()=>{(0,k.c)("serviceInfo",this.item.id),await this.attemptLoad()}},c.retry))))}get el(){return(0,r.a)(this)}};re.style=".title{max-width:32rem;word-wrap:break-word;word-break:break-word}.dropdown-item-disabled{pointer-events:none;opacity:var(--calcite-opacity-disabled)}.dropdown{display:block}.dropdown-group{max-height:10rem}";const se=class{constructor(e){(0,r.r)(this,e),this.item=void 0,this.user=void 0,this.portal=void 0,this.useProduction=!1}async componentWillLoad(){var e,t;this.store=(0,v.g)(this.el),this.useProduction=await(0,m.i)(this.portal,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket),(0,v.a)(this.store,async()=>{var e,t;this.useProduction=await(0,m.i)(this.portal,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)})}async handlePortalChange(e){var t,i;this.useProduction=await(0,m.i)(e,null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.bucket)}render(){const{item:e,user:t,portal:i,useProduction:s}=this;return(0,r.h)(r.H,{key:"be20290d47943873c04e4c71c0b87e1f3a9fb17e"},(0,r.h)("arcgis-item-thumbnail",{key:"94ec642439b10eab65803baeef32d87828ce2434",item:e,user:t,portal:i,useProduction:s}))}get el(){return(0,r.a)(this)}static get watchers(){return{portal:["handlePortalChange"]}}},oe=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.actionElement=void 0,this.actions=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el)}getColumnCount(e){if("grid"!==this.store.state.view)return 1;const t=this.store.state.filtersEmpty?1:0;switch(!0){case e<h.b.xs:return 1;case e<h.b.sm:case e<h.b.md:return 2;case e<h.b.xl:return 2+t;default:return 3+t}}async focusAction(){var e,t,i,r;null===(t=null===(e=this.actionElement)||void 0===e?void 0:e.focus)||void 0===t||t.call(e),null===(r=null===(i=this.actionElement)||void 0===i?void 0:i.setFocus)||void 0===r||r.call(i)}render(){const e=this.store.state.view,t=this.getColumnCount(this.store.state.width);return(0,r.h)(r.H,{key:"70744d2716b8ba5c024a3f1552da4d312779b8e2"},(0,r.h)("div",{key:"18b62089f60c8c8ff3d8d1ebe4931b9ba3016829",class:{["grid"===e?"grid-container":e]:!0,[`columns-${t}`]:!0,"no-space":this.store.state.width<h.b.xs&&this.store.state.panel}},(0,r.h)("slot",{key:"3d144a5142ae85ba1f847efe5ef4cf23840ef3ce"})))}get el(){return(0,r.a)(this)}};oe.style=":host{--arcgis-item-browser-content-spacing:0.5rem}.grid-container slot,.list slot{display:grid;grid-gap:var(--arcgis-item-browser-content-spacing)}.columns-1 slot{grid-template-columns:repeat(1, 1fr)}.columns-2 slot{grid-template-columns:repeat(2, 1fr)}.columns-3 slot{grid-template-columns:repeat(3, 1fr)}.columns-4 slot{grid-template-columns:repeat(4, 1fr)}.no-space slot{gap:0.25rem}";const ae=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserCategorySchemaUpdate=(0,r.c)(this,"arcgisItemBrowserCategorySchemaUpdate",7),this.arcgisItemBrowserCategoryEditSuccess=(0,r.c)(this,"arcgisItemBrowserCategoryEditSuccess",7),this.arcgisReadOnlyMode=(0,r.c)(this,"arcgisReadOnlyMode",7),this.refetchCategories=async()=>{(null===a.c||void 0===a.c?void 0:a.c.portal)&&await this.fetchCategories(a.c.portal,!1)},this.displayNames={},this.fetchCategories=async(e,t=!1)=>{var i,r,s,o,l,n,c,d,h,u;const p="living atlas"===(null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.bucket),m="group"===(null===(o=null===(s=this.store)||void 0===s?void 0:s.state)||void 0===o?void 0:o.bucket)||!(null===(n=null===(l=this.store)||void 0===l?void 0:l.state)||void 0===n?void 0:n.bucket)&&(null===(d=null===(c=this.store)||void 0===c?void 0:c.state)||void 0===d?void 0:d.groupId),g=this.groupId;if(this.isAllGroups())return this.schema=null,void this.arcgisItemBrowserCategorySchemaUpdate.emit(null);const v=p?await(0,E.a)(e,"LivingAtlas",t):g&&"all"!==g&&m?await(0,E.b)(g,e,t):await(0,E.f)(e,null===a.c||void 0===a.c?void 0:a.c.user,t),b=null===(u=null===(h=null==v?void 0:v.categorySchema)||void 0===h?void 0:h[0])||void 0===u?void 0:u.categories;this.setSchema(b),this.loading=!1},this.setSchema=e=>{this.schema=e,this.arcgisItemBrowserCategorySchemaUpdate.emit(e)},this.renderSchemaEditor=()=>{const{groupId:e,allowEdit:t,isEditing:i,handleEditSchemaComplete:s,setSchema:o,isCategorizingGroup:l}=this,{user:n,portal:c}=a.c;return t?(0,r.h)("arcgis-tunnel",{reference:this.el},(0,r.h)("arcgis-item-category-schema-editor",{isActive:i,group:l()?{id:e}:void 0,user:n,config:a.c.config,portal:c,onWorkflowCancel:async e=>{e.detail?(s(e.detail.hasChangeSinceLastOpen),e.detail.hasChangeSinceLastOpen&&this.arcgisItemBrowserCategoryEditSuccess.emit()):this.isEditing=!1},onNewSchemaWorkflowComplete:async({detail:e})=>{this.isEditing=!1,o(e.newSchema),this.arcgisItemBrowserCategoryEditSuccess.emit()},onDeleteAllSchema:async()=>{s(!0),this.arcgisItemBrowserCategoryEditSuccess.emit()}})):null},this.handleEditSchemaComplete=async e=>{this.isEditing=!1,e&&await this.refetchCategories();const{category:t,schema:i,clearFilter:r,checkSchemaFilterStillValid:s}=this;t&&!s(i,t,A.U)&&r()},this.checkSchemaFilterStillValid=(e,t,i)=>(null!=e?e:[]).some(e=>{var r;const s=(0,A.b)(i,e,!1);return s===t||!!(null===(r=e.categories)||void 0===r?void 0:r.length)&&this.checkSchemaFilterStillValid(e.categories,t,s)}),this.clearFilter=()=>{this.category=null,this.emitFilterEvent()},this.isCategorizingGroup=()=>{var e;const t=null===(e=this.store)||void 0===e?void 0:e.state.bucket,i=this.groupId;return(!t||"group"===t)&&i&&"all"!==i},this.onEditClick=()=>{(null===a.c||void 0===a.c?void 0:a.c.portal.isReadOnly)?this.arcgisReadOnlyMode.emit():this.isEditing=!0},this.category=void 0,this.expanded=void 0,this.groupId=void 0,this.allowEdit=void 0,this.loading=void 0,this.schema=[],this.isEditing=!1,this.canEdit=!1,this.tooltipReferenceElement=void 0}updateCanEdit(){this.checkAllowEdit()}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterCategories,await(0,c.t)(1e3),this.store.state.groupId&&(this.groupId=this.store.state.groupId),(null===a.c||void 0===a.c?void 0:a.c.portal)?(await this.fetchCategories(a.c.portal),await this.checkAllowEdit()):(0,a.o)("portal",e=>{this.fetchCategories(e)}),(0,O.b)(this.store,()=>{this.groupId=this.store.state.groupId,this.fetchCategories(a.c.portal)}),(0,O.a)("categories",this.store,()=>this.category=null),(0,v.a)(this.store,()=>{this.fetchCategories(a.c.portal)})}isAllGroups(){var e,t;const i=this.groupId;return"group"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&(!i||"all"===i)}async checkAllowEdit(){const{allowEdit:e,groupId:t}=this,{user:i,portal:r}=a.c;this.canEdit=!!e&&((!t||"all"!==t)&&await(async({groupId:e,portal:t,user:i})=>{var r;const s=!i,o=(0,f.b)(i),a=(0,f.g)(i),l=(0,f.f)(i),n=!!e,c=n?await(0,P.f)(e,t):null,d=null==c?void 0:c.owner,h=n?await(0,I.f)(d,t):null,u=!o&&i.orgId===(null==h?void 0:h.orgId),p=null===(r=null==c?void 0:c.userMembership)||void 0===r?void 0:r.memberType,m=!s&&("owner"===p||"admin"===p||u&&(0,f.h)(i)),g=!s&&!o&&(l||a&&(0,f.j)(i));return c?m:g})({user:i,portal:r,groupId:t}))}async componentDidLoad(){this.category&&this.emitFilterEvent(),this.store.onChange("bucket",()=>this.refetchCategories()),this.store.onChange("groupId",()=>{this.refetchCategories(),this.checkAllowEdit()})}emitFilterEvent(){const{category:e,i18n:t,displayNames:i}=this,r=e?JSON.stringify([e]):"",s="_none_"===e?t.uncategorized:i[e]||(null==e?void 0:e.replace("/Categories/","")),o=t.category.replace("${category}",s);this.arcgisItemBrowserFilter.emit({id:"categories",param:"categories",value:r,label:o,category:e})}renderNestedCategories(e,t){return e.map(e=>{var i;const s=t?`${t}/${e.title}`:`/Categories/${e.title}`;this.displayNames[s]=e.displayName||e.title;const o=!!(null===(i=e.categories)||void 0===i?void 0:i.length);return(0,r.h)("calcite-tree-item",{"data-value":s,"data-displayName":e.displayName||e.title,"data-children":o,selected:this.category===s,key:`${s}--${o}`},(0,r.h)("a",{class:"filter-tree-link"},(0,r.h)("span",{id:`${s}-toggle`},e.displayName||e.title)),Boolean(e.description)&&(0,r.h)("calcite-tooltip",{referenceElement:`${s}-toggle`,offsetSkidding:16},(0,r.h)("span",{class:"category-tooltip__description"},e.description)),o&&(0,r.h)("calcite-tree",{slot:"children",selectionMode:"children"},this.renderNestedCategories(e.categories,s)))})}render(){var e;const{loading:t,schema:i,allowEdit:s,canEdit:o,i18n:l,renderSchemaEditor:n,groupId:c,isCategorizingGroup:d,onEditClick:h}=this,u=null===(e=this.store)||void 0===e?void 0:e.state.bucket,p=(null==i?void 0:i.length)>0;if(t||!p&&!s||this.isAllGroups()||(0,f.b)(a.c.user)&&"group"!==u)return null;const m=d();return(0,r.h)(r.F,null,(0,r.h)("arcgis-browser-filter",{heading:l[m?"groupCategories":"categories"],expanded:this.expanded,active:!!this.category,filterID:"categories",onArcgisBrowserFilterRemove:()=>{this.category=null}},p?(0,r.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const r=e.target,s=null===(i=null===(t=null==r?void 0:r.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==s?void 0:s.value)||"";this.category===o?this.category=null:this.category=o,this.emitFilterEvent()}},!!c&&(!u||"group"===u)&&(0,r.h)("calcite-tree-item",{"data-value":"_none_",selected:"_none_"===this.category},(0,r.h)("a",null,l.uncategorized)),this.renderNestedCategories(i)):(0,r.h)("div",null,(0,r.h)("h3",{class:"no-category-title"},l[m?"noGroupCategoriesTitle":"noCategoriesTitle"]),(0,r.h)("p",{class:"no-category-description"},l[m?"noGroupCategories":"noCategories"]),o&&(0,r.h)("calcite-button",{class:"add-category-button",appearance:"outline-fill",color:"blue",onClick:h},l[m?"setupGroupCategories":"setupCategories"])),p&&s&&o&&"living atlas"!==u&&(0,r.h)(r.F,null,(0,r.h)("calcite-button",{iconStart:"pencil",appearance:"transparent",kind:"neutral",slot:"action","aria-label":l.configureCategories,onClick:h,ref:e=>this.tooltipReferenceElement=e}),(0,r.h)("calcite-tooltip",{referenceElement:this.tooltipReferenceElement},l.configureCategories))),n())}get el(){return(0,r.a)(this)}static get watchers(){return{allowEdit:["updateCanEdit"]}}};ae.style=".no-category-title{margin-bottom:0.75rem;margin-top:1rem;font-size:1rem;font-weight:400}.no-category-description{overflow-wrap:break-word}.no-category-description:not(:last-child){margin-bottom:1rem;margin-top:0px}.add-category-button{margin-bottom:1rem;max-width:100%;overflow-wrap:break-word}.category-tooltip__description{display:block;width:12rem}";const le=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.loadCollaborations=async()=>{const{portal:e,user:t,config:i,subscriptionInfo:r}=null!==a.c&&void 0!==a.c?a.c:{};!this.collaborations&&e&&t&&!(0,f.b)(t)&&(0,f.k)(i,t,e,r)&&(this.collaborations=await(0,m.j)(a.c.portal),this.collaboration&&this.emitEvent())},this.renderParticipant=(e,t)=>{const[i,s]=Object.entries(e)[0],o=`${t}/${i}`;return(0,r.h)("calcite-tree-item",{"data-id":o,"data-name":s,selected:this.collaboration===t&&this.participant===i||this.collaboration===o},(0,r.h)("a",null,s))},this.renderCollaboration=({collaborationId:e,collaborationName:t,participants:i})=>(0,r.h)("calcite-tree-item",{"data-id":e,"data-name":t,selected:this.collaboration===e&&!this.participant},(0,r.h)("a",null,t),(null==i?void 0:i.length)&&(0,r.h)("calcite-tree",{slot:"children"},(i||[]).map(t=>this.renderParticipant(t,e)))),this.collaboration=void 0,this.participant=void 0,this.collaborationName=void 0,this.expanded=void 0,this.collaborations=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterCollaborations}async componentDidLoad(){this.loadCollaborations(),(0,a.o)("portal",this.loadCollaborations),(0,a.o)("user",this.loadCollaborations),(0,a.o)("subscriptionInfo",this.loadCollaborations),(0,O.a)("collaborations",this.store,()=>this.collaboration=null)}async getEventDetail(){var e,t,i;const{collaboration:r,participant:s,i18n:o}=this;if(!r)return{id:"collaborations",param:"filter",value:"",label:"",collaboration:{id:"",name:""}};this.collaborations||await this.loadCollaborations();const a=null==r?void 0:r.split("__"),l=a[0],n=s||a[1],c=null===(e=this.collaborations)||void 0===e?void 0:e.find(e=>e.collaborationId===l),d=n?null===(i=null===(t=c.participants)||void 0===t?void 0:t.find(e=>e[n]))||void 0===i?void 0:i[n]:c.collaborationName,h=n?`__${n}`:"";return{id:"collaborations",param:"filter",value:"_temp_",label:d?o.label.replace("${name}",d):"",collaboration:{id:r,name:d},additionalParams:{origin:`${r}${h}`}}}async emitEvent(){const e=await this.getEventDetail();this.arcgisItemBrowserFilter.emit(e)}render(){const{config:e,user:t,portal:i,subscriptionInfo:s}=a.c,{collaborations:o}=this;return t&&(0,f.k)(e,t,i,s)&&(null==o?void 0:o.length)?(0,r.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.collaboration,filterID:"collaborations",onArcgisBrowserFilterRemove:()=>{this.collaboration=null}},(0,r.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const r=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],[s,o]=null!==(i=null==r?void 0:r.dataset.id.split("/"))&&void 0!==i?i:[],a=null==r?void 0:r.dataset.name;a&&(this.collaboration!==s||o&&o!==this.participant?(this.collaboration=s,this.collaborationName=a,this.participant=o):(this.collaboration=null,this.collaborationName=null,this.participant=null),this.emitEvent())}},o.map(this.renderCollaboration))):null}get el(){return(0,r.a)(this)}},ne=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.contentStatus=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterContentStatus}componentDidLoad(){this.contentStatus&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,O.a)("contentStatus",this.store,()=>this.contentStatus=null)}getEventDetail(){var e;const{contentStatus:t,i18n:i}=this,{user:r,portal:s}=a.c,o=s&&!s.isPortal?` orgid:${s.id}`:"";return{id:"contentStatus",param:"filter",value:null!==(e={authoritative:r&&!(0,f.b)(r)?`((contentstatus:org_authoritative${o}) OR contentstatus:public_authoritative)`:"contentstatus:public_authoritative",deprecated:"contentstatus:deprecated"}[t])&&void 0!==e?e:"",label:t?i.label.replace("${contentStatus}",i[t]):"",contentStatus:t}}render(){return(0,r.h)("arcgis-browser-filter",{key:"eb6b4799bfdd286a5d460cf7abd8d2eab576a5f9",heading:this.i18n.title,expanded:this.expanded,active:!!this.contentStatus,filterID:"contentStatus",onArcgisBrowserFilterRemove:()=>{this.contentStatus=null}},(0,r.h)("calcite-tree",{key:"2db66f9b3bd94f4b187e3a2de8e7c1a9f11b532f",selectionMode:"single",scale:"m",onCalciteTreeSelect:e=>{var t;const i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],r=null==i?void 0:i.dataset.contentStatus;this.contentStatus===r?this.contentStatus=null:this.contentStatus=r,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},["authoritative","deprecated"].map(e=>(0,r.h)("calcite-tree-item",{"data-content-status":e,selected:e===this.contentStatus},(0,r.h)("a",null,this.i18n[e])))))}get el(){return(0,r.a)(this)}},ce=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.property="modified",this.range=void 0,this.start=void 0,this.end=void 0,this.expanded=void 0}componentWillLoad(){this.store=(0,v.g)(this.el)}getEventDetail(e){return Object.assign({param:"filter"},e)}render(){const{property:e,range:t,start:i,end:s,store:o,expanded:a}=this;return(0,r.h)("arcgis-browser-filter-date",{key:"b06e44323cef2d4ff3af2e02964ce13e20f58c2e",serverProperty:"modified"===e?e:"uploaded",property:this.property,store:o,start:i,end:s,range:t,expanded:a,onArcgisBrowserFilter:e=>{this.arcgisItemBrowserFilter.emit(this.getEventDetail(e.detail))}})}get el(){return(0,r.a)(this)}},de=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.extent=void 0,this.checked=void 0}emitCheckedChange(){this.arcgisItemBrowserFilter.emit(this.getEventDetail())}emitExtentChange(){this.checked&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterExtent}componentDidLoad(){this.extent&&this.checked&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,O.a)("extent",this.store,()=>this.checked=!1)}getEventDetail(){const{extent:e,checked:t,i18n:i}=this;return{id:"extent",param:"bbox",value:t&&e?e:"",label:e&&t?i.label:"",extent:e}}render(){var e,t;return(0,r.h)(r.H,{key:"532c2ffd3e4512d9025b4a3633b667b1fa818989"},(0,r.h)("div",{key:"82d008adb52d1186a36fc66df941c7355f1115b8",class:{"filter-extent":!0,"filter-extent--padded":null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.panel}},(0,r.h)("calcite-label",{key:"6becd18ac41c714e1b2f4c38693f73b2e92eea6b",layout:"inline",class:"filter-extent__wrap"},(0,r.h)("span",{key:"78a59ea4e1dc9217d6e413e8ef96c14a6492fd3c",class:"filter-extent__label"},this.i18n.title),(0,r.h)("calcite-switch",{key:"f1d6472415154e31ba838591529cc077cd39d1f8",class:"filter-extent__switch",checked:this.checked,onCalciteSwitchChange:e=>{this.checked=e.currentTarget.checked}}))))}get el(){return(0,r.a)(this)}static get watchers(){return{checked:["emitCheckedChange"],extent:["emitExtentChange"]}}};de.style=".filter-extent{margin-bottom:0.5rem;display:flex;width:100%}.filter-extent__wrap{width:100%}.filter-extent__label{flex:1 1 0%}.filter-extent__switch{padding-left:0.25rem;padding-right:0.25rem}.filter-extent--padded{box-sizing:border-box;padding-left:0.5rem;padding-right:0.5rem;padding-bottom:0px;padding-top:1rem;margin-bottom:-1px;border-bottom:1px solid var(--calcite-color-border-2)}";const he=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserFolderDelete=(0,r.c)(this,"arcgisItemBrowserFolderDelete",7),this.arcgisItemBrowserFolderDeleteFail=(0,r.c)(this,"arcgisItemBrowserFolderDeleteFail",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.hovered=!1,this.isTitleValid=(e,t)=>{const i=(0,L.g)(e,this.store.state.folders);if(!i)return!0;let r;const s=this.i18n.error;if("invalidCharacters"===i.error){const e=i.invalidCharacters;r=(0,_.a)(this.store.state.lang,s.invalidCharacters,e.length,{invalidCharacters:e.join(", ")})}else r=s[i.error].replace("${folder}",e);return"create"===t?this.createFolderError=r:this.editFolderError=r,!1},this.folder="all",this.showRecycle=void 0,this.allowEdits=void 0,this.expanded=void 0,this.currentEdit=void 0,this.deleteFolderId=void 0,this.createOpen=void 0,this.createClosing=void 0,this.createTitle="",this.deleteOpen=void 0,this.deleteClosing=void 0,this.processing=void 0,this.tooltip=void 0,this.tooltipReferenceElement=void 0,this.deleteItemsModalRef=void 0,this.deleteFolderContent=void 0,this.createFolderError=null,this.tooltipElement=void 0,this.editFolderError=null}async updateFolders(){this.fetchUserFolders(this.user)}navigateToFolder(){var e;(null===(e=this.store.state.folders)||void 0===e?void 0:e.length)&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}async componentWillLoad(){var e;this.store=(0,v.g)(this.el);const t=await(0,C.g)(this.el);this.i18n=null==t?void 0:t.filterFolder,this.user=this.store.state.contentUser||a.c.user,this.specialFolders={all:{id:"all",created:new Date,title:this.store.state.contentUser?this.i18n.allContentUser.replace("${username}",this.user.username):this.i18n.all,username:""},recycle:{created:"now",id:"recycle",title:this.i18n.recycleBin,username:null===(e=this.user)||void 0===e?void 0:e.username}},"recycle"!==this.folder||a.c.portal.recycleBinEnabled||(this.folder="all"),this.user?this.fetchUserFolders(this.user):((0,v.b)(this.store,e=>{this.user=e,this.fetchUserFolders(e)}),(0,a.o)("user",e=>{this.user||(this.fetchUserFolders(e),this.user=e)}))}async componentDidLoad(){var e,t,i,r;if((null===(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.filters)||void 0===i?void 0:i.folder)&&(this.folder=this.store.state.filters.folder.folder),this.folder&&"all"!==this.folder){this.arcgisItemBrowserFilter.emit(this.getEventDetail()),await(0,c.t)(100);const e=Array.from(null===(r=this.el)||void 0===r?void 0:r.querySelectorAll("calcite-list-item")).find(e=>e.dataset.id===this.folder);e&&e.scrollIntoView({block:"center",inline:"nearest",behavior:"smooth"})}(0,O.a)("folder",this.store,()=>this.folder="all")}getEventDetail(){var e;const{user:t}=this,i=this.folder||"all",r=i===t.username?"root":i,s=null===(e=this.store.state.folders)||void 0===e?void 0:e.find(e=>e.id===i),o=(null==s?void 0:s.title)||"";return{id:"folder",param:"filter",value:"all"!==i?`ownerfolder:${r}`:"",label:this.i18n.label.replace("${folder}",o),folder:i,folderData:s}}emitInternalAction(e){this.arcgisItemBrowserInternalUIAction.emit({category:"folder action",action:e})}async refreshFilteredItems(){const e=this.listElement.filterText;e&&(this.listElement.filterText="",await(0,c.t)(10),this.listElement.filterText=e)}resetEdit(){this.inlineEdit=null,this.currentEdit=null,this.editFolderError=null}async resetCreate(){this.createClosing=!0,await(0,c.t)(250),this.createOpen=!1,this.createClosing=!1,this.processing=!1,this.createTitle="",this.createFolderError=null}async resetDelete(){this.deleteClosing=!0,await(0,c.t)(250),this.deleteOpen=!1,this.deleteClosing=!1,this.processing=!1,this.deleteFolderId=""}async setTooltip(e,t,i){i&&(await(0,c.t)(40),!t.matches(`${t.tagName}:hover`))||(this.tooltip=e,this.tooltipReferenceElement=t,requestAnimationFrame(()=>{!this.tooltipElement||i&&!t.matches(`${t.tagName}:hover`)||(this.tooltipElement.open=!0,this.tooltipReferenceElement.addEventListener("mouseout",async()=>{await(0,c.t)(200),this.tooltipReferenceElement===t&&(this.tooltipElement.open=!1)}),this.tooltipReferenceElement.addEventListener("keydown",e=>{"Escape"===e.key&&(this.tooltipElement.open=!1)}))}))}async createFolder(){const{createTitle:e,i18n:t,isTitleValid:i}=this;this.emitInternalAction("create folder"),this.createFolderError=null;if(!i(e,"create"))return;this.processing=!0;const{error:r}=await(0,I.c)(e,this.user);if(r){const i="folderNameExists"===r.code?"folderAlreadyExists":"errorCreatingFolder";return this.createFolderError=t.error[i].replace("${folder}",e).replace("${folderName}",e),void(this.processing=!1)}this.resetCreate(),this.fetchUserFolders(this.user),this.refreshFilteredItems()}async updateFolder(e){const t=this.currentEdit.title,i=await(0,I.u)(e.id,t,this.user);(null==i?void 0:i.error)?this.editFolderError=this.i18n.error.errorCreatingFolder.replace("${folderName}",t):(this.store.state.folders=this.store.state.folders.map(i=>(i.id==e.id&&(i.title=t),i)),this.resetEdit()),this.refreshFilteredItems()}async fetchUserFolders(e){const{specialFolders:t}=this,i=await(0,I.a)(e);this.store.state.folders=[t.all,...i],this.folder&&![...this.store.state.folders,t.recycle].some(e=>e.id===this.folder)&&(this.folder="all",this.arcgisItemBrowserFilter.emit(this.getEventDetail()))}canEditFolder(){var e,t;return!(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.contentUser)||(0,f.f)(null===a.c||void 0===a.c?void 0:a.c.user)&&!(0,f.g)(null===a.c||void 0===a.c?void 0:a.c.user)}renderComboboxItem(e){var t;const{title:i,id:s}=e;return(0,r.h)("calcite-combobox-item",{label:i,value:i,key:s,"data-id":s,heading:i,onCalciteComboboxItemChange:()=>{this.resetEdit(),this.folder=s,this.emitInternalAction("select folder")},icon:(0,L.a)({folderId:s,currentUsername:null===(t=this.user)||void 0===t?void 0:t.username,selectedFolderId:this.folder}),selected:this.folder===s})}renderListItem(e){var t,i;const{i18n:s}=this,{title:o,id:a}=e,l=["all",null===(t=this.user)||void 0===t?void 0:t.username,"recycle"];return(0,r.h)("calcite-list-item",{class:{folder:!0,"recycle-bin":"recycle"===a},label:o,value:o,key:a,"data-id":a,onCalciteListItemSelect:()=>{this.resetEdit(),this.folder=a,this.emitInternalAction("select folder")},selected:this.folder===a},(0,r.h)("calcite-icon",{icon:(0,L.a)({folderId:a,currentUsername:null===(i=this.user)||void 0===i?void 0:i.username,selectedFolderId:this.folder}),class:"folder-icon",slot:"content-start",scale:"s"}),!l.includes(a)&&this.allowEdits&&this.canEditFolder()&&(0,r.h)("calcite-dropdown",{slot:"actions-end",placement:"bottom-end",widthScale:"m",type:"click",overlayPositioning:"fixed",onClick:e=>{e.stopPropagation()}},(0,r.h)("calcite-action",{slot:"trigger",scale:"s",label:s.folderOptions,appearance:"transparent",icon:"ellipsis",text:"",class:"folder-action"}),(0,r.h)("calcite-dropdown-group",{selectionMode:"none"},(0,r.h)("calcite-dropdown-item",{iconStart:"pencil",onCalciteDropdownItemSelect:()=>{this.resetEdit(),this.currentEdit=Object.assign({},e),this.emitInternalAction("edit folder")}},s.editFolder),(0,r.h)("calcite-dropdown-item",{iconStart:"trash",onCalciteDropdownItemSelect:()=>{this.emitInternalAction("delete folder"),this.deleteFolderId=e.id,this.deleteOpen=!0}},s.deleteFolder))))}renderEdit(e){const{i18n:t,isTitleValid:i}=this;return(0,r.h)(r.F,null,(0,r.h)("form",{class:"folder-edit",onSubmit:t=>{var r;t.preventDefault();const s=null===(r=this.currentEdit)||void 0===r?void 0:r.title;(null==s?void 0:s.trim())===e.title&&this.resetEdit(),this.editFolderError=null;i(s,"edit")&&(this.editFolderError=null,this.updateFolder(e))}},(0,r.h)("input",{class:"folder-edit__input",value:e.title,onInput:e=>{this.currentEdit.title=e.target.value},onKeyDown:e=>{if(["Home","End"].includes(e.key)){e.preventDefault();const t=e.target,i=t.value.length,r="Home"===e.key?0:i;t.setSelectionRange(r,r)}["ArrowDown","ArrowUp"].includes(e.key)&&e.stopPropagation(),"Escape"===e.key&&this.resetEdit()},maxLength:124,ref:e=>{!this.inlineEdit&&this.currentEdit&&(this.inlineEdit=e,requestAnimationFrame(()=>{null==e||e.focus()}))}}),(0,r.h)("calcite-icon",{icon:"folder",class:"folder-edit__icon",scale:"s"}),(0,r.h)("calcite-button",{iconStart:"x",label:t.cancel,appearance:"outline",kind:"neutral",scale:"m",onClick:()=>this.resetEdit(),onMouseEnter:e=>{this.setTooltip(t.cancel,e.target,!0)},onFocus:e=>{this.setTooltip(t.cancel,e.target)}}),(0,r.h)("calcite-button",{iconStart:"check",label:t.save,appearance:"solid",kind:"brand",scale:"m",type:"submit",onMouseEnter:e=>{this.setTooltip(t.save,e.target,!0)},onFocus:e=>{this.setTooltip(t.save,e.target)}})),(0,r.h)("calcite-notice",{open:!!this.editFolderError,kind:"danger",scale:"s",closable:!0,onCalciteNoticeClose:()=>{this.editFolderError=null}},(0,r.h)("div",{slot:"message"},this.editFolderError)))}renderCreate(){const{i18n:e,el:t,createFolderError:i}=this;return(0,r.h)("arcgis-tunnel",{reference:t,key:"create-modal"},(0,r.h)("calcite-modal",{open:!this.createClosing,onCalciteModalClose:()=>this.resetCreate(),outsideCloseDisabled:!0,scale:"m",widthScale:"s"},(0,r.h)("h2",{slot:"header",class:"header"},e.createAFolder),(0,r.h)("div",{slot:"content"},(0,r.h)("calcite-label",null,e.folderName,(0,r.h)("calcite-input",{maxLength:124,onCalciteInputInput:e=>{this.createTitle=e.currentTarget.value},onKeyDown:e=>{this.createTitle&&"Enter"===e.key&&(e.preventDefault(),this.createFolder())}})),(0,r.h)("calcite-alert",{icon:!0,label:i,open:!!i,kind:"danger",onCalciteAlertClose:()=>this.createFolderError=null},(0,r.h)("div",{slot:"message"},i))),(0,r.h)("calcite-button",{slot:"secondary",appearance:"outline-fill","data-id":"cancelButton",onClick:()=>this.resetCreate(),width:"full"},e.cancel),(0,r.h)("calcite-button",{slot:"primary",appearance:"solid",kind:"brand",loading:this.processing,onClick:()=>this.createFolder(),width:"full",disabled:!this.createTitle},e.save)))}renderDelete(){var e,t,i,s;const{el:o}=this;return(0,r.h)("arcgis-tunnel",{reference:o,key:"delete-modal"},(0,r.h)("arcgis-delete-folder",{folder:null===(e=this.store.state.folders)||void 0===e?void 0:e.find(e=>e.id===this.deleteFolderId),portal:a.c.portal,user:null!==(s=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.contentUser)&&void 0!==s?s:this.user,active:!this.deleteClosing,onArcgisDeleteFolderClose:async()=>{var e;this.resetDelete(),await this.fetchUserFolders(this.user);(null===(e=this.store.state.folders)||void 0===e?void 0:e.find(e=>e.id===this.folder))||"recycle"===this.folder||(this.folder="all",this.arcgisItemBrowserFilter.emit(this.getEventDetail()))},onArcgisDeleteFolderSuccess:e=>{this.listElement.filterText="",this.arcgisItemBrowserFolderDelete.emit(e.detail)},onArcgisDeleteFolderFail:e=>{this.arcgisItemBrowserFolderDeleteFail.emit(e.detail)}}))}renderPrimary(){const{portal:e}=a.c,{bucket:t,folders:i}=this.store.state,{i18n:s,showRecycle:o}=this,l=!this.user||!i||"my"!==t;return(0,r.h)(r.H,null,(0,r.h)("div",{class:{"primary-filter":!0},style:{display:l?"none":"block"}},(0,r.h)("calcite-combobox",{label:s.folders,clearDisabled:!0,selectionMode:"single-persist",disabled:!i},(i||[]).map(e=>this.renderComboboxItem(e)),o&&!(0,f.b)(this.user)&&!(null==e?void 0:e.isPortal)&&this.renderComboboxItem(this.specialFolders.recycle))))}render(){var e,t;const{portal:i}=a.c,{bucket:s,folders:o}=this.store.state,{i18n:l,deleteOpen:n,createOpen:c,tooltip:d,tooltipReferenceElement:h,showRecycle:u}=this;if("primary-filter"===(null===(e=this.el)||void 0===e?void 0:e.getAttribute("slot")))return this.renderPrimary();const p=!this.user||!o||"my"!==s;return(0,r.h)(r.H,null,(0,r.h)("arcgis-browser-filter",{heading:l.folders,expanded:this.expanded,noPadding:!0,class:{hide:p},onMouseOver:()=>{this.hovered=!0},onMouseOut:()=>{this.hovered=!1},primary:"primary"===this.el.getAttribute("slot")},(0,r.h)("calcite-list",{filterEnabled:!0,label:l.folders,selectionAppearance:"border",selectionMode:"single-persist",loading:!o,class:{folders:!0,"folders--recycle":u},filterPlaceholder:l.placeholder,onCalciteListFilter:()=>{this.emitInternalAction("search folder")},onFocus:()=>{this.currentEdit=null}},(o||[]).map(e=>{var t;return this.currentEdit&&(null===(t=this.currentEdit)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)?this.renderEdit(e):this.renderListItem(e)}),u&&!(0,f.b)(this.user)&&!(null==i?void 0:i.isPortal)&&this.renderListItem(this.specialFolders.recycle)),this.allowEdits&&this.canEditFolder()&&(0,r.h)("calcite-button",{id:"create-folder-button",iconStart:"folder-plus",appearance:"transparent",kind:"neutral",slot:"action",onClick:()=>{this.createOpen=!0},onMouseEnter:async e=>{this.setTooltip(l.createFolder,e.target,!0)},onFocus:e=>{this.setTooltip(l.createFolder,e.target)}})),c&&this.renderCreate(),n&&this.renderDelete(),!!d&&h&&(0,r.h)("calcite-tooltip",{overlayPositioning:(null===(t=this.store.state)||void 0===t?void 0:t.panel)?"absolute":"fixed",referenceElement:this.tooltipReferenceElement,placement:"bottom-end",ref:e=>{this.tooltipElement||(this.tooltipElement=e,e.open=!0)}},d))}get el(){return(0,r.a)(this)}static get watchers(){return{folder:["navigateToFolder"]}}};he.style=".hide.sc-arcgis-item-browser-filter-folder{display:none}.folders.sc-arcgis-item-browser-filter-folder{max-height:28rem;min-height:4rem;position:relative;overflow:auto;--calcite-color-foreground-1:var(--calcite-color-background);--calcite-font-size--1:var(--calcite-font-size--2);border-bottom:1px solid var(--calcite-color-border-2)}.folders--recycle.sc-arcgis-item-browser-filter-folder{border-bottom:none;border-bottom-width:0px}.folder-action.sc-arcgis-item-browser-filter-folder{opacity:0;margin:2px}.folder-icon.sc-arcgis-item-browser-filter-folder{margin-inline-end:0px;margin-inline-start:0.5rem}.folder.sc-arcgis-item-browser-filter-folder:hover .folder-action.sc-arcgis-item-browser-filter-folder,.folder.sc-arcgis-item-browser-filter-folder:focus-within .folder-action.sc-arcgis-item-browser-filter-folder{opacity:1}.folders.sc-arcgis-item-browser-filter-folder calcite-list-item.sc-arcgis-item-browser-filter-folder calcite-dropdown.sc-arcgis-item-browser-filter-folder,.folders.sc-arcgis-item-browser-filter-folder calcite-list-item[selected].sc-arcgis-item-browser-filter-folder,.folders.sc-arcgis-item-browser-filter-folder calcite-notice.sc-arcgis-item-browser-filter-folder{--calcite-color-foreground-1:var(--calcite-color-text-inverse)}.recycle-bin.sc-arcgis-item-browser-filter-folder{position:sticky;bottom:0px;margin-top:-1px;border-top:1px solid var(--calcite-color-border-2)}.tooltip.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px}.folder-edit.sc-arcgis-item-browser-filter-folder{position:relative;margin-top:-1px;display:flex}.folder-edit__input.sc-arcgis-item-browser-filter-folder{position:relative;z-index:0;box-sizing:border-box;display:block;height:2.5rem;width:100%;border-style:none;padding-top:1rem;padding-bottom:1rem;padding-inline-end:0.5rem;padding-inline-start:2.5rem;font-size:0.75rem;color:var(--calcite-color-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;outline-color:transparent;border:1px solid var(--calcite-color-border-1);margin-inline-end:-1px;background-color:transparent;font-family:inherit}.folder-edit__input.sc-arcgis-item-browser-filter-folder:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.folder-edit__icon.sc-arcgis-item-browser-filter-folder{position:absolute;inset:0px;margin-top:0.75rem;margin-bottom:0.75rem;margin-inline-start:0.75rem}.header.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;font-size:1.25rem;font-weight:400;color:var(--calcite-color-text-1)}.headline.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;padding-bottom:0.5rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.description.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-2)}.primary-filter.sc-arcgis-item-browser-filter-folder{background-color:var(--calcite-color-foreground-2);padding:1rem}";const ue=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserGroupFetched=(0,r.c)(this,"arcgisItemBrowserGroupFetched",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.group="all",this.allowEdits=void 0,this.expanded=void 0,this.groups=[]}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterGroup,this.group&&"all"!==this.group&&(this.store.state.groupId=this.group),a.c.user&&a.c.portal?this.fetchUserGroups():((0,a.o)("user",()=>this.fetchUserGroups()),(0,a.o)("portal",()=>this.fetchUserGroups())),(0,v.a)(this.store,e=>{var t;"group"===e&&(null===(t=this.groups)||void 0===t?void 0:t.length)>m.M&&("all"===this.group&&(this.group=this.groups[0].id),this.arcgisItemBrowserFilter.emit(this.getEventDetail()))})}componentDidLoad(){this.expanded&&this.accordionItem&&(this.accordionItem.expanded=!0),(0,O.a)("group",this.store,()=>this.group="all")}getEventDetail(){var e,t;const{group:i}=this,r=null===(e=this.groups)||void 0===e?void 0:e.find(e=>e.id===i),s=(null==r?void 0:r.title)||"";return{id:"group",param:"filter",value:"all"!==i?`group:${i}`:`group:(${null===(t=this.groups)||void 0===t?void 0:t.map(({id:e})=>e).join(" OR ")})`,label:this.i18n.label.replace("${group}",s),group:i}}async fetchUserGroups(){var e,t,i,r;if(a.c.user&&a.c.portal){const s=await(0,I.h)(a.c.user,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.lang);this.arcgisItemBrowserGroupFetched.emit(s.map(e=>e.id));const o=s.length>m.M;o&&"all"===this.group&&(this.group=s[0].id),this.groups=[...o?[]:[{id:"all",title:this.i18n.all}],...s],"group"===(null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.bucket)&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}}renderPrimary(){const{user:e}=a.c,t=this.store.state.bucket,{i18n:i,groups:s}=this,o=!e||!s||"group"!==t;return(0,r.h)(r.H,null,(0,r.h)("div",{class:{"primary-filter":!0},style:{display:o?"none":"block"}},(0,r.h)("calcite-combobox",{label:i.groups,clearDisabled:!0,selectionMode:"single-persist",disabled:!s},null==s?void 0:s.map(e=>(0,r.h)("calcite-combobox-item",{class:"group",heading:e.title,label:e.title,value:e.id,key:e.id,onCalciteComboboxItemChange:()=>{this.group=e.id,this.store.state.groupId=e.id,this.arcgisItemBrowserFilter.emit(this.getEventDetail()),this.arcgisItemBrowserInternalUIAction.emit({category:"group action",action:"select group"})},selected:this.group===e.id},"all"===e.id?(0,r.h)("span",{class:"group-thumbnail",slot:"content-start"},(0,r.h)("calcite-icon",{icon:"users",scale:"s"})):(0,r.h)("arcgis-group-thumbnail",{slot:"content-start",class:"group-thumbnail",group:e,portal:a.c.portal,tooltip:!1,scale:"s"}))))))}render(){var e;const t=null===(e=this.el)||void 0===e?void 0:e.getAttribute("slot");if("primary-filter"===t)return this.renderPrimary();const{user:i}=a.c,s=this.store.state.bucket,{i18n:o,groups:l}=this,n=!i||!l||"group"!==s;return(0,r.h)(r.H,null,(0,r.h)("arcgis-browser-filter",{heading:o.groups,expanded:this.expanded,noPadding:!0,class:{hide:n},primary:"primary"===t},(0,r.h)("calcite-list",{filterEnabled:!0,label:o.groups,selectionAppearance:"border",selectionMode:"single-persist",loading:!l,class:"groups",onCalciteListFilter:()=>{this.arcgisItemBrowserInternalUIAction.emit({category:"group action",action:"search group"})}},null==l?void 0:l.map(e=>(0,r.h)("calcite-list-item",{class:"group",label:e.title,value:e.id,key:e.id,onCalciteListItemSelect:()=>{this.group=e.id,this.store.state.groupId=e.id,this.arcgisItemBrowserFilter.emit(this.getEventDetail()),this.arcgisItemBrowserInternalUIAction.emit({category:"group action",action:"select group"})},selected:this.group===e.id},"all"===e.id?(0,r.h)("span",{class:"group-thumbnail",slot:"content-start"},(0,r.h)("calcite-icon",{icon:"users",scale:"s"})):(0,r.h)("arcgis-group-thumbnail",{slot:"content-start",class:"group-thumbnail",group:e,portal:a.c.portal,tooltip:!1,scale:"s"}))))))}get el(){return(0,r.a)(this)}};ue.style=".hide.sc-arcgis-item-browser-filter-group{display:none}.groups.sc-arcgis-item-browser-filter-group{max-height:16.5rem;min-height:4rem;position:relative;z-index:0;overflow:auto;--calcite-color-foreground-1:var(--calcite-color-background);--calcite-font-size--1:var(--calcite-font-size--2);border-bottom:1px solid var(--calcite-color-border-2)}.groups.sc-arcgis-item-browser-filter-group calcite-list-item.sc-arcgis-item-browser-filter-group calcite-dropdown.sc-arcgis-item-browser-filter-group{--calcite-color-foreground-1:var(--calcite-color-text-inverse)}.groups.sc-arcgis-item-browser-filter-group calcite-list-item[selected].sc-arcgis-item-browser-filter-group{--calcite-color-foreground-1:var(--calcite-color-text-inverse)}.group-thumbnail.sc-arcgis-item-browser-filter-group{margin-inline-end:0.5rem;display:flex;height:1.5rem;width:1.5rem;align-items:center;justify-content:center;min-width:1.5rem}.primary-filter.sc-arcgis-item-browser-filter-group{background-color:var(--calcite-color-foreground-2);padding:1rem}";const pe=["Agriculture","Electric Utilities","Environment","Forestry","Gas Utilities","General","Natural Resources","Petroleum","Public Safety","Telecommunications","Transportation","Water Utilities"],me=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.industry=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterIndustry}async componentDidLoad(){this.industry&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,O.a)("industry",this.store,()=>this.industry=null)}getEventDetail(){const{industry:e}=this;return{id:"industry",param:"filter",value:e?`typekeywords: "${e}"`:"",label:this.i18n.Industry.replace("${industry}",this.i18n[e]),industry:e}}render(){return(0,r.h)("arcgis-browser-filter",{key:"c61eae8b8af2b53b102113138c21a4c1cf4177a0",heading:this.i18n.title,expanded:this.expanded,active:!!this.industry,filterID:"industry",onArcgisBrowserFilterRemove:()=>{this.industry=null}},(0,r.h)("calcite-tree",{key:"e48085afe27782a021b6d27bd41664b04d5c9020",selectionMode:"single",scale:"s",onCalciteTreeSelect:e=>{var t,i;const r=(null===(i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset.industry)||"";this.industry===r?this.industry=null:this.industry=r,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},pe.map(e=>(0,r.h)("calcite-tree-item",{"data-industry":e,selected:e===this.industry},(0,r.h)("a",null,this.i18n[e])))))}get el(){return(0,r.a)(this)}},ge=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.renderItemType=([e,t])=>{const{itemType:i,allowedItemTypes:s}=this,o=!(null==s?void 0:s.includes(e)),l=s&&o&&t.children&&Object.keys(t.children).some(e=>s.includes(e));return o&&!l||t.show&&!t.show({portal:a.c.portal,subscriptionInfo:a.c.subscriptionInfo,portalConfigProperties:this.portalConfigProperties,user:a.c.user,userLicensedItems:a.c.userLicensedItems})?null:o&&l?(0,r.h)(r.F,null,Object.entries(t.children).map(this.renderItemType)):(0,r.h)("calcite-tree-item",{"data-item-type":e,"data-children":!!t.children,selected:e===i},(0,r.h)("a",null,P.a[e]),t.children&&(0,r.h)("calcite-tree",{slot:"children",selectionMode:"children"},Object.entries(t.children).map(this.renderItemType)))},this.itemType=void 0,this.allowedItemTypes=P.d,this.expanded=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterItemType,this.portalConfigProperties=(await(0,y.e)(a.c.portal)).portalConfigProperties}componentDidLoad(){var e;if(this.itemType){this.arcgisItemBrowserFilter.emit(this.getEventDetail());let t=null===(e=this.el)||void 0===e?void 0:e.querySelector(`calcite-tree-item[data-item-type="${this.itemType}"]`);for(;t;)t.expanded=!0,t=t.parentElement.closest("calcite-tree-item"),(null==t?void 0:t.closest("arcgis-item-browser-filter-item-type"))||(t=null)}(0,O.a)("itemType",this.store,()=>this.itemType=null)}getEventDetail(){const{itemType:e}=this,t=(0,P.g)(e);return{id:"itemType",param:"filter",value:(null==t?void 0:t.q)?`(${t.q})`:"",label:t?this.i18n.itemType.replace("${itemType}",P.a[e]):"",itemType:e}}render(){return(0,r.h)("arcgis-browser-filter",{key:"548124e25627e74e5a7bfc9c6c2fcd363f36b5fd",heading:this.i18n.title,expanded:this.expanded,active:!!this.itemType,filterID:"itemType",onArcgisBrowserFilterRemove:()=>{this.itemType=null}},(0,r.h)("calcite-tree",{key:"8878171455786875091c358df1a0bbf9ff59c6da",selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const r=e.target,s=null===(i=null===(t=null==r?void 0:r.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==s?void 0:s.itemType)||"";this.itemType===o?this.itemType=null:this.itemType=o,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},Object.entries(P.i).map(this.renderItemType)))}get el(){return(0,r.a)(this)}};function ve(e){return!(!(e.singleLineFieldName||(0,D.i)(e.url)||e.enableSuggestions)||!e.placefinding)}function be(e,t,i,r){var s;const o=null!==(s=null==t?void 0:t.geocodeAutoComplete)&&void 0!==s&&s,a=function(e,t,i){var r;let s=[...(e.helperServices||{}).geocode||[]];const o=null!==(r=t.geocodeAutoComplete)&&void 0!==r&&r;return s.filter(ve).map(e=>{const t=!(!0!==e.suggest||!o),r=(0,D.i)(e.url);return Object.assign(Object.assign({},e),{name:r?"ArcGIS World Geocoding Service":e.name,enableSuggestions:t,categories:r?["Populated Place","Coordinate System"]:null,placefinding:!!r||e.placefinding,outFields:r?["Match_addr","Addr_type","StAddr","City"]:null,placeholder:e.placeholder||i.findLocationText,singleLineFieldName:e.singleLineFieldName||"SingleLine",highlightSymbol:null,localSearchOptions:{minScale:3e5,distance:5e4}})})}(e,t,i),l={suggestionsEnabled:o,minSuggestCharacters:3,maxResults:5,searchTerm:r||null,activeSourceIndex:"all",sources:[].concat(a),popupEnabled:!1,portal:e};return 1===l.sources.length&&delete l.activeSourceIndex,l}const fe=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserSort=(0,r.c)(this,"arcgisItemBrowserSort",7),this.suggest=e=>{this.loadingSuggestions=!0,(null==e?void 0:e.length)>2?this.searchViewModel.suggest(e):(this.loadingSuggestions=!1,this.suggestions=[])},this.debouncedSuggest=(0,c.f)(this.suggest.bind(this),1e3),this.updateSuggest=e=>{(null==e?void 0:e.length)>2&&(this.loadingSuggestions=!0),this.debouncedSuggest(e)},this.location=void 0,this.extent=void 0,this.expanded=void 0,this.loading=void 0,this.searching=void 0,this.suggestions=[],this.loadingSuggestions=void 0,this.searchTerm=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterLocation,(0,O.a)("location",this.store,()=>{var e;this.location=null,this.extent=null,null===(e=this.searchViewModel)||void 0===e||e.clear(),this.searchTerm=""})}async componentDidLoad(){this.location&&this.extent&&(this.searchTerm=this.location,this.emitFilterEvent()),(null===a.c||void 0===a.c?void 0:a.c.portal)?this.setupSearch():(0,a.o)("portal",()=>{this.setupSearch()})}async setupSearch(){const e=be(a.c.portal,a.c.config,this.i18n,this.location),[t]=await(0,T.l)(["esri/widgets/Search/SearchViewModel"]);this.searchViewModel=new t(Object.assign(Object.assign({},e),{allPlaceholder:this.i18n.findLocationText,showInfoWindowOnSelect:!1})),this.searchViewModel.on("suggest-start",()=>{this.loadingSuggestions=!0}),this.searchViewModel.on("suggest-complete",async e=>{this.suggestions=[...e.results],this.loadingSuggestions=!1}),this.searchViewModel.on("search-start",()=>{this.loadingSuggestions=!1,this.searching=!0,this.suggestPopover.open=!1}),this.searchViewModel.on("search-complete",()=>{this.searching=!1}),this.searchViewModel.on("select-result",this.handleLocationChange.bind(this)),this.searchViewModel.on("search-clear",()=>{this.extent&&this.location&&(this.location=null,this.extent=null,this.emitFilterEvent())})}handleLocationChange(e){this.location=e.result.name;const t=e.result.extent;this.extent=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`,this.emitFilterEvent()}emitFilterEvent(){const{location:e,extent:t}=this,i=this.i18n.label.replace("${location}",e);this.arcgisItemBrowserFilter.emit({id:"location",param:"bbox",value:null!=t?t:"",label:i,location:e,extent:t}),t&&this.arcgisItemBrowserSort.emit({sortField:"relevance",sortOrder:"desc"})}handleSuggestSelect(e){var t;this.searchViewModel.search(e),this.searchTerm=e.text,null===(t=this.input)||void 0===t||t.setFocus()}hasResults(){var e;return null===(e=this.suggestions)||void 0===e?void 0:e.some(e=>{var t;return null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.length})}renderSuggestions(e){var t;return null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.map(e=>(0,r.h)("calcite-list-item",{class:"location-filter__suggestion",key:e.key,label:e.text,onClick:()=>this.handleSuggestSelect(e),onCalciteListItemSelect:()=>this.handleSuggestSelect(e)}))}render(){var e,t;return 3===(null===a.c||void 0===a.c?void 0:a.c.api)?null:(0,r.h)("arcgis-browser-filter",{heading:this.i18n.location,expanded:this.expanded,active:!!this.location,filterID:"location",onArcgisBrowserFilterRemove:()=>{this.location=null,this.extent=null}},(0,r.h)("div",{class:"location-filter__container"},(0,r.h)("calcite-input",{loading:this.searching||this.loadingSuggestions,type:"text",value:this.searchTerm,"aria-label":this.i18n.findLocationText,placeholder:this.i18n.findLocationText,scale:"m",class:"location-filter__input",ref:e=>this.input=e,clearable:!0,onKeyPress:e=>{const t=e.target.value;if("Enter"===e.key&&e.target===e.currentTarget)return this.searchTerm=t,void this.searchViewModel.suggest(t)},onKeyDown:e=>{var t,i;"ArrowDown"===e.key&&!this.loadingSuggestions&&(null===(t=this.suggestions)||void 0===t?void 0:t.length)&&(e.preventDefault(),e.stopPropagation(),null===(i=this.el.querySelector("calcite-list-item"))||void 0===i||i.setFocus())},onCalciteInputInput:e=>{const t=e.currentTarget.value;this.searchTerm=t,this.updateSuggest(t)}},(0,r.h)("calcite-button",{class:"location-filter__button",label:"search",slot:"action",kind:"neutral",appearance:"outline-fill",iconStart:"search",scale:"m",ref:e=>this.searchButton=e,onClick:()=>{this.suggest(this.searchTerm)},onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||this.suggest(this.searchTerm)},disabled:!this.searchTerm})),!this.loadingSuggestions&&(null===(e=this.searchTerm)||void 0===e?void 0:e.length)>2&&(0,r.h)("calcite-popover",{label:this.i18n.suggestions,referenceElement:this.searchButton,ref:e=>this.suggestPopover=e,autoClose:!0,pointerDisabled:!0,offsetDistance:0,overlayPositioning:"fixed",open:!0,placement:"bottom-end",flipPlacements:["top-end"]},this.hasResults()?(0,r.h)("calcite-list",{key:this.searchTerm,class:"location-filter__suggestions",label:this.i18n.suggestions},null===(t=this.suggestions)||void 0===t?void 0:t.map(e=>this.renderSuggestions(e))):(0,r.h)("div",{class:"location-filter__suggestions"},(0,r.h)("p",{class:"location-filter__no-results"},this.i18n.noResults.replace("${searchTerm}",this.searchTerm))))))}get el(){return(0,r.a)(this)}};fe.style=".location-filter__container{box-sizing:border-box;display:flex;width:100%}.location-filter__input{flex:1 1 0%;--calcite-color-border-input:var(--calcite-color-border-3)}.location-filter__button{margin-inline-start:-1px}.location-filter__suggestions{box-sizing:border-box;height:8rem;overflow-y:auto;border-top:1px solid var(--calcite-color-border-1);border-bottom:1px solid var(--calcite-color-border-1);width:calc(var(--item-browser-pane-width) - 2.5rem)}.location-filter__no-results{margin-top:3rem;margin-bottom:0px;padding-top:0.5rem;padding-bottom:0px;text-align:center;color:var(--calcite-color-text-3)}";const ye=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.regions=[],this.region=void 0,this.expanded=void 0,this.loading=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterRegion,(null===a.c||void 0===a.c?void 0:a.c.portal)?this.fetchRegions(a.c.portal):(0,a.o)("portal",e=>this.fetchRegions(e)),(0,O.a)("region",this.store,()=>this.region=null)}async fetchRegions(e){this.regions=await async function(e){const t=(0,S.b)(e);return(0,k.r)(`${(0,S.g)(e)}portals/regions`,{culture:t})}(e),this.loading=!1}async componentDidLoad(){this.region&&this.emitFilterEvent()}emitFilterEvent(){var e;const{region:t,i18n:i}=this,r=t?`/region/${t.toLowerCase()}`:"",s=t?JSON.stringify([r]):"",o=null===(e=this.regions)||void 0===e?void 0:e.find(e=>e.region===t),a=i.region.replace("${region}",(null==o?void 0:o.localizedName)||(null==o?void 0:o.name)||"");this.arcgisItemBrowserFilter.emit({id:"region",param:"categories",categoryValue:r,value:s,label:a,region:t})}render(){var e,t;const{loading:i,regions:s,store:o}=this;return i||!(null==s?void 0:s.length)||"living atlas"!==(null===(e=o.state)||void 0===e?void 0:e.bucket)||(null===(t=null===a.c||void 0===a.c?void 0:a.c.portal)||void 0===t?void 0:t.isPortal)?null:(0,r.h)("arcgis-browser-filter",{heading:this.i18n.regions,expanded:this.expanded,active:!!this.region,filterID:"region",onArcgisBrowserFilterRemove:()=>{this.region=null}},(0,r.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const r=e.target,s=null===(i=null===(t=null==r?void 0:r.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==s?void 0:s.value)||"";this.region===o?this.region=null:this.region=o,this.emitFilterEvent()}},s.map(({name:e,region:t,localizedName:i})=>(0,r.h)("calcite-tree-item",{"data-value":t,selected:this.region===t},(0,r.h)("a",null,i||e)))))}get el(){return(0,r.a)(this)}},we=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.filterLevel=e=>"account"!==e||!(0,f.b)(a.c.user),this.sharingLevels=[["owner",["private","shared"]],"account","public"],this.renderLevel=e=>{const[t,i]=Array.isArray(e)?e:[e];return(0,r.h)("calcite-tree-item",{"data-sharing":t,selected:(null==i?void 0:i.includes(this.sharing))||t===this.sharing},(0,r.h)("a",null,this.i18n[t]),i&&(0,r.h)("calcite-tree",{slot:"children",selectionMode:"children"},i.map(this.renderLevel)))},this.sharing=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterSharing}componentDidLoad(){this.sharing&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,O.a)("sharing",this.store,()=>this.sharing=null)}getEventDetail(){const{sharing:e,i18n:t}=this;return{id:"sharing",param:"filter",value:e?"owner"===e?"access:(private OR shared)":`access: ${e}`:"",label:e?t.label.replace("${sharing}",t[e]):"",sharing:e}}render(){var e,t;return"all"!==(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&a.c.user?(0,r.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.sharing,filterID:"sharing",onArcgisBrowserFilterRemove:()=>{this.sharing=null}},(0,r.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t;const i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],r=null==i?void 0:i.dataset.sharing;this.sharing===r?this.sharing=null:this.sharing=r,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},this.sharingLevels.filter(this.filterLevel).map(e=>this.renderLevel(e)))):null}get el(){return(0,r.a)(this)}},Ie=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserFilter=(0,r.c)(this,"arcgisItemBrowserFilter",7),this.deselectAllTags=()=>{this.tags=[],this.el.querySelectorAll("calcite-combobox-item[selected]").forEach(e=>{e.selected=!1})},this.tags=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.filterTags}async componentDidLoad(){this.tags&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,O.a)("tags",this.store,()=>{this.tags=null,this.deselectAllTags()})}getEventDetail(){const{tags:e}=this,t=(null==e?void 0:e.length)?`tags:(${e.map(e=>`"${e}"`).join(" OR ")})`:"",i=(null==e?void 0:e.length)?this.i18n.label.replace("${tags}",e.join(", ")):"";return{id:"tags",param:"filter",value:t,tags:e,label:i}}componentDidRender(){const e=this.el.querySelectorAll("calcite-combobox-item"),t=[];e.forEach(e=>{t.includes(e.value)?e.parentElement.removeChild(e):t.push(e.value)})}render(){var e;const{i18n:t}=this,i=this.store.state.knownTags||[];return(0,r.h)("arcgis-browser-filter",{key:"3843adf3b3b8ba3607caeea67e8343407abb28e7",heading:t.title,expanded:this.expanded,active:!!(null===(e=this.tags)||void 0===e?void 0:e.length),onArcgisBrowserFilterRemove:()=>{this.deselectAllTags(),this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},(0,r.h)("calcite-combobox",{key:"0a9c5e4ee9a710627d815bd07e2396cf6d7bb982",class:"item-browser-tags-filter",label:t.title,overlayPositioning:"fixed",placeholder:t.selectTags,scale:"s",maxItems:5,allowCustomValues:!0,clearDisabled:!0,onCalciteComboboxChange:e=>{var t;this.tags=null===(t=e.target.selectedItems)||void 0===t?void 0:t.map(e=>e.value),this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},i.map(e=>{var t;return(0,r.h)("calcite-combobox-item",{key:e,value:e,textLabel:e,selected:null===(t=this.tags)||void 0===t?void 0:t.includes(e)})})))}get el(){return(0,r.a)(this)}};Ie.style=".item-browser-tags-filter calcite-combobox-item{max-width:var(--tag-item-max-width)}";const ke=class{constructor(e){(0,r.r)(this,e)}async componentWillLoad(){this.store=(0,v.g)(this.el)}render(){var e,t,i,s,o,a,l,n;return(0,r.h)("arcgis-browser-filters",{key:"71bfd6dcf509c74d7cc02b15c08eda7a99110287",store:this.store,style:"subscription content"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)?{display:"none"}:{}},(0,r.h)("div",{key:"fcef3f5e7a0394fc931a07cc57ce3669d594ec90",slot:"top"},(0,r.h)("slot",{key:"7d7c7eea0f73e59f04ca7f376a92fed4f070f593",name:"top"})),(0,r.h)("div",{key:"07f01aee2f00bfc4584fac7c812df1bddfaf153d",slot:"primary",class:"primary"},(0,r.h)("slot",{key:"6016461db5a8c84976daf8a3d35e2fcf3054b28d",name:"primary"})),(0,r.h)("div",{key:"d3b111d85b1e8fe8b9d73b7064215e6da3487fc8",slot:"title"},!(null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.recycleBin)&&(0,r.h)("h2",{key:"c86e4b036632eb622662790d4351c211edacb2ad",class:"title"},(null===(n=null===(l=null===(a=null===(o=this.store)||void 0===o?void 0:o.state)||void 0===a?void 0:a.i18n)||void 0===l?void 0:l.itemBrowser)||void 0===n?void 0:n.filters)||""),(0,r.h)("slot",{key:"152187d19ca70430f171552a43a0819a99cb6758",name:"before-filters"})),(0,r.h)("slot",{key:"dff4c36b51eeb1efb11148f31f7c1b45169ad42d"}),(0,r.h)("div",{key:"aa5be7617202733eb76e26bff69503044ae9885b",slot:"bottom"},(0,r.h)("slot",{key:"59bfd0ff5bef154800aa4800d3dec7c695f4976f",name:"bottom"})))}get el(){return(0,r.a)(this)}};ke.style=".title{margin:0px;padding-left:0.5rem;padding-right:0.5rem;padding-top:1rem;padding-bottom:1rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1);line-height:1;margin-bottom:-1px;border-bottom:1px solid var(--calcite-color-border-2)}.primary{position:relative;z-index:10}";const Se=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserPage=(0,r.c)(this,"arcgisItemBrowserPage",7),this.total=void 0,this.start=void 0,this.num=60}async nextPage(){this.paginationRef.nextPage()}async componentWillLoad(){this.store=(0,v.g)(this.el);const{start:e,total:t,num:i}=this;this.arcgisItemBrowserPage.emit({start:e,total:t,num:i})}render(){const{start:e,total:t,num:i,store:s}=this;return(0,r.h)("arcgis-browser-pagination",{key:"bf87f4f5cc793cfe39e8bb7dd59f5fdb2d596d70",ref:e=>this.paginationRef=e,start:e,total:t,num:i,store:s,onArcgisBrowserPage:e=>this.arcgisItemBrowserPage.emit(e.detail)})}get el(){return(0,r.a)(this)}},xe=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserPreviewClose=(0,r.c)(this,"arcgisItemBrowserPreviewClose",7),this.arcgisInternalItemBrowserSublayer=(0,r.c)(this,"arcgisInternalItemBrowserSublayer",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.arcgisItemBrowserCardSelectError=(0,r.c)(this,"arcgisItemBrowserCardSelectError",7),this.checkForExternalLink=e=>{var t,i;const r=e.target;if(!r.href)return;new URL(r.href).host!==window.location.host&&(r.href.includes("arcgis.com")||r.href.includes("esri.com")||null===(i=(t=this.store.state).externalLinkHandler)||void 0===i||i.call(t,e))},this.sortSublayers=(e,t)=>{const i=this.layerMatches(e);return i===this.layerMatches(t)?t.id-e.id:i?-1:1},this.layerMatches=e=>{var t,i,r,s,o;return null===(o=null===(s=null===(r=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.highlights)||void 0===r?void 0:r[this.item.id])||void 0===s?void 0:s.sublayers)||void 0===o?void 0:o.includes(e.id)},this.renderField=e=>{if("OBJECTID"!==e.name)return(0,r.h)("arcgis-item-browser-preview-field-details",{field:e,item:this.item,sublayer:this.sublayer,api:a.c.api,showFieldStatistics:this.store.state.showFieldStatistics})},this.handleLayerClick=e=>{this.sublayer=e,this.fetchSublayer(),this.arcgisItemBrowserInternalUIAction.emit({action:"click",category:"panel action",details:"sublayer"}),this.arcgisInternalItemBrowserSublayer.emit(Object.assign({},e))},this.renderLayer=e=>{const t=this.layerMatches(e),{icon:i}=(0,R.g)({geometry:e.geometryType,type:e.type});return(0,r.h)("calcite-list-item",{onClick:()=>this.handleLayerClick(e),onKeyDown:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),this.handleLayerClick(e))},class:"sublayer-item"},(0,r.h)("calcite-icon",{icon:i,flipRtl:!0,scale:"s",slot:"content-start"}),(0,r.h)("span",{slot:"content",class:"sublayer-item__content"},(0,r.h)("span",{class:{"sublayer-item__title":!0,"sublayer-item__title--matched":t}},e.title||e.name),t&&(0,r.h)("span",{class:"sublayer-item__description"},this.i18n.matched)),(0,r.h)("calcite-icon",{scale:"s",slot:"content-end",icon:"chevron-right",flipRtl:!0,style:{display:"flex",justifyContent:"flex-end"}}))},this.item=void 0,this.portal=void 0,this.user=void 0,this.hidePreviewFooters=!1,this.showHosted=void 0,this.fullItem=void 0,this.formattedViews=void 0,this.loadingLayers=!0,this.layerError=void 0,this.layers=[],this.serviceInfo=void 0,this.sublayer=void 0,this.fullSublayer=void 0,this.showLayers=void 0,this.userInfo=void 0,this.tab="fields",this.itemError=void 0,this.onlineInPortal=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.preview,this.layerTypes=this.store.state.i18n.layerTypes,this.lang=await(0,d.a)(this.el),this.init(),this.guid=(0,U.g)()}updatePreview(){this.init()}async fetchItem(){return this.itemError=null,(0,m.k)(this.item,this.portal,this.user,this.store)}async init(){var e,t,i,r,s,o,l;if(!this.item)return;const{item:n,portal:d,lang:h}=this;this.fullItem=null,this.shouldExpandOverview=!0,this.loadingLayers=!0;const u=await(0,c.m)(this.fetchItem(),600);if(u.error)return void(this.itemError="disabledSubscription"===u.error.code?this.i18n.itemError.subscription:this.i18n.itemError.unhandled);this.fullItem=u.result,this.formattedViews=await(0,_.f)(n.numViews||0,{api:a.c.api,places:0,type:"decimal"}),this.onlineInPortal=await(0,m.i)(d,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket),this.userInfo=await(0,p.a)(n,d,h),null===(i=this.flowItem)||void 0===i||i.setFocus();if(this.showLayers=["Feature Service","Layer Template","Feature Collection"].includes(n.type)&&!["Route Layer","Markup","Map Notes","markup","IndoorPositioningDataService"].some(e=>n.typeKeywords.includes(e)),this.showLayers||"Image Service"===n.type)if("Layer Template"===n.type&&(null===(r=n.typeKeywords)||void 0===r?void 0:r.map(e=>e.toLowerCase()).includes("service template"))){const e=await(0,k.r)(`${(0,S.g)(this.portal)}content/items/${this.item.id}/data`);this.layers=[...null!==(s=e.layers)&&void 0!==s?s:[],...null!==(o=e.tables)&&void 0!==o?o:[]]}else{const e=await(0,B.f)({item:this.fullItem,portal:a.c.portal,layers:null,isSecure:!1});e.result?(this.serviceInfo=e.result.serviceInfo,this.layers=null===(l=e.result.sublayers)||void 0===l?void 0:l.sort(this.sortSublayers)):e.error&&(this.layerError=this.i18n.layerError,"serviceNotExist"===e.error.code&&(this.layerError.message=this.i18n.noServiceMessage))}this.loadingLayers=!1}handleAccordionItemClick(e,t){this.arcgisItemBrowserInternalUIAction.emit({action:e.expanded?"expand":"collapse",category:"panel action",details:t})}async fetchSublayer(){const e=await(0,B.a)(this.portal,this.sublayer.id,this.item.url);this.fullSublayer=null==e?void 0:e.result}closePreview(){this.sublayer=null,this.fullItem=null,this.arcgisItemBrowserCardSelectError.emit(),this.arcgisItemBrowserInternalUIAction.emit({action:"close panel",category:"panel action"}),this.arcgisItemBrowserPreviewClose.emit()}renderHeader(){var e;return(0,r.h)("div",{slot:"header-content",class:"preview__header"},(0,r.h)("h3",{id:"preview-title",class:"preview__title"},null===(e=this.item)||void 0===e?void 0:e.title),(0,r.h)("arcgis-item-type",{item:this.item,portal:this.portal,user:this.user,scale:"m",serviceInfo:this.serviceInfo,showHosted:this.showHosted}))}renderLayers(){var e;return this.loadingLayers?(0,r.h)("calcite-loader",{label:this.i18n.loading,scale:"s"}):this.layerError?(0,r.h)("div",{class:"section"},(0,r.h)("calcite-notice",{icon:!0,open:!0,scale:"s",width:"full",kind:"warning"},(0,r.h)("div",{slot:"title"},this.layerError.title),(0,r.h)("div",{slot:"message"},this.layerError.message))):(0,r.h)("div",{class:"section section--tight"},(0,r.h)("calcite-list",{"selection-mode":"none",label:this.i18n.layers,loading:this.loadingLayers,ref:e=>{var t;const i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("table");i&&(i.style.borderSpacing="0")}},null===(e=this.layers)||void 0===e?void 0:e.map(this.renderLayer)))}isAccordionItem(e){return"CALCITE-ACCORDION-ITEM"===e.tagName}handleSublayerSectionChange(e){this.tab=e,this.arcgisItemBrowserInternalUIAction.emit({action:"click",category:"panel action",details:`sublayer ${e}`})}renderSublayerPreview(){var e,t,i,s;const{sublayer:o,item:a,i18n:n,fullSublayer:c}=this;if(!this.sublayer)return null;const{geometryType:d,title:h,name:u,description:p}=o||{},{type:m,isGeometry:g}=(0,R.g)({geometry:d,type:o.type}),v=this.layerTypes[m];return(0,r.h)(r.F,null,this.renderHeader(),(0,r.h)("div",{class:"sublayer__header"},(0,r.h)("arcgis-sublayer-type",{name:u||h,geometry:o.geometryType,type:o.type,showType:!1,scale:"s"})),(0,r.h)("calcite-tabs",{position:"top",scale:"m",layout:"center",class:{sublayer__tabs:!0,"sublayer__tabs--white":"fields"===this.tab}},(0,r.h)("calcite-tab-nav",{slot:"title-group",class:"sublayer__tab-nav"},(0,r.h)("calcite-tab-title",{onClick:()=>this.handleSublayerSectionChange("fields"),selected:"fields"===this.tab},n.fields),(0,r.h)("calcite-tab-title",{onClick:()=>this.handleSublayerSectionChange("overview"),selected:"overview"===this.tab},n.overview)),(0,r.h)("calcite-tab",null,(0,r.h)("div",{class:"sublayer__content"},o.fields?o.fields.map(this.renderField):(0,r.h)("p",{class:"details-text details-text--empty"},n.noFields))),(0,r.h)("calcite-tab",null,(0,r.h)("div",{class:"sublayer__content sublayer__content--overview"},this.renderDetail(g?n.geometryTypeTitle:n.layerTypeTitle,v),(0,r.h)("h4",{class:"details-title"},n.description),p?(0,r.h)("div",{class:"details-text description",innerHTML:(0,l.s)((0,l.d)(p))}):(0,r.h)("p",{class:"details-text details-text--empty"},n.noDescription),!(null===(e=this.portal)||void 0===e?void 0:e.isPortal)&&this.renderDetail(n.dataUpdated,(0,_.b)(null===(t=null==c?void 0:c.editingInfo)||void 0===t?void 0:t.dataLastEditDate)),!(null===(i=this.portal)||void 0===i?void 0:i.isPortal)&&this.renderDetail(n.schemaUpdated,(0,_.b)(null===(s=null==c?void 0:c.editingInfo)||void 0===s?void 0:s.schemaLastEditDate)),a.url&&(0,r.h)("arcgis-item-browser-preview-copy",{text:`${a.url}/${o.id}`,heading:n.URL,label:n.copyURL})))),!this.hidePreviewFooters&&(0,r.h)("div",{slot:"footer",class:"footer-actions"},this.renderSublayerSelect(),(0,r.h)("slot",{name:"sublayer-footer"})))}renderDetail(e,t,i,s){const o=!i||t?s?(0,r.h)("p",{class:"details-text",innerHTML:(0,l.s)(t),onClick:this.checkForExternalLink}):(0,r.h)("p",{class:"details-text"},t):(0,r.h)("p",{class:"details-text details-text--empty"},i);return[(0,r.h)("h4",{class:"details-title"},e),o]}renderSublayerSelect(){var e,t,i;return(null===(t=null===(e=this.store)||void 0===e?void 0:e.state.selection)||void 0===t?void 0:t.includes("sublayer"))?(0,r.h)("arcgis-item-browser-card-sublayer-select",{item:this.item,user:this.user,portal:this.portal,selection:"multiple-sublayer"===(null===(i=this.store)||void 0===i?void 0:i.state.selection)?"multiple":"single",appearance:"solid",width:"full"}):null}render(){var e,t,i,s,o,d,h,u,p,m;const{item:g,fullItem:v,i18n:b,user:f,sublayer:y,userInfo:w,portal:I,itemError:k,guid:S}=this,x=null!==(e=null==g?void 0:g.owner)&&void 0!==e?e:"",F="public_authoritative"===(0,M.g)(v)?this.i18n.itemManagedBy.replace("${username}",x):x,C=(null===(t=this.layers)||void 0===t?void 0:t.length)?b.layersCount.replace("${count}",`${(null===(i=this.layers)||void 0===i?void 0:i.length)||0}`):b.layers,B=null===(d=null===(o=null===(s=this.store)||void 0===s?void 0:s.state.highlights)||void 0===o?void 0:o[null==g?void 0:g.id])||void 0===d?void 0:d.sublayers,T=(null==B?void 0:B.length)&&!this.loadingLayers?b.matchedNumber.replace("${num}",`${B.length}`):null;return(0,r.h)(r.H,{key:"5e56cf2d24a91e88f4cdf307cc1069c2ddfe7931"},(0,r.h)("calcite-flow",{key:`flow-${S}`},(0,r.h)("calcite-flow-item",{selected:!y,role:"dialog","aria-describedby":"preview-title",key:`flow-preview-${S}`,closable:!0,loading:!v&&!k,onCalciteFlowItemClose:e=>{e.stopPropagation(),this.closePreview()},ref:e=>this.flowItem=e},this.renderHeader(),!!k&&(0,r.h)("div",{key:"0657890a177fb3861e48a3c4f9ba87cb0b307899",class:"error-container"},(0,r.h)("calcite-notice",{key:"301954470294d101e900e7034ce7f3641a7ad84c",kind:"danger",open:!0,scale:"s"},(0,r.h)("div",{key:"4186341f86a53bec308d3a71bb918f4ced36d461",slot:"title"},this.i18n.itemError.title),(0,r.h)("div",{key:"0100be7ecff204882629a3a9c187838140e1c90f",slot:"message"},k))),v&&(0,r.h)("div",{key:"3c9adde97aca8757282ad38a81ec56b48e5b86ee",class:"content"},(0,r.h)("calcite-accordion",{"icon-position":"start",appearance:"transparent",key:g.id,class:"accordion",onClick:async e=>{const t=e.target;this.isAccordionItem(t)&&(await(0,c.t)(300),t.expanded&&t.scrollIntoView({behavior:"smooth",block:"nearest"}))}},(0,r.h)("calcite-accordion-item",{key:"e4c9efaf1650efeb33f47daf13c49bd4058b40b5",heading:b.thumbnail,ref:e=>{this.thumbnailElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.thumbnailElement,"thumbnail")},(0,r.h)("div",{key:"5dd0b1d20d464876bdfb5ed0430fba97f3bd7d9a",class:"section section--tight"},(0,r.h)("arcgis-item-browser-card-thumbnail",{key:"a2a5d38e0c97c1650380a61631e179939c110c0b",item:g,user:f,portal:I}))),(0,r.h)("calcite-accordion-item",{key:"df58c041e3088688bc6c0b3bb5bc38282922d9d6",heading:b.overview,ref:e=>{this.overviewElement=e,this.shouldExpandOverview&&(e.expanded=!0,this.shouldExpandOverview=!1)},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.overviewElement,"overview")},(0,r.h)("div",{key:"ebb316e938a2309f7f7aac0b08265947065bd273",class:"section"},(0,r.h)("slot",{key:"1a0c5141ac1fa1c2b02fd18161a66b9cdeab7a07",name:"summary-top"}),this.renderDetail(b.summary,v.snippet,b.noSummary),!!(null===(h=(0,M.a)(g,I,f))||void 0===h?void 0:h.length)&&[(0,r.h)("h4",{key:"4057a70c028a4096bdac1796c31efada7e0c5afb",class:"details-title"},b.itemStatus),(0,r.h)("arcgis-item-badges",{key:"dbfa8fd9cdd4dd0e901ca77c71dace0e8ffc591b",class:"badges",item:g,portal:I,user:f,scale:"s",width:"full"})],(0,r.h)("h4",{key:"7404bd67e298e177d85a4cc5fddf6b5bc1637008",class:"details-title"},b.owner),(null===(u=this.store)||void 0===u?void 0:u.state.panel)?(0,r.h)("arcgis-user-avatar",{user:w,scale:"s",portal:I,showName:!0,description:F}):(0,r.h)("arcgis-user-popup",{baseUrl:a.c.config.baseUrl,portal:I,item:v}),(0,r.h)("h4",{key:"a85f6f356729b9a9a09bdd11b7245e51e905e067",class:"details-title"},b.shared),(0,r.h)("arcgis-item-share-summary",{key:"41af353415b958a4bf81e41d954ac4ada1087db3",item:v,scale:"m",user:f,groups:this.store.state.groupSharing[g.id]}),this.renderDetail(b.updated,(0,_.b)(v.modified)),this.store.state.groupId&&Boolean(null===(p=g.groupCategories)||void 0===p?void 0:p.length)&&(0,r.h)(r.F,{key:"b89502db93320b6d0c8cc97087cdee3d55de1739"},(0,r.h)("h4",{key:"b5081ebd3fafe933b1c955d31ca02cd8c2b6d9b6",class:"details-title"},b.groupCategories),(0,r.h)("calcite-chip-group",{key:"e6b69c056b32d74f35b2b342989022aede96073b",label:b.groupCategories},g.groupCategories.map(e=>{const t=e.replace("/Categories/","");return(0,r.h)("calcite-chip",{value:e,label:t,key:e,appearance:"outline-fill",scale:"s"},t)}))),!!f&&!this.onlineInPortal&&(0,r.h)("arcgis-item-favorite",{key:"31bec6dca6ff6847018553ced8a49babc2136dae",class:"favorite",user:f,portal:I,item:v,width:"full",onArcgisItemFavoriteUpdate:e=>{const t=e.detail.favorite?"add to fav":"remove from fav";this.arcgisItemBrowserInternalUIAction.emit({action:"click",details:t})}}))),(0,r.h)("calcite-accordion-item",{heading:b.description,key:"description",ref:e=>{this.descriptionElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.descriptionElement,"description")},(0,r.h)("div",{key:"b2675a8732c1b7277e2290bc2828409ab2d69138",class:"section"},v.description?(0,r.h)("div",{class:"description",onClick:this.checkForExternalLink,innerHTML:(0,l.s)(v.description)}):(0,r.h)("p",{class:"details-text details-text--empty"},b.noDescription))),(0,r.h)("calcite-accordion-item",{key:"216bf1754fd611d51715e3d7ad15de5eeb23286d",heading:b.details,ref:e=>{this.detailsElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.detailsElement,"details")},(0,r.h)("div",{key:"8b7db803533d8b0d9beb530fc797176d0b5b6505",class:"section"},this.renderDetail(b.created,(0,_.b)(v.created)),this.renderDetail(b.viewCount,this.formattedViews),"Dashboard"===g.type&&this.renderDetail(b.dashboardViews,(null===(m=g.typeKeywords)||void 0===m?void 0:m.includes("Mobile"))?b.dashboardMobile:b.dashboardDesktop),!!v.size&&this.renderDetail(b.fileSize,(0,n.f)(v.size)),(0,r.h)("arcgis-item-browser-preview-copy",{key:"04725305d28bc0e3db2e8848567800fe542b4708",label:b.copyID,text:v.id,heading:b.ID}),v.url&&(0,r.h)("arcgis-item-browser-preview-copy",{key:"5de53b818878ee4a1bca07dabf2774dbcac250d5",label:b.copyURL,text:v.url,heading:b.URL}),this.renderDetail(b.credits,v.accessInformation,b.noCredits),this.renderDetail(b.termsOfUse,v.licenseInfo,b.noTermsOfUse,!0))),this.showLayers&&(0,r.h)("calcite-accordion-item",{key:"5c0897eb5a483b100cb480a9ecee925f29ab7095",heading:C,description:T,ref:e=>{this.layersElement=e},onClick:async e=>{this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.layersElement,"layers")}},this.renderLayers()))),!this.hidePreviewFooters&&(0,r.h)("div",{key:"fb2438d713759a29612dae2795d93dcdc92b68c8",slot:"footer",class:"footer-actions"},this.renderSublayerSelect(),(0,r.h)("slot",{key:"b36f7feee1de46fa103992b948ed7d41f5127602",name:"footer"}))),(0,r.h)("calcite-flow-item",{selected:!!y,key:`flow-sublayer-${S}`,closable:!0,onCalciteFlowItemBack:e=>{e.stopPropagation(),this.arcgisInternalItemBrowserSublayer.emit(),this.sublayer=null},onCalciteFlowItemClose:e=>{e.stopPropagation(),this.closePreview()}},this.renderSublayerPreview())))}get el(){return(0,r.a)(this)}static get watchers(){return{item:["updatePreview"]}}};xe.style=":host{display:flex;height:100%;width:100%;flex:1 1 0%;flex-direction:column;background-color:var(--calcite-color-background)}.preview__header{margin-inline-start:0.75rem}.preview__title{margin:0px;overflow-wrap:break-word;padding:0px;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1);line-height:1.375}.title{margin-top:0.75rem;margin-bottom:0.75rem;padding:0px;font-size:1.125rem;font-weight:500;color:var(--calcite-color-text-1);word-wrap:break-word;word-break:break-word}.badges{margin-bottom:1rem;display:block}.badges[empty]{display:none}calcite-accordion{--calcite-accordion-item-header-background-color:var(--calcite-color-foreground-1)}calcite-accordion-item{--calcite-internal-accordion-item-padding:1rem 1rem;width:100%;box-sizing:border-box;border-bottom:1px solid var(--calcite-color-border-2)}.section{margin:-1rem;background-color:var(--calcite-color-background);padding-left:1rem;padding-right:1rem;padding-top:1rem;padding-bottom:1rem;line-height:1.35}.section--tight{padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px}.details-title{margin-top:1rem;margin-bottom:0px;padding-bottom:0.25rem;padding-top:0px;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-3);--calcite-label-margin-bottom:0}.details-title:first-of-type{margin-top:0px}.details-title--label{padding-bottom:0px}.details-text{margin:0px;overflow-wrap:break-word;padding:0px;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-1)}.details-text a{color:var(--calcite-color-text-link)}.details--text-empty{font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-3)}.description{width:100%;overflow:auto;overflow-wrap:break-word;padding-bottom:0.25rem;line-height:1.35}.description *{max-width:100%;font-size:0.875rem !important}.description{--item-browser-table-border:1px solid var(--calcite-color-border-2)}.description img,.description video{height:auto}.description table{width:100%;border-collapse:collapse;--tw-border-spacing-x:0px;--tw-border-spacing-y:0px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);overflow:auto;background-color:var(--calcite-color-foreground-1);text-align:start;font-size:0.75rem;border:var(--item-browser-table-border)}.description table>thead{background-color:var(--calcite-color-foreground-1);font-weight:400;border-bottom:var(--item-browser-table-border)}.description table>tbody{width:100%;overflow:auto}.description table>tfoot{border-top:var(--item-browser-table-border)}.description table th,.description table td{padding:0.5rem;text-align:start;font-weight:300;border-left:var(--item-browser-table-border);border-right:var(--item-browser-table-border)}.description table tr{text-align:start;border-bottom:var(--item-browser-table-border)}.description table tr:last-child{border-bottom:none}.favorite{display:block;padding-top:1.5rem}.copy-input{--calcite-color-background:var(--calcite-color-foreground-1)}.sublayer-item{--tw-shadow:none}.sublayer__tabs{flex:1 1 auto;background-color:var(--calcite-color-background)}.sublayer__tabs--white{background-color:var(--calcite-color-foreground-1)}.sublayer-item__content{max-width:10.875rem;display:flex;min-width:0px;flex-direction:column}.sublayer-item__title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0.5rem;padding-bottom:0.5rem;font-size:0.875rem;color:var(--calcite-color-text-2);text-decoration-line:underline}.sublayer-item__title--matched{padding-top:0px;padding-bottom:0px}.sublayer-item__description{font-size:0.75rem;color:var(--calcite-color-text-3)}.sublayer__header{display:flex;background-color:var(--calcite-color-foreground-1);padding-left:1rem;padding-right:1rem;padding-top:1rem;padding-bottom:0.5rem;font-weight:500;color:var(--calcite-color-text-1)}.sublayer__header__title{min-width:0px;overflow-wrap:break-word}.sublayer__tab-nav{background-color:var(--calcite-color-foreground-1);padding-left:1rem;padding-right:1rem}.sublayer__content{height:100%;background-color:var(--calcite-color-foreground-1);margin-top:-0.5rem}.sublayer__content--overview{box-sizing:border-box;background-color:var(--calcite-color-background);padding-top:2rem;padding-bottom:2rem;padding-left:1.25rem;padding-right:1.25rem}.footer-actions{display:grid;width:100%;grid-template-columns:repeat(1, minmax(0, 1fr));gap:0.5rem}.error-container{display:flex;height:100%;padding:1rem}";const Fe=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.heading=void 0,this.text=void 0,this.label=void 0,this.copied=!1}async componentWillLoad(){const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.copy}async handleCopy(e){navigator.clipboard.writeText(e),this.copied=!0;const t=this.el.parentElement.classList.contains("sublayer__content");this.arcgisItemBrowserInternalUIAction.emit({action:"copy",category:"panel action",details:t?"layers":"details"}),await(0,c.t)(1e4),this.copied=!1}render(){const{heading:e,text:t,i18n:i}=this;return(0,r.h)(r.H,{key:"fdeec92883b4fbea363607d5635965e0bcbc9cbc"},(0,r.h)("calcite-label",{key:"abd42884a9227e625095c2fd4532b0a73bfc2d78",class:"label",scale:"s"},(0,r.h)("h4",{key:"9512f7e6da59a55a8f36d65751a584a81a12c5f6",class:"heading"},e),(0,r.h)("calcite-input",{key:"2d75ab422e9fdace99b2f2f23235233fa48cb00d",value:t,readOnly:!0,alignment:"start",type:"text",label:e,scale:"s",class:"input"},(0,r.h)("div",{key:"ff5fdaf7e4ba3076ddf03edc5a8e2777e6db6578",slot:"action",class:"action"},(0,r.h)("calcite-button",{key:"221984c69f878048644492ec72f8e11c9fb8dd55",class:"button","aria-label":this.label,slot:"action",iconStart:"copy-to-clipboard",id:"copy-button",kind:"neutral",scale:"s",onClick:()=>this.handleCopy(t),onMouseOut:async()=>{await(0,c.t)(200),this.copied=!1}}),(0,r.h)("div",{key:"e956990db8fb30fd74c29afe4add21611ea60442",class:"tooltip"},this.copied?null==i?void 0:i.copied:null==i?void 0:i.copy)))))}get el(){return(0,r.a)(this)}};Fe.style=".heading{margin-top:1rem;margin-bottom:0px;padding-bottom:0.25rem;padding-top:0px;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-3);--calcite-label-margin-bottom:0}.label{padding-bottom:0px}.input{--calcite-color-background:var(--calcite-color-foreground-1)}.action{position:relative}.tooltip{position:absolute;white-space:nowrap;border-radius:var(--calcite-border-radius);background-color:var(--calcite-color-foreground-1);padding-top:0.5rem;padding-bottom:0.5rem;padding-left:0.75rem;padding-right:0.75rem;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-1);opacity:0;--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;transform:translateY(-8px);top:calc(100% + 4px);inset-inline-end:0;width:auto;border:1px solid var(--calcite-color-border-3);line-height:1.375}.button:hover+.tooltip,.button:focus+.tooltip{opacity:1;transform:translateY(0)}";const Ce=class{constructor(e){(0,r.r)(this,e),this.field=void 0,this.item=void 0,this.sublayer=void 0,this.showFieldStatistics=void 0,this.api=void 0,this.layer=void 0}async getFieldData(){if(!this.layer){const[e]=await(0,T.l)(["esri/layers/FeatureLayer"]),t=new e({url:this.item.url,layerId:this.sublayer.id});await t.load(),this.layer=t}}render(){const{field:e,showFieldStatistics:t,api:i}=this;return e?(0,r.h)(r.H,null,(0,r.h)("calcite-block",{heading:e.alias||e.name,description:e.name,headingLevel:5,collapsible:t&&4===i&&"Feature Service"===this.item.type,onCalciteBlockToggle:()=>{this.getFieldData()}},(0,r.h)("calcite-icon",{slot:"icon",icon:G.f[e.type]||"string",scale:"s",class:"layer-icon"}),!!this.layer&&(0,r.h)("arcgis-field-info",{layer:this.layer,fieldName:e.name}))):null}get el(){return(0,r.a)(this)}},_e=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserSearch=(0,r.c)(this,"arcgisItemBrowserSearch",7),this.arcgisItemBrowserSearchInput=(0,r.c)(this,"arcgisItemBrowserSearchInput",7),this.computeDefaultPlaceholder=()=>{var e,t,i,r,s;const o=this.i18n,{bucket:l,contentUser:n,filters:c,panel:d}=this.store.state;if(d)return o.searchName.replace("${searchName}","");let h;switch(l){case"my":const l=!!n,d=n||a.c.user,u=!(null===(e=c.folder)||void 0===e?void 0:e.folder)||"all"===c.folder.folder,p=(null===(t=c.folder)||void 0===t?void 0:t.folderData)||(null===(i=this.store.state.folders)||void 0===i?void 0:i.find(e=>{var t;return e.id===(null===(t=c.folder)||void 0===t?void 0:t.folder)})),m=null==p?void 0:p.title,g=d.username;if(u){h=l?o.searchAllUserContent.replace("${username}",g):o.searchAllContent;break}h=o.searchName.replace("${searchName}",null!=m?m:g);break;case"favorites":h=o.searchFavoritesContent;break;case"group":const v=null===(r=c.group)||void 0===r?void 0:r.label;h="all"!==(null===(s=c.group)||void 0===s?void 0:s.group)&&v?o.searchName.replace("${searchName}",v):o.searchGroupsContent;break;case"living atlas":h=o.searchLivingAtlasContent;break;case"org":h=o.searchOrganizationsContent}this.defaultPlaceholder=h},this.term=void 0,this.placeholder=void 0,this.defaultPlaceholder=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.search,(0,v.a)(this.store,this.computeDefaultPlaceholder),(0,v.c)(this.store,this.computeDefaultPlaceholder),(0,v.d)(this.store,this.computeDefaultPlaceholder),this.computeDefaultPlaceholder()}render(){var e,t;const{term:i,placeholder:s,defaultPlaceholder:o}=this;return(0,r.h)(r.H,{key:"d79a83a0d70659587f80110f8ef38a68f6b96cdd"},"subscription content"!==(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&(0,r.h)("arcgis-browser-search",{key:"01f558a17a27b289c9d2cf80ecb859ea92b3aadf",term:i,placeholder:null!=s?s:o,onArcgisBrowserSearch:e=>this.arcgisItemBrowserSearch.emit(e.detail),onArcgisBrowserSearchInput:e=>this.arcgisItemBrowserSearchInput.emit(e.detail),store:this.store}))}get el(){return(0,r.a)(this)}},Be={my:{sortField:"modified",sortOrder:"desc"},favorites:{sortField:"modified",sortOrder:"desc"},group:{sortField:"modified",sortOrder:"desc"},org:{sortField:"modified",sortOrder:"desc"},"subscription content":{sortField:"relevance",sortOrder:"asc"},"living atlas":{sortField:"relevance",sortOrder:"asc"},"living atlas analysis":{sortField:"relevance",sortOrder:"asc"},all:{sortField:"relevance",sortOrder:"asc"},catalog:{sortField:"modified",sortOrder:"desc"}},Te=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserSort=(0,r.c)(this,"arcgisItemBrowserSort",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.options=["title","relevance","modified"],this.field=void 0,this.order=void 0,this.activeField=void 0,this.activeOrder=void 0,this.userSetSort=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const{field:e,options:t}=this;if(e)this.userSetSort=!0,this.activeField=e,this.activeOrder=this.order||(0,$.a)(e);else{const e=this.store.state.bucket&&Be[this.store.state.bucket];this.activeField=e?e.sortField:(null==t?void 0:t[0])||"relevance",this.activeOrder=(0,$.a)(this.activeField)}(0,v.e)(this.store,e=>{this.activeField=e.sortField,this.activeOrder=e.sortOrder})}updateOptions(e){var t,i;if(!e.includes(this.activeField)){const r=(null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.bucket)&&Be[this.store.state.bucket];this.activeField=r?r.sortField:null==e?void 0:e[0],this.activeOrder=(0,$.a)(this.activeField),this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder})}}componentDidLoad(){this.arcgisItemBrowserSort.emit({sortField:this.field||this.activeField,sortOrder:this.order||(this.field?(0,$.a)(this.field):this.activeOrder)})}emitInternal(){this.arcgisItemBrowserInternalUIAction.emit({category:"sort",action:`${this.activeField} ${"asc"===this.activeOrder?"ascending":"descending"}`})}updateSortField(e){this.activeField=e,this.activeOrder=(0,$.a)(e),this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder}),this.emitInternal()}updateSortOrder(e){this.activeOrder=e,this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder}),this.emitInternal()}render(){var e,t,i,s;const{activeField:o,activeOrder:a,field:l,order:n,options:c}=this,d=o||(c.includes(l)?l:c[0]),h=a||n,u="relevance"===d||(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.searchTerm)?c:c.filter(e=>"relevance"!==e);return(0,r.h)(r.H,{key:"80495bbc5f9ecc6c282fedc4c128d27ce1f77590"},"subscription content"!==(null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.bucket)&&(0,r.h)("arcgis-browser-sort",{key:"aa5a4a6e7259f72a24242e8daeb0bb2f72da773c",store:this.store,field:d,order:h,options:u,onArcgisBrowserSortFieldChange:e=>this.updateSortField(e.detail),onArcgisBrowserSortOrderChange:e=>this.updateSortOrder(e.detail)}))}get el(){return(0,r.a)(this)}static get watchers(){return{options:["updateOptions"]}}},Ee={title:{width:{default:"minmax(0, 7fr)"},header:!0},type:{width:{default:"minmax(0, 5fr)",md:"2.5rem"}},modified:{width:{useTextWidth:"modified",default:"minmax(0, 3fr)"},header:!0,hide:860},created:{width:{default:"7.5rem"},header:!0,hide:860},badges:{width:{default:"6rem"},hide:1300},owner:{width:{useTextWidth:"owner",default:"minmax(0, 3fr)"},header:!0,hide:900},sharing:{width:{default:"5rem"},hide:1150},size:{width:{useTextWidth:"size",default:"minmax(0, 2fr)"},header:!0,hide:1175},deleted:{width:{useTextWidth:"deleted",default:"minmax(0, 7fr)"},header:!0,hide:1e3},details:{width:{useTextWidth:"details",default:"8rem"},hide:1050},favorite:{width:{default:"3rem"},hide:1150},actions:{width:{default:"3rem"}},dataset:{width:{default:"minmax(0, 7fr)"},header:!0},download:{width:{default:"3rem"},hide:1150}};function Ae(e,t){const{hide:i}=Ee[e];return!i||t>i}const Oe=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserColumnUpdate=(0,r.c)(this,"arcgisItemBrowserColumnUpdate",7),this.arcgisItemBrowserSort=(0,r.c)(this,"arcgisItemBrowserSort",7),this.rows=[],this.getColumnWidthId=e=>"details"!==e?e:this.store.state.recycleBin?"restore":"action"===this.store.state.tableRowPreview?"preview":"details",this.columns=["title","type","modified","badges","owner","sharing","details","actions"],this.sortable=!0,this.textWidths=void 0}handleMove(e){const{activeFocus:t}=this.store.state;switch(this.updateRows(),e.detail){case"right":return this.moveRight(t);case"left":return this.moveLeft(t);case"up":return this.moveUp(t);case"down":return this.moveDown(t)}}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.table,(0,v.f)(this.store,e=>{var t;if(!e&&this.store.state.activeFocus){const[e,i]=this.store.state.activeFocus;this.updateRows();const r=null===(t=this.rows)||void 0===t?void 0:t[e];null==r||r.focusColumn(i)}}),this.calculateTextWidths()}async componentDidLoad(){this.arcgisItemBrowserColumnUpdate.emit(this.columns)}updateColumns(e){this.arcgisItemBrowserColumnUpdate.emit(e),this.calculateTextWidths(!0)}async attemptMove([e,t],i){const r=this.rows[e];if(await r.canFocusColumn(t))this.store.state.activeFocus=[e,t],requestAnimationFrame(()=>r.focusColumn(t));else switch(i){case"right":return this.moveRight([e,t]);case"left":return this.moveLeft([e,t]);case"up":return this.moveUp([e,t]);case"down":return this.moveDown([e,t])}}updateRows(){var e;this.rows=null===(e=this.rowSlot)||void 0===e?void 0:e.assignedElements()}measureText(e){return Math.ceil((0,j.g)({text:e}))}calculateTextWidths(e){var t,i;const{measureText:r}=this;(null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.i18n)&&this.columns&&(!this.textWidths||e)&&(this.textWidths=this.columns.reduce((e,t)=>{const{width:i}=Ee[t];if(i.useTextWidth){let s=this.store.state.i18n.table.headers[i.useTextWidth];return"details"===i.useTextWidth&&(e=Object.assign(Object.assign({},e),{restore:r(this.store.state.i18n.tableRow.restore),preview:r(this.store.state.i18n.card.openDetails)}),s=this.store.state.i18n.tableRow.details),Object.assign(Object.assign({},e),{[t]:r(s)})}return e},{}))}getLastColumnIndex(){const e="multiple"===this.store.state.selection;return this.columns.filter(e=>Ae(e,this.store.state.width)).length-(e?0:1)}getLastRowIndex(){return this.rows.length-1}async moveRight([e,t]){const i=t>=this.getLastColumnIndex()?0:t+1;this.attemptMove([e,i],"right")}async moveLeft([e,t]){const i=t<1?this.getLastColumnIndex():t-1;this.attemptMove([e,i],"left")}async moveUp([e,t]){const i=e<1?this.getLastRowIndex():e-1;this.attemptMove([i,t],"up")}async moveDown([e,t]){const i=e+1>this.getLastRowIndex()?0:e+1;this.attemptMove([i,t],"down")}handleKeyboard(e){const{key:t}=e,i=this.store.state.activeFocus||[0,0];switch(this.updateRows(),t){case"ArrowDown":return e.preventDefault(),this.moveDown(i);case"ArrowUp":return e.preventDefault(),this.moveUp(i);case"ArrowLeft":return e.preventDefault(),this.moveLeft(i);case"ArrowRight":return e.preventDefault(),this.moveRight(i)}}renderColumn(e){const t=this.i18n.headers[e],{header:i}=Ee[e],{recycleBin:s}=this.store.state,o=this.sortable&&i&&!(s&&"title"===e),{sortField:a,sortOrder:l}=this.store.state.sort||{},n="deleted"===e?"modified":e,c=a===n;return i&&o?(0,r.h)("div",{class:{"column-header":!0,"column-header--sorted":c}},!("title"!==e||"multiple"!==this.store.state.selection)&&(0,r.h)("div",{role:"columnheader",class:"screen-reader-only"},(0,r.h)("span",null,this.i18n.selection)),(0,r.h)("div",{role:"columnheader","aria-sort":"asc"===l?"ascending":"descending"},(0,r.h)("calcite-button",{width:"full",alignment:"icon-end-space-between",scale:"m",appearance:"transparent",kind:c?"brand":"neutral","icon-end":c&&"asc"===l?"caret-up":"caret-down",onClick:()=>{c?this.arcgisItemBrowserSort.emit({sortField:n,sortOrder:"asc"===l?"desc":"asc"}):this.arcgisItemBrowserSort.emit({sortField:n,sortOrder:(0,$.a)(n)})}},(0,r.h)("span",{class:{button__text:!0,"button__text--sorted":c}},t)))):(0,r.h)("div",{role:"columnheader",class:"column-header"},i?(0,r.h)("calcite-button",{tabindex:-1,class:"column-header--inactive",alignment:"start",width:"full",scale:"m",appearance:"transparent",kind:"neutral"},(0,r.h)("span",{class:"button__text"},t)):(0,r.h)("span",{class:"screen-reader-only"},t))}render(){const{loading:e}=this.store.state,t="multiple"===this.store.state.selection,i=this.columns.filter(e=>Ae(e,this.store.state.width));return(0,r.h)(r.H,{key:"5aace56ac8b1baeeb60d9e4666eb512233459ce1",style:{"--item-browser-table-columns":`${i.map(e=>{var t;return function(e,t,i){const r=Ee[e],{default:s,md:o,useTextWidth:a}=r.width;if(a&&i>0)return`${i+(42+(r.header?18:0))}px`;return t&&t<=h.b.md&&o?o:s}(e,this.store.state.width,null===(t=this.textWidths)||void 0===t?void 0:t[this.getColumnWidthId(e)])}).join(" ")}`}},(0,r.h)("div",Object.assign({key:"802bb11fd699bfcd18566edc604c7fb194047a90",class:"table","aria-label":this.i18n.caption,role:"grid","aria-readonly":"true"},t?{"aria-multiselectable":"true"}:{},{onKeyDown:e=>this.handleKeyboard(e)}),(0,r.h)("div",{key:"4b0f61812fe0674a3d462c49e5c16806fd8acdfb",role:"rowgroup"},(0,r.h)("div",{key:"6f325f47eed74925ee6f56b9a972517d3ba1f46b",role:"row",class:"header"},i.map(e=>this.renderColumn(e)))),e?(0,r.h)("calcite-loader",{label:this.i18n.loading}):(0,r.h)("div",null,(0,r.h)("slot",{ref:e=>this.rowSlot=e}))))}get el(){return(0,r.a)(this)}static get watchers(){return{columns:["updateColumns"]}}};Oe.style=".table{background-color:var(--calcite-color-foreground-1)}.header{display:grid;grid-template-columns:var(--item-browser-table-columns)}.button__text--sorted{font-weight:500}.column-header{border-bottom:1px solid var(--calcite-color-border-2);margin-bottom:1px}.column-header--sorted{border-bottom-color:var(--calcite-color-brand)}.column-header--inactive{pointer-events:none}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const Pe=class{constructor(e){var t;(0,r.r)(this,e),this.arcgisItemBrowserColumnUpdate=(0,r.c)(this,"arcgisItemBrowserColumnUpdate",7),this.arcgisItemBrowserCardSelect=(0,r.c)(this,"arcgisItemBrowserCardSelect",7),this.arcgisItemBrowserCardPreview=(0,r.c)(this,"arcgisItemBrowserCardPreview",7),this.arcgisItemBrowserActionsOpen=(0,r.c)(this,"arcgisItemBrowserActionsOpen",7),this.arcgisItemBrowserRestoreItem=(0,r.c)(this,"arcgisItemBrowserRestoreItem",7),this.arcgisItemBrowserFocusMove=(0,r.c)(this,"arcgisItemBrowserFocusMove",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.columnRefs={},this.item=void 0,this.portal=void 0,this.index=void 0,this.user=void 0,this.api=void 0,this.baseUrl=null===(t=null===a.c||void 0===a.c?void 0:a.c.config)||void 0===t?void 0:t.baseUrl,this.link=void 0,this.newTab=void 0,this.name=void 0,this.preview=void 0,this.allowSharing=void 0,this.actions=[],this.showItemTypeHosted=!1,this.showFavoriteInActionsMenu=void 0,this.titleIcon=void 0,this.hasMouse=void 0,this.mouseOverColumn=void 0,this.onlineInPortal=void 0}async componentWillLoad(){var e,t;this.store=(0,v.g)(this.el);const i=await(0,C.g)(this.el);this.i18n=null==i?void 0:i.tableRow,this.updateDetailsText(this.preview),this.onlineInPortal=await(0,m.i)(this.portal,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)}updateDetailsText(e){var t;e&&(null===(t=this.store.state)||void 0===t?void 0:t.tableRowPreview)!==e&&(this.store.state.tableRowPreview=e)}async canFocusColumn(e){var t;const i=(this.store.state.columns||[]).filter(e=>Ae(e,this.store.state.width)),r=this.getColumnNumber(e),s=i[r];return"badges"===s?!this.badges.empty:!!(null===(t=this.columnRefs[s])||void 0===t?void 0:t.method)||r<0}async focusColumn(e){var t;let i=e;if("multiple"===this.store.state.selection){if(0===e)return void(null===(t=this.checkbox)||void 0===t||t.setFocus());i=e-1}const r=(this.store.state.columns||[]).filter(e=>Ae(e,this.store.state.width)),{el:s,method:o}=this.columnRefs[r[i]]||{};s[o]()}getColumnNumber(e){return"multiple"===this.store.state.selection?e-1:e}isSimpleColumn(e){return!["owner","details","favorite","actions"].includes(e)}clampColumn(e){return["title"].includes(e)}onClick(e){return{onClick:()=>{e()},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||e()}}}emitInternalAction(e){this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:e})}renderTitle(e){var t,i,s,o,a;const{item:l}=this,n=null!==(i=null===(t=this.store.state.activeFocus)||void 0===t?void 0:t[1])&&void 0!==i?i:0,c=(null!==(o=null===(s=this.store.state.activeFocus)||void 0===s?void 0:s[0])&&void 0!==o?o:0)===this.index,d=n<2,h=this.link&&"title"!==this.preview,u=`${l.title} ${l.type}`,p=Object.assign({ariaLabel:u,href:`${(0,N.r)(this.baseUrl)}/item.html?id=${l.id}`},(null===(a=this.store.state)||void 0===a?void 0:a.linkHandler)?{onClick:e=>{var t;e.ctrlKey||e.metaKey||(e.preventDefault(),null===(t=this.store.state)||void 0===t||t.linkHandler(this.item))}}:{});return(0,r.h)("div",{class:"checkbox-wrap",onMouseOver:()=>{this.mouseOverColumn=0},key:"title"},(0,r.h)("div",{role:"gridcell",class:"cell cell--end-2 cell--hoverable",onClick:()=>{if(this.checkbox){const e=!this.checkbox.checked;this.checkbox.checked=e,this.arcgisItemBrowserCardSelect.emit({item:l,selected:e})}}},(0,r.h)("calcite-checkbox",Object.assign({},c&&d||this.hasMouse&&0===this.mouseOverColumn?{}:{inert:!0},{class:"checkbox",checked:e,ref:e=>{this.checkbox=e},onClick:e=>{e.stopPropagation(),this.store.state.activeFocus=[this.index,0]},onCalciteCheckboxChange:()=>{this.arcgisItemBrowserCardSelect.emit({item:l,selected:!e})},value:l.id,label:u}))),h?(0,r.h)("div",{onMouseOver:()=>{this.mouseOverColumn=0},role:"gridcell",id:`row-${l.id}`,class:"cell--link__container"},(0,r.h)("a",Object.assign({},p,{ref:e=>{this.columnRefs.title={el:e,method:"focus"}},tabindex:1===n&&c?0:-1,class:"cell cell--narrow cell--start-2 cell--end-2 checkbox__title title cell--link"}),(0,r.h)("span",{class:"cell--clamp"},this.item.title))):(0,r.h)("div",Object.assign({onMouseOver:()=>{this.mouseOverColumn=0},role:"gridcell",class:{"cell cell--narrow cell--start-2 cell--end-2 checkbox__title title":!0,"cell--hoverable":"title"===this.preview&&!this.store.state.recycleBin,"cell--hoverable--active":"title"===this.preview&&this.store.state.preview===l.id,"cell--link":this.link&&"title"!==this.preview},id:`row-${l.id}`,tabindex:1===n&&c?0:-1},h?p:this.onClick(()=>{"title"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(l),this.store.state.activeFocus=[this.index,1]}),{ref:e=>{this.columnRefs.title={el:e,method:"focus"}}}),(0,r.h)("span",{class:"cell--clamp"},this.item.title)))}renderDeleted(){const{item:e,i18n:t,store:i}=this,s=function(e){const t=new Date(e),i=new Date(t.setDate(t.getDate()+z.D));return Math.max(Math.ceil((i.valueOf()-Date.now())/864e5),1)}(e.modified),o=s<2?t.deletesTomorrow:(0,_.a)(i.state.lang,t.deletes,s);return(0,r.h)("div",null,(0,r.h)("span",{class:"date-deleted"},(0,_.b)(e.modified)),(0,r.h)("span",{class:"deletes-in"},o))}renderColumn(e,t,i){var s,o,l,c,d,u,p,m,g,v,b,f,y,w,I,k,S;const{item:x,api:F,portal:C,baseUrl:B,user:T,actions:E}=this,A=null!==(o=null===(s=this.store.state.activeFocus)||void 0===s?void 0:s[1])&&void 0!==o?o:0,O=this.isSimpleColumn(e),{header:P}=Ee[e],L=(null!==(c=null===(l=this.store.state.activeFocus)||void 0===l?void 0:l[0])&&void 0!==c?c:0)===this.index,D=t===this.getColumnNumber(A);if("title"===e&&"multiple"===this.store.state.selection)return this.renderTitle(i);const M={tabIndex:D&&L?0:-1},R=D&&L?{}:{tabIndex:-1},U=["owner"].includes(e),G=this.link&&"title"===e,$="action"===this.preview,j=$?"button":"a",z="modified"===e?(0,_.b)(x.modified,!0):"";return G?(0,r.h)("div",{onMouseOver:()=>{this.mouseOverColumn=0},role:"gridcell",id:`row-${x.id}`,class:"cell--link__container"},(0,r.h)("a",Object.assign({},R,{href:this.link,target:this.newTab?"_blank":"_self",ref:t=>{O&&(this.columnRefs[e]={el:t,method:"focus"})},class:"cell cell--narrow cell--start-2 cell--end-2 checkbox__title title cell--link"}),(0,r.h)("span",{class:"cell--clamp"},this.item.title),this.titleIcon&&(0,r.h)("calcite-icon",{icon:this.titleIcon,scale:"s",class:"title__icon"}))):(0,r.h)("div",Object.assign({key:e},O?M:{},{role:"gridcell",class:{cell:!0,"cell--overflow":U,"cell--start-2":!P,"cell--end-2":!P,"cell--hoverable":"title"===e&&"title"===this.preview,"cell--hoverable--active":"title"===e&&this.store.state.preview===x.id&&!G,"cell--link":"title"===e&&this.link&&"title"!==this.preview},ref:t=>{O&&(this.columnRefs[e]={el:t,method:"focus"})}},z?{title:z}:{},G?{href:this.link}:{onClick:()=>{setTimeout(()=>{const i="multiple"===this.store.state.selection?t+1:t;D&&L||(this.store.state.activeFocus=[this.index,i]),"title"!==e||"title"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(x)},100)}},{onMouseOver:()=>{this.mouseOverColumn=t}}),(0,r.h)("span",{class:{"cell--clamp":this.clampColumn(e),"cell__inner-container":!0}},"title"===e&&(0,r.h)("span",{class:"title"},this.item.title),"type"===e&&(0,r.h)("arcgis-item-type",{item:x,portal:this.portal,showHosted:this.showItemTypeHosted,user:T,class:"item-type",scale:"m",showText:this.store.state.width>h.b.md}),"modified"===e&&(0,_.b)(x.modified),"created"===e&&(0,_.b)(x.created),"deleted"===e&&this.renderDeleted(),"size"===e&&(0,n.f)(x.size),"badges"===e&&(0,r.h)("arcgis-item-badges",Object.assign({ref:e=>this.badges=e,showTooltips:!0,item:x,user:T,portal:C,width:"narrow",scale:"s",useProduction:"all"===(null===(u=null===(d=this.store)||void 0===d?void 0:d.state)||void 0===u?void 0:u.bucket)&&(null==C?void 0:C.isPortal)},R)),"sharing"===e&&(0,r.h)("arcgis-item-share-summary-editable",Object.assign({user:T,showText:!1,item:x,scale:"m",allowEdit:this.allowSharing,groups:this.store.state.groupSharing[x.id],userGroups:this.store.state.userContentGroups,ref:e=>{this.allowSharing&&(this.columnRefs.sharing={el:e,method:"setFocus"})},portal:C,config:a.c.config},R,{onClick:()=>{this.emitInternalAction("share")}})),"owner"===e&&(0,r.h)("arcgis-user-popup",Object.assign({item:x,underline:!0,api:F,portal:C,baseUrl:B,scale:"m",class:"user-popup",showName:this.store.state.width>h.b.lg,showAvatar:this.store.state.width<=h.b.lg,wrap:!0,ref:e=>{this.columnRefs.owner={el:e,method:"setFocus"}},onArcgisUserPopupInternalUIAction:e=>{var t;this.emitInternalAction(null===(t=e.detail)||void 0===t?void 0:t.action)}},R)),"details"===e&&(this.store.state.recycleBin?(0,r.h)("button",Object.assign({},R,{class:"button",ref:e=>{this.columnRefs.details={el:e,method:"focus"}},onClick:()=>{this.arcgisItemBrowserRestoreItem.emit(this.item)}}),this.i18n.restore):(0,r.h)(j,Object.assign({},R,$?{}:{href:`${(0,N.r)(this.baseUrl)}/item.html?id=${x.id}`,target:"_blank"},{class:{button:!0,"button--active":$&&this.store.state.preview===x.id},ref:e=>{this.columnRefs.details={el:e,method:"focus"}},onClick:()=>{"action"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(x),this.store.state.activeFocus=[this.index,1],this.emitInternalAction("view details")}}),$?null===(g=null===(m=null===(p=this.store)||void 0===p?void 0:p.state)||void 0===m?void 0:m.i18n)||void 0===g?void 0:g.card.openDetails:this.i18n.details)),"download"===e&&(0,r.h)("div",null,(0,r.h)("calcite-button",{key:e,iconStart:"download",onClick:()=>this.emitInternalAction("download"),appearance:"transparent",kind:"neutral",id:"download",width:"full"}),(0,r.h)("calcite-tooltip",{"reference-element":"download",placement:"bottom"},(0,r.h)("span",null,this.i18n.download))),"favorite"===e&&!this.onlineInPortal&&(0,r.h)("arcgis-item-favorite",Object.assign({item:x,portal:C,user:T||(null===a.c||void 0===a.c?void 0:a.c.user),iconOnly:!0,ref:e=>{this.columnRefs.favorite={el:e,method:"setFocus"}},onArcgisItemFavoriteUpdate:e=>{this.emitInternalAction(e.detail.favorite?"add to fav":"remove from fav")},showTooltip:!0},R)),"dataset"===e&&(0,r.h)("span",{class:"dataset"},this.item.datasetName),"actions"===e&&(0,r.h)("span",null,E.length>0&&(0,r.h)("arcgis-item-actions",Object.assign({ref:e=>{this.columnRefs.actions={el:e,method:"setFocus"}},item:x,portal:C,user:T,actions:E,showFavorite:this.showFavoriteInActionsMenu,previewText:null===(f=null===(b=null===(v=this.store)||void 0===v?void 0:v.state)||void 0===b?void 0:b.i18n)||void 0===f?void 0:f.card.openDetails,showPreview:Boolean(null==E?void 0:E.length)&&(null===(I=null===(w=null===(y=this.store)||void 0===y?void 0:y.state)||void 0===w?void 0:w.columns)||void 0===I?void 0:I.includes("details"))&&(null===(S=null===(k=this.store)||void 0===k?void 0:k.state)||void 0===S?void 0:S.width)<Ee.details.hide&&"action"===this.preview},R,{keyHandler:(e,t)=>{if(!t)switch(e.key){case"ArrowRight":this.arcgisItemBrowserFocusMove.emit("right");break;case"ArrowLeft":this.arcgisItemBrowserFocusMove.emit("left");break;case"ArrowUp":this.arcgisItemBrowserFocusMove.emit("up");break;case"ArrowDown":this.arcgisItemBrowserFocusMove.emit("down")}e.stopPropagation()},onArcgisItemActionsOpen:()=>{this.arcgisItemBrowserActionsOpen.emit({actions:this.actions,el:this.columnRefs.actions.el})},onArcgisItemActionClick:e=>{"preview"===e.detail&&this.arcgisItemBrowserCardPreview.emit(x),this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:"more options",attribute:e.detail})}})))))}render(){var e,t;const{item:i,store:s,i18n:o}=this;if(!i||!s||!o)return;const a=(this.store.state.columns||[]).filter(e=>Ae(e,this.store.state.width)),l=null===(e=this.store)||void 0===e?void 0:e.state.selection,n=["single","multiple"].includes(l)&&(0,g.i)({item:i,selectedItems:null===(t=this.store)||void 0===t?void 0:t.state.selectedItems});return(0,r.h)(r.H,Object.assign({},n?{"data-selected":!0}:{},{onMouseOver:()=>{this.hasMouse=!0},onMouseOut:()=>{this.hasMouse=!1}}),(0,r.h)("div",Object.assign({class:{row:!0,"row--selected":n,"row--first":0===this.index},role:"row"},n?{ariaSelected:!0}:{},{"aria-labelledby":`row-${i.id}`}),a.map((e,t)=>this.renderColumn(e,t,n))))}get el(){return(0,r.a)(this)}static get watchers(){return{preview:["updateDetailsText"]}}};Pe.style=":host{display:block;--item-browser-table-row-active-background:var(--calcite-color-foreground-1)}@media (forced-colors: active){calcite-checkbox{border:1px solid var(--calcite-color-border-1)}}.row{display:grid;background-color:var(--calcite-color-foreground-1);grid-template-columns:var(--item-browser-table-columns);border:1px solid var(--calcite-color-foreground-1);border-top:1px solid var(--calcite-color-border-2);margin-top:-1px}.row--first{border-top-color:var(--calcite-color-foreground-1)}.row--selected{position:relative;border-color:var(--calcite-color-brand);background-color:var(--item-browser-table-row-active-background)}.row--selected-last{border-top-color:var(--item-browser-table-row-active-background)}.cell{display:flex;align-items:center;justify-content:flex-start;padding-top:0.5rem;padding-bottom:0.5rem;padding-inline-start:0.75rem;padding-inline-end:0.25rem;font-size:0.875rem;color:var(--calcite-color-text-1);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;outline-color:transparent;line-height:1.35}.cell:focus{outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.cell--clamp{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.cell--link{background-color:transparent;text-decoration-line:none;transition-property:all;transition-duration:150ms}.cell--link:hover,.cell--link:focus{background-color:var(--calcite-color-background);text-decoration-line:underline;text-decoration-style:solid}.cell--link__container{display:flex;flex:1 1 0%}.cell--start-2{padding-inline-start:0.5rem}.cell--end-2{padding-inline-end:0.5rem}.cell--overflow{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:break-word}.cell--hoverable{background-color:transparent;transition-property:all;transition-duration:150ms}.cell--hoverable:hover,.cell--hoverable--active{cursor:pointer;background-color:var(--calcite-color-foreground-2);text-decoration-line:underline;text-underline-offset:2px;transition:background-color text-decoration 200ms linear}.cell__inner-container{width:100%}.checkbox-wrap{display:flex}.checkbox__title{flex:1 1 0%}.title{word-break:break-all}.user-popup{width:100%}.item-type{display:flex}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.date-deleted{display:block;padding-bottom:0.25rem;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-1)}.deletes-in{display:block;font-size:0.75rem;font-weight:400;color:var(--calcite-color-text-2)}.button{border:1px solid var(--calcite-color-foreground-3);font-family:inherit;font-size:inherit;line-height:1;box-sizing:border-box;display:flex;max-width:100%;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;align-items:center;background-color:var(--calcite-color-foreground-1);padding-left:0.75rem;padding-right:0.75rem;padding-top:0.5rem;padding-bottom:0.5rem;color:var(--calcite-color-text-1);text-decoration-line:none;outline-color:transparent;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s}.button:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.button:focus{outline:2px solid var(--calcite-color-brand);outline-offset:2px}.button--active{background-color:var(--calcite-color-foreground-3)}.button--transparent{border:1px solid transparent;background:transparent;padding-left:0.5rem;padding-right:0.5rem}.button--transparent:hover{background-color:var(--calcite-color-foreground-2);box-shadow:none}.button__icon{pointer-events:none}.title__icon{margin-inline-start:0.5rem}";const Le=class{constructor(e){(0,r.r)(this,e)}async componentWillLoad(){this.store=(0,v.g)(this.el)}render(){var e,t;return(0,r.h)(r.H,{key:"310d4af5c52c6ef174477083148b5f996cd23446"},(0,r.h)("arcgis-browser-top-bar",{key:"00110ff393df8a8c5598ab7d2fb13eb665a70ae2",store:this.store,filtersDisabled:"subscription content"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)},(0,r.h)("div",{key:"989a0bac2010d75041bb7eec9a2a542675987ee9",slot:"content-start"},(0,r.h)("slot",{key:"b59e3cb4dc6d530e6c84cec6330e4e4ee95d22e8",name:"content-start"})),(0,r.h)("div",{key:"ab29139131a25623960a398a912241a5ecf12465",slot:"bucket"},(0,r.h)("slot",{key:"e657cd4df535485e5de2069f7dbce3875df875d0",name:"bucket"})),(0,r.h)("div",{key:"28482ba9d599d10e56cb5e8ba90a07f893c70991",slot:"primary-filter"},(0,r.h)("slot",{key:"5bdf8192bc3fad4d9015038633c3cd1f9c291f4c",name:"primary-filter"})),(0,r.h)("div",{key:"2f25468714b8a0c6a20643537cffe7c009247e2e",slot:"search"},(0,r.h)("slot",{key:"5780081e2627110da74a4444dc20c83de243aaa6",name:"search"})),(0,r.h)("div",{key:"d694d616547636b7f4682a774610f569b0f34e96",slot:"content-end"},(0,r.h)("slot",{key:"a038a4004ef777d24cea6744428e5f5380f9f287",name:"content-end"}))))}get el(){return(0,r.a)(this)}},De=class{constructor(e){(0,r.r)(this,e),this.arcgisItemBrowserView=(0,r.c)(this,"arcgisItemBrowserView",7),this.arcgisItemBrowserInternalUIAction=(0,r.c)(this,"arcgisItemBrowserInternalUIAction",7),this.options=["grid","list"],this.view=void 0}async componentWillLoad(){this.store=(0,v.g)(this.el);const e=await(0,C.g)(this.el);this.i18n=null==e?void 0:e.view;const{view:t}=this;t||(this.view=this.store.state.view||"list"),(0,v.h)(this.store,e=>{this.view=e})}syncStore(e){this.store.state.view=e}componentDidLoad(){this.arcgisItemBrowserView.emit(this.view)}renderOption(e){return(0,r.h)("calcite-dropdown-item",{key:e,selected:e===this.view,onCalciteDropdownItemSelect:()=>{this.arcgisItemBrowserView.emit(e),this.arcgisItemBrowserInternalUIAction.emit({category:"switch view",action:e})},iconStart:e,iconFlipRtl:"start"},this.i18n[e])}renderButton(){var e,t;const{i18n:i,view:s}=this,o={class:"button",slot:"trigger",scale:"m",appearance:"outline-fill",kind:"neutral",iconStart:s,iconFlipRtl:"start",ariaLabel:`${i.view}: ${i[s]}`};return(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.width)>h.D?(0,r.h)("calcite-button",Object.assign({},o),i[s]):(0,r.h)("calcite-button",Object.assign({},o))}render(){var e,t;if(!(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.recycleBin))return(0,r.h)(r.H,null,(0,r.h)("calcite-dropdown",{placement:"bottom-end",scale:"m",overlayPositioning:"fixed",widthScale:"s"},this.renderButton(),(0,r.h)("calcite-dropdown-group",{selectionMode:"single"},this.options.map(e=>this.renderOption(e)))))}get el(){return(0,r.a)(this)}static get watchers(){return{view:["syncStore"]}}}},78242:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>l,c:()=>c,d:()=>d,e:()=>p,f:()=>u,g:()=>o,h:()=>a,o:()=>h,r:()=>m});var r=i(74174),s=i(80619);function o(e){return(0,r.g)(e,"arcgis-item-browser")}const a=(e,t)=>{e.onChange("view",e=>{t(e)})},l=(e,t)=>{e.onChange("contentUser",e=>{t(e)})},n=(e,t)=>{e.onChange("bucket",e=>{t(e)})},c=(e,t)=>{e.onChange("filters",e=>{t(e)})},d=(e,t)=>{e.onChange("folders",e=>{t(e)})},h=(e,t)=>{e.onChange("recycleBin",e=>{t(e)})},u=(e,t)=>{e.onChange("preview",e=>{t(e)})},p=(e,t)=>{e.onChange("sort",e=>{t(e)})},m=e=>(Object.keys(e).forEach(t=>{s.I.includes(t)||delete e[t]}),e)},79238:(e,t,i)=>{i.d(t,{a:()=>r,e:()=>s,f:()=>o});const r={point:"point",line:"line",polygon:"polygon",multipatch:"cube",table:"table",multipoint:"layer-points"},s={esriGeometryPoint:"point",esriGeometryPolyline:"line",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"cube",esriGeometryMultipoint:"point",none:"table"},o={esriFieldTypeOID:"key",esriFieldTypeBoolean:"boolean",esriFieldTypeString:"string",esriFieldTypeSingle:"number",esriFieldTypeDouble:"number",esriFieldTypeInteger:"integer",esriFieldTypeSmallInteger:"integer",esriFieldTypeGlobalID:"key",esriFieldTypeDate:"date-time",esriFieldTypeBigInteger:"integer",esriFieldTypeDateOnly:"calendar",esriFieldTypeTimeOnly:"clock",esriFieldTypeTimestampOffset:"time-zone",esriFieldTypeGUID:"key"}},79321:(e,t,i)=>{i.d(t,{g:()=>s});var r=i(12192);async function s(e){const t=await(0,r.g)(e,"arcgis-item-browser");return t&&t.length?t[0]:null}},80619:(e,t,i)=>{i.d(t,{I:()=>r,a:()=>s});const r=["folder","group","contentType"],s=99999},80729:(e,t,i)=>{i.d(t,{a:()=>s,g:()=>r});const r=e=>e.match(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F700}-\u{1F77F}]|[\u{1F780}-\u{1F7FF}]|[\u{1F800}-\u{1F8FF}]|[\u{1F900}-\u{1F9FF}]|[\u{1FA00}-\u{1FA6F}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu),s=e=>{const t=o(e);if(t)return t;const i=r(e);return i||null},o=e=>e.match(/[<>\/]/g)},89209:(e,t,i)=>{i.d(t,{D:()=>r,M:()=>s});const r=14,s=5}}]);