/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103"],{931:(e,t,i)=>{i.d(t,{l:()=>o});var r=i(93814);const o=async(e,t)=>(await r.e.exports.loadModules(e,t)).map(e=>e.__esModule&&e.default?e.default:e)},1654:(e,t,i)=>{i.d(t,{A:()=>w,B:()=>E,C:()=>L,D:()=>M,E:()=>p,F:()=>A,a:()=>n,b:()=>l,c:()=>s,d:()=>f,e:()=>F,f:()=>y,g:()=>x,h:()=>C,i:()=>g,j:()=>T,k:()=>N,l:()=>c,m:()=>d,n:()=>a,o:()=>I,p:()=>h,q:()=>v,r:()=>m,s:()=>j,t:()=>D,u:()=>u,v:()=>k,w:()=>P,x:()=>O,y:()=>$,z:()=>b});var r=i(46904);const o=e=>{var t,i,r;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(i=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==i?i:null===(r=null==e?void 0:e.sourceJSON)||void 0===r?void 0:r.id};function l(e){return e&&!e.orgId}function s(e,t){return(0,r.u)(e,t)||"update"===e.itemControl||(0,r.c)([e],t)&&y(t)}function n(e,t){const i=(0,r.c)([e],t),o=(0,r.u)(e,t)||y(t)&&i,l=x(t)&&S(t);return!!(o||i&&l)}const a=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageLicenses"))},c=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:inviteUsers"))},d=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageRoles"))},u=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:changeUserRoles"))},h=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewGroups"))},v=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewUsers"))};function g(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function p(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}function m(e){return["Geoanalytics Engine","GeoAnalytics MS Fabric"].includes(null==e?void 0:e.type)}const f=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("Developer")},b=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("PublicSharingDisabled")},w=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("HostedServicesPublicSharingDisabled")};function y(e){return"org_admin"===o(e)||"account_admin"===o(e)}function F(e){return["org_admin","account_admin"].includes(o(e))&&!(null==e?void 0:e.roleId)}function x(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function T(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function C(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function I(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:assignToGroups"))}const S=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))};function k(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function P(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function E(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function $(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function L(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function O(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function N(e,t,i,r){const o=r&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(r.type),l=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!y(t)&&!l||!(null==i?void 0:i.isPortal)&&!o)}function A(e){return!!e&&(!x(e)||x(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const M=({items:e,user:t,portal:i})=>{const o=e[0],l=o.owner;if(i.isPortal&&l!==t.username&&l.includes("esri_")&&!["esri_livingatlas"].includes(l))return!1;const n=(0,r.u)(o,t),a=x(t),c=R(t),d=s(o,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!a&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||k(e)||P(e)||!!t.canSharePublic&&E(e)}(t,i)||R(t));return n||d||(0,r.c)(e,t)&&c};function R(e){return O(e)||$(e)||L(e)}const _=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];function D(e){return e.some(e=>_.includes(e))}function j(e){return e.filter(e=>_.includes(e))}},4429:(e,t,i)=>{i.d(t,{a:()=>a,b:()=>u,c:()=>l,d:()=>c,e:()=>o,f:()=>r,g:()=>h,i:()=>v,m:()=>s,t:()=>n,u:()=>d});const r=(e,t)=>{let i,r="idle";const o=(...o)=>new Promise(l=>{switch(r){case"flushed":r="idle",i?(clearTimeout(i),l(e(...o))):l(null);break;case"invoked":clearTimeout(i),r="idle",l(e(...o));break;case"cancelled":clearTimeout(i),r="idle",l(null);break;default:i&&clearTimeout(i),r="pending",i=setTimeout(()=>(r="idle",l(e(...o))),t)}});return o.flush=function(...e){return r="flushed",o(...e)},o.invoke=function(...e){return r="invoked",o(...e)},o.cancel=function(...e){return r="cancelled",o(...e)},o.getStatus=function(){return r},o};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e){return null!=e}async function s(e,t){return await Promise.all([e,n(t)]),e}function n(e){return new Promise(t=>setTimeout(t,e))}const a=(e,t)=>Object.fromEntries((e||[]).map(e=>{const{key:i,data:r}=t(e);return[i,r]})),c=(e,t)=>e.length===t.length&&e.reduce((e,i)=>e&&t.indexOf(i)>-1,!0);function d(e,t){const i=[],r={};return e.forEach(e=>{const o=t(e);null==r[o]&&(r[o]=e,i.push(e))}),i}function u(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter(e=>{let r=typeof e;return r in t?!t[r].hasOwnProperty(e)&&(t[r][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}const h=(e,t)=>[...Array(Math.ceil(e.length/t))].map((i,r)=>e.slice(t*r,t+t*r)),v=(e,t)=>e.includes(t)},12192:(e,t,i)=>{i.d(t,{a:()=>s,g:()=>c});var r=i(15332),o=i(94984),l=i(87849);function s(e){var t,i,l;const s=null!==(t=(0,r.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===l?void 0:l.documentElement,n=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return o.l.has(n)?o.l.get(n):o.l.has(n.slice(0,2))?o.l.get(n.slice(0,2)):"en"}const n={};function a(e,t){const i=`${e}${t}`;return n[i]||(n[i]=function(e,t){return new Promise((i,r)=>{fetch((0,l.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then(e=>{e.ok?i(e.json()):r()},()=>r())})}(e,t)),n[i]}async function c(e,t){const i=t||e.tagName.toLowerCase(),l=s(e),n=function(e){var t,i,l;const s=null!==(t=(0,r.c)(e,"[lang]"))&&void 0!==t?t:null===(l=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===l?void 0:l.documentElement,n=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return o.l.has(n)?o.l.get(n):o.l.has(n.slice(0,2))?n:"en"}(e);let c;try{c=await a(i,l)}catch(e){console.warn(`no locale for ${i} (${l}) loading default locale en.`),c=await a(i,"en")}return[c,l,n]}},22407:(e,t,i)=>{i.d(t,{a:()=>s,g:()=>l});var r=i(4429),o=i(80729);function l(e,t){if(function(e,t){return null==t?void 0:t.some(t=>t.title===e)}(e,t))return{error:"folderAlreadyExists"};if(!e||0===e.trim().length)return{error:"noName"};const i=(0,o.a)(e);return(null==i?void 0:i.length)>0?{error:"invalidCharacters",invalidCharacters:(0,r.b)(i)}:null}function s(e){const{folderId:t,currentUsername:i,selectedFolderId:r}=e;switch(t){case"all":return"folders";case i:return"home";case"recycle":return"recycle-bin";default:return t===r?"folder-open":"folder"}}},24869:(e,t,i)=>{i.d(t,{a:()=>l,f:()=>c,g:()=>a,s:()=>s,v:()=>n});var r=i(15912),o=i(46227);function l(e,t){const i=/(?:\.([^.]+))?$/;let r=null==e?void 0:e.replace(/^.*(\\|\/|:)/,""),l=r&&i.exec(r)[1]?i.exec(r)[1].toLowerCase():"",s="";if((null==r?void 0:r.indexOf(".rft."))>-1){const[e,t]=r.split(".rft.");l=`rft.${t}`,s=e}return r&&!s&&(s=-1===r.lastIndexOf(".")?r:r.substring(0,r.lastIndexOf("."))),s=s.replace(/\.|-/g,"_"),t&&(s=function(e){return`${e}_${(0,o.g)()}`}(s),r=`${s}.${l}`),{title:s,fileName:r,extension:l}}function s(e,t){return l(e.name,!!t)}function n(e,t){let i=e;const r=e.lastIndexOf("\\");return r>-1&&(i=i.substring(r+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function a(e){return r.a[e]?r.a[e]:r.a[Object.keys(r.a).find(t=>r.a[t].type===e)]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},26262:(e,t,i)=>{i.d(t,{a:()=>o,g:()=>l,i:()=>s});var r=i(41473);const o=(e,t)=>(0,r.a)(`${(0,r.g)(e)}community/groups/${t.id}`),l=(e,t)=>`${((e,t)=>(0,r.a)(`${(0,r.g)(e)}content/groups/${t.id}`))(e,t)}search`,s=e=>{var t;return null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.includes("distributed")}},37362:(e,t,i)=>{i.d(t,{U:()=>r,a:()=>l,b:()=>o,g:()=>s});const r="/Categories",o=(e,t,i=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function l(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||r}const s=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},46227:(e,t,i)=>{i.d(t,{g:()=>r});const r=()=>[2,1,1,1,3].map(e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}).join("-")},50315:(e,t,i)=>{i.d(t,{a:()=>g,b:()=>u,c:()=>v,d:()=>m,e:()=>h,f:()=>d,g:()=>c,u:()=>p});var r=i(83692),o=i(37362),l=i(59317),s=i(26262),n=i(41473),a=i(1654);const c=async({portal:e,user:t,group:i,useCache:r=!1})=>{var o;try{const l=await(i?u(i.id,e,r):d(e,t,r));return{result:null!==(o=null==l?void 0:l.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function d(e,t,i=!0){if(null!=e||(e=l.c.portal),null!=t||(t=l.c.user),!(null==e?void 0:e.id)||t&&(0,a.b)(t))return null;const o=()=>(0,r.r)(`${(0,n.g)(e)}portals/${e.id}/categorySchema`);return i?(0,r.f)(o,"categorySchema",e.id):o()}async function u(e,t,i=!0){if(null!=t||(t=null===l.c||void 0===l.c?void 0:l.c.portal),!e||!t)return null;const o=()=>(0,r.r)(`${(0,s.a)(t,{id:e})}categorySchema`);return i?(0,r.f)(o,"categorySchema",e):o()}const h=async({user:e,portal:t,useCache:i=!1})=>{var r;const o=await v(t,e,i);return{result:null!==(r=null==o?void 0:o.memberCategorySchema)&&void 0!==r?r:null}};async function v(e,t,i=!0){if(null!=e||(e=l.c.portal),null!=t||(t=l.c.user),!(null==e?void 0:e.id)||t&&(0,a.b)(t))return null;const o=()=>(0,r.r)(`${(0,n.g)(e)}portals/${e.id}/memberCategorySchema`);return i?(0,r.f)(o,"memberCategorySchema",e.id):o()}async function g(e,t,i=!0){const o=()=>async function(e,t){var i;const o=(0,n.g)(e),l=(0,n.b)(e),a=await(0,r.r)(`${o}portals/self?culture=${l}`),c=await(0,r.r)(`${o}community/groups?q=${a.contentCategorySetsGroupQuery}`),d=null===(i=null==c?void 0:c.results)||void 0===i?void 0:i[0],u=(await(0,r.r)((0,s.g)(e,d),{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${o}content/items/${u.id}/data`)}(e,t);return i?(0,r.f)(o,"categorySchema",t):o()}async function p({categories:e,itemIds:t,portal:i,group:o}){try{const l=`${(0,n.g)(i)}/content/${o?`groups/${o.id}/updateCategories`:"updateItems"}`,s=JSON.stringify(t.map(t=>{const i=Array.isArray(e)?e:e[t];return{[t]:o?i:{categories:i}}}));return{result:await(0,r.r)(l,{items:s},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const m=async({path:e,portal:t,group:i,updateInfo:r})=>{try{const l=(await f({category:e,portal:t,group:i,num:1})).total;if(0===l)return console.warn(`No items found with category ${e} when updating schema`),{};const s=100,n=Math.ceil(l/s),a=[];for(let l=0;l<n;l++)a.push(f({category:e,portal:t,group:i,start:l*s,num:s}).then(({results:t})=>{const l={};return t.forEach(t=>{var s;const n=null!==(s=i?t.groupCategories:t.categories)&&void 0!==s?s:[],a="change-title"===r.type?n.map(t=>{const i=(0,o.g)(e,r.newTitle);return t===e?i:t.replace(`${e}/`,`${i}/`)}):n.filter(t=>!t.startsWith(e));l[t.id]=a}),l}));const c=await Promise.all(a);return await Promise.all(c.map(e=>p({categories:e,itemIds:Object.keys(e),portal:t,group:i}))),{}}catch(t){return console.error(`Error ${r.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},f=({category:e,num:t=100,start:i=0,portal:o,group:l})=>{const a={start:i,num:t,categories:JSON.stringify([e])},c=l?(0,s.g)(o,l):`${(0,n.g)(o)}search`;return(0,r.r)(c,Object.assign(Object.assign({},a),{q:l?void 0:`orgid: ${o.id}`}))}},54251:(e,t,i)=>{i.d(t,{g:()=>o});var r=i(59317);function o(e){var t,i,o,l;return null!=e||(e=null===r.c||void 0===r.c?void 0:r.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(o=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===o?void 0:o.token)||(null===(l=null==e?void 0:e.portalUser)||void 0===l?void 0:l.token)||""}},80729:(e,t,i)=>{i.d(t,{a:()=>o,g:()=>r});const r=e=>e.match(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F700}-\u{1F77F}]|[\u{1F780}-\u{1F7FF}]|[\u{1F800}-\u{1F8FF}]|[\u{1F900}-\u{1F9FF}]|[\u{1FA00}-\u{1FA6F}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu),o=e=>{const t=l(e);if(t)return t;const i=r(e);return i||null},l=e=>e.match(/[<>\/]/g)},83692:(e,t,i)=>{i.d(t,{a:()=>p,b:()=>g,c:()=>v,f:()=>u,g:()=>w,i:()=>h,p:()=>b,r:()=>m});var r=i(59317),o=i(4429),l=i(931),s=i(41473),n=i(54251);const a={},c={},d={};async function u(e,t,i,r){var o,l,s,n;const u=null===(l=null===(o=d[t])||void 0===o?void 0:o[i])||void 0===l?void 0:l.expireAt,h=!!u&&(new Date).getTime()>u;if((null===(s=a[t])||void 0===s?void 0:s[i])&&!h)return a[t][i];c[t]||(c[t]={}),c[t][i]&&!h||(c[t][i]=e());const v=await c[t][i];if(a[t]||(a[t]={}),d[t]||(d[t]={}),a[t][i]=v,r){const{expireAfter:e,getExpireAfterFromResult:o}=r,l=o||e?(new Date).getTime()+(null!==(n=null==o?void 0:o(v))&&void 0!==n?n:e):null;d[t][i]=Object.assign(Object.assign({},d[t][i]),{expireAt:l})}return v}function h(e,t){var i;return null===(i=null==a?void 0:a[e])||void 0===i?void 0:i[t]}const v=(e,t)=>{var i,r;t?(null===(i=a[e])||void 0===i||delete i[t],null===(r=c[e])||void 0===r||delete r[t]):(delete a[e],delete c[e])};function g(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}async function p(e,t,i={},r){const[o]=await(0,l.l)(["esri/request"]);e.includes("f=")||t.append("f","json");const s=(0,n.g)();return s&&!t.has("token")&&t.append("token",s),new Promise((l,s)=>{o(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:r||"auto"})).then(e=>{l(e.data)}).catch(e=>s(e))})}async function m(e,t={},i={},o,s){const[n]=await(0,l.l)(["esri/request"]),{api:a,portal:c}=r.c,{customToken:d,addTokenManually:u,addSSL:h,useProxy:v}=i,g=Object.assign({},t);if(e.includes("f=")||!0===(null==s?void 0:s.excludeJson)||(g.f="json"),d)g.token=d;else if(!1!==u){const e=await w(c);e&&(g.token=e)}const p=!1===h?e:function(e){var t;const{config:i}=r.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}(e);if(3===a){const e=Object.assign({url:p,content:g,timeout:i.timeout||0},null==s?void 0:s.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return n(e,"post"===o?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:g,method:o||"auto"},i),{timeout:i.timeout||0,useProxy:v}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await n(p,e)).data}}const f=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const b=async(e,t,i)=>{var r,l;const s=null!==(r=null==t?void 0:t.pendingStatuses)&&void 0!==r?r:["processing","partial","Pending","InProgress","EXECUTING"],n=null!==(l=null==t?void 0:t.successStatuses)&&void 0!==l?l:["completed","Completed","COMPLETED"];let a=0;const c=async()=>{const r=await m(e,null==t?void 0:t.requestParams,{},i),l=r.status||r.jobStatus;if(s.includes(l))return await(0,o.t)((d=a++,1e3*f[d>-1&&d<f.length-1?d:f.length-1])),c();if(n.includes(l)||"failed"===l||"esriJobFailed"===l)return r;throw r;var d};try{return c()}catch(e){throw console.error(e),e}},w=async e=>{var t;if(!(null==e?void 0:e.isPortal)||!(0,s.i)(e))return(0,n.g)(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,s.i)(e))return;const{token:i}=await u(()=>y(e),"platformSelf",null!==(t=g(e.user))&&void 0!==t?t:e.id,{getExpireAfterFromResult:e=>e.expires_in});return i},y=async e=>{const t=await(async e=>{var t,i;const[r]=await(0,l.l)(["esri/identity/IdentityManager"]);return null!==(i=null===(t=(await u(()=>r.getCredential((0,s.g)(e),{oAuthPopupConfirmation:!1}),"credential",g(e.user))).oAuthState)||void 0===t?void 0:t.appId)&&void 0!==i?i:"arcgisonline"})(e),i={"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return m(`${(0,s.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:i,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:i}})}},93718:(e,t,i)=>{i.r(t),i.d(t,{arcgis_categories_picker:()=>F,arcgis_folder_picker:()=>x,arcgis_item_properties:()=>C,arcgis_summary_input:()=>I,arcgis_tags_picker:()=>P,arcgis_title_input:()=>E});var r=i(87849),o=i(37362),l=i(59317),s=i(4429),n=i(12192),a=i(50315),c=i(72257),d=i(94984),u=i(1654),h=i(22407),v=i(88878),g=i(37762),p=i(1536),m=i(80729),f=i(41473),b=i(83692),w=i(80562),y=i(24869);i(15332),i(26262),i(86562),i(931),i(93814),i(46904),i(54251),i(3826),i(95878),i(15912);const F=class{constructor(e){(0,r.r)(this,e),this.arcgisCategoriesPickerChange=(0,r.c)(this,"arcgisCategoriesPickerChange",7),this.renderCombobox=()=>{const{i18n:e,scale:t,schema:i,label:o}=this;return(0,r.h)("calcite-combobox",{label:null!=o?o:e.categories,maxItems:5,selectionMode:"ancestors",placeholder:e.assignCategories,scale:t,ref:e=>this.combobox=e,overlayPositioning:this.overlayPositioning},this.renderNestedCategories(i))},this.api=void 0,this.portal=void 0,this.scale=void 0,this.label=void 0,this.hideLabel=void 0,this.overlayPositioning=void 0,this.categories=[],this.schema=[],this.rootCategoryPath=o.U}async componentWillLoad(){var e,t,i,r,o,s,a;const d=await(0,n.g)(this.el);this.i18n=d[0],this.store=(0,c.g)(this.el),null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.scale)&&void 0!==t||(this.scale=l.c.scale),this.categories.length>0?this.updateCategories():this.categories=(null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.categories.length)>0?null===(s=null===(o=this.store)||void 0===o?void 0:o.state)||void 0===s?void 0:s.categories:c.i.categories,null===(a=this.store)||void 0===a||a.on("reset",()=>{var e,t;this.categories=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.categories})}async componentDidLoad(){var e,t,i;const{portal:r,schema:l}=this;if(r&&!(null==l?void 0:l.length))if(r.categories)this.schema=null===(e=r.categories[0])||void 0===e?void 0:e.categories;else{const e=await(0,a.f)(r);this.schema=null===(i=null===(t=e.categorySchema)||void 0===t?void 0:t[0])||void 0===i?void 0:i.categories,this.rootCategoryPath=(0,o.a)(e.categorySchema)}}updateCategories(){this.arcgisCategoriesPickerChange.emit(this.categories)}categoriesPickerChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];(0,s.d)(r,this.categories)||(this.categories=r)}renderNestedCategories(e,t){return e.map(e=>{const i=t?`${t}/${e.title}`:`${this.rootCategoryPath}/${e.title}`;return(0,r.h)("calcite-combobox-item",{key:i,value:i,textLabel:e.title,selected:this.categories.some(e=>e===i||e.toLocaleLowerCase()===i.toLocaleLowerCase()||e.toLocaleLowerCase().includes(`${i.toLocaleLowerCase()}/`))},e.categories&&this.renderNestedCategories(e.categories,i))})}render(){const{i18n:e,scale:t,schema:i,hideLabel:o,label:l,renderCombobox:s}=this;return o?s():!!i&&(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:"label"},null!=l?l:e.categories),s())}get el(){return(0,r.a)(this)}static get watchers(){return{categories:["updateCategories"]}}};F.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}";const x=class{constructor(e){(0,r.r)(this,e),this.arcgisFolderPickerChange=(0,r.c)(this,"arcgisFolderPickerChange",7),this.arcgisFolderPickerLoad=(0,r.c)(this,"arcgisFolderPickerLoad",7),this.canCreateNewFolder=!1,this.capComboboxTagWidth=()=>{var e,t;const{comboboxElement:i,overlayPositioning:r}=this;if("fixed"!==r)return;const o=null!==(e=null==i?void 0:i.offsetWidth)&&void 0!==e?e:0,l=null===(t=i.shadowRoot)||void 0===t?void 0:t.querySelector(".list-container");l&&(l.style.maxWidth=`${o}px`)},this.isTitleValid=e=>{var t;const i=(0,h.g)(e,this.folders);if(!i)return!0;const r=this.i18n.error;if("invalidCharacters"===i.error){const e=i.invalidCharacters;this.errorString=(0,d.a)(this.lang,r.invalidCharacters,e.length,{invalidCharacters:e.join(", ")})}else this.errorString=(null!==(t=r[i.error])&&void 0!==t?t:this.newItemI18n.cloud.error.generic.message).replace("${folder}",e);return this.showError=!0,!1},this.handleCreateNewFolderFromCreateLink=async()=>{this.showError=!1,await this.createNewFolder(this.filterText),this.listElement.filterText="",this.emptyFilterList=!1},this.renderItem=e=>{const{id:t,username:i,title:o}=e,{internalSelectedFolder:l}=this,s=t===(null==l?void 0:l.id),n=(0,h.a)({folderId:t,currentUsername:i,selectedFolderId:null==l?void 0:l.id});return this.alwaysOpen?(0,r.h)("calcite-list-item",{key:t,value:t,selected:s,class:"list-item",label:o,onCalciteListItemSelect:()=>this.handleNewFolderId(e.id)},(0,r.h)("calcite-icon",{slot:"content-start",scale:"s",icon:n})):(0,r.h)("calcite-combobox-item",{key:t,"data-id":t,value:t,heading:o,selected:s,icon:n})},this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.folder=void 0,this.selectedFolder=void 0,this.folders=[],this.alwaysOpen=void 0,this.disabled=!1,this.overlayPositioning=void 0,this.disallowFolderCreation=!1,this.filterHomeFolder=!1,this.internalSelectedFolder=void 0,this.newFolderActive=!1,this.emptyFilterList=!1,this.filterText=void 0,this.newFolderInput=void 0,this.createFolderText=void 0,this.showError=!1,this.errorString=void 0,this.newFolderInputElement=void 0,this.loading=!1,this.homeFolder=void 0}async componentWillLoad(){var e,t,i,r,o,s,a,d,h,v,g,p,m,f,b,w,y,F;const[x,T]=await Promise.all([(0,n.g)(this.el),(0,n.g)(this.el,"arcgis-new-item")]);this.i18n=x[0],this.lang=x[1],this.store=(0,c.g)(this.el),this.newItemI18n=T[0],null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=l.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=l.c.scale);const C=null!==(o=null===(r=this.selectedFolder)||void 0===r?void 0:r.id)&&void 0!==o?o:null===(s=this.folder)||void 0===s?void 0:s.id;null!==(a=this.internalSelectedFolder)&&void 0!==a||(this.internalSelectedFolder=null!==(p=null!==(g=null!==(d=this.folders.find(e=>e.id===C))&&void 0!==d?d:null===(v=null===(h=this.store)||void 0===h?void 0:h.state)||void 0===v?void 0:v.folder)&&void 0!==g?g:l.c.initialFolder)&&void 0!==p?p:null===(m=this.folders)||void 0===m?void 0:m[0]),this.createFolderText=this.i18n.createNewFolder,this.canCreateNewFolder=!this.disallowFolderCreation&&((0,u.e)(null===(f=this.portal)||void 0===f?void 0:f.user)||this.user&&(null===(w=null===(b=this.portal)||void 0===b?void 0:b.user)||void 0===w?void 0:w.username)===(null===(y=this.user)||void 0===y?void 0:y.username)),null===(F=this.store)||void 0===F||F.on("reset",()=>{var e,t,i,r,o;this.internalSelectedFolder=null!==(r=null!==(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.folder)&&void 0!==i?i:l.c.initialFolder)&&void 0!==r?r:null===(o=this.folders)||void 0===o?void 0:o[0]})}async componentDidLoad(){this.folders.length||await this.loadFolders(this.user),this.capComboboxTagWidth()}async handleUserChange(e,t){t&&e.username!==t.username&&(await this.loadFolders(e),this.internalSelectedFolder=this.getHomeFolder())}handleFolderChange(){this.selectedFolder||(this.arcgisFolderPickerChange.emit(this.internalSelectedFolder),this.folder=this.internalSelectedFolder)}handleSelectedFolderChange(){this.internalSelectedFolder=this.folders.find(e=>{var t;return e.id===(null===(t=this.selectedFolder)||void 0===t?void 0:t.id)})}async loadFolders(e){var t,i,r,o,l,s;this.loading=!0,this.folders=await(0,v.a)(e),this.filterHomeFolder&&(this.folders=this.folders.filter(e=>e.title!==e.id)),this.arcgisFolderPickerLoad.emit([...this.folders]);const n=null!==(o=null!==(i=null===(t=this.selectedFolder)||void 0===t?void 0:t.id)&&void 0!==i?i:null===(r=this.internalSelectedFolder)||void 0===r?void 0:r.id)&&void 0!==o?o:null===(l=this.folder)||void 0===l?void 0:l.id;this.internalSelectedFolder=null!==(s=this.folders.find(e=>e.id===n))&&void 0!==s?s:this.getHomeFolder(),this.loading=!1}getHomeFolder(){return this.folders.find(e=>e.title===e.id)}setNewFolderActive(){var e;null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),this.newFolderInputElement||(this.showError=!1,this.newFolderInput="")}checkForEmptySuggestions(e){var t,i;e.stopPropagation();const r=this.comboboxElement.shadowRoot.querySelector("input").value,{i18n:o}=this;this.emptyFilterList=(null===(t=this.comboboxElement.filteredItems)||void 0===t?void 0:t.length)<=1&&""!==r.trim(),this.createFolderText=this.emptyFilterList?o.noFoldersFoundCreate.replace("${folder}",r):o.createNewFolder,this.filterText=r,null===(i=this.createItem)||void 0===i||i.removeAttribute("hidden")}handleComboboxChange(e){if("create-folder"===e)return this.showError=!1,void(this.emptyFilterList?this.createNewFolder(this.filterText,!0):this.newFolderActive=!0);this.handleNewFolderId(e)}handleNewFolderId(e){var t,i;const r=null!==(i=null!==(t=this.folders.find(t=>t.id===e))&&void 0!==t?t:this.internalSelectedFolder)&&void 0!==i?i:this.homeFolder;this.selectedFolder?this.arcgisFolderPickerChange.emit(r):this.internalSelectedFolder=r}closeNewFolderInput(e){e.stopPropagation(),this.newFolderActive=!1}async saveActiveFolder(){if(!this.newFolderActive)return!0;try{await this.createNewFolder(this.newFolderInput)}catch(e){return this.errorString}return!this.showError}async setFocus(){this.comboboxElement&&(this.comboboxElement.setFocus(),this.comboboxElement.open=!0)}async createNewFolder(e,t){var i,r,o,n;const a=(null==e?void 0:e.trim())||"";if(this.showError=!1,!this.isTitleValid(a)){if(t){this.internalSelectedFolder=this.folders[0],await(0,s.t)(100);const e=null===(i=this.el.shadowRoot)||void 0===i?void 0:i.querySelector(`calcite-combobox-item[data-id="${null===(r=this.internalSelectedFolder)||void 0===r?void 0:r.id}"]`);e&&(this.createItem&&(this.createItem.selected=!1),e.selected=!0)}throw new Error}try{const{result:e}=await(0,v.c)(a,this.user);this.internalSelectedFolder=null==e?void 0:e.folder,this.folders=[this.internalSelectedFolder,...this.folders],l.c.folders=this.folders,this.newFolderActive=!1,this.showError=!1,await(0,s.t)(100);const t=null===(o=this.el.shadowRoot)||void 0===o?void 0:o.querySelector(`calcite-combobox-item[data-id="${null===(n=this.internalSelectedFolder)||void 0===n?void 0:n.id}"]`);t&&(this.createItem&&(this.createItem.selected=!1),t.selected=!0)}catch(e){throw this.errorString=e.message,this.showError=!0,e}}renderError(){const{scale:e}=this;return(0,r.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError,scale:e},this.errorString)}renderNewFolder(){const{i18n:e,scale:t}=this;return(0,r.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{var e;try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(t){throw null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),t}},scale:t},(0,r.h)("label",{slot:"label",htmlFor:"folderNameInput"},e.enterFolder),(0,r.h)("calcite-input",{id:"folderNameInput",placeholder:e.enterFolder,value:this.newFolderInput,maxLength:250,scale:t,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:async e=>{var t;switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(e){null===(t=this.newFolderInputElement)||void 0===t||t.setFocus()}break;case"Escape":this.newFolderActive=!1,this.showError=!1}},ref:e=>this.newFolderInputElement=e,status:this.showError?"invalid":"idle"}))}renderCombobox(){var e;const{i18n:t,scale:i,overlayPositioning:o}=this;return(0,r.h)("calcite-label",{scale:i,class:"input-height"},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.folder),(0,r.h)("div",null,this.newFolderActive?this.renderNewFolder():(0,r.h)("div",{class:"combobox-wrapper"},this.loading&&(0,r.h)("calcite-progress",{type:"indeterminate",class:"progress"}),(0,r.h)("calcite-combobox",{label:t.folder,selectionMode:"single-persist",maxItems:5,placeholder:this.loading?t.loading:t.searchFolders,scale:i,overlayPositioning:o,ref:e=>this.comboboxElement=e,disabled:this.loading||this.disabled,clearDisabled:!0,onCalciteComboboxChange:e=>{e.stopPropagation();const t=e.target.selectedItems[0].value;this.handleComboboxChange(t),this.selectedFolder&&(e.target.value=this.selectedFolder.id)},onCalciteComboboxBeforeClose:()=>{var e;!this.comboboxElement||(null===(e=this.comboboxElement.selectedItems)||void 0===e?void 0:e.length)||this.filterHomeFolder||(this.comboboxElement.value=this.internalSelectedFolder.id)}},!this.loading&&(0,r.h)(r.F,null,this.user&&this.canCreateNewFolder&&(0,r.h)("calcite-combobox-item",{class:"create-folder",value:"create-folder",heading:this.createFolderText,selected:!1,icon:"folder-plus",filterDisabled:!0,key:"create",ref:e=>{this.createItem=e}}),this.folders.map(this.renderItem))))),this.renderError())}renderList(){const{i18n:e}=this;return(0,r.h)(r.F,null,(0,r.h)("calcite-list",{label:e.folders,class:"list",selectionMode:"single-persist",selectionAppearance:"border",ref:e=>this.listElement=e,filterPlaceholder:this.loading?e.loading:e.searchFolders,onCalciteListFilter:t=>{var i;const r=t.target;this.emptyFilterList=(null===(i=r.filteredItems)||void 0===i?void 0:i.length)<1,this.createFolderText=e.create.replace("${folder}",r.filterText),this.filterText=r.filterText},onCalciteListChange:e=>{this.selectedFolder&&e.target.filteredItems.forEach(e=>{e.selected=e.value===this.selectedFolder.id})},filterEnabled:!0},this.emptyFilterList&&(0,r.h)("div",{class:"no-folders-found"},e.noFoldersFound,this.user&&(0,r.h)("calcite-link",{class:"create-link",onClick:this.handleCreateNewFolderFromCreateLink,onKeyDown:e=>{"Enter"===e.key&&this.handleCreateNewFolderFromCreateLink()}},this.createFolderText)),this.folders.map(this.renderItem)),this.user&&this.canCreateNewFolder&&(0,r.h)("div",{class:"below"},this.newFolderActive?this.renderNewFolder():(0,r.h)("calcite-button",{iconStart:"folder-plus",appearance:"transparent",onClick:()=>{this.showError=!1,this.newFolderActive=!0}},e.createNewFolder),this.renderError()))}render(){return(0,r.h)(r.H,{key:"f3aff2e985b96a1aa28912dc12ff87c3c74466a6"},this.alwaysOpen?this.renderList():this.renderCombobox())}get el(){return(0,r.a)(this)}static get watchers(){return{user:["handleUserChange"],internalSelectedFolder:["handleFolderChange"],selectedFolder:["handleSelectedFolderChange"],newFolderInputElement:["setNewFolderActive"]}}};var T;x.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.create-folder{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}.create-link{margin-left:0.25rem;margin-right:0.25rem}.combobox-wrapper{position:relative}.progress{position:absolute;top:0px;z-index:1}.below{margin-top:1.25rem}.list{max-height:15rem;overflow:auto;--tw-shadow:0 2px 12px -4px rgba(0, 0, 0, 0.2), 0 2px 4px -2px rgba(0, 0, 0, 0.16);--tw-shadow-colored:0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.list-item{min-width:0px;max-width:100%;text-overflow:ellipsis}.no-folders-found{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:3.5rem;padding-right:3.5rem;font-size:0.75rem;color:var(--calcite-color-text-1)}",function(e){e.arcgisTitleInputChange="title",e.arcgisFolderPickerChange="folder",e.arcgisSummaryInputChange="snippet",e.arcgisTagsPickerChange="tags",e.arcgisCategoriesPickerChange="categories"}(T||(T={}));const C=class{constructor(e){(0,r.r)(this,e),this.arcgisItemPropertiesChange=(0,r.c)(this,"arcgisItemPropertiesChange",7),this.portal=void 0,this.user=void 0,this.api=void 0,this.config=void 0,this.itemId=void 0,this.type=void 0,this.scale=void 0,this.resetStoreOnUnmount=!0,this.store=(0,g.c)({title:"",snippet:"",tags:[],categories:[]})}async resetItemPropertiesStore(){this.store.reset(),c.a.reset()}handleItemPropertiesChange(e){const{detail:t,type:i}=e;this.store.state[T[i]]=t,c.i[T[i]]=t,this.arcgisItemPropertiesChange.emit(Object.assign({},this.store.state))}async componentWillLoad(){var e,t;this.portal&&(l.c.portal=this.portal),this.user&&(l.c.user=this.user),this.config&&(l.c.config=this.config),this.itemId&&({result:this.store.state.item}=await(0,p.b)(this.itemId,this.portal)),this.type&&(this.store.state.type=null!==(e=this.type)&&void 0!==e?e:null===(t=this.store.state.item)||void 0===t?void 0:t.type),this.scale&&(l.c.scale=this.scale)}render(){return(0,r.h)(r.H,{key:"71f47895d51365ebf69a840cff963837723c1292"},(0,r.h)("slot",{key:"05e19332eef658d4c41d8cb9f3d5ba5e3ad00255"}))}disconnectedCallback(){this.resetStoreOnUnmount&&this.resetItemPropertiesStore()}get el(){return(0,r.a)(this)}},I=class{constructor(e){(0,r.r)(this,e),this.arcgisSummaryInputChange=(0,r.c)(this,"arcgisSummaryInputChange",7),this.updateLiveRegion=(0,s.f)(e=>{this.liveRegionText=this.getCharactersText(e)},1500),this.scale=void 0,this.label=void 0,this.summary=void 0,this.maxLength=2048,this.rows=2,this.minHeight=void 0,this.maxHeight=void 0,this.placeholder=void 0,this.trimInput=!0,this.readOnly=!1,this.liveRegionText=void 0,this.valid=!0,this.isTextSelected=!1}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async getErrorMessage(){return this.valid?null:{code:"summaryInvalid",translatedMessage:this.i18n.invalid}}async componentWillLoad(){var e,t;const i=await(0,n.g)(this.el);this.i18n=i[0],this.store=(0,c.g)(this.el),null!==(e=this.scale)&&void 0!==e||(this.scale=l.c.scale),null!==(t=this.summary)&&void 0!==t||(this.summary=this.store.state.snippet),this.placeholder=this.placeholder||this.i18n.addSummary,this.liveRegionText=this.getCharactersText(this.summary),this.store.on("reset",()=>{this.summary=this.store.state.snippet})}componentDidRender(){var e;const{rows:t,minHeight:i,maxHeight:r}=this,o=null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("calcite-text-area");o&&(o.style.minHeight=`${i}px`,o.style.maxHeight=`${r}px`,o.rows=t)}getCharactersText(e){return this.i18n.charactersLeft.replace("${num}",""+(this.maxLength-e.length))}validate(){this.valid=!/>|</.test(this.summary)}trimInputToMaxLength(e){return e.substring(0,this.maxLength)}getHighlightedText(){const e=window.getSelection().toString();this.isTextSelected=e.length>0&&this.summary.length===this.maxLength}render(){const{i18n:e,summary:t,label:i,maxLength:o,scale:l,liveRegionText:s,valid:n,placeholder:a,trimInput:c,readOnly:d}=this;return(0,r.h)("div",{key:"7ee4fbff17a86276eefef530daed95c39310cc6d",class:`container-${l}`},(0,r.h)("calcite-label",{key:"80034b1db725423624ea9cee821b8895a1571a29",scale:l,class:"label"},(0,r.h)("p",{key:"cdb6c4281660b399d0c9e5edd0f67f0789d32201",class:"label-text"},null!=i?i:e.summary),(0,r.h)("calcite-text-area",{key:"c388041ffa50ce6a9497d0f1f417371dd3775df0",ref:e=>this.mainInputRef=e,id:"summary-input",resize:"vertical",placeholder:a,value:t,maxLength:o,scale:l,status:n?"idle":"invalid",readOnly:d,"aria-label":d?e.summaryReadOnly:null,onKeyDown:e=>{!c||this.summary.length!==o||this.isTextSelected||"Space"!==e.code&&("Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowUp"===e.key||"ArrowRight"===e.key||"ArrowDown"===e.key||"Tab"===e.key||e.ctrlKey||e.metaKey)||e.preventDefault()},onMouseUp:()=>{this.getHighlightedText()},onCalciteTextAreaInput:e=>{e.stopPropagation();const t=e.target;let i=t.value;c&&i.length>o&&(i=this.trimInputToMaxLength(t.value)),this.summary=i,this.arcgisSummaryInputChange.emit(this.summary),this.updateLiveRegion(i),this.validate()}}),(0,r.h)("calcite-input-message",{key:"3a35060cd1e161ec633620476ec6fdf52ce9d696",hidden:n,icon:!0,scale:l,status:n?"idle":"invalid"},e.invalid),(0,r.h)("span",{key:"a0ca0bc7f5c872686b8cf662368d189dbc132ff4",class:"screen-readers-only","aria-live":"polite"},s)))}get el(){return(0,r.a)(this)}};function S(e){return null==e?void 0:e.includes("Photo locations")}I.style=":host{--arcgis-label-margin-bottom:1rem}.container-s{margin-bottom:0.5rem}.container-m{margin-bottom:0.75rem}.container-l{margin-bottom:1rem}.label{--calcite-label-margin-bottom:0}.label-text{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}.count{font-size:0.75rem;color:var(--calcite-color-text-1);opacity:0.75}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";async function k({portal:e,user:t,title:i,itemType:r,typeKeywords:o,folder:l,extension:n,enablePublishing:a=!1,update:c=!1}){if(!t||!e)return{code:"missingUserOrPortal"};if(!i||i.trim().length<=0)return{code:"titleRequired"};const d=(0,m.g)(null!=i?i:"");if(d)return{code:"titleInvalid",details:d};if("Data Store"===r&&(/[\s.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"dataStoreTitleInvalid"};if(!a&&(/<|>/gi.test(i)||i.length>250))return{code:"titleInvalid"};if(a&&(/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"serviceNameInvalid"};if((0,s.i)(["WFS","Scene Service"],r)&&i.match(/^\d/))return{code:"titleStartsWithNumber"};const u="Image Collection"===r&&!S(o),h=a?function(e,t){switch(e){case"Image Collection":return S(t)?"Feature Service":"Image Service";case"CSV":case"Microsoft Excel":case"GeoJson":case"Shapefile":case"File Geodatabase":case"GeoPackage":case"Service Definition":case"Feature Collection":return"Feature Service";case"Tile Package":return"Map Service";case"Vector Tile Package":return"Vector Tile Service";case"Scene Package":return"Scene Service";case"3DTiles Package":return"3DTiles Service"}return e}(r,o):u?"Image Service":r,{itemURLList:v}=await(0,p.k)(i,h,l,n,t,e)||{};if(v&&!c)return{code:"itemExists",itemUrl:v[0]};const g=function(e){switch(e){case"Feature Service":case"Map Service":return e;case"OGCFeatureServer":return"OGCFeatureService";case"WCS":return"WCS";case"Tile Package":case"Tile Layer":return"Map Service";case"Scene Package":return"Scene Service";case"Vector Tile Package":case"Vector Tile Service":return"Vector Tile Service";case"Image Collection":return"Image Service";case"WFS":return"WFS";default:return null}}(h);if(a&&g){const t=await(0,b.r)(`${(0,f.g)(e)}portals/${e.id}/isServiceNameAvailable`,{name:i.replace(/\s/g,"_"),type:g});if(!(null==t?void 0:t.available))return{code:"titleInUseService",layerName:i,inRecycleBin:!!t.inRecycleBin}}return null}const P=class{constructor(e){(0,r.r)(this,e),this.arcgisTagsPickerChange=(0,r.c)(this,"arcgisTagsPickerChange",7),this.isTag=e=>void 0!==e.tag&&void 0!==e.count,this.controlledTags=[],this.mapItemValue=e=>e.map(e=>e.value),this.addTagItems=e=>{(/\r|\n/.exec(e)?null==e?void 0:e.split(/\r?\n/):null==e?void 0:e.split(",")).forEach(e=>{(null==e?void 0:e.length)&&this.addTagItem(e)}),requestAnimationFrame(()=>{this.itemPropertiesTagsChangeHandler()})},this.addTagItem=(e,t)=>{var i,r,o,l;const s=null===(i=this.combobox)||void 0===i?void 0:i.querySelector(`calcite-combobox-item[text-label="${e}"]`);if(s)s.selected=!0;else{const t=document.createElement("calcite-combobox-item");t.value=e,t.textLabel=e,t.selected=!0,null===(r=this.combobox)||void 0===r||r.appendChild(t)}const n=null===(l=null===(o=this.combobox)||void 0===o?void 0:o.shadowRoot)||void 0===l?void 0:l.querySelector("input");n.value=t||"";const a=new InputEvent("input",{data:t||""});n.dispatchEvent(a)},this.handleKeyUp=e=>{var t;if(","===e.key){const i=e.target,r=null===(t=null==i?void 0:i.shadowRoot)||void 0===t?void 0:t.querySelector("input");if(null==r?void 0:r.value){const e=r.value.trim();if(!e)return;const t=null==e?void 0:e.endsWith(","),i=e.split(",");t||2!==(null==i?void 0:i.length)?this.addTagItems(e):(this.addTagItem(i[0],i[1]),requestAnimationFrame(()=>{this.itemPropertiesTagsChangeHandler()}))}}},this.api=void 0,this.user=void 0,this.scale=void 0,this.activeTags=[],this.knownTags=[],this.label=void 0,this.placeholder=void 0,this.hideLabel=void 0,this.doNotFetchTags=void 0,this.readOnly=!1}async componentWillLoad(){var e,t,i,r,o,s,a,d,u;const h=await(0,n.g)(this.el);this.i18n=h[0],this.store=(0,c.g)(this.el),null!==(e=this.user)&&void 0!==e||(this.user=l.c.user),null!==(t=this.scale)&&void 0!==t||(this.scale=l.c.scale),this.activeTags.length>0?(this.activeTags=(0,w.a)(this.activeTags),this.arcgisTagsPickerChange.emit(this.activeTags)):this.activeTags=(0,w.a)((null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.tags.length)>0?null===(s=null===(o=this.store)||void 0===o?void 0:o.state)||void 0===s?void 0:s.tags:c.i.tags),this.knownTags=(0,w.a)([...null!==(a=this.knownTags)&&void 0!==a?a:[],...null!==(d=this.activeTags)&&void 0!==d?d:[]]),null===(u=this.store)||void 0===u||u.on("reset",()=>{var e,t;this.activeTags=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.tags})}async componentDidLoad(){var e,t,i,r;const{user:o,doNotFetchTags:s}=this;if(!s&&o){const s=null!==(e=o.contentTags)&&void 0!==e?e:o.tags;if(!(null==s?void 0:s.length)||(null==s?void 0:s.length)>0&&!this.isTag(s[0])){const e=(await async function(e){null!=e||(e=l.c.user);const t=e.url+"/tags";try{return(await(0,b.r)(t)).tags}catch(e){console.error(e)}}(o)).map(e=>e.tag),i=null===(t=this.activeTags)||void 0===t?void 0:t.map(e=>null==e?void 0:e.toLowerCase()),r=null==e?void 0:e.filter(e=>!(null==i?void 0:i.includes(e.toLowerCase())));this.knownTags=[...this.knownTags,...r]}else this.knownTags=[...this.knownTags,...s.map(e=>e.tag)];this.knownTags=(0,w.a)([...null!==(i=this.activeTags)&&void 0!==i?i:[],...null!==(r=this.knownTags)&&void 0!==r?r:[]])}}itemPropertiesTagsChangeHandler(e){var t;null==e||e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];this.arcgisTagsPickerChange.emit((0,w.a)(r));const o=Array.from(this.combobox.children),l=this.combobox.selectedItems;o.forEach(e=>{this.controlledTags.includes(e.value)||e.remove()});const s=[];l.forEach(e=>{const t=e.value;if(this.knownTags.includes(t))return;const i=this.knownTags.find(e=>e.toLowerCase()===t.toLowerCase());if(i){const e=o.find(e=>e.value===i);e&&(e.selected=!0,s.push(t))}}),this.knownTags=this.mapItemValue(o).filter(e=>!(null==s?void 0:s.includes(e))),this.activeTags=this.mapItemValue(l).filter(e=>!(null==s?void 0:s.includes(e)))}renderFormattedTags(){const{i18n:e,scale:t,handleKeyUp:i,placeholder:o,readOnly:l}=this;this.knownTags.forEach(e=>{this.controlledTags.includes(e)||this.controlledTags.push(e)});const s=this.knownTags.map(e=>{var t;return(0,r.h)("calcite-combobox-item",{key:e,value:e,textLabel:e.length>36?`${e.slice(0,36)}...`:e,selected:(null===(t=this.activeTags)||void 0===t?void 0:t.indexOf(e))>=0})});return(0,r.h)("calcite-combobox",{label:e.tags,maxItems:5,"allow-custom-values":!0,placeholder:null!=o?o:e.addTags,scale:t,onKeyUp:i,onPaste:e=>{var t;const i=null===(t=null==e?void 0:e.clipboardData)||void 0===t?void 0:t.getData("text");((null==i?void 0:i.includes(","))||/\r|\n/.exec(i))&&(e.preventDefault(),this.addTagItems(i))},ref:e=>this.combobox=e,readOnly:l},s)}async setFocus(){var e;null===(e=this.combobox)||void 0===e||e.setFocus()}render(){const{i18n:e,scale:t,hideLabel:i,label:o}=this;return(0,r.h)("calcite-label",{key:"52079db41884d9107bcce9c186223eb06b8ca78e",scale:t},(0,r.h)("p",{key:"545d8c365e05ab4bb890e41133a6ccd4d5e2ca4b",class:{label:!0,"screen-reader-only":i}},null!=o?o:e.tags),this.renderFormattedTags())}get el(){return(0,r.a)(this)}};P.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const E=class{constructor(e){(0,r.r)(this,e),this.arcgisTitleInputChange=(0,r.c)(this,"arcgisTitleInputChange",7),this.arcgisTitleInputValidation=(0,r.c)(this,"arcgisTitleInputValidation",7),this.debouncedInput=(0,s.f)(()=>this.handleTitleValidation(),400),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.itemTitle=void 0,this.currentFolder=void 0,this.type=void 0,this.typeKeywords=void 0,this.update=!1,this.enablePublishing=void 0,this.readOnly=!1,this.titleError=void 0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async validateTitle(){return this.debouncedInput.invoke()}async handleTitleValidation(){const{type:e,itemTitle:t,typeKeywords:i,enablePublishing:r,portal:o,user:l,update:s}=this,{extension:n}=(0,y.a)(t);if(e)return this.titleError=await k({portal:o,user:l,title:t,itemType:e,typeKeywords:i,folder:this.currentFolder,extension:n,enablePublishing:r,update:s}),this.arcgisTitleInputValidation.emit({valid:!this.titleError}),this.getErrorMessage();console.error("No item type found. Skipping title validation")}getErrorMessage(){const{lang:e,itemTitle:t,titleError:i,i18n:r}=this;if(t||(this.titleError={code:"titleRequired",translatedMessage:this.i18n.validation.titleRequired}),i)if(i.details&&"titleInvalid"===i.code){const t=i.details;i.translatedMessage=(0,d.a)(e,this.i18n.validation.invalidCharacters,t.length,{invalidCharacters:t.join(", ")})}else"titleInUseService"===i.code&&i.inRecycleBin?i.translatedMessage=r.validation.itemInRecycleBin.replace("${name}",t):r.validation[this.titleError.code]&&(i.translatedMessage=r.validation[this.titleError.code].replace("${name}",t));return i}async componentWillLoad(){var e,t,i,r,o,s;const a=await(0,n.g)(this.el);this.i18n=a[0],this.lang=a[1],this.store=(0,c.g)(this.el),null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=l.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=l.c.scale),null!==(r=this.type)&&void 0!==r||(this.type=this.store.state.type),null!==(o=this.itemTitle)&&void 0!==o||(this.itemTitle=this.store.state.title),null!==(s=this.currentFolder)&&void 0!==s||(this.currentFolder=this.store.state.folder),this.itemTitle&&this.handleTitleValidation(),this.store.state.title=this.itemTitle,this.store.on("reset",()=>{this.itemTitle=this.store.state.title})}render(){var e;const{i18n:t,itemTitle:i,scale:o,readOnly:l}=this,{translatedMessage:s,code:n}=this.titleError||{},a=!s;return(0,r.h)("calcite-label",{key:"1da64a3aed233b5ded4d2954e906e4b0caaec325",scale:o},(0,r.h)("p",{key:"705cb63995e8da9829c39931117015b07f417a67",class:"label"},null!==(e=this.label)&&void 0!==e?e:t.title),(0,r.h)("calcite-input",{key:"83483be3ae074c1c4cf4da35b24006f18e610b88",id:"item-properties-title",readOnly:l,disabled:l,placeholder:t.addTitle,value:i,scale:o,onInput:this.debouncedInput,max:250,ref:e=>this.mainInputRef=e,status:a?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation(),this.itemTitle=e.target.value,this.arcgisTitleInputChange.emit(this.itemTitle)}}),(0,r.h)("calcite-input-message",{key:"ec052bc679b2bed24258fcb17230e358cb17df08",icon:!0,hidden:a,status:a?"idle":"invalid"},s||t[n]||t.title))}get el(){return(0,r.a)(this)}static get watchers(){return{currentFolder:["handleTitleValidation"]}}};E.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}"},94984:(e,t,i)=>{i.d(t,{C:()=>n,a:()=>u,b:()=>d,f:()=>a,g:()=>s,l:()=>l,s:()=>v});var r=i(15332),o=i(931);const l=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function s(e){return function(e,t,i){const o=(0,r.c)(e,`[${t}]`);return o?o.getAttribute(t):i}(e,"dir","ltr")}const n={rtl:"arcgis--rtl"};async function a(e,t){const{api:i,type:r,places:l}=t||{};if(3===i){const[i]=await(0,o.l)(["dojo/number"]);return i.format(e,{type:r,places:l,pattern:null==t?void 0:t.pattern})}const[s]=await(0,o.l)(["esri/intl"]),n=s.convertNumberFormatToIntlOptions({places:l,style:r,digitSeparator:!0});return s.formatNumber(e,Object.assign(Object.assign({},n),{style:r}))}const c={};function d(e,t){let i=document.documentElement.lang;const r="bs"===i;if(r&&(i="hr"),t){const t=`${i}-full`,r={dateStyle:"full",timeStyle:"long"};return c[t]||(c[t]=new Intl.DateTimeFormat(i,r)),c[t].format(e)}const o={year:"numeric",month:r?"numeric":"short",day:"numeric"};return c[i]||(c[i]=new Intl.DateTimeFormat(i,o)),c[i].format(e)}function u(e,t,i,r){const o=null!=e?e:"en";let l=t.unknown;return(1===i||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(o))&&(l=t.single),1!==i&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(o)&&(l=t.multiple),v(l,Object.assign(Object.assign({},r),{number:i}))}const h=/\$\{([^}]+)\}/g;function v(e,t,i=h){let r=e;try{r=e.replace(i,(e,i)=>function(e,t){const i=e.split(".").reduce((e,t)=>e[t],t);return"string"==typeof i||"number"==typeof i?i:e}(i,t).toString())}catch(e){console.error(e)}return r}}}]);