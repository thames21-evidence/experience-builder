/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-a6c107.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-a6c107"],{89541:(o,e,t)=>{t.r(e),t.d(e,{ArcgisMapConfigPopupColorButton:()=>v});var r=t(73679),s=t(4395),l=t(56451),i=t(5294),c=t(59640),p=t(49403),n=t(83552),a=t(85643),h=t(73801),d=t(20936);const u=s.AH`.color-selector{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0 0 0 1px inset}.color-selector:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.color-selector:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.color-selector:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.color-selector.selected{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.color-icon-section{height:16px;display:inline-block}.color-icon{width:100%;height:16px;overflow:hidden;border-radius:0}.color-icon.transparent{height:15px;width:100%}.color-icon.transparent svg{height:15px;width:95%;stroke:#e0e0e0;stroke-width:1px}.color-edit-button{padding:1px;height:18px;width:18px;border:none;cursor:pointer;color:var(--calcite-icon-color)}.color-edit-button:focus{outline:none}`;class v extends h.WF{constructor(){super(...arguments),this._direction=(0,n.jH)(),this.resizeObserver=new ResizeObserver(()=>this.requestUpdate()),this.popoverButtonNode=(0,a._)(),this.selected=!1,this.arcgisPopupColorButtonBeforeOpen=(0,h.lh)(),this.arcgisPopupColorButtonChange=(0,h.lh)()}static{this.properties={selected:16,referenceElement:0,chartMediaInfo:0,colors:0,popupState:0}}static{this.styles=u}async closePopover(){this.closeColorPopover()}async setFocus(){this.popoverButtonNode.value?.focus()}loaded(){this.requestUpdate(),this.resizeObserver.observe(this.popoverButtonNode.value)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.disconnect()}async openColorPopover(){const{popoverNode:o,colors:e}=this,t=(0,d.el)(this.el,"calcite-panel");if(o)this.closeColorPopover();else if(1===e.length){this.arcgisPopupColorButtonBeforeOpen.emit(),this.selected=!0;const o=(0,h.dN)(s.qy`<arcgis-map-config-popup-color-popover .hexColor=${e[0].toHex()} .popoverProps=${{placement:"leading-start",offsetDistance:1,offsetSkidding:52,popoverWidth:315,refElement:t}} .popupState=${this.popupState} @arcgisPopupColorPopoverChange=${({detail:o})=>{this.colors[0]=new l.default(o),this.chartMediaInfo.value.colors=i.clone(this.colors),this.arcgisPopupColorButtonChange.emit(i.clone(this.colors)),this.requestUpdate()}} @arcgisPopupColorPopoverClose=${()=>{this.popoverNode=void 0}}></arcgis-map-config-popup-color-popover>`);document.body.appendChild(o),o.setOpen(!0),this.popoverNode=o}else this.arcgisPopupColorButtonBeforeOpen.emit(),this.selected=!0,this.popoverNode=this.createSymbolStylerPopover({referenceElement:t}),this.symbolStylerWatchScaleHandle=await this.buildSymbolStylerForRamp({popoverNode:this.popoverNode,onChange:()=>{(this.chartMediaInfo?.value).colors=i.clone(this.colors),this.arcgisPopupColorButtonChange.emit(i.clone(this.colors))}})}createSymbolStylerPopover(o){const{popupState:e}=this,{referenceElement:t}=o,r=(0,h.dN)(s.qy`<arcgis-map-config-popup-styler-popover .referenceElement=${t} .popupState=${e} @arcgisClose=${o=>{o.stopPropagation(),this.closeColorPopover(),setTimeout(()=>this.popoverButtonNode.value?.focus(),300)}}></arcgis-map-config-popup-styler-popover>`);return document.body.appendChild(r),r.open=!0,setTimeout(()=>r.open=!0,300),r.reposition(),r}closeColorPopover(){1===this.colors.length?this.popoverNode?.remove():(this.symbolStylerWatchScaleHandle?.remove(),this.popoverNode&&this.closeSymbolStylerPopover()),this.selected=!1,this.popoverNode=void 0}closeSymbolStylerPopover(){this.popoverNode?.remove(),this.popoverNode=void 0}async buildSymbolStylerForRamp(o){const{popupState:e}=this,{mapView:t,portal:r,_messages:s}=e,{colors:l}=this,{popoverNode:n}=o,a=i.clone(l.filter((o,e)=>e<10)),h=c.getSchemes({basemap:t.map?.basemap??"topo",geometryType:"polygon",numColors:Math.min(10,l.length)}),d=this.getColorRampsWithSchemes(h).map(o=>({stops:o.colors.reverse(),tags:o.scheme.tags,name:o.scheme.name})),u=await this.createSymbolStylerElement(n,({detail:{info:{fill:o}}})=>{const e=i.clone(o.color).reverse();if(e.length<this.colors.length){for(let o=e.length;o<this.colors.length;o++)e.push(i.clone(e[o%10]))}(this.chartMediaInfo?.value).colors=e,this.colors=e,this.requestUpdate(),this.arcgisPopupColorButtonChange.emit(i.clone(this.colors))}),v=u.edit(new p.default,{portal:r,sections:{marker:{parts:{preview:!1,rotation:!1,size:!1}},fill:{type:"color-ramp",style:"discrete",open:!0,colorRampsOpen:!0,colorRamps:d,parts:{transparency:!1}}},fill:{color:a.reverse()}});u.stringOverrides={fillColor:s.color},n.addStyler(u),await v}getColorRampsWithSchemes(o){const e=[o.primaryScheme].concat(o.secondarySchemes),t=[];return e.forEach(o=>{t.push({colors:o.colors,scheme:o})}),t}async createSymbolStylerElement(o,e){return(0,h.dN)(s.qy`<arcgis-map-config-symbol-styler .popoverProps=${{placement:"bottom-end",offsetDistance:10,offsetSkidding:"rtl"===this._direction?3:-3,refElement:await o.getPopoverRefElement()||this.popoverButtonNode.value}} style=${(0,h.zl)({maxHeight:"max(calc(100vh - 200px), 300px)"})} @arcgisEdit=${e}></arcgis-map-config-symbol-styler>`)}render(){const{popupState:o}=this,{_messages:e}=o;return s.qy`<calcite-label scale=s>${e.color}${this.renderColorButton()}</calcite-label>`}renderColorButton(){const{colors:o,selected:e}=this,t=o?.length?o.filter((o,e)=>e<10).map(e=>s.qy`<div class="color-icon-section" style=${(0,h.zl)({width:95/Math.min(10,Math.min(10,o.length))+"%",backgroundColor:e?.toHex()??"#ffffff"})}></div>`):null;return s.qy`<div class=${(0,h.CP)({"color-selector":!0,selected:e})} role=button tabindex=0 @click=${()=>this.openColorPopover()} @keyup=${o=>{(" "===o.key||"Enter"===o.key)&&this.openColorPopover()}} ${(0,a.K)(this.popoverButtonNode)}><div class="color-icon">${t}</div><div class="color-edit-button"><calcite-icon scale=s icon=pencil></calcite-icon></div></div>`}}(0,r.c)("arcgis-map-config-popup-color-button",v)}}]);