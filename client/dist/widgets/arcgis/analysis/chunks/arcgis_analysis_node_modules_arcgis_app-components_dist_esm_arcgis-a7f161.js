/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a7f161.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a7f161"],{3826:(e,i,a)=>{a.d(i,{a:()=>n,b:()=>o,c:()=>r,d:()=>t});const t=(0,a(37762).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),n=t.state,o=t.state,r=t.state},10556:(e,i,a)=>{a.d(i,{a:()=>s,b:()=>d,f:()=>o,i:()=>l,m:()=>r});var t=a(4429),n=a(15912);function o(e,i){let a;a=i?i.map(e=>e.type):Object.keys(n.a);let t=[];return a.forEach(i=>{var a;(null===(a=n.a[i].fileExt)||void 0===a?void 0:a.indexOf(e))>=0&&t.push(n.a[i])}),t}function r(e){return e?(0,t.b)(e.flatMap(e=>{var i;return null===(i=n.a[e])||void 0===i?void 0:i.fileExt}).filter(e=>!!e)):null}const l=e=>e/1024/1024>50,s=e=>e/1024/1024>20,d=e=>e/1024/1024>10},36443:(e,i,a)=>{a.d(i,{a:()=>o,g:()=>r});var t=a(83692),n=a(41473);const o=async e=>{try{return{result:await(0,t.r)(`${(0,n.g)(e)}portals/self/subscriptionInfo`)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},r=async(e,i)=>await(0,t.f)(()=>o(e),"subscriptionType",(0,t.b)(i))},44069:(e,i,a)=>{a.d(i,{A:()=>n,a:()=>o,b:()=>r,c:()=>s,d:()=>l,u:()=>t});const t=["esriFieldTypeOID","esriFieldTypeGlobalID"],n={"file geodatabase":"filegeodatabase",shapefile:"shapefile",geojson:"geojson",csv:"CSV","microsoft excel":"excel",geopackage:"geoPackage","service definition":"serviceDefinition"},o={Shapefile:"shapefile","File Geodatabase":"fileGeodatabase",CSV:"csv","Microsoft Excel":"excel",GeoJson:"geojson",GeoPackage:"geoPackage"},r={csv:"CSV",excel:"Microsoft Excel",shapefile:"Shapefile",fgdb:"File Geodatabase",geojson:"GeoJson",googlesheets:"Microsoft Excel"},l=["zip","csv","xls","xlsx","geojson","gpkg","json","sd"],s=["zip","csv","xls","xlsx"]},46904:(e,i,a)=>{a.d(i,{a:()=>r,b:()=>o,c:()=>d,d:()=>c,e:()=>u,f:()=>p,g:()=>y,i:()=>l,u:()=>s});a(93814);var t=a(41473);function n(e){var i;return!!(null===(i=e.owner)||void 0===i?void 0:i.toLowerCase().includes("esri"))}function o(e){var i;return n(e)&&!!(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Requires Credits"))}function r(e){var i;return n(e)&&!!(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Requires Subscription"))}function l(e,i){return e.owner===i.username}function s(e,i){return l(e,i)||function(e,i){var a;if(null!=e.isAdmin)return!!e.isAdmin;const t=e.owner,n="admin"===e.itemControl,o=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(a=e.portal)||void 0===a?void 0:a.isPortal)&&!l(e,i)&&n&&t.includes("esri_")&&!o.includes(t))return!1;return n}(e,i)}const d=(e,i)=>!!i.orgId&&e.every(e=>e.isOrgItem),c=(e,i)=>`${(0,t.a)(i)}item.html?id=${e}`,u=(e,i)=>`${(0,t.g)(i)}/content/users/${e}`,p=e=>e.reduce((e,i)=>(e[i.owner]=e[i.owner]?[...e[i.owner],i.id]:[i.id],e),{}),y=(e,i)=>`${(0,t.a)(i)}content/items/${e}`},52308:(e,i,a)=>{a.r(i),a.d(i,{arcgis_new_item_pages_csv_location_fields:()=>g});var t=a(87849),n=a(36443),o=a(59317),r=a(94984),l=a(1654),s=a(84454),d=a(69280),c=a(3826),u=a(95878),p=a(54077),y=a(10556),h=a(10578);a(83692),a(931),a(93814),a(41473),a(54251),a(37762),a(15332),a(46904),a(44069),a(15912),a(29599);const g=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,t.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,t.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,t.c)(this,"newItemDisableCloseButtons",7),this.userHasAssignedCredits=!1,this.orgIsRestricted=!1,this.showTotalCredits=!1,this.isAppendWorkflow=!1,this.logCSVLocationFieldsChanges=()=>{const e=o.c.telemetry,i={eventType:"other",pageName:"my content",category:"new item csv location settings",label:this.currentLocationType};"address place names"===this.currentLocationType&&(this.displayEnrichLayerSettings?i.action="GeometryOnly"===this.selectedCandidateFieldsType?"enrich with some fields":"enrich with all fields":i.action="enrich with no fields",i.facetValue="Multiple"===this.selectedLocationFieldSelectionType?"multi":"single line address",i.details=this.initialLocator===c.a.geocodeServiceUrl?"default locator":"locator changed",i.attribute=this.initialRegion===c.a.sourceCountry?"default region":"region changed"),null==e||e.logEvent(i)},this.selectedLocationType="none",this.advancedExpanded=!1,this.selectedCandidateFieldsType="GeometryOnly",this.displayEnrichLayerSettings=!1,this.selectedLocationFieldSelectionType="Single",this.error=void 0,this.i18n=void 0}async handleNext(){var e;if((this.orgIsRestricted||this.userHasAssignedCredits)&&this.hasInsufficientCredits())return this.error=this.i18n.errors.insufficientCredits,void(null===(e=this.estimate)||void 0===e||e.scrollIntoView());const i=this.validateFields();if(i)this.error=i;else{if(this.error=null,this.isAppendWorkflow&&("add"===c.a.addAppendSelectOption||"upsert"===c.a.addAppendSelectOption)&&"none"===c.a.locationType&&"esriGeometryPoint"===c.a.sourceDataLayer.geometryType)return void(this.error=this.i18n.errors.noLocationTypeForAppend);const e=c.a.analyzeResults,i=(0,p.e)(this.selectedLocationFieldSelectionType,this.isAppendWorkflow);if(c.a.analyzeResults=Object.assign(Object.assign({},e),{publishParameters:i}),this.isAppendWorkflow){const{name:e}=c.a.dataLayer;c.a.dataLayer=i,c.a.dataLayer.name=e}this.logCSVLocationFieldsChanges();let a="itemProperties";if(this.isAddToMapTerminalPage())this.workflowComplete.emit({type:c.a.type,url:encodeURI(c.a.url),customParameters:c.a.customParameters,results:{analyzeResults:c.a.analyzeResults,fields:c.a.selectedFields}});else{if(this.isAppendWorkflow){const e=(0,d.a)(c.a.type,c.a.dataLayer,c.a.sourceDataLayer);a="add"!==c.a.addAppendSelectOption||(e||c.a.backupLayerFields.some(e=>"esriFieldTypeDate"===e.type))&&!this.isEnterprise?"appendKeyPairSelect":"appendMatchFields"}this.newItemUpdatePage.emit(a)}}}hasInsufficientCredits(){return"address"===this.selectedLocationType&&(0,p.i)(c.a.geocodeServiceUrl)&&c.a.geocodeCost&&c.a.geocodeCost.transactionCreditCost>c.a.geocodeCost.availableCredits}showUnrestrictedOrgCreditsNotice(){return!(this.orgIsRestricted||this.userHasAssignedCredits)&&this.hasInsufficientCredits()}isAddToMapTerminalPage(){return"map"===u.u.workflow&&"url"===c.a.newItemMode&&!c.a.enablePublishing}async analyze(){var e;const{file:i,url:a,existingItem:t,id:n,cloudProviderResource:r,type:l}=c.a,{portal:d,user:u,config:p,lang:h}=o.c;return(0,s.a)({analyzeArgs:(t||r||(0,y.a)(null!==(e=null==i?void 0:i.size)&&void 0!==e?e:0))&&n?{type:"item",itemid:n}:i?{type:"file",file:i}:{type:"url",sourceUrl:a},itemArgs:{itemType:l},configArgs:{portal:d,user:u,config:p,lang:h}})}async componentWillLoad(){var e,i,a,t,r;const{analyzeResults:d,type:y,selectedSheet:g,standardizedFieldNames:m,enablePublishing:v,cloudProviderResource:T,geocodeServiceUrl:f}=c.a,{portal:b,user:F,lang:S}=o.c,w=(0,p.a)();this.isAppendWorkflow="append"===u.u.workflow;const{result:C}=await(0,n.g)(b,F);o.c.subscriptionInfo=C;const L=(0,l.i)(C);this.isDev=L,this.isLocationPlatform=(0,l.d)(C),this.orgIsRestricted="restricted"===(null==C?void 0:C.state),this.isEnterprise=b.isPortal;const I=this.isAppendWorkflow&&b.isPortal,O=null===(e=null==F?void 0:F.sourceJSON)||void 0===e?void 0:e.assignedCredits;this.userHasAssignedCredits=O>0,this.i18n=u.u.i18n.csvLocationFields,this.isAddToMapTerminalPage()&&(u.u.nextText="addToMap");let G=I?["coordinates","none"]:["coordinates","address","none","mgrs","usng"];const k=(0,h.o)(F)&&((0,h.t)(F)||!this.isLocationPlatform)&&c.a.geocodeServers&&("map"!==u.u.workflow||v);this.showTotalCredits=(0,h.u)(F,b);const{selectedLocationFieldSelectionType:A}=c.a;this.selectedLocationFieldSelectionType=null!=A?A:"Single";const M="map"===u.u.workflow&&!v;this.locationTypes=G.map(e=>({optionTitle:this.i18n.locationTypes[e].title,description:(this.isLocationPlatform||L)&&"address"===e?this.i18n.locationTypes.address.descriptionDeveloper:this.i18n.locationTypes[e].description.replace("${type}","googlesheets"===(null==T?void 0:T.cloudFileType)?"Google Sheet":y),value:e,badge:"address"!==e||o.c.portal.isPortal||L||l.d?null:{label:this.i18n.consumesCredits,icon:"credits"},icon:"none"===e?"table":"layer-points"})).filter(({value:e})=>("address"!==e||k)&&("coordinates"===e||!M));const x=null==d?void 0:d.publishParameters;if(x){const e="Microsoft Excel"===y?null!==(a=null===(i=null==x?void 0:x.layers)||void 0===i?void 0:i[g])&&void 0!==a?a:null===(t=null==x?void 0:x.layers)||void 0===t?void 0:t[0]:null==d?void 0:d.publishParameters;if((e.latitudeFieldName||e.longitudeFieldName)&&(this.selectedLocationType="coordinates",c.a.locationType="coordinates",c.a.coordinateFieldType="LatitudeAndLongitude"),"coordinates"===x.locationType&&x.coordinateFieldType)switch(c.a.locationType="coordinates",x.coordinateFieldType){case"MGRS":this.selectedLocationType="mgrs",c.a.coordinateFieldType="MGRS";break;case"USNG":this.selectedLocationType="usng",c.a.coordinateFieldType="USNG";break;default:this.selectedLocationType="coordinates",c.a.coordinateFieldType="LatitudeAndLongitude"}else"address"===e.locationType&&k&&(this.selectedLocationType="address",c.a.locationType="address");null!==(r=c.a.locationType)&&void 0!==r||(c.a.locationType="none")}if(1===this.locationTypes.length){const e=this.locationTypes[0].value;this.selectedLocationType=e,c.a.locationType="mgrs"===e||"usng"===e?"coordinates":e}k||"address"!==this.selectedLocationType||(this.selectedLocationType="coordinates",c.a.locationType="coordinates"),"address"!==this.selectedLocationType||w.addressFields||(c.a.locationType="address"),m||await(0,s.s)({geocodeServiceUrl:f,locationType:c.a.locationType,lang:S}),I&&(this.selectedLocationType="coordinates",c.a.locationType="coordinates"),this.initialLocator=c.a.geocodeServiceUrl,this.initialRegion=c.a.sourceCountry,this.setLocationTypeTelemetry(this.selectedLocationType)}validateFields(){const{standardizedFieldNames:e,selectedFields:i,backupLayerFields:a}=c.a,t=this.isAppendWorkflow?a:Object.values(i),n=!t.find(({locationType:i})=>{const a=(null==i?void 0:i.toLowerCase())===this.selectedLocationType.toLowerCase(),t=!!(null==e?void 0:e[i]);return a||t});switch(this.selectedLocationType){case"usng":case"mgrs":if(n)return this.i18n.errors.noFieldSelected;break;case"address":if("Single"===this.selectedLocationFieldSelectionType&&n)return this.i18n.errors.noFieldSelected;if("Multiple"===this.selectedLocationFieldSelectionType){if(!t.find(e=>e.locationType&&"unknown"!==e.locationType))return this.i18n.errors.noFieldSelected}break;case"coordinates":if(t.filter(({locationType:e})=>"latitude"===e||"longitude"===e).length<2)return this.i18n.errors.coordinate}}async updateLocationType(e,i){if(this.selectedLocationType=e,"none"===e)return c.a.locationType="none",void(this.currentLocationType="none");switch(e){case"mgrs":c.a.coordinateFieldType="MGRS",c.a.locationType="coordinates";break;case"coordinates":c.a.coordinateFieldType="LatitudeAndLongitude",c.a.locationType="coordinates";break;case"usng":c.a.coordinateFieldType="USNG",c.a.locationType="coordinates";break;case"address":c.a.locationType="address"}i&&await this.analyze(),this.setLocationTypeTelemetry(e)}setLocationTypeTelemetry(e){switch(e){case"mgrs":this.currentLocationType="mgrs coordinates";break;case"coordinates":this.currentLocationType="lat lon";break;case"usng":this.currentLocationType="usng coordinates";break;case"address":this.currentLocationType="address place names";break;case"none":this.currentLocationType="none"}}async updateGeocodeServer(e){c.a.geocodeServiceUrl=e,await this.analyze()}async updateRegion(e){c.a.sourceCountry=e,await this.analyze()}handleEnrichLayerSwitchChange(e){const i=e.target.checked;this.displayEnrichLayerSettings=i,this.updateCandidateFields(i?"Minimal":"GeometryOnly")}updateCandidateFields(e){this.selectedCandidateFieldsType=e,c.a.candidateFieldsType=e}renderLocationFields(){const{standardizedFieldNames:e}=c.a,i={address:e,coordinates:{latitude:this.i18n.latitude,longitude:this.i18n.longitude},mgrs:{mgrs:"MGRS"},usng:{usng:"USNG"}}[this.selectedLocationType];if("Single"===this.selectedLocationFieldSelectionType&&"address"===this.selectedLocationType&&i){const e=Object.keys(i)[0];return(0,t.h)("div",{class:"row",role:"row"},(0,t.h)("div",{class:"cell",role:"cell"},i[e]),(0,t.h)("div",{class:"cell",role:"cell"},this.renderFieldSelect(e,i[e])))}return i&&Object.keys(i).map(e=>(0,t.h)("div",{class:"row",role:"row"},(0,t.h)("div",{class:"cell",role:"cell"},i[e]),(0,t.h)("div",{class:"cell",role:"cell"},this.renderFieldSelect(e,i[e]))))}updateFieldLocationType(e,i){(this.isAppendWorkflow?c.a.backupLayerFields:Object.values(c.a.selectedFields)).forEach(a=>{a.name===e?a.locationType=i:a.locationType===i&&(a.locationType="unknown")})}handleLocationFieldSelectionChange(e){this.selectedLocationFieldSelectionType=e,c.a.selectedLocationFieldSelectionType=e}renderFieldSelect(e,i){const a=this.isAppendWorkflow?c.a.backupLayerFields:c.a.selectedFields,n=Object.keys(a).map(e=>a[e]),o=!n.some(i=>i.locationType===e);return(0,t.h)("calcite-select",{label:i,role:"cell",onCalciteSelectChange:i=>this.updateFieldLocationType(i.currentTarget.selectedOption.value,e)},(0,t.h)("calcite-option",{value:"unknown",selected:o},this.i18n.unknown),n.map(i=>(0,t.h)("calcite-option",{value:i.name,selected:i.locationType===e},i.alias||i.name)))}render(){var e,i,a,n,l;const{geocodeServiceUrl:s,geocodeServers:d,geocodeCost:y,sourceCountry:h,countryCodes:g,backupLayerFields:m}=c.a,{isDev:v,isLocationPlatform:T}=this;if(!m)return;const{config:f}=o.c,b=null!==(i=null===(e=(0,p.a)())||void 0===e?void 0:e.estimatedRecordCount)&&void 0!==i?i:0,{helpMap:F,helpBase:S}=f,w=(0,r.g)(this.el);return(0,t.h)("div",{class:"wrapper"},(0,t.h)("arcgis-select",{class:"label--top",selectedOption:this.selectedLocationType,options:this.locationTypes,label:this.i18n.locationSettings,labelDescription:this.i18n.locationSettingsDescription,onArcgisOptionChange:e=>this.updateLocationType(e.detail,!0)}),"none"!==this.selectedLocationType&&(0,t.h)("div",null,"address"===this.selectedLocationType&&(0,t.h)("div",{class:"advanced"},(0,t.h)("button",{class:"advanced__toggle","aria-expanded":this.advancedExpanded.toString(),"aria-controls":"advanced__content",onClick:()=>this.advancedExpanded=!this.advancedExpanded},(0,t.h)("calcite-icon",{icon:"chevron-up",scale:"s",class:{advanced__icon:!0,[r.C.rtl]:"rtl"===w,"advanced__icon--open":this.advancedExpanded}}),this.i18n.advancedSettings),this.advancedExpanded&&(0,t.h)("div",{class:"advanced__content",id:"advanced__content"},(0,t.h)("div",{class:"two-up"},(0,t.h)("calcite-label",{class:"column"},this.i18n.locator,(0,t.h)("calcite-select",{label:"",onCalciteSelectChange:e=>this.updateGeocodeServer(e.currentTarget.selectedOption.value)},null==d?void 0:d.map(e=>(0,t.h)("calcite-option",{value:e.url,selected:e.url===s},e.name)))),(0,t.h)("calcite-label",{class:"column"},this.i18n.region,(0,t.h)("calcite-select",{label:"",onCalciteSelectChange:e=>this.updateRegion(e.currentTarget.selectedOption.value)},null==g?void 0:g.map(e=>(0,t.h)("calcite-option",{value:e.value,selected:e.value.toLowerCase()===h.toLowerCase()},this.i18n.countryCodes[e.value.toUpperCase()]||e.label))))),!o.c.portal.isPortal&&!this.isAppendWorkflow&&(0,t.h)("div",{class:"enrich-layer-container"},(0,t.h)("calcite-label",{layout:"inline-space-between"},(0,t.h)("span",{class:"enrich-title"},this.i18n.enrich,(0,t.h)("arcgis-information",{label:null===(a=u.u.i18n)||void 0===a?void 0:a.moreInfo,placement:"top-start",paddedContent:!0,onClick:e=>{var i,a;e.stopPropagation(),null===(a=(i=e.target).togglePopover)||void 0===a||a.call(i)}},(0,t.h)("p",{class:"enrich-description"},this.i18n.enrichLayerDescription),(0,t.h)("calcite-link",{target:"_blank",href:`${S}${F[120002541]}`},this.i18n.enrichLayerLink))),(0,t.h)("calcite-switch",{checked:this.displayEnrichLayerSettings,onCalciteSwitchChange:this.handleEnrichLayerSwitchChange.bind(this)})),this.displayEnrichLayerSettings?(0,t.h)("calcite-radio-button-group",{layout:"vertical",name:"enrich-group",onCalciteRadioButtonGroupChange:e=>this.updateCandidateFields(e.currentTarget.selectedItem.value)},["Minimal","AllFields"].map(e=>(0,t.h)("calcite-label",{layout:"inline",key:e},(0,t.h)("calcite-radio-button",{checked:this.selectedCandidateFieldsType===e,value:e}),(0,t.h)("span",{class:"enrich-radio-text"},this.i18n.candidateFieldsTypes[e].description)))):null))),(0,t.h)("h3",{class:"header"},this.i18n.locationFields," ",(0,t.h)("span",{class:"asterisk"},"*")),"address"===this.selectedLocationType?(0,t.h)("calcite-radio-button-group",{name:"location-field-selection-group",layout:"vertical",onCalciteRadioButtonGroupChange:e=>this.handleLocationFieldSelectionChange(e.currentTarget.selectedItem.value)},["Single","Multiple"].map(e=>(0,t.h)("calcite-label",{layout:"inline",key:e},(0,t.h)("calcite-radio-button",{checked:this.selectedLocationFieldSelectionType===e,value:e}),this.i18n["Single"===e?"locationFieldSingle":"locationFieldMultiple"]))):null,(0,t.h)("div",{role:"table",class:"table"},(0,t.h)("div",{class:"row row--header",role:"row"},(0,t.h)("span",{class:"cell cell--header",role:"columnheader","aria-sort":"none"},this.i18n.locationType),(0,t.h)("span",{class:"cell cell--header",role:"columnheader","aria-sort":"none"},this.i18n.field)),this.renderLocationFields())),"address"===this.selectedLocationType&&y&&!o.c.portal.isPortal&&(0,p.i)(s)&&(0,t.h)(t.F,null,v?(0,t.h)("div",null,(0,t.h)("calcite-notice",{scale:"m",width:"full",open:!0,icon:"information"},(0,t.h)("div",{slot:"message"},this.i18n.recordCount.replace("${num}",`${b}`)))):T?null:(0,t.h)("arcgis-credit-estimate",{transactionCreditCost:y.transactionCreditCost,availableCredits:y.availableCredits,showTotal:this.showTotalCredits,class:"credit-estimate",ref:e=>this.estimate=e}),this.showUnrestrictedOrgCreditsNotice()&&(0,t.h)("calcite-notice",{class:"notice",kind:"brand",icon:"information",open:!0},(0,t.h)("div",{slot:"title"},this.i18n.unrestrictedOrgCredits.title),(0,t.h)("div",{slot:"message"},this.i18n.unrestrictedOrgCredits.description))),(0,t.h)("arcgis-new-item-alert",{heading:null===(n=this.error)||void 0===n?void 0:n.title,description:null===(l=this.error)||void 0===l?void 0:l.description,active:!!this.error,onAlertDismiss:()=>this.error=null}))}get el(){return(0,t.a)(this)}};g.style=".wrapper{padding-bottom:2rem}.table{margin-bottom:1.5rem}.row{display:flex;align-items:center;padding-left:0px;padding-right:0px;padding-top:0.5rem;padding-bottom:0.5rem;box-shadow:0px -1px 0px #eaeaea}.row--header{box-shadow:none}.cell{box-sizing:border-box;width:50%;padding:0.5rem;font-size:0.875rem;font-weight:500;color:var(--calcite-color-text-1)}.cell--header{font-weight:400}.advanced{margin-top:1rem;margin-bottom:2rem;background-color:var(--calcite-color-foreground-2)}.advanced__toggle{margin:0px;box-sizing:border-box;display:flex;width:100%;cursor:pointer;align-items:center;border-radius:0;border-style:none;padding:1.25rem;font-size:0.875rem;font-weight:500;color:var(--calcite-color-text-2);background-color:transparent;transition:all 150ms ease-in-out;outline-offset:0px;outline-color:transparent;font-family:inherit}.advanced__toggle:focus{outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.advanced__icon{margin-inline-end:1rem;transform:rotate(90deg);transition-duration:150ms;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.arcgis--rtl{transform:rotate(-90deg)}.advanced__icon--open{transform:rotate(180deg)}.advanced__content{padding-left:1.25rem;padding-right:1.25rem;padding-top:0.5rem;padding-bottom:0.5rem}.two-up{margin-bottom:0.75rem;display:flex;justify-content:space-between}.column{width:calc(50% - 6px)}.header{margin:0px;margin-bottom:0.5rem;padding:0px;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.description{margin:0px;margin-bottom:1.5rem;padding:0px;font-size:1rem;color:var(--calcite-color-text-3)}.enrich-layer-container{background-color:var(--calcite-color-foreground-1);border:1px solid var(--calcite-color-border-input);padding:15px 15px 0px 15px}.enrich-switch{display:flex;justify-content:space-between}.enrich-title{display:flex;color:var(--calcite-color-text-1)}.enrich-radio-text{color:var(--calcite-color-text-3)}.radio{margin-bottom:0.75rem}.asterisk{color:var(--calcite-color-status-danger)}.notice{margin-top:0.5rem}.loader-overlay{overflow:hidden}.enrich-description{margin-bottom:0.75rem;margin-top:0px}"},54077:(e,i,a)=>{a.d(i,{a:()=>c,b:()=>v,c:()=>l,d:()=>m,e:()=>s,f:()=>p,g:()=>u,i:()=>g});var t=a(4429),n=a(1654),o=a(3826),r=a(10578);const l={WORLD:"World",EU:"Europe",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barth\xe9lemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CD:"Congo, the Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"C\xf4te d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin (French part)",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, the former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PS:"Palestine, State of",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten (Dutch part)",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan, Province of China",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela, Bolivarian Republic of",VG:"Virgin Islands, British",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Republic of Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};function s(e,i){const{sourceCountry:a,locationType:t,analyzeResults:n,candidateFieldsType:r,coordinateFieldType:l,type:s,standardizedFieldNames:u,selectedFields:p}=o.a,y=c(),h=i?o.a.backupLayerFields:Object.values(p),g=Object.assign(Object.assign({locationType:t||"address",sourceCountry:a,candidateFieldsType:r},"coordinates"===t&&function(e,i){return e.reduce((e,a)=>{switch(a.locationType){case"latitude":e.latitudeFieldName=a.name,i||(e.coordinateFieldType="LatitudeAndLongitude");break;case"longitude":e.longitudeFieldName=a.name,i||(e.coordinateFieldType="LatitudeAndLongitude");break;case"mgrs":"MGRS"===i&&(e.coordinateFieldName=a.name,i||(e.coordinateFieldType="MGRS"));break;case"usng":"USNG"===i&&(e.coordinateFieldName=a.name,i||(e.coordinateFieldType="USNG"))}return e},{coordinateFieldType:i})}(h,l)),"address"===t&&{addressFields:d(h,e,u)});let m;return m=i||"Microsoft Excel"!==s?Object.assign(Object.assign({},n.publishParameters),g):Object.assign(Object.assign({},n.publishParameters),{layers:[Object.assign(Object.assign({},y),g)],hasStaticData:!0,maxRecordCount:2e3,layerInfo:{capabilities:"Query"}}),"coordinates"===t&&["USNG","MGRS"].includes(l)&&(delete m.latitudeFieldName,delete m.longitudeFieldName),m}function d(e,i,a){if("Single"===i){const i=Object.keys(a)[0]||"Address",t=e.find(({locationType:e})=>e===i||"address"===(null==e?void 0:e.toLowerCase()));return{[i]:(null==t?void 0:t.name)||""}}return e.reduce((e,i)=>("unknown"!==i.locationType&&(e[i.locationType]=i.name),e),{})}function c(e,i){var a,t,n,r,l,s,d;const{type:c,analyzeResults:u=e,selectedSheet:p}=o.a,y=null==u?void 0:u.publishParameters;if(i)return"CSV"===c?null==y?void 0:y.layerInfo:null!==(t=null===(a=null==y?void 0:y.layers)||void 0===a?void 0:a[p])&&void 0!==t?t:null===(n=null==y?void 0:y.layers)||void 0===n?void 0:n[0];switch(c){case"Microsoft Excel":return null!==(l=null===(r=null==y?void 0:y.layers)||void 0===r?void 0:r[p])&&void 0!==l?l:null===(s=null==y?void 0:y.layers)||void 0===s?void 0:s[0];case"GeoJson":return null===(d=null==y?void 0:y.layers)||void 0===d?void 0:d[0];default:return null==y?void 0:y.layerInfo}}function u(e){switch(e){case"esriFieldTypeBigInteger":return["esriFieldTypeBigInteger","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSmallInteger":return["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeInteger":return["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSingle":return["esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDouble":return["esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDate":return["esriFieldTypeDate","esriFieldTypeString"];case"esriFieldTypeDateOnly":return["esriFieldTypeDateOnly","esriFieldTypeString"];case"esriFieldTypeTimeOnly":return["esriFieldTypeTimeOnly","esriFieldTypeString"];case"esriFieldTypeTimestampOffset":return["esriFieldTypeTimestampOffset","esriFieldTypeString"];case"esriFieldTypeOID":return["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeString"];default:return["esriFieldTypeString"]}}function p(e,i){const a=null==i?void 0:i.filter(i=>i.url===e);return(null==a?void 0:a.length)?a.shift():null}function y(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com.*\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi))}function h(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi))}function g(e){return!!e&&(h(e)||y(e))}function m(e,i,a){let t=a||e||i||"";return t="wo"===(null==t?void 0:t.toLowerCase())?"world":t,l[t.toUpperCase()]||(t="world"),t}function v(e,i,a){var o;let l=(0,r.m)(i)&&(0,r.o)(i);const s=function(e,i,a){return e.filter(e=>{const n=Object.assign({},e),o=h(null==n?void 0:n.url),r=y(null==n?void 0:n.url);return(o||r)&&((0,t.c)(n.name)?"Esri World Geocoder"!==n.name&&"ArcGIS Geocoding service"!==n.name||(n.name="ArcGIS Geocoding Service"):n.name="ArcGIS World Geocoding Service"),(!o||!a&&!i)&&((0,t.c)(n.batch)?!!n.batch:o||r)})}(e,!l,a),d=null===(o=s[0])||void 0===o?void 0:o.url;if(null==s?void 0:s.length){l=!0;const e=p(s[0].url,s),t=h(null==e?void 0:e.url),o=y(null==e?void 0:e.url),r=t||o;let c=r||!!e.batch;return{allowGeocode:(!(0,n.g)(i)||l)&&(!a&&c||a&&(!t||o)&&c),isAgoWorldGeocodeServer:t,isServiceProxyAgoWorldGeocodeServer:o,isWorldGeocodeServer:r,geocodeServers:s,geocodeServiceUrl:d}}return null}},69280:(e,i,a)=>{a.d(i,{a:()=>c,c:()=>s,g:()=>d,h:()=>u});var t=a(3826),n=a(54077),o=a(15912),r=a(95878),l=function(e,i){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(e);n<t.length;n++)i.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(a[t[n]]=e[t[n]])}return a};function s(e,i){var a;const t=(null==e?void 0:e.type)||null,n=(null==i?void 0:i.type)||null;return n&&(n===t||(null===(a={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[t])||void 0===a?void 0:a.includes(n)))}function d(e){var i;const{timezone:a,analyzeResults:s,type:d,fieldMappings:c,dataLayer:u,id:p,portal:y,uidPair:h,addAppendSelectOption:g,sourceDataLayer:m,attachmentsEnabled:v,insertAttachmentsEnabled:T,featureAttachmentOption:f}=e;let b,F;const{publishParameters:S}=s,w=l(s,["publishParameters"]),C="upsert"===g||"update"===g,L=function(e){const i=e.filter(e=>e.source!==`<${r.u.i18n.appendKeyValuePair.noneField}>`),a=i.map(({source:e,name:i})=>({source:e,name:i}));return a}(c),I=function(e){const i=e.map(e=>e.name);return i}(L),O={dateFieldsTimeReference:Object.assign(Object.assign({},(null==y?void 0:y.isPortal)?{timeZone:a||"UTC"}:{ianaTimeZone:a||"GMT"}),{respectsDaylightSaving:!0})},G={sourceTableName:u.name,fieldMappings:(null==L?void 0:L.length)?JSON.stringify(L):null,upsert:C,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:C&&"esriFieldTypeGlobalID"===(null==h?void 0:h.type),updateGeometry:!C||"attributeAndGeometry"===t.a.addAppendSelectUpdateTypeOption,appendFields:I.length?JSON.stringify(I):null,appendItemId:p,appendUploadFormat:o.a[t.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===m.type&&(S.locationType="none");const k=l(S,["layers"]);if("CSV"===d)S.layerInfo.dateFieldsTimeReference=O.dateFieldsTimeReference,F=Object.assign(Object.assign(Object.assign({},O),S),w);else if("Microsoft Excel"===d){const e=function(e,i){const a=Object.assign({},e);a.locationType=(null==i?void 0:i.locationType)||e.locationType,"address"===a.locationType?(a.addressFields=i.addressFields,a.sourceCountry=i.sourceCountry):"coordinates"===a.locationType&&(a.coordinateFieldType=i.coordinateFieldType,"LatitudeAndLongitude"===a.coordinateFieldType?(a.latitudeFieldName=i.latitudeFieldName,a.longitudeFieldName=i.longitudeFieldName):a.coordinateFieldName=i.coordinateFieldName);return a}((0,n.a)({},!0),k);e.dateFieldsTimeReference=O.dateFieldsTimeReference,k.name=u.name,F=Object.assign(Object.assign(Object.assign(Object.assign({},O),{layers:[e]}),k),w)}else F=Object.assign(Object.assign(Object.assign({},O),S),w);return b=Object.assign(Object.assign(Object.assign({},G),{appendSourceInfo:JSON.stringify(F)}),v&&function({insertAttachmentsEnabled:e}){return e?{skipAttachmentInserts:!1,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}:{skipAttachmentInserts:!0,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}}({appendType:g,insertAttachmentsEnabled:T,featureAttachmentOption:f})),"add"===g?b.upsertMatchingField=m.objectIdField||(null===(i=m.uniqueField)||void 0===i?void 0:i.name):C&&(null==h?void 0:h.isUniqueIndex)&&(b.upsertMatchingField=null==h?void 0:h.name),b}function c(e,i,a){return"File Geodatabase"===e&&a.hasAttachments&&i.hasAttachments}function u(e,i){const a=i.appendErrorMessages;let t=r.u.i18n.error,n=a.appendError;switch(e.code){case"invalidUniqueIdentifier":t=a.invalidUniqueIdentifier.title,n=a.invalidUniqueIdentifier.description;break;case"cannotAddNullData":t=a.cannotAddNullData.title,n=a.cannotAddNullData.description;break;case"exceededMaxFieldLength":t=a.exceededMaxFieldLength.title,n=a.exceededMaxFieldLength.description;break;case"invalidFieldType":t=a.invalidFieldType.title,n=a.invalidFieldType.description}return{title:t,description:n}}},84454:(e,i,a)=>{a.d(i,{a:()=>u,g:()=>c,s:()=>p});var t=a(3826),n=a(44069),o=a(54077),r=a(10578),l=a(41473),s=a(83692);function d(e,i,a,t){var n,o,r,l;const s=null!==(n=i.latitudeFieldName)&&void 0!==n?n:a.latitudeFieldName,d=null!==(o=i.longitudeFieldName)&&void 0!==o?o:a.longitudeFieldName,c=null!==(r=i.coordinateFieldName)&&void 0!==r?r:a.coordinateFieldName,u=null!==(l=i.coordinateFieldType)&&void 0!==l?l:a.coordinateFieldType;return t[e.name]?t[e.name]:e.name===c?null==u?void 0:u.toLowerCase():e.name===s?"latitude":e.name===d?"longitude":e.locationType||"unknown"}const c=(e,i)=>{if(!i)return e;const{layers:a,tables:t}=i;return"Map Service"===e&&!(null==a?void 0:a.length)&&(null==t?void 0:t.length)?"Feature Service":e};async function u({analyzeArgs:e,configArgs:i,itemArgs:a,initialize:c}){var u,h,g,m;const{config:v,lang:T,portal:f,user:b}=i,{itemType:F,ignoreV2FieldTypesVersion:S}=a;if(c&&(0,r.o)(b)){const e=(0,o.b)(null!==(h=null===(u=f.helperServices)||void 0===u?void 0:u.geocode)&&void 0!==h?h:[],b,f.isPortal);if(e&&(t.a.allowGeocode=e.allowGeocode,t.a.isAgoWorldGeocodeServer=e.isAgoWorldGeocodeServer,t.a.isServiceProxyAgoWorldGeocodeServer=e.isServiceProxyAgoWorldGeocodeServer,t.a.isWorldGeocodeServer=e.isWorldGeocodeServer,t.a.geocodeServers=e.geocodeServers,t.a.geocodeServiceUrl=e.geocodeServiceUrl),t.a.geocodeServers){t.a.sourceCountry=(0,o.d)(b.region,f.ipCntryCode);try{t.a.countryCodes=await async function(e,i,a){const t=(0,o.f)(e,a);let n;if(null==t?void 0:t.itemId){const e=`${i}/content/items/${t.itemId}`,a=await(0,s.r)(e),o=a.proxyFilter&&JSON.parse(a.proxyFilter).sourceCountry;o&&(n=o.split(",").map(e=>e.toLowerCase()),n.push("world"))}return Object.keys(o.c).map(e=>({label:o.c[e],value:e})).filter(({value:e})=>!n||n.includes(e.toLowerCase())).sort((e,i)=>e.label<i.label?-1:e.label>i.label?1:0)}(t.a.geocodeServiceUrl,v.restBaseUrl,t.a.geocodeServers),t.a.standardizedFieldNames=await y(t.a.geocodeServiceUrl,T)}catch(e){return console.error("Geocoder unavailable",e),{error:{code:"unavailableGeocoder"}}}}}const{locationType:w,isWorldGeocodeServer:C,geocodeServiceUrl:L,geocodeServers:I,isServiceProxyAgoWorldGeocodeServer:O,sourceCountry:G,analyzeResults:k,analyzedLocationTypes:A}=t.a,M=`${v.restBaseUrl}content/features/analyze`,{isPortal:x}=f;let P,N=!1;"item"===(null==e?void 0:e.type)&&"append"===e.workflow?(P=n.a[F],N=!0):P="Microsoft Excel"===F?"excel":F.toLowerCase();const D="file"===(null==e?void 0:e.type)&&e.analyze3DData;let R={filetype:P};switch(null==e?void 0:e.type){case"url":R.sourceUrl=e.sourceUrl;break;case"item":R.itemid=e.itemid;break;case"file":R=new FormData,R.append("file",e.file),R.append("filetype",D&&"File Geodatabase"===a.itemType?"fileGeodatabase":P);break;case"text":R.text=e.text}if(!D)if(x&&L||!x){const e={enableGlobalGeocoding:!0,sourceLocale:T,locationType:w,returnEstimatedRowCount:!0,returnSize:!0};if(S||(e.fieldTypesVersion="V2"),(x||!x&&(null==I?void 0:I.length))&&(e.geocodeServiceUrl=encodeURI(L)),k||x){const i="address"===w?"addressTypes":"locationTypes";-1===A.indexOf(i)&&A.push(i),e.locationType=w||"coordinates"}(!f.isPortal&&C||f.isPortal&&O)&&(e.sourceCountryHint=k?"":G.toLowerCase(),e.sourceCountry=k?G.toLowerCase():"");const i=JSON.stringify(e);R instanceof FormData?R.append("analyzeParameters",i):R.analyzeParameters=i}else S||(R instanceof FormData?R.append("analyzeParameters",JSON.stringify({fieldTypesVersion:"V2"})):R.analyzeParameters=JSON.stringify({fieldTypesVersion:"V2"}));try{const e=await(R instanceof FormData?(0,s.a)(M,R,{},"post"):(0,s.r)(M,R,{},"post"));if(D){if(!function(e){var i;const a=null==e?void 0:e.publishParameters,t=null===(i=null==a?void 0:a.layers)||void 0===i?void 0:i[0],n=null==t?void 0:t.infoFor3D,o="esriGeometryMultiPatch"===(null==t?void 0:t.geometryType);return n&&o}(e))return{error:{code:"invalid3DObjectFeatureClass"}}}else!async function({response:e,analyzeSelectedLayer:i,initialize:a,geocodeServiceUrl:n,lang:r,portal:c,itemType:u}){var y,h,g,m,v,T;const f=t.a,b=c.isPortal,F="Microsoft Excel"===u,S=F?null!==(h=null===(y=e.publishParameters.layers)||void 0===y?void 0:y[f.selectedSheet])&&void 0!==h?h:null===(g=e.publishParameters.layers)||void 0===g?void 0:g[0]:e.publishParameters;let w;if(!b&&f.isWorldGeocodeServer||b&&f.isServiceProxyAgoWorldGeocodeServer){const e=null!=S.sourceCountry;w=f.sourceCountry||S.sourceCountry||"world",w="wo"===w?"world":w,t.a.isWorldGeocodeServer=e,t.a.sourceCountry=w}f.allowGeocode||"address"!==S.locationType||(t.a.locationType="none");!function(e){var i,a,n,o,r,l;const{selectedSheet:s}=t.a,{publishParameters:c}=e,u=null!==(o=null!==(a=null===(i=c.layers)||void 0===i?void 0:i[s])&&void 0!==a?a:null===(n=c.layers)||void 0===n?void 0:n[0])&&void 0!==o?o:c.layerInfo;if(!u)return e;const p=null!==(l=null!==(r=u.addressFields)&&void 0!==r?r:c.addressFields)&&void 0!==l?l:{},y=Object.keys(p).reduce((e,i)=>Object.assign(Object.assign({},e),{[p[i]]:i}),{});u.fields=u.fields.map(e=>Object.assign(Object.assign({},e),{locationType:d(e,u,c,y)})),t.a.selectedFields&&(t.a.selectedFields=Object.keys(t.a.selectedFields).reduce((e,i)=>{const a=t.a.selectedFields[i];return e[i]=Object.assign(Object.assign({},a),{locationType:d(a,u,c,y)}),e},{}))}(e);const C=function(e){return function(e,i){var a,t,n,o;const{selectedFields:r,type:l,selectedSheet:s}=i;if(!r)return e;const d=e.publishParameters;let c=null==d?void 0:d.layerInfo;switch(l){case"Microsoft Excel":c=null!==(t=null===(a=null==d?void 0:d.layers)||void 0===a?void 0:a[s])&&void 0!==t?t:null===(n=null==d?void 0:d.layers)||void 0===n?void 0:n[0];break;case"GeoJson":c=null===(o=null==d?void 0:d.layers)||void 0===o?void 0:o[0]}return c.fields=c.fields.reduce((e,i)=>{const a=r[i.name];return a&&(i.alias=a.alias,e.push(i)),e},[]),e}(e,t.a)}(e);t.a.analyzeResults=C,(null===(m=null==C?void 0:C.publishParameters)||void 0===m?void 0:m.layers)&&(t.a.excelLayers=null===(v=null==C?void 0:C.publishParameters)||void 0===v?void 0:v.layers);const L=(0,o.a)(e,i);a?t.a.backupLayerFields=JSON.parse(JSON.stringify(L.fields)):S.standardizedFieldNames?t.a.standardizedFieldNames=S.standardizedFieldNames:p({lang:r,geocodeServiceUrl:n,locationType:t.a.locationType});"address"===t.a.locationType||"address"===L.locationType||"address"===(null===(T=null==e?void 0:e.publishParameters)||void 0===T?void 0:T.locationType)?t.a.geocodeCost=await(I=L.estimatedRecordCount,(0,s.r)(`${(0,l.g)()}portals/self/cost`,{geocodeCount:I})):t.a.geocodeCost=null;var I}({response:e,initialize:c,analyzeSelectedLayer:N,geocodeServiceUrl:L,lang:T,portal:f,itemType:F});return{}}catch(e){console.error(e);const i=(null==e?void 0:e.message)||e||"";switch(!0){case i.includes("specify data to be analyzed"):return{error:{code:"emptyFile"}};case i.includes("duplicate field names are not allowed"):return{error:{code:"duplicateFieldNames"}};case i.toLowerCase().includes("timeout"):return{error:{code:"timeout"}};case i.toLowerCase().includes("unable to analyze"):if(null===(m=null===(g=null==e?void 0:e.details)||void 0===g?void 0:g.messages[0])||void 0===m?void 0:m.toLowerCase().includes("file exceeds the max size allowed of 10mb."))return{error:{code:"exceedsFileSize"}};case i.toLowerCase().includes("error in analyzing filegeodatabase"):return{error:{code:"invalidFileGeodatabase"}}}return{error:{code:"unhandledError"}}}}async function p({lang:e,geocodeServiceUrl:i,locationType:a}){"address"===a&&(t.a.standardizedFieldNames=await y(i,e))}async function y(e,i){return(await(0,s.r)(e,{},{addTokenManually:!1})).addressFields.reduce((e,a)=>{var t;return"unknown"!==a.name&&(e[a.name]=(null===(t=null==a?void 0:a.localizedNames)||void 0===t?void 0:t[`${i}`])||a.alias||a.name),e},{})}},94984:(e,i,a)=>{a.d(i,{C:()=>l,a:()=>u,b:()=>c,f:()=>s,g:()=>r,l:()=>o,s:()=>y});var t=a(15332),n=a(931);const o=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function r(e){return function(e,i,a){const n=(0,t.c)(e,`[${i}]`);return n?n.getAttribute(i):a}(e,"dir","ltr")}const l={rtl:"arcgis--rtl"};async function s(e,i){const{api:a,type:t,places:o}=i||{};if(3===a){const[a]=await(0,n.l)(["dojo/number"]);return a.format(e,{type:t,places:o,pattern:null==i?void 0:i.pattern})}const[r]=await(0,n.l)(["esri/intl"]),l=r.convertNumberFormatToIntlOptions({places:o,style:t,digitSeparator:!0});return r.formatNumber(e,Object.assign(Object.assign({},l),{style:t}))}const d={};function c(e,i){let a=document.documentElement.lang;const t="bs"===a;if(t&&(a="hr"),i){const i=`${a}-full`,t={dateStyle:"full",timeStyle:"long"};return d[i]||(d[i]=new Intl.DateTimeFormat(a,t)),d[i].format(e)}const n={year:"numeric",month:t?"numeric":"short",day:"numeric"};return d[a]||(d[a]=new Intl.DateTimeFormat(a,n)),d[a].format(e)}function u(e,i,a,t){const n=null!=e?e:"en";let o=i.unknown;return(1===a||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(n))&&(o=i.single),1!==a&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(n)&&(o=i.multiple),y(o,Object.assign(Object.assign({},t),{number:a}))}const p=/\$\{([^}]+)\}/g;function y(e,i,a=p){let t=e;try{t=e.replace(a,(e,a)=>function(e,i){const a=e.split(".").reduce((e,i)=>e[i],i);return"string"==typeof a||"number"==typeof a?a:e}(a,i).toString())}catch(e){console.error(e)}return t}},95878:(e,i,a)=>{a.d(i,{a:()=>t,u:()=>n});const t=(0,a(37762).c)({nextText:"next",cancelText:"cancel",workflow:"content",scale:"m",disableScroll:!1,onlyHosted:!1,featureFlags:{}}),n=t.state}}]);