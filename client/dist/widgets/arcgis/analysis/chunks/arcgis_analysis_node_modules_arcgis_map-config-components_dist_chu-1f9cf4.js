/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-1f9cf4.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-1f9cf4"],{4265:(e,t,s)=>{s.d(t,{a:()=>a,d:()=>i,t:()=>n});const i=(e,t)=>{let s,i="idle";const a=async(...a)=>await new Promise(n=>{switch(i){case"flushed":i="idle",s?(clearTimeout(s),n(e(...a))):n(null);break;case"invoked":clearTimeout(s),i="idle",n(e(...a));break;case"cancelled":clearTimeout(s),i="idle",n(null);break;default:s&&clearTimeout(s),i="pending",s=setTimeout(()=>{i="idle",n(e(...a))},t)}});return a.flush=async function(...e){return i="flushed",await a(...e)},a.invoke=async function(...e){return i="invoked",await a(...e)},a.cancel=async function(...e){return i="cancelled",await a(...e)},a.getStatus=function(){return i},a},a=(e,t)=>{let s;return async(...i)=>await new Promise(a=>{s||(s=setTimeout(()=>{clearTimeout(s),s=void 0,a(e(...i))},t))})};function n(e){return new Promise(t=>setTimeout(t,e))}},5589:(e,t,s)=>{s.d(t,{a:()=>o,b:()=>l,g:()=>r,s:()=>c});var i=s(5294),a=(s(52797),s(54312),s(44345),s(55448),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(66228)),n=(s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(1225));s(83552),s(77462),s(49403),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299);function l(e){const{mapView:t}=e,s=(0,n.g)(e),i=s.authoringInfo,l="class-breaks"===s.type?s.classBreakInfos:s.uniqueValueInfos,o=(0,n.c)(s,"size"),r=(0,n.p)(s,"reference-size"),d=(0,n.p)(s,"spike"),p=!!o&&!(0,a.i)(o.minSize),u=!!o&&"number"==typeof o.minSize,h="above-and-below"===i?.univariateTheme;let m=2,g=20;if(r)r.referenceSizeScale&&c(e),[m,g]=[r.sizeStops[0].size,r.sizeStops[1].size];else if(d)[m,g]=[d.sizeStops[0].size,d.sizeStops[1].size];else if(o)if(h){const e=o.stops;[m,g]=[e[2].size,Math.max(e[0].size,e[4].size)]}else if(p){const e=o.stops;[m,g]=[e[0].size,e[e.length-1].size]}else if(u)[m,g]=[o.minSize,o.maxSize];else{const e=t.scale,s=o.minSize.stops,i=o.maxSize.stops;[m,g]=[s[s.length-1].size,i[i.length-1].size];for(let t=0;t<s.length;t++){const a=s[t],n=i[t];if(e<=a.value){if(t>0){const l=s[t-1],o=i[t-1],r=(e-l.value)/(a.value-l.value);[m,g]=[l.size+(a.size-l.size)*r,o.size+(n.size-o.size)*r]}else[m,g]=[s[0].size,i[0].size];break}}}else if(l){const e=l[0].symbol,t=l[l.length-1].symbol;[m,g]=[(0,n.w)(e),(0,n.w)(t)],m>g&&([m,g]=[g,m])}return[m,g]}function o(e,t){const{mapView:s}=e,o=(0,n.g)(e),r=(0,n.c)(o,"size");let c=t[0],d=(0,a.i)(t[1])?t[1]:c;if(r){const n="above-and-below"===o.authoringInfo?.univariateTheme,p=!!r&&!(0,a.i)(r.minSize),u=!!r&&"number"==typeof r.minSize,[h,m]=l(e),g=h>m;if(!g&&c>=m?c=m-.75:g&&c>=h&&(c=h-.75),!g&&h>=d?d=h+.75:g&&m>=d&&(d=m+.75),n){const e=r.stops,s=g?t[1]:t[0],i=g?t[0]:t[1],a=Math.max(...e.map(e=>e.value)),n=e[2].value,l=Math.min(...e.map(e=>e.value)),o=Math.abs(a-n),c=Math.abs(l-n),d=o>c?o:c,p=i-s;e.forEach(e=>{const{value:t}=e;e.size=Math.abs(t-n)/d*p+s})}else if(p){const e=r.stops;r.stops=null,r.minSize=c,r.maxSize=d,r.minDataValue=e[0].value,r.maxDataValue=e[e.length-1].value}else if(u)g?(r.maxSize=c,r.minSize=d):(r.minSize=c,r.maxSize=d);else{const e=s.scale;let t=i.clone(r.minSize.stops),a=i.clone(r.maxSize.stops);g&&([t,a]=[a,t]);let n=c/t[t.length-1].size,l=d/a[a.length-1].size;for(let s=0;s<t.length;s++){const i=t[s],o=a[s];if(e<=i.value){if(s>0){const r=t[s-1],p=a[s-1],u=(e-r.value)/(i.value-r.value),[h,m]=[r.size+(i.size-r.size)*u,p.size+(o.size-p.size)*u];n=c/h,l=d/m}else n=c/t[0].size,l=d/a[0].size;break}}t.forEach(e=>e.size=Math.round(n*e.size*10)/10),a.forEach(e=>e.size=Math.round(l*e.size*10)/10),g&&([t,a]=[a,t]),r.minSize.stops=t,r.maxSize.stops=a}}else{const e=o.classBreakInfos[0].symbol,t=o.classBreakInfos[o.classBreakInfos.length-1].symbol;let s=(0,n.w)(e),i=(0,n.w)(t),a=!1;s>i&&([s,i]=[i,s],a=!0),s!==i&&c>i&&(c=i-.75),s=c,s!==i&&s>d&&(d=s+.75),i=d;const l=i-s,r=1===o.classBreakInfos.length?1:l/(o.classBreakInfos.length-1);o.classBreakInfos.forEach((e,t)=>{const l=e.symbol;a?(0,n.u)(l,i-r*t):(0,n.u)(l,s+r*t)})}}function r(e,t){const s=e.stops,i=s.length-1,a=s[0].value,n=s[i].value;if(t<=a)return s[0].size;if(t>=n)return s[i].size;for(let e=0;e<=i;e++){const i=s[e],a=s[e+1];if(t>=i.value&&t<a.value){const e=a.value-i.value,s=i.size-a.size,n=(t-i.value)/e,l=i.size-s*n;return Math.round(100*l)/100}}return 1}function c(e){const{mapView:t}=e,s=(0,n.g)(e),i=(0,n.p)(s,"reference-size"),a=i.referenceSizeScale/t.scale;i.sizeStops.forEach(e=>e.size*=a),i.referenceSizeScale=t.scale}},27155:(e,t,s)=>{s.d(t,{i:()=>a});var i=s(12762);function a(e){if(!e)return;let t=i.default.assetsPath;t.endsWith("/")||(t+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${t}esri/themes/light/main.css" />`)}},46317:(e,t,s)=>{s.d(t,{D:()=>l});var i=s(85282),a=s(34670),n=s(42466);const l=(0,a.u$)(class extends a.WL{constructor(){super(...arguments),this.key=i.s6}render(e,t){return this.key=e,t}update(e,[t,s]){return t!==this.key&&((0,n.mY)(e),this.key=t),s}})},65595:(e,t,s)=>{s.d(t,{c:()=>l,u:()=>o});var i=s(20936),a=s(1225),n=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(5294),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(75698),s(10628),s(59640),s(64451),s(6176),s(83552));s(77462),s(49403),s(10281),s(83930),s(66617),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299);function l(e){e.selectedFields=[],e.layerFields=void 0,e.fields=void 0,e.hideLayerTitle=!1,e.supportsArcade=!1,e.stringFieldsCount=-1,e.dateFieldsCount=-1,e.numberFieldsCount=-1,e.containsFlow=!0,e.oneFeatureResponseStatus=a.s.MISSING,e.selectedAttribute=void 0,e.selectedAttributeText=void 0,e.selectedTypeValue=void 0,e.selectedValue=void 0,e.lastDefault=void 0,e.lastDefaults=void 0,e.dotColorSelected=void 0,e.backgroundStyleSelected=void 0,e.lastSettings=void 0,e.classedSymbolSelectedIdx=void 0,e.allUniqueValues=void 0,e.useFeatureReduction=void 0,e.symbolStylerConfig={},e.allowTimeSeriesConfiguration=!1,e.rasterInfo=void 0}function o(){const e=(0,n.Gk)(),t=e;e.manager.onLoad(()=>{t.smartMappingState=function(e,t){const s=r.get(e);if(s)return s;const a=(0,i.el)(e,t);return a&&"store"in a?(r.set(e,a.store),a.store):null}(e.el,"arcgis-map-config-smart-mapping")})}const r=new WeakMap},70091:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigSmartMappingPanelsDotDensity:()=>y});var i=s(73679),a=s(4395),n=s(46317),l=s(5294),o=s(54312),r=s(86421),c=s(56451),d=s(41631),p=s(1225),u=s(89989),h=(s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(65595)),m=(s(77462),s(49403),s(10281),s(83930),s(96333)),g=(s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299),s(4265)),S=s(27155),b=s(85643),f=s(73801);const v=a.AH`:host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.dot-density-block{overflow-x:hidden}.hidden{display:none}img{width:16px;height:16px}.label{font-size:var(--calcite-font-size--1);padding-top:5px;padding-bottom:5px}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.selected{outline:1px solid var(--calcite-color-brand)}.symbol{width:16px;height:16px;margin:2px}.top-margin{margin-block-start:var(--calcite-label-margin-bottom, .75rem)}.top-grey-border{border-top:1px solid #e0e0e0}.text-wrap{overflow-wrap:anywhere}.dot-value-content{display:flex;flex-direction:column}.dot-value-slider{width:100%;height:70px;position:relative;margin:0 auto 10px;&.esri-slider--horizontal .esri-slider__tick-label{cursor:pointer}&.slider-bottom-label .esri-slider__max,&.slider-bottom-label .esri-slider__min{width:fit-content;position:absolute;bottom:11px}&.slider-bottom-label .esri-slider__max{right:0;text-align:right}&.slider-bottom-label .esri-slider__min{left:0;text-align:left}&.esri-slider--horizontal .esri-slider__label{text-decoration:underline}&.esri-slider--horizontal .esri-slider__label:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}}`;class y extends f.WF{constructor(){super(...arguments),this.flowItemNode=(0,b._)(),this.labelNodes=[],this.inputNodes=[],this.legendSwatchNodes=[],this.popoverSettings={},this.labelChanged=!1,this.smartMappingState=(0,h.u)(),this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.arcgisSmartMappingPanelsDotDensityBackClick=(0,f.lh)(),this.arcgisSmartMappingPanelsDotDensityClose=(0,f.lh)(),this.smartMappingCompleteClose=(0,f.lh)()}static{this.properties={menuOpen:5,showBackButton:5,selected:7,beforeBack:0}}static{this.styles=v}async setFocus(){await(this.flowItemNode.value?.setFocus())}load(){const{layer:e,mapView:t}=this.smartMappingState,s=(0,p.g)(this.smartMappingState);this.dotValue=s.dotValue,(0,p.V)(s.referenceScale)&&(this.dotValue=Math.round(s.calculateDotValue(t.scale)),this.tickDotValue=this.dotValue),this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?l.clone(e.featureReduction):void 0}async loaded(){requestAnimationFrame(async()=>await(this.flowItemNode.value?.setFocus()));const{mapView:e}=this.smartMappingState;this.mapViewWatchHandle=o.watch(()=>e.scale,(0,g.d)(e=>this.updateDotValue(e),300)),(0,S.i)(this.el.shadowRoot),this.scaleHandle=(0,u.w)(this.smartMappingState,this.flowItemNode.value,()=>this.smartMappingCompleteClose.emit("cancel"))}disconnectedCallback(){super.disconnectedCallback(),this.popoverSettings?.popoverNode?.remove(),this.dotWatchHandle?.remove(),this.mapViewWatchHandle?.remove(),this.scaleHandle?.remove()}dotValueDivRefHandler(e){setTimeout(()=>{this.dotValueSlider&&e&&(this.dotValueSlider.container=e)},1)}listRefHandler(e){e&&queueMicrotask(()=>{e.querySelectorAll(".symbol").forEach(e=>{const t=Number.parseInt(e.getAttribute("data-value"));this.legendSwatchNodes[t]=e}),e.querySelectorAll(".input").forEach(e=>{const t=Number.parseInt(e.getAttribute("data-value"));this.inputNodes[t]=e}),e.querySelectorAll(".label").forEach(e=>{const t=Number.parseInt(e.getAttribute("data-value"));this.labelNodes[t]=e})})}handleDone(){this.arcgisSmartMappingPanelsDotDensityClose.emit("save")}getSliderStepsPos(e){let t=0;return this.sliderSteps.forEach((s,i)=>{(e>=s||e-this.sliderSteps[t]>s-e)&&(t=i)}),t}handleLegendItemTextChange(e,t){const{smartMappingState:s}=this,i=(0,p.g)(s);t.length||(t=this.originalRendererJSON.attributes.find(t=>t.field===i.attributes[e].field).label),this.labelNodes[e].classList.remove("hidden"),this.inputNodes[e].classList.add("hidden"),i.attributes[e].label=t,(0,p.a4)(s),setTimeout(()=>{this.labelNodes[e].focus()},300)}handleDotValueChange(e){const{smartMappingState:t}=this,{mapView:s}=t;this.dotValue=e,this.labelChanged=!1;const i=(0,p.g)(t);i.dotValue=Math.round(this.dotValue),i.referenceScale=(0,p.V)(i.referenceScale)?s.scale:void 0,(0,p.a4)(t),this.requestUpdate()}handleSortLegend(e){const{smartMappingState:t}=this,s=(0,p.g)(t),i=s.attributes.map(e=>e.clone()),a=e.map(e=>e.value);i.sort((e,t)=>a.indexOf(e.field)-a.indexOf(t.field)),s.attributes=i,(0,p.a4)(t),this.requestUpdate()}initSliderSteps(){const{smartMappingState:e}=this,t=(0,p.g)(e).authoringInfo,s=this.dotValue,i=t.minSliderValue,a=Math.max(t.maxSliderValue,s);if(this.sliderSteps?.includes(s))return!1;let n=(a-i)/2**19;n=Math.max(n,1);const l=[i];for(let e=0;e<79;e++){let t=Math.round(i+2**(e/4)*n);if(t<i+(e+1)&&(t=i+(e+1)),s<t&&s>l[l.length-1]&&l.push(s),t>=a){l.push(a);break}l.push(t)}return this.sliderSteps=l,!0}openSymbolStylerForLegendSwatch(e){const{smartMappingState:t}=this,{_messages:s}=t;(0,p.f)();const i=this.legendSwatchNodes[e];this.popoverSettings.popoverNode=(0,f.dN)(a.qy`<arcgis-map-config-smart-mapping-symbol-styler-popover .referenceElement=${this.flowItemNode.value} .heading=${s.styler.symbolStyle} .smartMappingState=${t} @arcgisSmartMappingSymbolStylerPopoverClose=${()=>{this.popoverSettings.popoverNode?.remove(),setTimeout(()=>i?.focus(),300),i.classList.remove("selected")}} @arcgisSmartMappingSymbolStylerPopoverDisconnected=${()=>{this.popoverSettings.popoverNode?.remove(),i.classList.remove("selected"),this.popoverSettings.popoverNode=void 0}}></arcgis-map-config-smart-mapping-symbol-styler-popover>`),document.body.appendChild(this.popoverSettings.popoverNode),(0,m.d)(t,{selectedAttribute:e,symbolStylerPopoverNode:this.popoverSettings.popoverNode,onChange:()=>{(0,p.a4)(t),this.requestUpdate()}}),i.classList.add("selected")}updateDotValue(e){const t=(0,p.g)(this.smartMappingState);if((0,p.V)(t.referenceScale)){const s=Math.round(t.calculateDotValue(e));this.handleDotValueChange(s)}}htmlEncode(e){const t=document.createElement("textarea");return t.innerText=e,t.innerHTML.split("<br>").join("\n")}render(){const{hideLayerTitle:e,layer:t,mapImageSublayer:s,_messages:i}=this.smartMappingState,n=e?void 0:s?.title??t.title;return this.el.classList.add("calcite-match-height"),a.qy`<calcite-flow-item class="flow-item" .heading=${i.panels.dotDensity.styleOptions} .description=${n} .closable=${(0,p.aa)(this.el)} .showBackButton=${this.showBackButton} .selected=${this.selected} @calciteFlowItemClose=${this.handleDone} @calciteFlowItemBack=${e=>{e.stopPropagation(),this.arcgisSmartMappingPanelsDotDensityBackClick.emit()}} ${(0,b.K)(this.flowItemNode)}>${this.renderDoneButton()}${this.renderCancelButton()}${this.renderVisualization()}</calcite-flow-item>`}renderDoneButton(){const{_messages:e}=this.smartMappingState;return a.qy`<calcite-button slot=footer .label=${e.done} @click=${this.handleDone} appearance=solid width=half>${e.done}</calcite-button>`}renderCancelButton(){const{smartMappingState:e}=this,{_messages:t}=e;return a.qy`<calcite-button slot=footer .label=${t.cancel} @click=${()=>{const{originalRendererJSON:t,originalFeatureReduction:s}=this;(0,p.f)(),(0,p.a8)(e,t,s),this.arcgisSmartMappingPanelsDotDensityClose.emit("cancel")}} appearance=outline-fill width=half>${t.cancel}</calcite-button>`}renderVisualization(){const{_messages:e}=this.smartMappingState;return a.qy`<calcite-block class="dot-density-block" .heading=${e.panels.dotDensity.dotDensityStyle} expanded>${this.renderDotStyle()}${this.renderLegend()}${this.renderUnits()}${this.renderDotValue()}${this.renderDotSize()}${this.renderRegenerateStyle()}${this.renderBackgroundStyle()}${this.renderDotDensityOptions()}</calcite-block>`}renderDotStyle(){const{smartMappingState:e}=this,t=(0,p.g)(e).attributes.map(e=>e.color);return a.qy`<arcgis-map-config-smart-mapping-symbol-button type=dot-density-ramp ramp-type=discrete .colors=${t} @arcgisSmartMappingSymbolButtonSymbolChange=${()=>this.requestUpdate()}></arcgis-map-config-smart-mapping-symbol-button>`}renderLegend(){const{smartMappingState:e}=this,{_messages:t}=e,s=(0,p.g)(e);return a.qy`<calcite-label>${t.panels.dotDensity.legend}${(0,n.D)(s.attributes.map(e=>e.field).toString(),a.qy`<calcite-list .label=${t.panels.dotDensity.values} class="top-grey-border" drag-enabled @calciteListOrderChange=${e=>{(0,p.f)();const t=Array.from(e.target.children);this.handleSortLegend(t)}} ${(0,b.K)(this.listRefHandler)}>${s.attributes.map((e,t)=>this.renderLegendItem(e,t))}</calcite-list>`)}</calcite-label>`}renderLegendItem(e,t){return a.qy`<calcite-list-item .value=${e.field}>${this.renderSymbolNode(e,t)}${this.renderTextNode(e,t)}</calcite-list-item>`}renderSymbolNode(e,t){const{smartMappingState:s}=this,{selectedAttribute:i,_messages:n}=s,l=(0,p.g)(s);return a.qy`<div class="symbol" slot=content-start tabindex=0 role=button .ariaLabel=${n.panels.dotDensity.editSymbolFor.replace("${fieldName}",e.label)} aria-haspopup=true .ariaExpanded=${i===t} data-value=${t??f.s6} @click=${()=>{this.popoverSettings?.popoverNode?(this.legendSwatchNodes[t].classList.remove("selected"),this.popoverSettings.index===t?((0,p.f)(),this.popoverSettings.popoverNode=void 0,this.popoverSettings.index=void 0):(this.popoverSettings.index=t,this.openSymbolStylerForLegendSwatch(t))):(this.popoverSettings.index=t,this.openSymbolStylerForLegendSwatch(t))}} @keydown=${e=>{(" "===e.key||"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),this.openSymbolStylerForLegendSwatch(t))}}><img src=${d.renderDotDensityPreviewHTML(l,new c.default([e.color.r,e.color.g,e.color.b]),{swatchSize:16}).src??f.s6} aria-hidden=true></div>`}renderTextNode(e,t){const{_messages:s}=this.smartMappingState;return a.qy`<div .ariaLabel=${s.panels.dotDensity.editLabelFor.replace("${fieldName}",e.label)} class="label text-wrap" slot=content tabindex=0 data-value=${t??f.s6} @click=${e=>{e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus()}} @keydown=${e=>{(" "===e.key||"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus())}}>${e.label}</div><calcite-input class="input hidden" slot=content .value=${e.label} .placeholder=${e.label} data-value=${t??f.s6} @focusout=${e=>{const s=e.currentTarget;this.handleLegendItemTextChange(t,s.value)}} @keydown=${e=>{if(e.stopPropagation(),"Escape"===e.key||"Enter"===e.key){e.preventDefault();const s=e.currentTarget;this.handleLegendItemTextChange(t,s.value)}}}></calcite-input>`}renderUnits(){const{smartMappingState:e}=this,{_messages:t}=e,s=(0,p.g)(e);return a.qy`<calcite-label>${t.panels.dotDensity.dotsRepresent}<calcite-input .value=${s.legendOptions?.unit||""} @calciteInputInput=${t=>{const s=(0,p.g)(e),i=t.target;s.legendOptions=s.legendOptions??{unit:void 0},s.legendOptions.unit=i.value||"",(0,p.a4)(e),this.requestUpdate()}}></calcite-input></calcite-label>`}renderDotValue(){const{smartMappingState:e}=this,{_messages:t}=e,s=(0,p.g)(e),i=s.authoringInfo,{tickDotValue:n}=this;if(!i)return"";const l=this.initSliderSteps(),o=[{mode:"position",visibleElements:{labels:!0},labelsVisible:!0,values:[this.getSliderStepsPos(n)],tickCreatedFunction:(e,t,s)=>{t.onclick=()=>{this.handleDotValueChange(n)},s.onclick=()=>{this.handleDotValueChange(n)}}}];if(this.dotValueSlider){let e={values:[this.getSliderStepsPos(this.dotValue)]};(l||this.dotValueSlider.tickConfigs[0].values[0]!==o[0].values[0])&&(e={min:0,max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(this.dotValue)],labelFormatFunction:e=>this.sliderSteps[e],tickConfigs:o}),this.dotValueSlider.set(e)}else{const e={min:0,max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(this.dotValue)],visibleElements:{labels:!0,rangeLabels:!0},rangeLabelInputsEnabled:!1,precision:0,labelInputsEnabled:!0,labelFormatFunction:e=>this.sliderSteps[e],inputFormatFunction:e=>this.sliderSteps[e],inputParseFunction:e=>{this.labelChanged=!0;let t=Number.parseInt(e);return Number.isNaN(t)?this.dotValueSlider.values[0]:(t<=0&&(t=1),this.sliderSteps.includes(t)||(this.sliderSteps?.push(t),this.sliderSteps?.sort((e,t)=>e-t),this.dotValueSlider?.set({max:this.sliderSteps.length-1,values:[this.getSliderStepsPos(t)]})),this.handleDotValueChange(t),this.getSliderStepsPos(t))},tickConfigs:o};this.dotValueSlider=new r.default(e),this.dotValueSlider?.on("thumb-change",e=>{this.labelChanged||this.handleDotValueChange(this.sliderSteps[e.value])}),this.dotValueSlider?.on("thumb-drag",e=>{this.labelChanged||this.handleDotValueChange(this.sliderSteps[e.value])})}const c=i.minSliderValue!==i.maxSliderValue,d=i.minSliderValue.toString().length>5||i.maxSliderValue.toString().length>5;return c?a.qy`<calcite-label>${t.panels.dotDensity.dotValue}<div class="dot-value-content"><div class=${"slider dot-value-slider "+(d?"slider-bottom-label":"")} ${(0,b.K)(this.dotValueDivRefHandler)}></div><calcite-label alignment=center>${t.panels.dotDensity.dotValueEquation.replace("${value}",this.dotValue.toString()).replace("${units}",this.htmlEncode(s.legendOptions?.unit||""))}</calcite-label></div></calcite-label>`:""}renderDotSize(){const{smartMappingState:e}=this,{layer:t,mapImageSublayer:s,_messages:i}=e;if(s&&t.version<11.1)return"";const n=(0,p.g)(e),l=Math.round(n.dotSize/.75*10)/10;return a.qy`<calcite-label>${i.panels.dotDensity.dotSize}</calcite-label><arcgis-map-config-smart-mapping-slider-input min=0.5 max=4 .values=${[l]} precision=1 .suffixText=${i.panels.dotDensity.px} @arcgisSmartMappingSliderInputChange=${t=>{const s=(0,p.g)(e),i=Math.round(.75*t.detail*10)/10;i!==s.dotSize&&(s.dotSize=i,(0,p.a4)(e))}}></arcgis-map-config-smart-mapping-slider-input>`}renderRegenerateStyle(){const{smartMappingState:e}=this,{mapImageSublayer:t}=e;return t?"":a.qy`<arcgis-map-config-smart-mapping-regenerate-style @arcgisRendererRegenerate=${()=>{const{smartMappingState:e}=this,{mapView:t}=e;this.requestUpdate(),this.updateDotValue(t.scale)}}></arcgis-map-config-smart-mapping-regenerate-style>`}renderBackgroundStyle(){return a.qy`<arcgis-map-config-smart-mapping-background-symbol @arcgisSmartMappingBackgroundSymbolChange=${()=>this.requestUpdate()}></arcgis-map-config-smart-mapping-background-symbol>`}renderDotDensityOptions(){const{smartMappingState:e}=this,{mapImageSublayer:t,mapView:s,_messages:i}=e,n=(0,p.g)(e);return a.qy`<calcite-label layout=inline-space-between class="top-margin">${i.panels.dotDensity.varyDotByScale}<calcite-switch .checked=${n.referenceScale===s.scale} @calciteSwitchChange=${t=>{const i=t.target;(0,p.g)(e).referenceScale=i.checked?s.scale:void 0,(0,p.a4)(e)}}></calcite-switch></calcite-label>${!t&&a.qy`<calcite-label layout=inline-space-between>${i.panels.dotDensity.blendOverlappingColors}<calcite-switch .checked=${n.dotBlendingEnabled} @calciteSwitchChange=${t=>{const s=t.target;(0,p.g)(e).dotBlendingEnabled=s.checked,(0,p.a4)(e)}}></calcite-switch></calcite-label>`||""}`}}(0,i.c)("arcgis-map-config-smart-mapping-panels-dot-density",y)},89989:(e,t,s)=>{s.d(t,{w:()=>n});var i=s(54312),a=s(1225);s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(5294),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(75698),s(10628),s(59640),s(64451),s(6176),s(83552),s(77462),s(49403),s(10281),s(83930),s(66617),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299);function n(e,t,s){const{layer:n,mapView:o,useFeatureReduction:r}=e;return r&&"featureReduction"in n&&"binning"===n.featureReduction.type?i.watch(()=>o.scale,()=>{const i=n.featureReduction;o.scale<=i.maxScale&&!t.disabled?((0,a.f)(),function(e,t,s){const i=document.createElement("arcgis-map-config-smart-mapping-scale-alert-popover");i.smartMappingState=e,i.refElement=t,i.addEventListener("arcgisSmartMappingScaleAlertPopoverBack",()=>{l(),s()}),document.body.append(i)}(e,t,s),(0,a.h)(t,!0)):o.scale>i.maxScale&&t.disabled&&(l(),(0,a.h)(t,!1),t.setFocus())}):void 0}function l(){document.querySelectorAll("arcgis-map-config-smart-mapping-scale-alert-popover").forEach(e=>e.remove())}}}]);