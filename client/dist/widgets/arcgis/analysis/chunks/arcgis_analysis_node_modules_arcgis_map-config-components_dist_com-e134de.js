/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-e134de.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-e134de"],{36695:(e,r,o)=>{o.r(r),o.d(r,{ArcgisMapConfigSmartMappingFlowColorSlider:()=>f});var l=o(73679),t=o(4395),s=o(85643),i=o(91802),a=o(1225),n=(o(54312),o(44345),o(55448),o(52797),o(34031),o(63438),o(5933),o(28927),o(83368),o(75518)),h=(o(89704),o(47550)),u=(o(5294),o(56451),o(23054),o(5077),o(23795),o(17902),o(87420),o(30161),o(81734),o(18423),o(96086),o(91813),o(21255),o(13078),o(21303),o(12627),o(65595)),d=(o(77462),o(49403),o(10281),o(83930),o(66617),o(10628),o(59640),o(64451),o(6176),o(10454),o(29614),o(94916),o(52554),o(2156),o(4038),o(49851),o(75054),o(15223),o(70169),o(47207),o(70852),o(48103),o(39423),o(85681),o(18444),o(42411),o(74462)),c=(o(91914),o(31521),o(86605),o(68196),o(440),o(46547),o(6238),o(7299),o(73801)),p=o(20936);const m=t.AH`.slider-box{height:275px;.esri-color-slider{min-width:200px}.esri-color-slider .esri-slider .esri-slider__content{height:130px}.esri-color-slider .esri-slider .esri-slider__label,.esri-color-slider .esri-slider .esri-slider__min,.esri-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.esri-color-slider .esri-slider .esri-slider__label:hover,.esri-color-slider .esri-slider .esri-slider__min:hover,.esri-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}}.slider-box-buttons-front{display:flex}`;class f extends c.WF{constructor(){super(...arguments),this.currentStopValues=[],this.styleSheetStatus="not-loaded",this.smartMappingState=(0,u.u)(),this.arcgisSmartMappingFlowColorSliderChange=(0,c.lh)(),this.arcgisSmartMappingFlowColorSliderError=(0,c.lh)()}static{this.styles=m}loaded(){this.flowItemNode=(0,p.el)(this.el,"calcite-flow-item")}divRefHandler(e){if(e)if(this.flowColorSlider.container)e.append(this.flowColorSlider.container);else{const r=document.createElement("div");e.append(r),this.flowColorSlider.container=r}}prepareFlowColorSlider(){const{smartMappingState:e}=this,{layer:r}=e,o=r,l=(0,a.T)(e),t=(0,a.c)(l,"color"),{sourceJSON:s}=o,{minValues:n,maxValues:u}=s,d=(0,a.p)(l,"color"),c=d?.minSliderValue??n?.[0],p=d?.maxSliderValue??u?.[0],m=d?(0,a.aC)(d.theme,t.stops):void 0;if(!this.flowColorSlider||!t&&this.flowColorSlider.stops){this.flowColorSlider?.destroy();let e={min:c,max:p};e={...e,...m},e.stops=t.stops,e.precision=(0,h.g)(t.stops),e.labelFormatFunction=r=>r.toFixed(e.precision),this.flowColorSlider=new i.default(e),this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max&&this.flowColorSlider.set(e),this.createFlowColorSliderChangeEvents()}else{if("dragging"===this.flowColorSlider.slider?.state)return!0;let e={min:c,max:p};e={...e,...m},e.stops=t.stops,e.precision=(0,h.g)(t.stops),this.flowColorSlider.set(e)}return(0,a.V)(this.flowColorSlider)}handleInvertSlider(){const{smartMappingState:e}=this,r=(0,a.T)(e),o=(0,a.c)(r,"color");(0,a.f)();let l=o.stops.map(e=>e.color);l=l.reverse(),o.stops.forEach((e,r)=>{e.color=l[r]}),(0,a.ag)(e),this.requestUpdate(),this.arcgisSmartMappingFlowColorSliderChange.emit()}handleResetSlider(){const{smartMappingState:e}=this,r=(0,a.T)(e);(0,n.r)((0,d.a)(e,{includeColorVariable:!0}),this.flowItemNode).then(o=>{const l=(0,a.c)(r,"color"),t=(0,a.p)(r,"color"),s=(0,a.c)(o.renderer,"color"),i=(0,a.p)(o.renderer,"color");t.minSliderValue=i.minSliderValue,t.maxSliderValue=i.maxSliderValue,l.stops.forEach((e,r)=>e.value=s.stops[r].value),(0,a.ag)(e),this.requestUpdate()},e=>this.arcgisSmartMappingFlowColorSliderError.emit(e))}createFlowColorSliderChangeEvents(){this.flowColorSlider&&(this.flowColorSlider.on("min-change",e=>{e.value>this.currentStopValues[0]?(this.flowColorSlider.stops.forEach((e,r)=>{e.value=this.currentStopValues[r]}),this.handleMinMaxChange(this.currentStopValues[0],this.flowColorSlider.max)):this.handleMinMaxChange(e.value,this.flowColorSlider.max)}),this.flowColorSlider.on("max-change",e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.flowColorSlider.stops.forEach((e,r)=>{e.value=this.currentStopValues[r]}),this.handleMinMaxChange(this.flowColorSlider.min,this.currentStopValues[this.currentStopValues.length-1])):this.handleMinMaxChange(this.flowColorSlider.min,e.value)}),this.flowColorSlider.on("thumb-change",()=>this.updateRendererStops(this.flowColorSlider.stops)),this.flowColorSlider.on("thumb-drag",()=>this.updateRendererStops(this.flowColorSlider.stops)),this.flowColorSlider.on("segment-drag",()=>this.updateRendererStops(this.flowColorSlider.stops)))}handleMinMaxChange(e,r){const{smartMappingState:o}=this,l=(0,a.T)(o),t=(0,a.p)(l,"color")||{};t.minSliderValue=e,t.maxSliderValue=r,l.authoringInfo.classificationMethod="manual",(0,a.ag)(o),this.requestUpdate(),this.arcgisSmartMappingFlowColorSliderChange.emit()}updateRendererStops(e){const{smartMappingState:r}=this,o=(0,a.T)(r),l=(0,a.c)(o,"color");5===e.length&&e.forEach(e=>e.label=""),l.stops=e,l.stops.forEach((e,r)=>{this.currentStopValues[r]=e.value}),(0,a.ag)(r),this.arcgisSmartMappingFlowColorSliderChange.emit()}render(){const{config:e}=this.smartMappingState;return t.qy`<link rel=stylesheet href=${`${e.jsapiUrl}/themes/light/main.css`} @load=${()=>{this.styleSheetStatus="loaded",this.requestUpdate()}} @error=${()=>{this.styleSheetStatus="failed",this.requestUpdate()}}>${"loaded"===this.styleSheetStatus?this.renderFlowColorSlider():"not-loaded"===this.styleSheetStatus?this.renderFlowColorSliderLoading():null}`}renderFlowColorSlider(){const{smartMappingState:e}=this,{layer:r,_messages:o}=e,l=r,i=(0,a.T)(e),n=(0,a.c)(i,"color");if(!n)return"";const{sourceJSON:h}=l;if(!h)return"";const{minValues:u,maxValues:d}=h,c=(0,a.p)(i,"color"),p=c?.minSliderValue??u?.[0],m=c?.maxSliderValue??d?.[0];if(!(0,a.V)(p)||!(0,a.V)(m)||p===m||1===n?.stops.length)return this.flowColorSlider&&(this.flowColorSlider.destroy(),this.flowColorSlider=void 0),"";{const e=this.prepareFlowColorSlider();return n.stops.forEach((e,r)=>{this.currentStopValues[r]=e.value}),(e||this.flowColorSlider)&&this.flowColorSlider.min!==this.flowColorSlider.max?t.qy`<div class="slider-box"><calcite-label>${o.panels.flow.dataRange}</calcite-label><div class="slider-box-buttons-front">${this.renderInvertButton()}<div>&nbsp;</div>${this.renderResetButton()}</div><div ${(0,s.K)(this.divRefHandler)}></div></div>`:this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max?"":this.renderFlowColorSliderLoading()}}renderFlowColorSliderLoading(){const{_messages:e}=this.smartMappingState;return t.qy`<div class="slider-box"><calcite-loader .label=${e.loading}></calcite-loader></div>`}renderInvertButton(){const{_messages:e}=this.smartMappingState;return t.qy`<arcgis-map-config-smart-mapping-action .text=${e.panels.flow.invertSlider} icon=arrowUpDown @click=${()=>this.handleInvertSlider()}></arcgis-map-config-smart-mapping-action>`}renderResetButton(){const{_messages:e}=this.smartMappingState;return t.qy`<arcgis-map-config-smart-mapping-action .text=${e.panels.flow.resetSlider} icon=undo @click=${()=>this.handleResetSlider()}></arcgis-map-config-smart-mapping-action>`}}(0,l.c)("arcgis-map-config-smart-mapping-flow-color-slider",f)},47550:(e,r,o)=>{o.d(r,{a:()=>h,b:()=>n,g:()=>p,u:()=>a});var l=o(5294),t=o(52797),s=(o(54312),o(44345),o(55448),o(34031),o(63438),o(5933),o(28927),o(83368),o(89704),o(66228)),i=(o(56451),o(31521),o(23054),o(5077),o(23795),o(17902),o(87420),o(30161),o(81734),o(1225));o(83552),o(77462),o(49403),o(10281),o(83930),o(66617),o(10628),o(59640),o(64451),o(6176),o(10454),o(29614),o(94916),o(52554),o(2156),o(4038),o(49851),o(75054),o(15223),o(70169),o(47207),o(70852),o(48103),o(39423),o(85681),o(18444),o(42411),o(9767),o(38218),o(91914),o(86605),o(68196),o(440),o(46547),o(6238),o(7299);function a(e,r){const o=(0,i.g)(e),a=l.clone(o.classBreakInfos);o.classBreakInfos=[],a.forEach((e,l)=>{e=function(e,r,o,l){if((0,s.i)(r)&&0!==r)if(r<1){const s=Math.round(1/r);e.minValue="first"===l?Math.floor(e.minValue/r)/s:Math.round(e.minValue/r)/s,e.maxValue="last"===l?Math.ceil(e.maxValue/r)/s:Math.round(e.maxValue/r)/s,e.label=`${o>0?"> ":""}${e.minValue.toLocaleString(t.getLocale(),{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(t.getLocale(),{maximumSignificantDigits:15})}`}else e.minValue="first"===l?Math.floor(e.minValue/r)*r:Math.round(e.minValue/r)*r,e.maxValue="last"===l?Math.ceil(e.maxValue/r)*r:Math.round(e.maxValue/r)*r,e.label=`${o>0?"> ":""}${e.minValue.toLocaleString()} - ${e.maxValue.toLocaleString()}`;return e}(e,r,l,0===l?"first":l===a.length-1?"last":void 0),o.addClassBreakInfo({minValue:e.minValue,maxValue:e.maxValue,symbol:e.symbol,label:e.label})})}function n(e,r){const o=(0,i.g)(e).classBreakInfos;let l=r,t=Number.POSITIVE_INFINITY;o.forEach(e=>{l||(l=Math.max(u(e.minValue),u(e.maxValue))),t=Math.min(t,e.maxValue-e.minValue)});const s=[];return t>1e7?(s.push(1e7),s.push(1e6),s.push(1e5),s.push(1e4),s.push(1e3),s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01)):t>1e6?(s.push(1e6),s.push(1e5),s.push(1e4),s.push(1e3),s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01)):t>1e5?(s.push(1e5),s.push(1e4),s.push(1e3),s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01)):t>1e4?(s.push(1e4),s.push(1e3),s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01)):t>1e3?(s.push(1e3),s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01),l>3&&s.push(.001)):t>100?(s.push(100),s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01),l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5)):t>10?(s.push(10),l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01),l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6)):t>1?(l>0&&s.push(1),l>1&&s.push(.1),l>2&&s.push(.01),l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6)):t>.1?(l>1&&s.push(.1),l>2&&s.push(.01),l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6)):t>.01?(l>2&&s.push(.01),l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6)):t>.001?(l>3&&s.push(.001),l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6),l>7&&s.push(1e-7)):t>1e-4?(l>4&&s.push(1e-4),l>5&&s.push(1e-5),l>6&&s.push(1e-6),l>7&&s.push(1e-7),l>8&&s.push(1e-8)):t>1e-5&&(l>5&&s.push(1e-5),l>6&&s.push(1e-6),l>7&&s.push(1e-7),l>8&&s.push(1e-8),l>9&&s.push(1e-9)),s}function h(e){const r=(0,i.g)(e);let o=1e10;return r.classBreakInfos.forEach(e=>{o=Math.min(o,d(e.minValue)),o=Math.min(o,d(e.maxValue))}),o}function u(e){let r=1;for(;Math.round(e*r)/r!==e;)r*=10;return Math.log(r)/Math.LN10}function d(e){let r=1e-8;for(;c(Math.round(e/r)*r)===e;)r*=10;return r/10}function c(e){return Number.parseFloat(e.toPrecision(12))}function p(e){let r=0;e.forEach(e=>{(0,s.i)(e.value)?r=Math.max(u(c(e.value)),r):((0,s.i)(e.minValue)&&(r=Math.max(u(c(e.minValue)),r)),(0,s.i)(e.maxValue)&&(r=Math.max(u(c(e.maxValue)),r)),(0,s.i)(e.min)&&(r=Math.max(u(c(e.min)),r)),(0,s.i)(e.max)&&(r=Math.max(u(c(e.max)),r)))}),r=Math.min(r,3);const o=e[0],l=e[e.length-1],t=Math.min(o.minValue??o.min??o.value,l.minValue??l.min??l.value),i=Math.max(o.maxValue??o.max??o.value,l.maxValue??l.max??l.value)-t;return i/e.length<2e-7?r=8:i/e.length<2e-6?r=7:i/e.length<2e-5?r=6:i/e.length<2e-4?r=5:i/e.length<.002?r=4:i/e.length<.02?r=3:i/e.length<.2?r=Math.max(r,2):i/e.length<2&&(r=Math.max(r,1)),Math.round(r)}},65595:(e,r,o)=>{o.d(r,{c:()=>i,u:()=>a});var l=o(20936),t=o(1225),s=(o(54312),o(44345),o(55448),o(52797),o(34031),o(63438),o(5933),o(28927),o(83368),o(89704),o(5294),o(18423),o(96086),o(91813),o(21255),o(13078),o(21303),o(12627),o(56451),o(31521),o(23054),o(5077),o(23795),o(17902),o(87420),o(30161),o(81734),o(75698),o(10628),o(59640),o(64451),o(6176),o(83552));o(77462),o(49403),o(10281),o(83930),o(66617),o(10454),o(29614),o(94916),o(52554),o(2156),o(4038),o(49851),o(75054),o(15223),o(70169),o(47207),o(70852),o(48103),o(39423),o(85681),o(18444),o(42411),o(9767),o(38218),o(91914),o(86605),o(68196),o(440),o(46547),o(6238),o(7299);function i(e){e.selectedFields=[],e.layerFields=void 0,e.fields=void 0,e.hideLayerTitle=!1,e.supportsArcade=!1,e.stringFieldsCount=-1,e.dateFieldsCount=-1,e.numberFieldsCount=-1,e.containsFlow=!0,e.oneFeatureResponseStatus=t.s.MISSING,e.selectedAttribute=void 0,e.selectedAttributeText=void 0,e.selectedTypeValue=void 0,e.selectedValue=void 0,e.lastDefault=void 0,e.lastDefaults=void 0,e.dotColorSelected=void 0,e.backgroundStyleSelected=void 0,e.lastSettings=void 0,e.classedSymbolSelectedIdx=void 0,e.allUniqueValues=void 0,e.useFeatureReduction=void 0,e.symbolStylerConfig={},e.allowTimeSeriesConfiguration=!1,e.rasterInfo=void 0}function a(){const e=(0,s.Gk)(),r=e;e.manager.onLoad(()=>{r.smartMappingState=function(e,r){const o=n.get(e);if(o)return o;const t=(0,l.el)(e,r);return t&&"store"in t?(n.set(e,t.store),t.store):null}(e.el,"arcgis-map-config-smart-mapping")})}const n=new WeakMap},74462:(e,r,o)=>{o.d(r,{a:()=>a,c:()=>n,f:()=>h});var l=o(56451),t=o(9767),s=o(38218),i=(o(52797),o(54312),o(44345),o(55448),o(34031),o(63438),o(5933),o(28927),o(83368),o(89704),o(5294),o(18423),o(96086),o(91813),o(21255),o(13078),o(21303),o(12627),o(1225));o(23054),o(5077),o(23795),o(17902),o(87420),o(30161),o(81734),o(83552),o(77462),o(49403),o(10281),o(83930),o(66617),o(10628),o(59640),o(64451),o(6176),o(10454),o(29614),o(94916),o(52554),o(2156),o(4038),o(49851),o(75054),o(15223),o(70169),o(47207),o(70852),o(48103),o(39423),o(85681),o(18444),o(42411),o(91914),o(31521),o(86605),o(68196),o(440),o(46547),o(6238),o(7299);async function a(e,r){const{layer:o,mapView:l}=e,s=o;return r=r||{},await t.createRenderer({layer:s,view:l,theme:r.flowTheme||"flow-line",includeColorVariable:r.includeColorVariable,legendOptions:r.legendOptions,flowRepresentation:r.flowRepresentation,flowScheme:r.flowScheme||h(e)}).then(e=>(e.layerEffect&&!e.layerEffect.includes("drop-shadow")&&(s.effect=e.layerEffect),e.renderer.color=e.renderer.color&&(r.color||e.renderer.color),e))}async function n(e,r){const{layer:o,mapView:s}=e,a=o;r=r||{};const n=(0,i.T)(e),u=(0,i.c)(n,"color"),d=n.authoringInfo,c=r.flowTheme||d?.flowTheme||"flow-line";return await t.createRenderer({layer:a,view:s,theme:c,includeColorVariable:r.includeColorVariable??!!u,legendOptions:r.legendOptions||u?.legendOptions,flowRepresentation:r.flowRepresentation||n.flowRepresentation,flowScheme:r.flowScheme}).then(o=>{const t=(0,i.p)(n,"color"),s=(0,i.p)(o.renderer,"color");t?.minSliderValue&&t?.maxSliderValue&&s&&(s.minSliderValue=t.minSliderValue,s.maxSliderValue=t.maxSliderValue);const a=(0,i.c)((0,i.T)(e),"color"),u=(0,i.c)(o.renderer,"color");return a&&u&&a.stops.forEach((e,r)=>{u.stops[r].value=e.value}),o.renderer.color=o.renderer.color&&(r.color||n.color||o.renderer.color),(r.flowScheme||h(e))&&a&&u&&a.stops.forEach((e,r)=>{u.stops[r].color=new l.default(e.color.toJSON())}),c===d.flowTheme&&(o.renderer.flowSpeed=n.flowSpeed,o.renderer.density=n.density,o.renderer.trailLength=n.trailLength,o.renderer.trailWidth=n.trailWidth,o.renderer.trailCap=n.trailCap),o})}function h(e){const{mapView:r}=e,o=(0,i.T)(e),l=(0,i.c)(o,"color");if(!l)return null;const t=l.stops.map(e=>e.color),a=s.getSchemes({basemap:r.map?.basemap||"topo"}),n=[a.primaryScheme].concat(a.secondarySchemes),h=[];return n.forEach(e=>{let r=t.some((r,o)=>!(0,i.W)(e.colors[o],r));r?(e.colors=e.colors.reverse(),r=t.some((r,o)=>!(0,i.W)(e.colors[o],r)),r||h.push(e)):h.push(e)}),h.length?h[0]:null}},75518:(e,r,o)=>{let l,t;function s(e){e.loading=!1}async function i(e,r){return function(e){e.loading=!0,t=!1,l&&clearTimeout(l),l=setTimeout(()=>{s(e),t=!0},6e4)}(r),await e.then(e=>{if(s(r),t)throw new Error("timeout");return e}).catch(e=>{throw s(r),e})}o.d(r,{r:()=>i})}}]);