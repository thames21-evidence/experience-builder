/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-c482d0.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-c482d0"],{4265:(e,t,i)=>{i.d(t,{a:()=>s,d:()=>a,t:()=>l});const a=(e,t)=>{let i,a="idle";const s=async(...s)=>await new Promise(l=>{switch(a){case"flushed":a="idle",i?(clearTimeout(i),l(e(...s))):l(null);break;case"invoked":clearTimeout(i),a="idle",l(e(...s));break;case"cancelled":clearTimeout(i),a="idle",l(null);break;default:i&&clearTimeout(i),a="pending",i=setTimeout(()=>{a="idle",l(e(...s))},t)}});return s.flush=async function(...e){return a="flushed",await s(...e)},s.invoke=async function(...e){return a="invoked",await s(...e)},s.cancel=async function(...e){return a="cancelled",await s(...e)},s.getStatus=function(){return a},s},s=(e,t)=>{let i;return async(...a)=>await new Promise(s=>{i||(i=setTimeout(()=>{clearTimeout(i),i=void 0,s(e(...a))},t))})};function l(e){return new Promise(t=>setTimeout(t,e))}},16356:(e,t,i)=>{i.r(t),i.d(t,{ArcgisMapConfigFeatureReductionBinning:()=>m});var a=i(73679),s=i(4395),l=i(54312),n=i(69548),o=i(29614),c=i(86863),r=i(83552),d=i(42855),u=i(4265),g=i(85643),p=i(73801);const h=s.AH`@layer{:host{display:none}:host([selected]){display:flex}.block-section{padding:0 10px}.block-content{padding-top:10px}.slider-title-wrapper{background-color:var(--calcite-color-foreground-1);border-bottom:1px solid var(--calcite-color-foreground-3);padding:var(--calcite-spacing-lg)}.slider-div{display:flex;align-items:center;justify-content:space-between;flex-flow:row wrap}.slider-heading{display:inline-block;padding:var(--calcite-spacing-sm) 0}.slider-label{display:inline-block;order:2}.slider-slider{display:inline-block;width:100%;order:1}.btn-section{background-color:var(--calcite-color-foreground-1)}.btn{background:var(--calcite-color-transparent);border:none;border-bottom:solid 1px var(--calcite-color-foreground-3);display:flex;align-items:center;justify-content:space-between;padding:var(--calcite-spacing-lg) var(--calcite-spacing-lg);cursor:pointer;width:100%}.btn:hover{background-color:var(--calcite-color-foreground-3);border-color:var(--calcite-color-border-3)}.btn-disabled{opacity:var(--calcite-opacity-disabled)}.btn:focus{outline:none;border:2px solid var(--calcite-color-brand)}.btn-text{font-family:var(--calcite-font-family);font-size:var(--calcite-font-size)}.style-button-div{background-color:#fff;padding:10px}}`;class m extends p.WF{constructor(){super(...arguments),this._direction=(0,r.jH)(),this.flowItemNode=(0,g._)(),this.fieldsButtonNode=(0,g._)(),this.labelsButtonNode=(0,g._)(),this.popupButtonNode=(0,g._)(),this.styleDivNode=(0,g._)(),this.styleBtnNode=(0,g._)(),this.onBinSizeChange=(0,u.d)(async e=>{const{layer:t,view:i}=this;t.featureReduction.fixedBinLevel=e;try{const e=await c.regenerateRenderer({layer:t,view:i,forBinning:!0});e&&(t.featureReduction.renderer=e)}catch{let e=t.featureReduction.fields.find(e=>"count"===e.statisticType);e||(e=new n.default({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0}),t.featureReduction.fields.push(e));const a=await o.createContinuousRenderer({layer:t,view:i,field:e.name,outlineOptimizationEnabled:!0,sizeOptimizationEnabled:!0,defaultSymbolEnabled:!1,forBinning:!0});t.featureReduction.renderer=a.renderer}this.handleBinningChange()},300),this.hideLayerTitle=!1,this.symbolStylerConfig={},this.allowTimeSeriesConfiguration=!1,this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.arcgisBackClick=(0,p.lh)(),this.arcgisChange=(0,p.lh)(),this.arcgisStyleBtnBackClick=(0,p.lh)(),this.arcgisStyleBtnClick=(0,p.lh)(),this.arcgisArcadeTimeExpressionChange=(0,p.lh)()}static{this.properties={view:0,layer:0,portal:0,config:0,_messages:0,flowNode:0,hideLayerTitle:5,symbolStylerConfig:0,allowTimeSeriesConfiguration:5,menuOpen:5,showBackButton:5,selected:7,beforeBack:0}}static{this.styles=h}static{this.shadowRootOptions=p.Iq}async setFocus(){this.flowItemNode.value?.setFocus()}loaded(){this.flowItemNode.value?.setFocus();const{view:e,layer:t}=this,i=e;this.maxScaleHandle=l.watch(()=>[t.featureReduction?.maxScale,i.scale],()=>{const e=t.featureReduction;e&&(i.scale<=e.maxScale&&!this.styleDivNode.value.classList.contains("btn-disabled")?(this.styleDivNode.value.classList.add("btn-disabled"),this.styleBtnNode.value.disabled=!0):i.scale>e.maxScale&&this.styleDivNode.value.classList.contains("btn-disabled")&&(this.styleDivNode.value.classList.remove("btn-disabled"),this.styleBtnNode.value.disabled=!1))})}disconnectedCallback(){super.disconnectedCallback(),this.maxScaleHandle?.remove()}addFieldsPanel(){const{layer:e,view:t,portal:i,_messages:a,flowNode:l,hideLayerTitle:n}=this,o=(0,p.dN)(s.qy`<arcgis-map-config-feature-reduction-fields .layer=${e} .mapView=${t} .portal=${i} ._messages=${a} .hideLayerTitle=${n??!1} .flowNode=${l} .showBackButton=${!0} @arcgisChange=${e=>{e.stopPropagation(),this.handleBinningChange(),this.requestUpdate()}} @arcgisBackClick=${()=>{o.remove(),this.selected=!0,setTimeout(()=>this.fieldsButtonNode.value?.focus(),300)}}></arcgis-map-config-feature-reduction-fields>`);l.appendChild(o),l.childNodes.forEach(e=>e.selected=!1),setTimeout(()=>{o.selected=!0,o.setFocus()},1),this.selected=!1}addLabelPanel(){const{layer:e,view:t,portal:i,_messages:a,flowNode:l,hideLayerTitle:n,allowTimeSeriesConfiguration:o}=this,c=(0,p.dN)(s.qy`<calcite-flow-item .heading=${a.bin.labelBinFeaturesHeading} .description=${n?void 0:e.title??void 0} selected @calciteFlowItemBack=${()=>{c.remove(),this.selected=!0,setTimeout(()=>this.labelsButtonNode.value?.focus(),300)}}></calcite-flow-item>`),r=(0,p.dN)(s.qy`<arcgis-map-config-label .layer=${e} .mapView=${t} .portal=${i} .layerDisplayType=${d.l.cluster} .calciteFlowProps=${{calciteFlowItem:c}} .allowTimeSeriesConfiguration=${o} @arcgisChange=${e=>{e.stopPropagation(),this.handleBinningChange(),this.requestUpdate()}}></arcgis-map-config-label>`);c.appendChild(r),l.appendChild(c),this.selected=!1,c.setFocus()}addPopupPanel(){const{layer:e,view:t,portal:i,config:a,_messages:l,flowNode:n,hideLayerTitle:o,allowTimeSeriesConfiguration:c}=this,r=(0,p.dN)(s.qy`<calcite-flow-item .heading=${l.bin.binPopupsHeading} .description=${o?void 0:e.title??void 0} selected @calciteFlowItemBack=${()=>{r.remove(),this.selected=!0,setTimeout(()=>this.popupButtonNode.value?.focus(),300)}}></calcite-flow-item>`),u=(0,p.dN)(s.qy`<arcgis-map-config-popup .layer=${e} .mapView=${t} .portal=${i} .config=${a} .layerDisplayType=${d.l.cluster} .calciteFlowProps=${{calciteFlow:n,calciteFlowItem:r}} .allowTimeSeriesConfiguration=${c} @arcgisChange=${e=>{e.stopPropagation(),this.handleBinningChange(),this.requestUpdate()}}></arcgis-map-config-popup>`);r.appendChild(u),n.appendChild(r),this.selected=!1,r.setFocus()}addStylePanel(){const{layer:e,view:t,portal:i,config:a,flowNode:l,symbolStylerConfig:n}=this,o=(0,p.dN)(s.qy`<arcgis-map-config-smart-mapping .portal=${i} .layer=${e} .mapView=${t} .config=${a} hide-layer-title use-feature-reduction allow-time-series-configuration .symbolStylerConfig=${n} selected @arcgisClose=${e=>{e.stopPropagation();const t=e.detail;o.remove(),this.arcgisStyleBtnBackClick.emit(t),setTimeout(()=>{this.selected=!0,this.styleBtnNode.value?.focus()},1)}} @arcgisBeforeBack=${({detail:e})=>this.arcgisStyleBtnBackClick.emit(e)} @arcgisArcadeTimeExpressionChange=${e=>{e.stopPropagation();const t=e.detail;this.arcgisArcadeTimeExpressionChange.emit(t)}}></arcgis-map-config-smart-mapping>`);l.appendChild(o),this.selected=!1,o.setFocus(),this.arcgisStyleBtnClick.emit()}handleBinningChange(){const{layer:e}=this,t=e.featureReduction;e.featureReduction=t.clone(),this.arcgisChange.emit()}render(){const{layer:e,_messages:t,hideLayerTitle:i}=this;return this.el.classList.add("calcite-match-height"),s.qy`<calcite-flow-item .heading=${t.binning} .description=${i?void 0:e.title??void 0} .selected=${this.selected} show-back-button @calciteFlowItemBack=${()=>this.arcgisBackClick.emit()} ${(0,g.K)(this.flowItemNode)}>${this.renderBinSize()}${this.renderScaleThresholdSlider()}${this.renderFieldsBtn()}${this.renderLabelBtn()}${this.renderPopupBtn()}${this.renderStyleBtn()}</calcite-flow-item>`}renderBinSize(){const{layer:e,_messages:t}=this,i="rtl"===this._direction,a=e.featureReduction;return s.qy`<div class="slider-title-wrapper"><calcite-label class="slider-heading" layout=inline>${t.bin.binSizeTitle}</calcite-label><div class="slider-div"><label class="slider-label">${i?t.bin.large:t.bin.small}</label><calcite-slider class="slider-slider" min=1 max=9 .value=${10-(a.fixedBinLevel??3)} step=1 .minLabel=${t.bin.binSizeTitle} @calciteSliderInput=${e=>{const t=e.target;this.onBinSizeChange(10-t.value)}}></calcite-slider><label class="slider-label">${i?t.bin.small:t.bin.large}</label></div></div>`}renderScaleThresholdSlider(){const{layer:e,view:t,portal:i,_messages:a}=this;return s.qy`<arcgis-map-config-feature-reduction-scale-threshold-slider .view=${t} .portal=${i} .layer=${e} ._messages=${a}></arcgis-map-config-feature-reduction-scale-threshold-slider>`}renderFieldsBtn(){const{_messages:e}=this,t="rtl"===this._direction;return s.qy`<div class="btn-section"><button class="btn" @click=${e=>{e.stopPropagation(),this.addFieldsPanel()}} ${(0,g.K)(this.fieldsButtonNode)}><span class="btn-text">${e.bin.editAttributes}</span><span class="btn-icon"><calcite-icon scale=s .icon=${t?"chevron-left":"chevron-right"}></calcite-icon></span></button></div>`}renderLabelBtn(){const{_messages:e}=this,t="rtl"===this._direction;return s.qy`<div class="btn-section"><button class="btn" @click=${e=>{e.stopPropagation(),this.addLabelPanel()}} ${(0,g.K)(this.labelsButtonNode)}><span class="btn-text">${e.bin.editLabel}</span><span class="btn-icon"><calcite-icon scale=s .icon=${t?"chevron-left":"chevron-right"}></calcite-icon></span></button></div>`}renderPopupBtn(){const{_messages:e}=this,t="rtl"===this._direction;return s.qy`<div class="btn-section"><button class="btn" @click=${e=>{e.stopPropagation(),this.addPopupPanel()}} ${(0,g.K)(this.popupButtonNode)}><span class="btn-text">${e.bin.editPopups}</span><span class="btn-icon"><calcite-icon scale=s .icon=${t?"chevron-left":"chevron-right"}></calcite-icon></span></button></div>`}renderStyleBtn(){const{layer:e,view:t,_messages:i}=this,a="rtl"===this._direction,l=t,n=e.featureReduction,o=l.scale<=n.maxScale;return s.qy`<div class=${"btn-section "+(o?"btn-disabled":"")} ${(0,g.K)(this.styleDivNode)}><button class="btn" .disabled=${o} @click=${e=>{e.stopPropagation(),this.addStylePanel()}} ${(0,g.K)(this.styleBtnNode)}><span class="btn-text">${i.bin.editStyle}</span><span class="btn-icon"><calcite-icon scale=s .icon=${a?"chevron-left":"chevron-right"}></calcite-icon></span></button></div>`}}(0,a.c)("arcgis-map-config-feature-reduction-binning",m)},42855:(e,t,i)=>{i.d(t,{a:()=>n,f:()=>a,l:()=>s,s:()=>l});var a=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(a||{}),s=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(s||{}),l=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(l||{}),n=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(n||{})}}]);