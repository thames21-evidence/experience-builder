/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-d1a460.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-d1a460"],{11751:(e,o,s)=>{s.d(o,{a:()=>m,c:()=>c,g:()=>d});var l=s(5294),i=s(56451),a=s(42411),r=s(1225),n=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(89704),s(66228)),t=(s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(83552),s(77462),s(49403),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(28973));s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(29614),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(28927),s(6238),s(7299);async function m(e,o){const{layer:s,useFeatureReduction:l,mapImageSublayer:i,mapView:m}=e,c=s;o=o||{};const d=(0,r.d)(e),b=(0,r.a)(e,(0,r.g)(e)),p=o.fieldInfos?o.fieldInfos[0]:null,u=o.theme?o.theme:"high-to-low",y={layer:c,view:m,field:p.field,valueExpression:p.expression,valueExpressionTitle:p.expressionTitle,normalizationField:o.normalizationField,theme:u,legendOptions:o.legendOptions,colorOptions:{colorScheme:o.colorScheme||(0,r.a2)(e,u),isContinuous:!!(0,n.i)(o.isContinuous)&&o.isContinuous},symbolOptions:(0,r.n)(e)?void 0:{symbolStyle:o.symbolOptions||"caret"},symbols:o.symbols||void 0,minValue:o.min,maxValue:o.max,sizeOptimizationEnabled:!i&&"above-and-below"!==u&&(!!(0,n.i)(o.sizeOptimizationEnabled)&&o.sizeOptimizationEnabled),defaultSymbolEnabled:!1,forBinning:l};return await a.createContinuousRenderer(y).then(s=>{if(!o.noReuse&&["color","color-size","color-size-age"].includes(d)&&(0,t.s)(e,o)){const o=(0,r.c)((0,r.g)(e),"color"),l=(0,r.p)((0,r.g)(e),"color");o&&l&&u===l.univariateTheme&&(s.renderer.visualVariables=[o],b.sizeOutlineVisVar&&s.renderer.visualVariables.push(b.sizeOutlineVisVar),s.renderer.authoringInfo.visualVariables=[l],(0,r.Q)(e,s.renderer))}return(0,r.b)(b,s.renderer),s})}async function c(e,o){const{layer:s,useFeatureReduction:t,mapImageSublayer:m,mapView:c}=e,d=s;o=o||{};const b=(0,r.g)(e),p=(0,r.c)(b,"color");if(p&&o.fieldInfos?.[0]&&o.fieldInfos?.[0].field===p.field&&o.fieldInfos?.[0].expression===p.valueExpression&&o.normalizationField===p.normalizationField&&(delete o.fieldInfos,(0,r.O)(o)))return{renderer:b.clone()};const u=(0,r.a)(e,b),y=(0,r.c)(b,"size"),f=b.authoringInfo,h=(0,r.p)(b,"size"),g=o.fieldInfos?o.fieldInfos[0]:p?{field:p.field,expression:p.valueExpression,expressionTitle:p.valueExpressionTitle,simpleFieldType:(0,r.K)(e,p.field)?.simpleFieldType||r.J.NUMBER}:{field:b.field,expression:b.valueExpression,expressionTitle:b.valueExpressionTitle,simpleFieldType:(0,r.K)(e,b.field)?.simpleFieldType||r.J.NUMBER},v=null===o.normalizationField?void 0:o.normalizationField?o.normalizationField:p?p.normalizationField:b.normalizationField,S=o.theme?o.theme:f?f.univariateTheme:"high-to-low",B="above-and-below"===f.univariateTheme,P="above-and-below"===S,z="custom"===f.univariateSymbolStyle;"custom"===o.symbolStyle&&!o.symbols&&(1===b.classBreakInfos.length?o.symbols=[l.clone(b.classBreakInfos[0].symbol),l.clone(b.classBreakInfos[0].symbol)]:o.symbols=[l.clone(b.classBreakInfos[0].symbol),l.clone(b.classBreakInfos[1].symbol)]);const I=(0,n.i)(o.isContinuous)?o.isContinuous:!(!B&&P)&&!!p,k="picture-marker"===b.classBreakInfos[0].symbol?.type||"picture-marker"===b.classBreakInfos[2===b.classBreakInfos.length?1:0].symbol?.type,w=!B&&P||k&&I?"caret":P?o.symbolStyle?["single","custom"].includes(o.symbolStyle)?void 0:o.symbolStyle:o.symbols?void 0:"custom"!==f.univariateSymbolStyle?f.univariateSymbolStyle:void 0:void 0,x=!(k&&I)&&("custom"===o.symbolStyle||!o.symbolStyle&&z);let O=P&&!(0,r.n)(e)?{symbolStyle:w,symbols:w?void 0:2===o.symbols?.length?{below:o.symbols[0],above:o.symbols[1]}:1===o.symbols?.length?void 0:x?{below:b.classBreakInfos[0].symbol,above:b.classBreakInfos[2===b.classBreakInfos.length?1:0].symbol}:void 0}:void 0;!O?.symbolStyle&&!O?.symbols&&(O=void 0),I&&O?.symbols&&((0,r.y)(O?.symbols.below,new i.default([0,0,0,.5])),(0,r.y)(O?.symbols.above,new i.default([0,0,0,.5])));const F=b.defaultSymbol,E=b.defaultLabel,M=b.backgroundFillSymbol;let V=!1;S===f?.univariateTheme&&(0,n.i)(y.minSize)&&(V=y.minSize.stops?y.minSize.stops[0].size>y.maxSize.stops[0].size:y.minSize>y.maxSize);let T=!1;(null===o.normalizationField||o.normalizationField||o.fieldInfos?.[0])&&(T=!0);const C=P&&!B||!P&&B,N=o.discardMinMax?void 0:(0,n.i)(o.min)?o.min:T?void 0:h?h.minSliderValue:void 0,_=o.discardMinMax?void 0:(0,n.i)(o.max)?o.max:T?void 0:h?h.maxSliderValue:void 0,$="below"===f.univariateTheme,D="below"===S,R=D&&!$||!D&&$,q=o.colorScheme||!C&&(0,r.a2)(e,S),A={layer:d,view:c,field:g.field,valueExpression:g.expression,valueExpressionTitle:g.expressionTitle,theme:S,legendOptions:o.legendOptions||y.legendOptions,colorOptions:{colorScheme:q,isContinuous:I},symbolOptions:O,normalizationField:v,minValue:N,maxValue:_,sizeOptimizationEnabled:!m&&"above-and-below"!==S&&((0,n.i)(o.sizeOptimizationEnabled)?o.sizeOptimizationEnabled:!!u.sizeAutoVisVar),defaultSymbolEnabled:(0,n.i)(o.defaultSymbolEnabled)?o.defaultSymbolEnabled:!!b.defaultSymbol,forBinning:t};return await a.createContinuousRenderer(A).then(e=>{if(o.discardMinMax){const o=(0,r.c)(b,"color"),s=(0,r.c)(e.renderer,"color");o?.stops.forEach((e,o)=>e.value=s?.stops[o].value);const l=(0,r.c)(b,"size"),i=(0,r.c)(e.renderer,"size");"above-and-below"===f.univariateTheme?l.stops?.forEach((e,o)=>{i.stops&&(e.value=i.stops[o].value)}):(l.minDataValue=i.minDataValue,l.maxDataValue=i.maxDataValue)}if((0,r.b)(u,e.renderer),P){const s=(0,r.i)(e.renderer.classBreakInfos[0].symbol),a=e.renderer.classBreakInfos[1]?(0,r.i)(e.renderer.classBreakInfos[1].symbol):s;if(!w)if(1===o.symbols?.length&&1===e.renderer.classBreakInfos.length)e.renderer.classBreakInfos[0].symbol=o.symbols[0];else if(2===o.symbols?.length&&1===e.renderer.classBreakInfos.length){const o=l.clone(b.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=o}else if("single"===o.symbolStyle&&2===e.renderer.classBreakInfos.length){const o=l.clone(b.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=o.clone(),(0,r.y)(o,(0,r.i)(e.renderer.classBreakInfos[1].symbol)),e.renderer.classBreakInfos[1].symbol=o,e.renderer.authoringInfo.univariateSymbolStyle=void 0}else{let o=l.clone(b.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=o,e.renderer.classBreakInfos[1]&&(o=b.classBreakInfos[1]?l.clone(b.classBreakInfos[1].symbol):l.clone(b.classBreakInfos[0].symbol),e.renderer.classBreakInfos[1].symbol=o)}const n=(0,r.c)(e.renderer,"color");if(n){const o=new i.default([0,0,0,.5]);(0,r.y)(e.renderer.classBreakInfos[0].symbol,o),e.renderer.classBreakInfos[1]&&(0,r.y)(e.renderer.classBreakInfos[1].symbol,o)}else p||n?((0,r.y)(e.renderer.classBreakInfos[0].symbol,s),e.renderer.classBreakInfos[1]&&(0,r.y)(e.renderer.classBreakInfos[1].symbol,a)):((0,r.y)(e.renderer.classBreakInfos[0].symbol,(0,r.i)(b.classBreakInfos[0].symbol)),(0,r.y)(e.renderer.classBreakInfos[1].symbol,(0,r.i)(b.classBreakInfos[1].symbol)))}else P||(1===o.symbols?.length?e.renderer.classBreakInfos[0].symbol=o.symbols[0]:1===b.classBreakInfos?.length&&(e.renderer.classBreakInfos[0].symbol=b.classBreakInfos[0].symbol));if(B&&P&&!T){const o=(0,r.c)(e.renderer,"size"),s=(0,r.c)(e.renderer,"color");o.stops=l.clone(y.stops),s&&s.stops.forEach((e,o)=>{e.value=y.stops[o].value}),2===e.renderer.classBreakInfos.length&&(e.renderer.classBreakInfos[0].maxValue=y.stops[2].value,e.renderer.classBreakInfos[1].minValue=y.stops[2].value)}if(R&&q&&p){const o=(0,r.c)(e.renderer,"color"),s=p.stops.length-1;o.stops.forEach((e,o)=>{e.color=p.stops[s-o].color})}if(F&&(e.renderer.defaultSymbol=F,e.renderer.defaultLabel=E),e.renderer.backgroundFillSymbol=M||void 0,V){const o=(0,r.c)(e.renderer,"size"),s=o.minSize;o.minSize=o.maxSize,o.maxSize=s}return e})}function d(e){const{mapView:o}=e,s=(0,r.g)(e),l=(0,r.c)(s,"color"),i=(0,r.c)(s,"size"),a=o.scale,{minSize:n,maxSize:t}=i;let m;if(i.stops)m=l.stops.map((e,o)=>{const s=i.stops[o];return{color:e.color,size:s.size,value:s.value}});else{const e=l.stops.length-1;if("number"==typeof n)m=l.stops.map((o,s)=>({color:o.color,value:o.value,size:0===s?n:s===e?t:null}));else{let o,s;const r=n.stops.length-1;a>n.stops[r].value?(o=n.stops[r].size,s=t.stops[r].size):n.stops.forEach((e,l)=>{a<=e.value&&(o=e.size,s=t.stops[l].size)});const c=i.minDataValue,d=i.maxDataValue,b=(d-c)/4;m=l.stops.map((l,i)=>({color:l.color,value:0===i?c:i===e?d:c+i*b,size:0===i?o:i===e?s:void 0}))}}return m}},48549:(e,o,s)=>{s.r(o),s.d(o,{ArcgisMapConfigSmartMappingSymbolPairButton:()=>u});var l=s(73679),i=s(4395),a=s(1225),r=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(28927),s(83368),s(75518)),n=(s(89704),s(5294),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(65595)),t=(s(77462),s(49403),s(10281),s(83930),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(29614),s(87735)),m=(s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(11751)),c=(s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299),s(85643)),d=s(73801),b=s(20936);const p=i.AH`.symbol-pair-name{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);outline-color:var(--calcite-color-foreground-3);outline-width:1px;outline-style:solid;box-shadow:transparent 0 0 0 1px inset}.symbol-pair-name:hover{outline-width:2px}.symbol-pair-name:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}`;class u extends d.WF{constructor(){super(),this.symbolPairButtonNode=(0,c._)(),this.smartMappingState=(0,n.u)(),this.arcgisSmartMappingSymbolPairButtonBeforeOpen=(0,d.lh)(),this.arcgisSmartMappingSymbolPairButtonChange=(0,d.lh)(),this.arcgisSmartMappingSymbolPairButtonError=(0,d.lh)(),this.listenOn(window,"arcgisSmartMappingClosePopovers",this.arcgisSmartMappingClosePopoversHandler)}static{this.properties={symbolType:1}}static{this.styles=p}load(){const{smartMappingState:e,symbolType:o}=this,{_messages:s}=e;this.flowItemNode=(0,b.el)(this.el,"calcite-flow-item");const l=(0,a.d)(e);this.allSymbolPairs="above-and-below"===o?[["single",s.symbolPairButton.singleSymbol],["circle",s.symbolPairButton.circles],["square",s.symbolPairButton.squares],["caret",s.symbolPairButton.chevrons],["circle-caret",s.symbolPairButton.circlesChevrons],["arrow",s.symbolPairButton.arrows],["circle-arrow",s.symbolPairButton.circleArrows],["plus-minus",s.symbolPairButton.plusMinus],["circle-plus-minus",s.symbolPairButton.circlePlusMinus],["happy-sad",s.symbolPairButton.faces],["triangle",s.symbolPairButton.triangles],["thumb",s.symbolPairButton.thumbs]]:"reference-size"===o?[["circle",s.symbolPairButton.circles],["square",s.symbolPairButton.squares],["diamond",s.symbolPairButton.diamonds],["hexagon-pointy",s.symbolPairButton.hexagonsPointy],["hexagon-flat",s.symbolPairButton.hexagonsFlat]]:[["triangle-solid-fill-open",s.symbolPairButton.solidFill],["triangle-solid-fill-open-outline",s.symbolPairButton.solidFillOpenOutline],["triangle-solid-fill-closed-outline",s.symbolPairButton.solidFillClosedOutline],["triangle-open-outline",s.symbolPairButton.openOutline],["triangle-closed-outline",s.symbolPairButton.closedOutline]],"spike"===o&&"color-size"!==l&&this.allSymbolPairs.unshift(["triangle-gradient-fill-open",s.symbolPairButton.gradientFill],["triangle-gradient-fill-open-outline",s.symbolPairButton.gradientFillOpenOutline])}arcgisSmartMappingClosePopoversHandler(){this.symbolPairPopoverNode&&(this.symbolPairPopoverNode.remove(),this.symbolPairPopoverNode=void 0)}toggleSymbolPairPopover(){if(this.symbolPairPopoverNode)return void this.closeSymbolPairPopover();const{smartMappingState:e}=this;this.arcgisSmartMappingSymbolPairButtonBeforeOpen.emit();const o=(0,d.dN)(i.qy`<arcgis-map-config-smart-mapping-symbol-pair-popover .smartMappingState=${e} .symbolPairs=${this.allSymbolPairs} .popoverProps=${{refElement:this.flowItemNode,placement:"leading",offsetDistance:0,popoverWidth:1.05*this.flowItemNode.getBoundingClientRect().width,overlayPositioning:"absolute",flipDisabled:!1,triggerDisabled:!1}} @arcgisSmartMappingSymbolPairPopoverChange=${e=>{const o=e.detail;this.handleSymbolPairChange(o)}} @arcgisSmartMappingSymbolPairPopoverClose=${()=>this.closeSymbolPairPopover()} @arcgisSmartMappingSymbolPairPopoverDisconnected=${()=>this.closeSymbolPairPopover()}></arcgis-map-config-smart-mapping-symbol-pair-popover>`);this.symbolPairPopoverNode=o,(0,a.h)(this.flowItemNode,!0),document.body.appendChild(o)}closeSymbolPairPopover(){this.symbolPairPopoverNode?.remove(),this.symbolPairPopoverNode=void 0,(0,a.h)(this.flowItemNode,!1),setTimeout(()=>{this.symbolPairButtonNode.value?.setFocus()},300)}handleSymbolPairChange(e){const{smartMappingState:o,symbolType:s}=this,{layer:l,mapView:i}=o;this.closeSymbolPairPopover();const n=(0,a.g)(o),c=(0,a.p)(n,"reference-size"),d=(0,a.p)(n,"spike"),b="above-and-below"===s?{symbolStyle:e}:"reference-size"===s?{layer:l,view:i,fieldInfos:[{field:c?.field}],theme:"reference-size",referenceSizeOptions:{symbolStyle:e},normalizationField:c?.normalizationField}:{layer:l,view:i,fieldInfos:[{field:d?.field}],theme:"spike",spikeOptions:{symbolStyle:e},normalizationField:d?.normalizationField};(0,r.r)(("above-and-below"===s?m.c:t.d)(o,b),this.flowItemNode).then(async s=>{if(c){const s=await(0,t.a)(o,{referenceSizeOptions:{symbolStyle:e}});s&&(0,a.a4)(o,s)}else if(d){const s=await(0,t.b)(o,{spikeOptions:{symbolStyle:e}});s&&(0,a.a4)(o,s)}else(0,a.a4)(o,s.renderer);this.requestUpdate(),this.arcgisSmartMappingSymbolPairButtonChange.emit()},e=>this.arcgisSmartMappingSymbolPairButtonError.emit(e))}render(){const{smartMappingState:e,symbolType:o}=this,{_messages:s}=e,l=(0,a.g)(e),r=l.authoringInfo,n=(0,a.p)(l,"reference-size"),t=(0,a.p)(l,"spike"),m="above-and-below"===o?r.univariateSymbolStyle:"reference-size"===o?n?.referenceSizeSymbolStyle:t?.spikeSymbolStyle;let d=s.symbolPairButton.singleSymbol;return this.allSymbolPairs.forEach(e=>{m===e[0]&&(d=e[1])}),"custom"===m&&(d=s.symbolPairButton.custom),i.qy`<calcite-label>${"above-and-below"===o?s.symbolPairButton.symbolPair:"reference-size"===o?s.symbolPairButton.referenceSizeShape:s.symbolPairButton.spikeShape}<calcite-button alignment=icon-end-space-between icon-end=chevron-down appearance=outline-fill width=full role=button kind=neutral aria-haspopup=true .label=${s.symbolPairButton.symbolPair} @click=${()=>this.toggleSymbolPairPopover()} ${(0,c.K)(this.symbolPairButtonNode)}>${d}</calcite-button></calcite-label>`}}(0,l.c)("arcgis-map-config-smart-mapping-symbol-pair-button",u)},75518:(e,o,s)=>{let l,i;function a(e){e.loading=!1}async function r(e,o){return function(e){e.loading=!0,i=!1,l&&clearTimeout(l),l=setTimeout(()=>{a(e),i=!0},6e4)}(o),await e.then(e=>{if(a(o),i)throw new Error("timeout");return e}).catch(e=>{throw a(o),e})}s.d(o,{r:()=>r})}}]);