/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-member--ed896e.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-member--ed896e"],{1402:(e,t,s)=>{s.d(t,{g:()=>i});var r=s(12192);async function i(e){const t=await(0,r.g)(e,"arcgis-member-browser");return t&&t.length?t[0]:null}},23966:(e,t,s)=>{s.d(t,{a:()=>a,g:()=>o,o:()=>l});var r=s(37762),i=s(74174);function o(e){return(0,i.g)(e,"arcgis-member-browser")}const a=(e,t)=>{e.onChange("view",e=>{t(e)})};(0,r.c)({type:"member-browser",includeExternalUsers:!1});const l=(e,t)=>{e.onChange("sort",e=>{t(e)})}},45946:(e,t,s)=>{s.r(t),s.d(t,{arcgis_member_browser_filter_org_groups:()=>c});var r=s(87849),i=s(59317),o=s(74174),a=s(1402),l=s(23966),n=s(3367);s(37762),s(15332),s(12192),s(94984),s(931),s(93814),s(41473),s(83692),s(54251),s(94737);const c=class{constructor(e){(0,r.r)(this,e),this.arcgisMemberBrowserFilter=(0,r.c)(this,"arcgisMemberBrowserFilter",7),this.MAX_COUNT=500,this.groupsTotal=0,this.getOrgGroupsCount=async()=>{const{portal:e}=null!==i.c&&void 0!==i.c?i.c:{},t=this.getParams();t.num=1;const s=await(0,n.j)(e,t);return(null==s?void 0:s.total)||0},this.loadOrgGroups=async()=>{const{portal:e}=null!==i.c&&void 0!==i.c?i.c:{};if(!this.groups&&e){const t=await this.getOrgGroupsCount();this.groupsTotal=t,t>this.MAX_COUNT?this.groups=[]:this.groups=await(0,n.k)(e,this.getParams()),this.selectedGroupId&&this.emitEvent()}},this.handleSearchInput=async e=>{const t=e.target;if(this.searchTerm=t.value,this.groupsTotal>this.MAX_COUNT){this.fetching=!0;const{portal:e}=null!==i.c&&void 0!==i.c?i.c:{},t=this.getParams();t.q=`${t.q} ${this.searchTerm}`;const s=await(0,n.j)(e,t);this.groups=s.results,this.fetching=!1}},this.selectedGroupId=void 0,this.expanded=void 0,this.groups=void 0,this.searchTerm="",this.fetching=!1}async componentWillLoad(){var e;this.store=(0,l.g)(this.el),this.i18n=null===(e=await(0,a.g)(this.el))||void 0===e?void 0:e.filterOrgGroups}async componentDidLoad(){await this.loadOrgGroups(),(0,i.o)("portal",this.loadOrgGroups),(0,o.a)("orgGroup",this.store,()=>{this.selectedGroupId=null})}getParams(){const{portal:e}=null!==i.c&&void 0!==i.c?i.c:{};let t=`orgid:${e.id}`;return e.isPortal&&(t+=' -owner:"esri_livingatlas" -owner:"esri_boundaries" -owner:"esri_demographics" -owner:"esri_webstyles"'),{q:t,start:1,num:100,sortField:"title",sortOrder:"asc"}}async getEventDetail(){var e;const{selectedGroupId:t}=this;let s=t?null===(e=this.groups)||void 0===e?void 0:e.find(e=>e.id===t):null;if(!s){const{portal:e}=null!==i.c&&void 0!==i.c?i.c:{};s=(await(0,n.j)(e,{q:`id:${t}`})).results[0]}return{id:"orgGroup",param:"group",value:t||"",label:s?this.i18n.label.replace("${name}",null==s?void 0:s.title):"",group:t||""}}async emitEvent(){const e=await this.getEventDetail();this.arcgisMemberBrowserFilter.emit(e)}render(){var e,t;const{portal:s}=null!==i.c&&void 0!==i.c?i.c:{},o=null===(e=this.groups)||void 0===e?void 0:e.filter(e=>this.groupsTotal>this.MAX_COUNT||!this.searchTerm||e.title.toLowerCase().includes(this.searchTerm.toLowerCase()));return(null==s?void 0:s.id)&&this.groupsTotal?(0,r.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.selectedGroupId,onArcgisBrowserFilterRemove:()=>{this.selectedGroupId=null},filterID:"orgGroup"},(0,r.h)("div",null,this.groupsTotal>15&&(0,r.h)("calcite-input",{type:"search",icon:"search",placeholder:this.i18n.searchGroups,onCalciteInputInput:this.handleSearchInput}),(0,r.h)("div",{class:"tree-wrapper"},0===o.length&&!this.fetching&&(null===(t=this.searchTerm)||void 0===t?void 0:t.length)>0&&(0,r.h)("p",{class:"member-browser-filter__no-results-wrapper"},this.i18n.noGroupsFound),o.length>0&&(0,r.h)("calcite-tree",{selectionMode:"single",onCalciteTreeSelect:e=>{var t,s;const r=(null===(s=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0])||void 0===s?void 0:s.dataset.groupId)||"";this.selectedGroupId===r?this.selectedGroupId=null:this.selectedGroupId=r,this.emitEvent()}},o.map(e=>(0,r.h)("calcite-tree-item",{key:e.id,"data-group-id":e.id,selected:e.id===this.selectedGroupId},(0,r.h)("a",null,e.title))))))):null}get el(){return(0,r.a)(this)}};c.style=".tree-wrapper{max-height:14rem;overflow:auto}.member-browser-filter__no-results-wrapper{padding:1rem}"},74174:(e,t,s)=>{s.d(t,{a:()=>o,b:()=>l,g:()=>c,i:()=>i,o:()=>a});var r=s(15332);const i=e=>"item-browser"===e.state.type,o=(e,t,s)=>{t.onChange("filters",t=>{t[e]&&t[e].value||s()})},a=(e,t)=>{e.onChange("preview",e=>{t()})},l=(e,t)=>{e.onChange("groupId",e=>{t()})},n=new Map;function c(e,t){const s=n.get(e);if(s)return s;const i=(0,r.c)(e,t);return i?(n.set(e,i.store),i.store):null}}}]);