/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-58ed69.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-58ed69"],{75518:(e,t,a)=>{let i,s;function r(e){e.loading=!1}async function o(e,t){return function(e){e.loading=!0,s=!1,i&&clearTimeout(i),i=setTimeout(()=>{r(e),s=!0},6e4)}(t),await e.then(e=>{if(r(t),s)throw new Error("timeout");return e}).catch(e=>{throw r(t),e})}a.d(t,{r:()=>o})},89989:(e,t,a)=>{a.d(t,{w:()=>r});var i=a(54312),s=a(1225);a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(28927),a(83368),a(89704),a(5294),a(18423),a(96086),a(91813),a(21255),a(13078),a(21303),a(12627),a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(75698),a(10628),a(59640),a(64451),a(6176),a(83552),a(77462),a(49403),a(10281),a(83930),a(66617),a(10454),a(29614),a(94916),a(52554),a(2156),a(4038),a(49851),a(75054),a(15223),a(70169),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(6238),a(7299);function r(e,t,a){const{layer:r,mapView:n,useFeatureReduction:l}=e;return l&&"featureReduction"in r&&"binning"===r.featureReduction.type?i.watch(()=>n.scale,()=>{const i=r.featureReduction;n.scale<=i.maxScale&&!t.disabled?((0,s.f)(),function(e,t,a){const i=document.createElement("arcgis-map-config-smart-mapping-scale-alert-popover");i.smartMappingState=e,i.refElement=t,i.addEventListener("arcgisSmartMappingScaleAlertPopoverBack",()=>{o(),a()}),document.body.append(i)}(e,t,a),(0,s.h)(t,!0)):n.scale>i.maxScale&&t.disabled&&(o(),(0,s.h)(t,!1),t.setFocus())}):void 0}function o(){document.querySelectorAll("arcgis-map-config-smart-mapping-scale-alert-popover").forEach(e=>e.remove())}},97582:(e,t,a)=>{a.r(t),a.d(t,{ArcgisMapConfigSmartMappingPanelsColor:()=>h});var i=a(73679),s=a(4395),r=a(5294),o=a(1225),n=a(89989),l=(a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(75518)),c=(a(89704),a(18423),a(96086),a(91813),a(21255),a(13078),a(21303),a(12627),a(56451),a(31521),a(23054),a(5077),a(23795),a(17902),a(87420),a(30161),a(81734),a(65595)),p=(a(54312),a(77462),a(49403),a(66617),a(10628),a(59640),a(64451),a(6176),a(10454),a(28973)),d=(a(94916),a(52554),a(2156),a(4038),a(49851),a(75054),a(15223),a(70169),a(29614),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(86605),a(68196),a(440),a(46547),a(28927),a(6238),a(7299),a(85643)),g=a(73801);const m=s.AH`:host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.color-block{overflow-x:hidden}.attribute-name{word-break:break-all}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}`;class h extends g.WF{constructor(){super(...arguments),this.flowItemNode=(0,d._)(),this.themeButtonNode=(0,d._)(),this.classifyNode=(0,d._)(),this.rotationNode=(0,d._)(),this.smartMappingState=(0,c.u)(),this.visualizationOpen=!1,this.hideTransparency=!1,this.hideRotation=!1,this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.arcgisSmartMappingPanelsColorBackClick=(0,g.lh)(),this.arcgisSmartMappingPanelsColorClose=(0,g.lh)(),this.arcgisSmartMappingPanelsColorError=(0,g.lh)(),this.smartMappingCompleteClose=(0,g.lh)()}static{this.properties={visualizationOpen:16,hideTransparency:5,hideRotation:5,menuOpen:5,showBackButton:5,selected:7,beforeBack:0}}static{this.styles=m}async setFocus(){await(this.flowItemNode.value?.setFocus())}load(){this.visualizationOpen=!0;const{layer:e}=this.smartMappingState,t=(0,o.g)(this.smartMappingState);this.originalRendererJSON=t.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?r.clone(e.featureReduction):void 0}async loaded(){requestAnimationFrame(async()=>await(this.flowItemNode.value?.setFocus())),this.scaleHandle=(0,n.w)(this.smartMappingState,this.flowItemNode.value,()=>this.smartMappingCompleteClose.emit("cancel"))}disconnectedCallback(){super.disconnectedCallback(),this.scaleHandle?.remove()}symbolButtonRefHandler(e){e&&(this.symbolButtonNode=e)}sliderRefHandler(e){e&&(this.sliderNode=e)}defaultSymbolRefHandler(e){e&&(this.defaultSymbolNode=e)}handleDone(){this.arcgisSmartMappingPanelsColorClose.emit("save")}handleCancel(){const{originalRendererJSON:e,originalFeatureReduction:t,smartMappingState:a}=this;(0,o.a8)(a,e,t),this.arcgisSmartMappingPanelsColorClose.emit("cancel")}handleIncludeInLegendToggle(){const{smartMappingState:e}=this,t=(0,o.g)(e),a=(0,o.c)(t,"color"),i=a.legendOptions;i&&!1===i.showLegend?i.title?i.showLegend=!0:a.legendOptions=void 0:(a.legendOptions=i||{},a.legendOptions.showLegend=!1),(0,o.a4)(e)}render(){const{layer:e,hideLayerTitle:t,_messages:a}=this.smartMappingState;return this.el.classList.add("calcite-match-height"),s.qy`<calcite-flow-item .heading=${a.panels.styleOptions} .description=${t?void 0:e.title} class="flow-item" .closable=${(0,o.aa)(this.el)} .showBackButton=${this.showBackButton} .selected=${this.selected} @calciteFlowItemClose=${this.handleDone} @calciteFlowItemBack=${e=>{e.stopPropagation(),this.arcgisSmartMappingPanelsColorBackClick.emit()}} ${(0,d.K)(this.flowItemNode)}>${this.renderDoneButton()}${this.renderCancelButton()}${this.renderVisualization()}${this.renderTransparency()}${this.renderRotation()}</calcite-flow-item>`}renderDoneButton(){const{layer:e,_messages:t}=this.smartMappingState;return e?s.qy`<calcite-button slot=footer .label=${t.done} @click=${this.handleDone} appearance=solid width=half>${t.done}</calcite-button>`:""}renderCancelButton(){const{layer:e,_messages:t}=this.smartMappingState;return e?s.qy`<calcite-button slot=footer .label=${t.cancel} @click=${this.handleCancel} appearance=outline-fill width=half>${t.cancel}</calcite-button>`:""}renderVisualization(){const{visualizationOpen:e,hideTransparency:t,hideRotation:a,smartMappingState:i}=this,{_messages:r}=i,n=(0,o.d)(i),l=["color-age","color-age-size"].includes(n),c=(0,o.g)(i),p=(0,o.c)(c,"color"),d=p?p.field?(0,o.K)(i,p.field)?.label:p.valueExpressionTitle||r.expression:c.field?(0,o.K)(i,c.field)?.label:c.valueExpressionTitle||r.expression,g=(0,o._)(i)[0].simpleFieldType===o.J.DATE;return s.qy`<calcite-block class="color-block" .heading=${l?r.panels.color.colorAgeStyle:g?r.panels.color.colorStyleDate:r.panels.color.colorStyle} .collapsible=${!t||!a} .expanded=${e} @calciteBlockOpen=${()=>this.visualizationOpen=!0} @calciteBlockClose=${()=>this.visualizationOpen=!1}>${l?null:s.qy`<calcite-label class="attribute-name">${d}</calcite-label>`}${this.renderAge()}${this.renderTheme()}${this.renderDividedBy()}${this.renderSymbol()}${this.renderColorSlider()}${this.renderRegenerateStyle()}${this.renderBackgroundStyle()}${this.renderDefaultSymbol()}${this.renderShowInLegend()}${this.renderClassify()}</calcite-block>`}renderAge(){const{smartMappingState:e}=this,t=(0,o.d)(e);return["color-age","color-age-size"].includes(t)?s.qy`<arcgis-map-config-smart-mapping-age renderer-subtype=color @arcgisSmartMappingAgeChange=${()=>{this.sliderNode.updateStatistics()}} @arcgisSmartMappingAgeError=${e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)}></arcgis-map-config-smart-mapping-age>`:""}renderTheme(){const{smartMappingState:e}=this,t=(0,o.g)(e);if(!(0,o.c)(t,"color"))return"";const a=(0,o.d)(e);return s.qy`<arcgis-map-config-smart-mapping-theme-button renderer-subtype=color @arcgisSmartMappingThemeButtonBeforeOpen=${()=>(0,o.f)()} @arcgisSmartMappingThemeButtonChange=${t=>{let i=p.a;["color-age","color-age-size"].includes(a)&&(i=p.b),(0,l.r)(i(e,{theme:t.detail,discardMinMax:!0}),this.flowItemNode.value).then(t=>{const a=(0,o.g)(e);a.visualVariables=(0,o.H)(a,"color")||[],a.visualVariables.push((0,o.c)(t.renderer,"color")),a.authoringInfo.visualVariables=(0,o.P)(a,"color")||[],a.authoringInfo.visualVariables.push((0,o.p)(t.renderer,"color")),(0,o.a4)(e),this.requestUpdate(),this.themeButtonNode.value&&this.themeButtonNode.value.manager.component.requestUpdate(),this.classifyNode.value&&this.classifyNode.value.manager.component.requestUpdate(),this.sliderNode&&(this.sliderNode.manager.component.requestUpdate(),this.sliderNode.updateStatistics())},e=>{this.themeButtonNode.value.manager.component.requestUpdate(),this.arcgisSmartMappingPanelsColorError.emit(e)})}} ${(0,d.K)(this.themeButtonNode)}></arcgis-map-config-smart-mapping-theme-button>`}renderDividedBy(){const{smartMappingState:e}=this,{fields:t}=e,a=(0,o.g)(e),i=(0,o.d)(e);if(["color-age","color-age-size"].includes(i)||(0,o.ae)(e,t).number<2)return"";const r=(0,o.c)(a,"color");if(r){const t=(0,o.K)(e,r.field),a={field:r.field,expression:r.valueExpression,expressionTitle:r.valueExpressionTitle,simpleFieldType:t?t.simpleFieldType:o.J.NUMBER};if(a.expression||a.simpleFieldType!==o.J.NUMBER)return""}else if(a.valueExpression)return"";return s.qy`<arcgis-map-config-smart-mapping-divided-by renderer-subtype=color .normalizationField=${(r?r.normalizationField:a.normalizationField)??void 0} @arcgisSmartMappingDividedByChange=${()=>{this.requestUpdate(),this.sliderNode.updateStatistics(),this.classifyNode.value&&this.classifyNode.value.manager.component.requestUpdate()}} @arcgisSmartMappingDividedByError=${e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)}></arcgis-map-config-smart-mapping-divided-by>`}renderSymbol(){const{smartMappingState:e}=this,t=(0,o.g)(e),a=(0,o.c)(t,"color"),i=t.classBreakInfos,r=i[0].symbol;let n;return a?n=a.stops.map(e=>{const t=e.color.clone();return t.a=1,t}):i?.length&&(n=i.map(e=>(0,o.i)(e.symbol))),s.qy`<arcgis-map-config-smart-mapping-symbol-button .symbol=${r} .colors=${n} type=color-ramp .rampType=${a?"continuous":"discrete"} @arcgisSmartMappingSymbolButtonSymbolChange=${()=>{this.requestUpdate(),this.sliderNode&&(this.sliderNode.manager.component.requestUpdate(),this.sliderNode.updateColors()),this.classifyNode.value&&(this.classifyNode.value.manager.component.requestUpdate(),this.classifyNode.value.updateDisabled()),this.rotationNode.value&&this.rotationNode.value.manager.component.requestUpdate()}} ${(0,d.K)(this.symbolButtonRefHandler)}></arcgis-map-config-smart-mapping-symbol-button>`}renderColorSlider(){return s.qy`<arcgis-map-config-smart-mapping-color-slider @arcgisSmartMappingColorSliderChange=${()=>{this.requestUpdate(),this.sliderNode&&this.sliderNode.manager.component.requestUpdate(),this.classifyNode.value&&this.classifyNode.value.manager.component.requestUpdate(),this.rotationNode.value&&this.rotationNode.value.manager.component.requestUpdate()}} @arcgisSmartMappingColorSliderError=${e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)} ${(0,d.K)(this.sliderRefHandler)}></arcgis-map-config-smart-mapping-color-slider>`}renderRegenerateStyle(){const{smartMappingState:e}=this,{mapImageSublayer:t}=e;return t?"":s.qy`<arcgis-map-config-smart-mapping-regenerate-style renderer-subtype=color @arcgisRendererRegenerate=${()=>{this.requestUpdate(),this.sliderNode&&(this.sliderNode.manager.component.requestUpdate(),this.sliderNode.updateStatistics()),this.classifyNode.value&&this.classifyNode.value.manager.component.requestUpdate()}}></arcgis-map-config-smart-mapping-regenerate-style>`}renderBackgroundStyle(){const{smartMappingState:e}=this,t=(0,o.d)(e);return(0,o.o)(e)&&"color-size"===t?s.qy`<arcgis-map-config-smart-mapping-background-symbol></arcgis-map-config-smart-mapping-background-symbol>`:""}renderDefaultSymbol(){return s.qy`<arcgis-map-config-smart-mapping-default-symbol @arcgisSmartMappingDefaultSymbolBeforeToggle=${()=>(0,o.f)()} @arcgisSmartMappingDefaultSymbolChange=${()=>this.symbolButtonNode?.manager.component.requestUpdate()} ${(0,d.K)(this.defaultSymbolRefHandler)}></arcgis-map-config-smart-mapping-default-symbol>`}renderShowInLegend(){const{smartMappingState:e}=this,{_messages:t}=e,a=(0,o.g)(e),i=(0,o.c)(a,"color");if(!i)return"";const r=i.legendOptions,n=!r||!1!==r.showLegend;return s.qy`<calcite-label class="legend-toggle-padding" layout=inline-space-between>${t.panels.color.includeInLegend}<calcite-switch .checked=${n} @calciteSwitchChange=${()=>this.handleIncludeInLegendToggle()}></calcite-switch></calcite-label>`}renderClassify(){const{smartMappingState:e}=this,t=(0,o.g)(e),a=(0,o.d)(e),i=(0,o._)(e)[0].simpleFieldType===o.J.DATE,r=["color-age","color-age-size"].includes(a);if("color"!==a||i||r)return"";const n=t.classBreakInfos;return s.qy`<arcgis-map-config-smart-mapping-classify @arcgisSmartMappingClassifyChange=${e=>{const t=e.detail;(t?.closePopovers||t?.classesChange)&&(0,o.f)(),(t?.classesChange||t?.symbolChange)&&(this.symbolButtonNode.colors=n.map(e=>(0,o.i)(e.symbol)),this.sliderNode?.updateColors()),this.requestUpdate(),this.sliderNode?.manager.component.requestUpdate(),(t?.toggle||!t?.symbolChange&&!t?.closePopovers)&&this.sliderNode.updateStatistics(),this.classifyNode.value&&this.classifyNode.value.manager.component.requestUpdate(),this.symbolButtonNode&&this.symbolButtonNode.manager.component.requestUpdate(),this.defaultSymbolNode&&this.defaultSymbolNode.manager.component.requestUpdate()}} @arcgisSmartMappingClassifyError=${e=>this.arcgisSmartMappingPanelsColorError.emit(e.detail)} ${(0,d.K)(this.classifyNode)}></arcgis-map-config-smart-mapping-classify>`}renderTransparency(){const{hideTransparency:e,smartMappingState:t}=this;if(e)return"";const a=(0,o.g)(t),i=(0,o.c)(a,"opacity");return s.qy`<arcgis-map-config-smart-mapping-transparency .open=${!!i} @arcgisSmartMappingSymbolTransparencyError=${({detail:e})=>this.arcgisSmartMappingPanelsColorError.emit(e)}></arcgis-map-config-smart-mapping-transparency>`}renderRotation(){const{hideRotation:e,smartMappingState:t}=this;if(e)return"";const a=(0,o.g)(t),i=(0,o.c)(a,"opacity"),r=(0,o.c)(a,"rotation");return s.qy`<arcgis-map-config-smart-mapping-rotation .open=${!i&&!!r} @arcgisSmartMappingRotationError=${({detail:e})=>this.arcgisSmartMappingPanelsColorError.emit(e)} ${(0,d.K)(this.rotationNode)}></arcgis-map-config-smart-mapping-rotation>`}}(0,i.c)("arcgis-map-config-smart-mapping-panels-color",h)}}]);