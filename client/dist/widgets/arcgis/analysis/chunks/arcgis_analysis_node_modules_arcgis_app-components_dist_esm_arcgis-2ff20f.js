/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f"],{6750:(e,t,i)=>{function a(e){var t,i;const{dataLayer:a,type:n,sourceDataLayer:s}=e,l=null!==(t=null==a?void 0:a.geometryType)&&void 0!==t?t:null===(i=null==a?void 0:a.layerInfo)||void 0===i?void 0:i.geometryType,d="table"===(null==s?void 0:s.type.toLowerCase()),o=null==a?void 0:a.type;if("Microsoft Excel"===n||"CSV"===n){if(("address"===a.locationType&&a.addressFields||"coordinates"===a.locationType)&&"esriGeometryPoint"===(null==s?void 0:s.geometryType))return null;if(!l||"none"===a.locationType||d)return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==s?void 0:s.geometryType)!==l)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else{if((null==s?void 0:s.geometryType)!==(null==a?void 0:a.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"};if(d&&"table"===o.toLowerCase())return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if(d)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}}function n(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||("esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>n,v:()=>a})},45831:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>y});var a=i(87849),n=i(48538),s=i(12906),l=i(1536),d=i(3826),o=i(95878),r=i(6750),p=i(69280),c=i(88878),u=i(59317);i(83692),i(931),i(93814),i(41473),i(54251),i(74695),i(24869),i(15912),i(72257),i(37762),i(86562),i(15332),i(27137),i(76246),i(58573),i(29599),i(60958),i(32478),i(98704),i(82149),i(54077),i(1654),i(46904),i(10578),i(8417),i(50315),i(26262),i(26854),i(62645),i(44069);const y=class{constructor(e){(0,a.r)(this,e),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,a.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,a.c)(this,"newItemPrevPage",7),this.newItemSetButtonState=(0,a.c)(this,"newItemSetButtonState",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===o.u.workflow?"attribute":"uploaded",this.i18n=o.u.i18n.appendSelectUpdateType,"append"===o.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,r.v)({dataLayer:d.a.dataLayer,type:d.a.type,sourceDataLayer:d.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),o.u.nextText="updateAppend",this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!1}})}async handleNext(){const e=this.selected;if("update"===o.u.workflow){d.a.addUpdateItemPropertiesOption=e;const t="uploaded"!==e;d.a.keepDescription=t,this.handleUpdate()}else d.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:a,fileName:n}=d.a,l=await(0,c.f)(a.owner,a.portal),r=(0,c.g)(l,a.portal),p=await(0,s.u)(a,r,{file:e,overwrite:t,keepDescription:i,fileName:n});p.success?this.workflowComplete.emit({success:p.success}):(this.loading=!1,this.error={title:o.u.i18n.error,description:o.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.appendCloseNotice;const t=()=>{var e;this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,p.h)(null!==(e=null==i?void 0:i.error)&&void 0!==e?e:{code:"unhandledError"},{appendErrorMessages:o.u.i18n.append.appendErrorMessages})},i=await(0,n.a)({portal:null===u.c||void 0===u.c?void 0:u.c.portal,sourceDataLayer:d.a.sourceDataLayer,existingItem:d.a.existingItem,timezone:d.a.timezone,analyzeResults:d.a.analyzeResults,type:d.a.type,fieldMappings:d.a.fieldMappings,dataLayer:d.a.dataLayer,id:d.a.id,uidPair:d.a.uidPair,addAppendSelectOption:d.a.addAppendSelectOption,attachmentsEnabled:d.a.attachmentsEnabled,insertAttachmentsEnabled:d.a.insertAttachmentsEnabled,featureAttachmentOption:d.a.featureAttachmentOption}),{result:a}=i;if(a){try{await(0,l.d)(d.a.id,{permanentDelete:!0})}catch(e){t()}if("completed"===(null===(e=null==a?void 0:a.status)||void 0===e?void 0:e.toLowerCase())){const e=Object.assign({appendType:d.a.addAppendSelectOption,insertAttachmentsEnabled:d.a.insertAttachmentsEnabled},i);return void this.workflowComplete.emit(e)}t()}else t()}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:n,error:s}=this;let l=t,r=e.header,p="appendOptions";return"update"===o.u.workflow&&(l=i,r=e.itemPropertiesHeader,p="updateOptions"),"Raster function template"===d.a.type&&(p="updateRFTOptions"),(0,a.h)(a.H,{key:"8df9b40350ceb73d2f0105db2f3c2e32889d0b50",class:{"overflow-hidden":this.loading}},(0,a.h)("arcgis-new-item-description",{key:"90a9394363a052e8fcbf402b2a60dbab2e543d87",header:r}),(0,a.h)("div",{key:"65d7b9a332a8944cb8b99091a39e31f13bffeeb7",class:"w-full"},(0,a.h)("div",{key:"fb10a5e356b723fcf57d96605059a88f9ed4334e",class:"w-full"},(0,a.h)("calcite-tile-group",{key:"d1c06696b62af665e2e3484084624217e13d5ad0",layout:"vertical",class:"tile-select",label:r,selectionMode:"single-persist"},Object.keys(l).map(t=>{const{icon:i}=l[t];return(0,a.h)("calcite-tile",{key:t,selected:this.selected===t,heading:e[p][t].title,description:e[p][t].description,icon:i,"input-enabled":!0,"data-value":t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelect:e=>this.selected=e.target.dataset.value})})))),"append"===o.u.workflow&&this.cannotUpdateGeometry&&(0,a.h)("calcite-notice",{key:"d76afefd1d9a06d8daa3e9dd8714cf155c039fb0",class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,a.h)("div",{key:"f6b5382b83a45498cadb48d340f7ca5cf79e1676",slot:"title"},e[n.title]),(0,a.h)("div",{key:"6346d71fce6b8bef756992ef4770fd7364acd781",slot:"message"},e[n.description])),(0,a.h)("arcgis-new-item-loader",{key:"38f509458dbdada5256ce5a3cdffcb4e31622c65",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,a.h)("arcgis-new-item-alert",{key:"279e903cabfea955cec731383929ded2d01b3d91",heading:null==s?void 0:s.title,description:null==s?void 0:s.description,link:{href:null==s?void 0:s.link,title:null==s?void 0:s.linkText},active:!!s,onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.a)(this)}};y.style=".div-w-full{width:100%}.tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}calcite-tile-group{inline-size:100%}calcite-tile{max-inline-size:100%;min-inline-size:100%}"},48538:(e,t,i)=>{i.d(t,{a:()=>l});var a=i(83692),n=i(69280),s=i(74695);async function l(e){var t,i,l,d;const o=(0,n.g)(e),r=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,a.r)(r,o,{},"post"),{status:i,recordCount:n,attachmentCount:l}=await(0,s.g)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:i,recordCount:n,attachmentCount:l}}}catch(e){let t="unhandledError";const a=(null===(d=null!==(l=null!==(i=e.description)&&void 0!==i?i:e.message)&&void 0!==l?l:e.errorMessage)||void 0===d?void 0:d.toLowerCase())||"";switch(!0){case a.includes("the create unique index statement terminated because a duplicate key was found for the object name"):t="invalidUniqueIdentifier";break;case a.includes("does not allow nulls"):t="cannotAddNullData";break;case a.includes("the value violates the maxlength limit of this column"):t="exceededMaxFieldLength";break;case a.includes("input string was not in a correct format"):t="invalidFieldType"}return console.error(e),{error:{code:t,message:JSON.stringify(e)}}}}},69280:(e,t,i)=>{i.d(t,{a:()=>p,c:()=>o,g:()=>r,h:()=>c});var a=i(3826),n=i(54077),s=i(15912),l=i(95878),d=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(i[a[n]]=e[a[n]])}return i};function o(e,t){var i;const a=(null==e?void 0:e.type)||null,n=(null==t?void 0:t.type)||null;return n&&(n===a||(null===(i={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[a])||void 0===i?void 0:i.includes(n)))}function r(e){var t;const{timezone:i,analyzeResults:o,type:r,fieldMappings:p,dataLayer:c,id:u,portal:y,uidPair:m,addAppendSelectOption:g,sourceDataLayer:h,attachmentsEnabled:f,insertAttachmentsEnabled:b,featureAttachmentOption:T}=e;let v,F;const{publishParameters:w}=o,O=d(o,["publishParameters"]),I="upsert"===g||"update"===g,k=function(e){const t=e.filter(e=>e.source!==`<${l.u.i18n.appendKeyValuePair.noneField}>`),i=t.map(({source:e,name:t})=>({source:e,name:t}));return i}(p),M=function(e){const t=e.map(e=>e.name);return t}(k),D={dateFieldsTimeReference:Object.assign(Object.assign({},(null==y?void 0:y.isPortal)?{timeZone:i||"UTC"}:{ianaTimeZone:i||"GMT"}),{respectsDaylightSaving:!0})},S={sourceTableName:c.name,fieldMappings:(null==k?void 0:k.length)?JSON.stringify(k):null,upsert:I,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:I&&"esriFieldTypeGlobalID"===(null==m?void 0:m.type),updateGeometry:!I||"attributeAndGeometry"===a.a.addAppendSelectUpdateTypeOption,appendFields:M.length?JSON.stringify(M):null,appendItemId:u,appendUploadFormat:s.a[a.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===h.type&&(w.locationType="none");const A=d(w,["layers"]);if("CSV"===r)w.layerInfo.dateFieldsTimeReference=D.dateFieldsTimeReference,F=Object.assign(Object.assign(Object.assign({},D),w),O);else if("Microsoft Excel"===r){const e=function(e,t){const i=Object.assign({},e);i.locationType=(null==t?void 0:t.locationType)||e.locationType,"address"===i.locationType?(i.addressFields=t.addressFields,i.sourceCountry=t.sourceCountry):"coordinates"===i.locationType&&(i.coordinateFieldType=t.coordinateFieldType,"LatitudeAndLongitude"===i.coordinateFieldType?(i.latitudeFieldName=t.latitudeFieldName,i.longitudeFieldName=t.longitudeFieldName):i.coordinateFieldName=t.coordinateFieldName);return i}((0,n.a)({},!0),A);e.dateFieldsTimeReference=D.dateFieldsTimeReference,A.name=c.name,F=Object.assign(Object.assign(Object.assign(Object.assign({},D),{layers:[e]}),A),O)}else F=Object.assign(Object.assign(Object.assign({},D),w),O);return v=Object.assign(Object.assign(Object.assign({},S),{appendSourceInfo:JSON.stringify(F)}),f&&function({insertAttachmentsEnabled:e}){return e?{skipAttachmentInserts:!1,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}:{skipAttachmentInserts:!0,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}}({appendType:g,insertAttachmentsEnabled:b,featureAttachmentOption:T})),"add"===g?v.upsertMatchingField=h.objectIdField||(null===(t=h.uniqueField)||void 0===t?void 0:t.name):I&&(null==m?void 0:m.isUniqueIndex)&&(v.upsertMatchingField=null==m?void 0:m.name),v}function p(e,t,i){return"File Geodatabase"===e&&i.hasAttachments&&t.hasAttachments}function c(e,t){const i=t.appendErrorMessages;let a=l.u.i18n.error,n=i.appendError;switch(e.code){case"invalidUniqueIdentifier":a=i.invalidUniqueIdentifier.title,n=i.invalidUniqueIdentifier.description;break;case"cannotAddNullData":a=i.cannotAddNullData.title,n=i.cannotAddNullData.description;break;case"exceededMaxFieldLength":a=i.exceededMaxFieldLength.title,n=i.exceededMaxFieldLength.description;break;case"invalidFieldType":a=i.invalidFieldType.title,n=i.invalidFieldType.description}return{title:a,description:n}}}}]);