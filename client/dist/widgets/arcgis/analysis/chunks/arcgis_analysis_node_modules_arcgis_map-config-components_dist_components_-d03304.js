/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-d03304.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-d03304"],{42855:(e,t,a)=>{a.d(t,{a:()=>r,f:()=>i,l:()=>s,s:()=>n});var i=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(i||{}),s=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(s||{}),n=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(n||{}),r=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(r||{})},52496:(e,t,a)=>{a.r(t),a.d(t,{ArcgisMapConfigPopupAddContentPopover:()=>p});var i=a(73679),s=a(4395),n=a(66228),r=a(85643),o=a(73801),c=(a(9923),a(42097),a(81565),a(98295));const l=s.AH`.popover{--calcite-popover-z-index: 100}`;class p extends o.WF{constructor(){super(...arguments),this.popoverNode=(0,r._)(),this.panelNode=(0,r._)(),this.isMultimediaContent=!1,this.arcgisAddMultimediaContent=(0,o.lh)(),this.arcgisAddPopoverContent=(0,o.lh)(),this.closePopupPopovers=(0,o.lh)()}static{this.properties={referenceElement:0,popoverPanelWidth:9,isMultimediaContent:5,popupState:0}}static{this.styles=l}async reposition(){this.popoverNode.value?.reposition()}loaded(){this.panelNode.value?.setFocus()}initiateAddContent(e){const{isMultimediaContent:t}=this;t?this.arcgisAddMultimediaContent.emit(e):this.arcgisAddPopoverContent.emit(e)}render(){const{popupState:e,isMultimediaContent:t}=this,{_messages:a}=e,i=(0,n.q)(this.referenceElement,"calcite-flow-item"),c=i?.getBoundingClientRect().top??56,l=i?.getBoundingClientRect().bottom??0,p=this.referenceElement.getBoundingClientRect().top,d=p-c<l-(p+25)?0:p-c-50-10,u={maxHeight:d>0?`${d}px`:"60vh"};return this.el.classList.add("js-app-flyout"),s.qy`<calcite-popover .referenceElement=${this.referenceElement} open placement=bottom class="popover" .label=${t?a.addMedia:a.addContent} trigger-disabled ${(0,r.K)(this.popoverNode)}><calcite-panel closable style=${(0,o.zl)({width:`${this.popoverPanelWidth}px`})} @calcitePanelClose=${()=>this.closePopupPopovers.emit()} ${(0,r.K)(this.panelNode)}><div slot=header-content>${t?a.addMedia:a.content}</div>${t?s.qy`<div style=${(0,o.zl)(u)}>${this.renderCharts()}${this.renderImages()}</div>`:s.qy`<div style=${(0,o.zl)(u)}>${this.renderAttributes()}${this.renderAttachments()}${this.renderCharts()}${this.renderImages()}${this.renderText()}${this.renderArcade()}${this.renderRelatedRecords()}${this.renderAssociations()}${this.renderLastEditedSummary()}</div>`}</calcite-panel></calcite-popover>`}renderAttributes(){const{popupState:e}=this,{_messages:t,layerHasAttributes:a}=e;return a?s.qy`<calcite-action .label=${t.fieldsList} .text=${t.fieldsList} text-enabled @click=${()=>this.initiateAddContent(c.C.ATTRIBUTES)}><calcite-icon scale=s icon=feature-details></calcite-icon></calcite-action>`:""}renderAttachments(){const{popupState:e}=this,{_messages:t,layerSupportsAttachments:a}=e;return a?s.qy`<calcite-action .label=${t.attachments} .text=${t.attachments} text-enabled @click=${()=>this.initiateAddContent(c.C.ATTACHMENTS)}><calcite-icon scale=s icon=attachment></calcite-icon></calcite-action>`:""}renderCharts(){const{popupState:e}=this,{_messages:t,layerHasCharts:a}=e;return a?s.qy`<calcite-action .label=${t.chart} .text=${t.chart} text-enabled @click=${()=>this.initiateAddContent(c.C.CHARTS)}><calcite-icon scale=s icon=graph-bar></calcite-icon></calcite-action>`:""}renderImages(){const{popupState:e}=this,{_messages:t,layerHasImages:a}=e;return a?s.qy`<calcite-action .label=${t.image} .text=${t.image} text-enabled @click=${()=>this.initiateAddContent(c.C.IMAGES)}><calcite-icon scale=s icon=image></calcite-icon></calcite-action>`:""}renderText(){const{popupState:e}=this,{_messages:t,layerHasText:a}=e;return a?s.qy`<calcite-action .label=${t.text} .text=${t.text} text-enabled @click=${()=>this.initiateAddContent(c.C.RICH_TEXT)}><calcite-icon scale=s icon=text></calcite-icon></calcite-action>`:""}renderArcade(){const{popupState:e}=this,{_messages:t,layerSupportsArcade:a}=e;return a?s.qy`<calcite-action .disabled=${e.blockFeatureReductionArcade} .label=${t.arcade} .text=${t.arcade} icon=code text-enabled @click=${()=>this.initiateAddContent(c.C.ARCADE)}></calcite-action>`:""}renderRelatedRecords(){const{popupState:e}=this,{_messages:t,layerHasRelatedRecords:a,backingFeatureLayer:i}=e;return!a||i?"":s.qy`<calcite-action .label=${t.relatedRecords} .text=${t.relatedRecords} text-enabled @click=${()=>this.initiateAddContent(c.C.RELATIONSHIP)}><calcite-icon scale=s icon=link></calcite-icon></calcite-action>`}renderAssociations(){const{popupState:e}=this,{_messages:t,layerIsUNLayer:a}=e;return a?s.qy`<calcite-action .label=${t.associations.associationsList} .text=${t.associations.associationsList} text-enabled @click=${()=>this.initiateAddContent(c.C.ASSOCIATIONS)}><calcite-icon scale=s icon=view-associations></calcite-icon></calcite-action>`:""}renderLastEditedSummary(){const{popupState:e}=this,{_messages:t,popupTemplate:a,layerHasEditInfo:i}=e;return i?s.qy`<calcite-action .label=${t.editInfoSummaryHeading} .text=${t.editInfoSummaryHeading} text-enabled @click=${()=>this.initiateAddContent(c.C.EDIT_INFO_SUMMARY)} .disabled=${!!a.lastEditInfoEnabled}><calcite-icon scale=s icon=user></calcite-icon></calcite-action>`:""}}(0,i.c)("arcgis-map-config-popup-add-content-popover",p)},66228:(e,t,a)=>{a.d(t,{a:()=>b,b:()=>$,c:()=>_,d:()=>T,e:()=>S,f:()=>P,g:()=>f,h:()=>h,i:()=>y,j:()=>g,k:()=>C,l:()=>N,m:()=>v,n:()=>u,o:()=>A,p:()=>M,q:()=>E,r:()=>k,s:()=>x,t:()=>I,u:()=>w});var i=a(63438),s=a(18423),n=a(96086),r=a(91813),o=a(21255),c=a(13078),l=a(21303),p=a(12627),d=a(42855);const u=["feature","scene","geojson","csv","subtype-sublayer","oriented-imagery","catalog-footprint","sublayer"],m=["feature"];function y(e){return null!=e}function g(e,t,a){const i=t.fieldName;if(i.includes(d.f.expression)){const e=a.get(i);return e?.title?e.title:i}return x(e)&&e.getFieldConfiguration(i)?e.getFieldAlias(i)||i:t.label||i}async function f(e){return new Map((await C(e)).filter(e=>e.visible).map(e=>[e.name,e]))}function h(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach(e=>{const a=`${d.f.expression}${e.name}`;t.set(a,e)}),t}function b(e){return"map-image"===e?.layer?.type?d.s.mapImage:"subtype-sublayer"===e?.type?d.s.subtype:"tile"===e?.layer?.type?d.s.tile:"scene"===e?.type?d.s.scene:"ogc-feature"===e?.type?d.s.ogcFeature:"imagery"===e?.type?d.s.imagery:"imagery-tile"===e?.type?d.s.imageryTile:"wfs"===e?.type?d.s.wfs:"wcs"===e?.type?d.s.wcs:"wms"===e?.layer?.type?d.s.wms:"csv"===e?.type?d.s.csv:"geojson"===e?.type?d.s.geojson:"stream"===e?.type?d.s.stream:"oriented-imagery"===e?.type?d.s.orientedImagery:"catalog"===e?.type?d.s.catalog:"catalog-footprint"===e?.type?d.s.catalogFootprint:"knowledge-graph-sublayer"===e?.type?d.s.knowledgeGraphSublayer:"voxel"===e?.type?d.s.voxel:"parquet"===e?.type?d.s.parquet:d.s.feature}function w(e){const t=b(e);let a;return t===d.s.wms||t===d.s.mapImage?a=e?.layer.version:(t===d.s.imagery||t===d.s.feature||t===d.s.scene)&&(a=e.version),Number.parseFloat(a)}function x(e){return"fieldConfigurations"in e&&m.includes(e.type)}async function C(e){return await new Promise((t,a)=>{switch(b(e)){case d.s.feature:case d.s.ogcFeature:case d.s.stream:t(e.fields);break;case d.s.mapImage:{const i=e,s=i?.layer;s?.portalItem&&s.url.includes("https://demographics")&&s.url.includes(".arcgis.com")?s.portalItem?.fetchData().then(e=>{if(e?.thematicGroup){const a=new Map(i.fields.map(e=>[e.name,e])),s=e.thematicGroup.fieldNames,n=[];s.forEach(e=>{a.has(e)&&n.push(a.get(e))}),t(n)}else t(i.fields)}).catch(e=>{a(new Error(e))}):t(i.fields);break}case d.s.imagery:case d.s.imageryTile:case d.s.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}})}function A(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function v(e){return Number((100*(1-e)).toFixed(1))}function I(e){return Number((1-e/100).toFixed(3))}const T=(e,t)=>{const a=[];return e?.fieldInfos?.forEach(e=>{e.fieldName?.includes(d.f.expression)||a.push({name:e.fieldName,alias:e.label,type:"string"})}),a},$=async(e,t)=>{const a=new p.default;return a.geometry=t.extent,a.mapExtent=t.extent,a.returnGeometry=!0,a.tolerance=6,a.layerOption="popup",a.width=t.width,a.height=t.height,a.layerIds=[e.id],(await l.identify(e.layer.url,a))?.results?.[0]?.feature},S=async(e,t,a)=>{const i=await(await e.whenLayerView(t)).queryAggregates();return await R(a,i.features?.[0])},R=async(e,t)=>{let a;if(t)a=t.clone();else{a=new i.default;const t=T(e);if(t?.length){const e={};t.forEach(t=>{e[t.name]=""}),a.attributes=e}const n=new s.default;a.geometry=n}return a};function E(e,t){const a=t.startsWith("#"),i=t.startsWith(".");for((i||a)&&(t=t.slice(1));e;){if(a){if(e.id===t)return e}else if(i){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function _(e){if(b(e)===d.s.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(b(e)===d.s.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find(t=>{if(t.id===e.id)return t})?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function N(e,t,a){let i="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))i="number";else if(t.has(e)){const a=t.get(e);i=a.type?a.type.toLowerCase():""}else if(a.has(e)){const t=a.get(e);i=t.returnType?t.returnType.toLowerCase():""}else i="number";return i}async function P(e,t){try{const a=b(e);if(a===d.s.mapImage&&e.layer.version>=10.5&&!e.layer.capabilities?.operations?.supportsQuery&&e.layer.capabilities?.operations?.supportsIdentify)return{features:[await $(e,t)||await L(e,t)]};if(a===d.s.scene&&!e.capabilities?.operations?.supportsQuery)return{features:[await L(e,t)]};const i=a===d.s.ogcFeature||a===d.s.stream?await t.whenLayerView(e):e,s=i.createQuery();s.where=i.definitionExpression||"1=1",s.outFields=["*"],s.returnM="hasM"in e&&e.hasM,s.returnZ="hasZ"in e&&e.hasZ,s.outSpatialReference=t.spatialReference,s.returnGeometry=!0,(i.sourceJSON?.advancedQueryCapabilities?.supportsPagination||a===d.s.ogcFeature)&&(s.start=0,s.num=1),s.outSpatialReference=t.spatialReference;const n=await i.queryFeatures(s);return n?.features?.length||(n.features[0]=await L(e,t)),n}catch(e){console.error(e)}}async function L(e,t){return await new Promise(a=>{const s=new i.default;if(e.fields?.length){const t={};e.fields.forEach(e=>{t[e.name]=e.defaultValue}),s.attributes=t}const l=t.extent;let p;"polygon"===e.geometryType?p=o.default.fromExtent(l):"point"===e.geometryType?p=l.center.clone():"multipoint"===e.geometryType?p=new n.default({points:[[l.center.x,l.center.y]],spatialReference:l.center.spatialReference.clone()}):"polyline"===e.geometryType?(p=new r.default({spatialReference:t.spatialReference.clone()}),p.addPath([[l.xmin,l.ymin],[l.xmax,l.ymax]])):"mesh"===e.geometryType&&(p=c.default.createBox(l.center.clone(),{size:{width:50,height:50,depth:50}})),s.geometry=p,a(s)})}function k(e){return b(e)===d.s.tile&&"url"in e&&"sublayer"===e.type&&-1===e.url?.indexOf(e.parent.url)&&!!e.fields?.length}function M(e){return b(e)===d.s.tile&&"url"in e&&"sublayer"===e.type&&-1!==e.url?.indexOf(e.parent.url)&&!!e.fields?.length}},98295:(e,t,a)=>{a.d(t,{A:()=>s,C:()=>i,I:()=>r,P:()=>n});var i=(e=>(e.ATTRIBUTES="attributes",e.ATTACHMENTS="attachments",e.CHARTS="charts",e.IMAGES="images",e.RICH_TEXT="richText",e.ARCADE="arcade",e.RELATIONSHIP="relationship",e.ASSOCIATIONS="associations",e.EDIT_INFO_SUMMARY="editInfoSummary",e))(i||{}),s=(e=>(e.PREVIEW="preview",e.LIST="list",e.AUTO="auto",e))(s||{}),n=(e=>(e.IMAGE="image",e.BAR_CHART="bar-chart",e.COLUMN_CHART="column-chart",e.LINE_CHART="line-chart",e.PIE_CHART="pie-chart",e))(n||{}),r=(e=>(e.SOURCE_URL="sourceUrl",e.TITLE="title",e.CAPTION="caption",e.LINK_URL="linkUrl",e.ALT_TEXT="altText",e))(r||{})}}]);