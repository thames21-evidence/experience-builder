/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f44b7b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f44b7b"],{931:(e,t,i)=>{i.d(t,{l:()=>s});var n=i(93814);const s=async(e,t)=>(await n.e.exports.loadModules(e,t)).map(e=>e.__esModule&&e.default?e.default:e)},3826:(e,t,i)=>{i.d(t,{a:()=>s,b:()=>r,c:()=>a,d:()=>n});const n=(0,i(37762).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),s=n.state,r=n.state,a=n.state},4429:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>u,c:()=>r,d:()=>c,e:()=>s,f:()=>n,g:()=>v,i:()=>h,m:()=>a,t:()=>o,u:()=>d});const n=(e,t)=>{let i,n="idle";const s=(...s)=>new Promise(r=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),r(e(...s))):r(null);break;case"invoked":clearTimeout(i),n="idle",r(e(...s));break;case"cancelled":clearTimeout(i),n="idle",r(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout(()=>(n="idle",r(e(...s))),t)}});return s.flush=function(...e){return n="flushed",s(...e)},s.invoke=function(...e){return n="invoked",s(...e)},s.cancel=function(...e){return n="cancelled",s(...e)},s.getStatus=function(){return n},s};function s(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(e){return null!=e}async function a(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise(t=>setTimeout(t,e))}const l=(e,t)=>Object.fromEntries((e||[]).map(e=>{const{key:i,data:n}=t(e);return[i,n]})),c=(e,t)=>e.length===t.length&&e.reduce((e,i)=>e&&t.indexOf(i)>-1,!0);function d(e,t){const i=[],n={};return e.forEach(e=>{const s=t(e);null==n[s]&&(n[s]=e,i.push(e))}),i}function u(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter(e=>{let n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}const v=(e,t)=>[...Array(Math.ceil(e.length/t))].map((i,n)=>e.slice(t*n,t+t*n)),h=(e,t)=>e.includes(t)},8412:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(83692);async function s(e){var t;const i=` ${null===(t=e[0])||void 0===t?void 0:t.url}/admin/services/types/customdataproviders`;try{return await(0,n.r)(i,"post")}catch(e){console.warn(e)}}},19574:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_feature_layer_from_custom_data_provider:()=>l});var n=i(87849),s=i(3826),r=i(95878),a=i(8412),o=i(59317);i(37762),i(83692),i(931),i(93814),i(41473),i(54251);const l=class{constructor(e){(0,n.r)(this,e),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.handleSelectChange=e=>{this.selectedCustomProvider=e,this.serviceParametersObject={},this.inputValidity={}},this.customDataProviders=null,this.selectedCustomProvider=void 0,this.serviceParametersObject={},this.inputValidity={}}async componentWillLoad(){const{hostingServer:e}=o.c;this.i18n=r.u.i18n.featureLayerFromCustomDataProvider,this.customDataProviders=await(0,a.g)(e);const t=Object.keys(this.customDataProviders);if(t.length>0){const{serviceInfo:e}=s.a;this.selectedCustomProvider=e?t.find(t=>this.customDataProviders[t][0].name===e.jsonProperties.customDataProviderInfo.dataProviderName):t[0],e&&(this.serviceParametersObject=e.jsonProperties.customDataProviderInfo.serviceParameters)}}async handleNext(){if(this.validateInputFields())return;const e=this.customDataProviders[this.selectedCustomProvider][0];s.a.serviceInfo={jsonProperties:{customDataProviderInfo:{forwardUserIdentity:!1,dataProviderName:e.name,dataProviderHost:this.serviceParametersObject.host||"",dataProviderId:this.serviceParametersObject.id||"",serviceParameters:this.serviceParametersObject}},provider:"CUSTOMDATA"},this.newItemUpdatePage.emit("itemProperties")}handleInputChange(e,t){this.serviceParametersObject[t]=e.target.value}validateInputFields(){let e=!1;const t=this.customDataProviders[this.selectedCustomProvider][0].properties.serviceParameters,i=Object.assign({},this.inputValidity);return t.forEach(({key:t})=>{this.serviceParametersObject[t]?i[t]=!1:(i[t]=!0,e=!0)}),this.inputValidity=i,e}renderSelectOptions(){return Object.entries(this.customDataProviders).map(([e,t],i)=>(0,n.h)("calcite-option",{value:e,key:i},t[0].name))}renderInputFields(){return Object.keys(this.customDataProviders).flatMap(e=>{const{serviceParameters:t}=this.customDataProviders[e][0].properties;return this.selectedCustomProvider!==e?[]:t.map(({label:e,description:t,key:i})=>(0,n.h)("div",{key:this.selectedCustomProvider+i},(0,n.h)("calcite-label",{layout:"inline"},e,(0,n.h)("calcite-icon",{icon:"information",scale:"s",id:`${this.selectedCustomProvider} ${t}`}),(0,n.h)("calcite-tooltip",{"reference-element":`${this.selectedCustomProvider} ${t}`},(0,n.h)("span",null,t))),(0,n.h)("calcite-input",{onCalciteInputInput:e=>this.handleInputChange(e,i),scale:"l",status:this.inputValidity[i]?"invalid":"idle",value:this.serviceParametersObject[i]||""}),(0,n.h)("calcite-input-message",{icon:!0,status:"invalid",hidden:!this.inputValidity[i]},this.i18n.missingValue.replace("${missingValue}",e))))})}render(){const{i18n:e}=this;return(0,n.h)(n.H,{key:"e0683db3bfb2c0dd088748e8611b5c90f264d8bf"},(0,n.h)("calcite-label",{key:"efc9e66b0466fc8d0f2b06f66bed16e9edaba6ed",class:"label"},(0,n.h)("arcgis-new-item-description",{key:"701c81aa661bef70df58eb61c709725ffd10e054",header:e.header}),(0,n.h)("calcite-select",{key:"200fc628ec66fcbb2f139e1f521347a977be0645",label:e.header,onCalciteSelectChange:e=>this.handleSelectChange(e.currentTarget.value),value:this.selectedCustomProvider},this.renderSelectOptions()),this.customDataProviders&&this.renderInputFields()))}get el(){return(0,n.a)(this)}};l.style=".label{margin-top:1.5rem}.hide{display:none}"},54251:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(59317);function s(e){var t,i,s,r;return null!=e||(e=null===n.c||void 0===n.c?void 0:n.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(s=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===s?void 0:s.token)||(null===(r=null==e?void 0:e.portalUser)||void 0===r?void 0:r.token)||""}},83692:(e,t,i)=>{i.d(t,{a:()=>p,b:()=>m,c:()=>h,f:()=>u,g:()=>P,i:()=>v,p:()=>b,r:()=>f});var n=i(59317),s=i(4429),r=i(931),a=i(41473),o=i(54251);const l={},c={},d={};async function u(e,t,i,n){var s,r,a,o;const u=null===(r=null===(s=d[t])||void 0===s?void 0:s[i])||void 0===r?void 0:r.expireAt,v=!!u&&(new Date).getTime()>u;if((null===(a=l[t])||void 0===a?void 0:a[i])&&!v)return l[t][i];c[t]||(c[t]={}),c[t][i]&&!v||(c[t][i]=e());const h=await c[t][i];if(l[t]||(l[t]={}),d[t]||(d[t]={}),l[t][i]=h,n){const{expireAfter:e,getExpireAfterFromResult:s}=n,r=s||e?(new Date).getTime()+(null!==(o=null==s?void 0:s(h))&&void 0!==o?o:e):null;d[t][i]=Object.assign(Object.assign({},d[t][i]),{expireAt:r})}return h}function v(e,t){var i;return null===(i=null==l?void 0:l[e])||void 0===i?void 0:i[t]}const h=(e,t)=>{var i,n;t?(null===(i=l[e])||void 0===i||delete i[t],null===(n=c[e])||void 0===n||delete n[t]):(delete l[e],delete c[e])};function m(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}async function p(e,t,i={},n){const[s]=await(0,r.l)(["esri/request"]);e.includes("f=")||t.append("f","json");const a=(0,o.g)();return a&&!t.has("token")&&t.append("token",a),new Promise((r,a)=>{s(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:n||"auto"})).then(e=>{r(e.data)}).catch(e=>a(e))})}async function f(e,t={},i={},s,a){const[o]=await(0,r.l)(["esri/request"]),{api:l,portal:c}=n.c,{customToken:d,addTokenManually:u,addSSL:v,useProxy:h}=i,m=Object.assign({},t);if(e.includes("f=")||!0===(null==a?void 0:a.excludeJson)||(m.f="json"),d)m.token=d;else if(!1!==u){const e=await P(c);e&&(m.token=e)}const p=!1===v?e:function(e){var t;const{config:i}=n.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}(e);if(3===l){const e=Object.assign({url:p,content:m,timeout:i.timeout||0},null==a?void 0:a.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return o(e,"post"===s?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:m,method:s||"auto"},i),{timeout:i.timeout||0,useProxy:h}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await o(p,e)).data}}const g=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const b=async(e,t,i)=>{var n,r;const a=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],o=null!==(r=null==t?void 0:t.successStatuses)&&void 0!==r?r:["completed","Completed","COMPLETED"];let l=0;const c=async()=>{const n=await f(e,null==t?void 0:t.requestParams,{},i),r=n.status||n.jobStatus;if(a.includes(r))return await(0,s.t)((d=l++,1e3*g[d>-1&&d<g.length-1?d:g.length-1])),c();if(o.includes(r)||"failed"===r||"esriJobFailed"===r)return n;throw n;var d};try{return c()}catch(e){throw console.error(e),e}},P=async e=>{var t;if(!(null==e?void 0:e.isPortal)||!(0,a.i)(e))return(0,o.g)(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,a.i)(e))return;const{token:i}=await u(()=>y(e),"platformSelf",null!==(t=m(e.user))&&void 0!==t?t:e.id,{getExpireAfterFromResult:e=>e.expires_in});return i},y=async e=>{const t=await(async e=>{var t,i;const[n]=await(0,r.l)(["esri/identity/IdentityManager"]);return null!==(i=null===(t=(await u(()=>n.getCredential((0,a.g)(e),{oAuthPopupConfirmation:!1}),"credential",m(e.user))).oAuthState)||void 0===t?void 0:t.appId)&&void 0!==i?i:"arcgisonline"})(e),i={"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return f(`${(0,a.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:i,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:i}})}},95878:(e,t,i)=>{i.d(t,{a:()=>n,u:()=>s});const n=(0,i(37762).c)({nextText:"next",cancelText:"cancel",workflow:"content",scale:"m",disableScroll:!1,onlyHosted:!1,featureFlags:{}}),s=n.state}}]);