/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-1e2ed8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-1e2ed8"],{30812:(e,t,n)=>{n.d(t,{g:()=>s});var a=n(42097),r=n(42855),i=n(66228);async function s(e,t){return await async function(e,t){const n=[],s=new Map(t?.fieldInfos?.map(e=>[e.fieldName,e])),o=await(0,i.g)(e);return o?.size&&(s.forEach(e=>{o.has(e.fieldName)&&("geometry"!==o.get(e.fieldName).type&&n.push(e),o.delete(e.fieldName))}),o.forEach(e=>{if(!["geometry"].includes(e.type)){const t=new a.default;t.fieldName=e.name,t.label=e.alias,t.visible=!1,n.push(t)}}),o.clear()),t?.expressionInfos&&t.expressionInfos?.forEach(e=>{const t=`${r.f.expression}${e.name}`;if(s.has(t))n.push(s.get(t));else{const e=new a.default;e.fieldName=t,e.visible=!1,n.push(e)}}),t?.fieldInfos?.forEach(e=>{e.fieldName.includes(r.f.relationship)&&n.push(e)}),await Promise.resolve(n)}(e,t)}},34132:(e,t,n)=>{n.d(t,{a:()=>c,b:()=>f,c:()=>p,d:()=>h,e:()=>g,f:()=>m,g:()=>d,s:()=>y});var a=n(9923),r=n(42097),i=n(42855),s=n(66228),o=n(30812),l=n(71384),u=n(34883);async function d(e,t,n,a,r){return r===i.l.cluster?{id:"popup-feature-reduction",definitions:{$feature:{fields:(0,s.d)(a)},$aggregatedFeatures:await w(t,e,a)}}:n===i.s.voxel?{id:"popup-voxel",definitions:{$voxel:e}}:{id:"popup",...(n===i.s.mapImage||n===i.s.scene||n===i.s.tile)&&{disabledVariables:["$layer","$map","$datastore"]},...(n===i.s.geojson||n===i.s.wfs||n===i.s.csv)&&{disabledVariables:["$datastore"]},definitions:{$feature:e,$layer:e,$map:t.map,$datastore:e}}}async function c(e,t,n,a){try{return"subtype-sublayer"!==e.type&&"voxel"!==e.type&&n===i.l.cluster?{profileVariableInstances:{$feature:await(0,s.e)(t,e,a),$aggregatedFeatures:await w(t,e,a),$view:{scale:"scale"in t?t.scale:void 0,timeProperties:t.timeExtent?{currentStart:t.timeExtent.start,currentEnd:t.timeExtent.end,startIncluded:!0,endIncluded:!0}:void 0}},spatialReference:t.spatialReference,timeZone:t.timeZone}:"voxel"===e.type?void 0:{profileVariableInstances:{$feature:(await(0,s.f)(e,t)).features[0],$layer:e,$map:t.map,$view:{scale:"scale"in t?t.scale:void 0,timeProperties:t.timeExtent?{currentStart:t.timeExtent.start,currentEnd:t.timeExtent.end,startIncluded:!0,endIncluded:!0}:void 0},$datastore:"subtype-sublayer"===e.type?e.parent.url:e.url,$userInput:t.extent?.center},spatialReference:t.spatialReference,timeZone:t.timeZone}}catch(e){console.log(e)}}function f(e,t,n){return e||(t===i.l.cluster?function(e){return`// ${e.clusterArcadeScriptLine3} \nExpects($aggregatedFeatures, "field1", "field2")\n`}(n):"")}function p(e,t){const{layer:n,_messages:a,serviceType:r,allowTimeSeriesConfiguration:s}=e,o=n;let u;return"popupElement"===t&&(u=[{label:a.chartTemplate,code:T()},{label:a.fieldsListTemplate,code:v()},{label:a.richText,code:P()}]),s&&"attributeExpression"===t&&r!==i.s.mapImage&&(u=u||[],u.push({label:a.timeSeries,description:a.timeSeriesDescription,code:(0,l.g)()})),"hasM"in o&&o.hasM&&(u=u||[],u.push({label:a.mValueTemplate,code:E()})),u?.length?[{label:a.templates,suggestions:u}]:void 0}function m(e,t){const n=`// ${t.arcadeContentClusterScriptLine} \nExpects($aggregatedFeatures, "field1", "field2")\n\n`,a=`/* \n${t.arcadeContentScriptLine1} \n${t.arcadeContentScriptLine2} \nhttps://developers.arcgis.com/arcade/guide/profiles/#popup-element \n*/\n\n${P()}`;return e===i.l.cluster?n+a:a}function y(e,t,n){const r=t,i=new a.default;return i.expression=e.script,i.title=e.title,i.name=x(n,r),i.returnType="number"===e.predictOutputType?"number":"string",n.expressionInfos?r?n.expressionInfos.find((e,t)=>{e.name===r&&(n.expressionInfos[t]=i)}):n.expressionInfos.push(i):n.expressionInfos=[i],i}async function h(e){const{popupTemplate:t,layerDisplayType:n,layer:a}=e;n===i.l.cluster?(a.featureReduction.popupTemplate.expressionInfos=[...t.expressionInfos],t.fieldInfos=b(t)):(a.popupTemplate.expressionInfos=[...t.expressionInfos],t.fieldInfos=[...await(0,o.g)((0,u.g)(e),t)])}function g(e){const{mapView:t,layerDisplayType:n}=e;return n===i.l.cluster&&(0,u.g)(e).featureReduction.maxScale>=t.scale}async function w(e,t,n){const a=await e.whenLayerView(t),r=a.createQuery();return r.aggregateIds=[(await(0,s.e)(e,t,n)).getObjectId()],await a.queryFeatures(r)}const P=()=>"return { \n\ttype : 'text', \n\ttext : 'place your text or html here' //this property supports html tags \n}",v=()=>"return {\n    type: 'fields',\n    //title: '',\n    //description : '',\n    fieldInfos:  [{\n          fieldName: \"att1\"  // fieldName should match the key in the attributes dictionary\n        },\n        {\n          fieldName: \"att2\"  // fieldName should match the key in the attributes dictionary\n        },\n        {\n          fieldName: \"att3\"  // fieldName should match the key in the attributes dictionary\n        }],\n    attributes : {att1 : 2, att2 : 3, att3 : 4}  // replace this dictionary with your own key-value pairs\n  }",T=()=>"return {\n    type: 'media',\n    // title : 'The title for all media in the element',\n    // description : '',\n    attributes : {att1 : 2, att2 : 3, att3 : 4},  // replace this dictionary with your own key-value pairs,\n    mediaInfos: [{\n        type : 'piechart', //linechart | barchart | piechart | columnchart\n        title : 'give your chart a title',\n        // caption : '',\n        altText : '', //altText will be read by screen readers\n        value : {\n          fields: [\"att1\", \"att2\", \"att3\"],  // choose what attributes to use in the chart\n          /* colors: [  // values must be an array of [r, g, b, a] values (0-255)\n            [122, 190, 229, 255],\n            [179, 155, 213, 255],\n            [248, 174, 131, 255]\n          ], */\n          //normalizeField : '',  // the name of the attribute to normalize by or value\n        }\n      }]\n  }",E=()=>"if (TypeOf($userInput) == \"Point\") {\n  var result = PointToCoordinate($feature, $userInput);\n  return Text(result.coordinate.m, '#,###.00');\n}",b=e=>{const t=[];return e.fieldInfos.forEach(e=>{e.fieldName.includes(i.f.expression)||t.push(e)}),e.expressionInfos?.forEach(async e=>{const n=new r.default;n.fieldName=`${i.f.expression}${e.name}`,n.visible=!1,t.push(n)}),t},x=(e,t)=>{if(t)return t;if(e.expressionInfos?.length){const t=e.expressionInfos[e.expressionInfos.length-1].name.match(/\d+$/u);return t?.[0]?`expr${Number(t[0])+1}`:`expr${e.expressionInfos.length}`}return"expr0"}},34883:(e,t,n)=>{function a(e){const{layer:t,backingFeatureLayer:n}=e;return n??t}n.d(t,{g:()=>a})},42855:(e,t,n)=>{n.d(t,{a:()=>s,f:()=>a,l:()=>r,s:()=>i});var a=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(a||{}),r=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(r||{}),i=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(i||{}),s=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(s||{})},66228:(e,t,n)=>{n.d(t,{a:()=>w,b:()=>_,c:()=>L,d:()=>I,e:()=>N,f:()=>M,g:()=>h,h:()=>g,i:()=>m,j:()=>y,k:()=>T,l:()=>O,m:()=>b,n:()=>f,o:()=>E,p:()=>S,q:()=>A,r:()=>R,s:()=>v,t:()=>x,u:()=>P});var a=n(63438),r=n(18423),i=n(96086),s=n(91813),o=n(21255),l=n(13078),u=n(21303),d=n(12627),c=n(42855);const f=["feature","scene","geojson","csv","subtype-sublayer","oriented-imagery","catalog-footprint","sublayer"],p=["feature"];function m(e){return null!=e}function y(e,t,n){const a=t.fieldName;if(a.includes(c.f.expression)){const e=n.get(a);return e?.title?e.title:a}return v(e)&&e.getFieldConfiguration(a)?e.getFieldAlias(a)||a:t.label||a}async function h(e){return new Map((await T(e)).filter(e=>e.visible).map(e=>[e.name,e]))}function g(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach(e=>{const n=`${c.f.expression}${e.name}`;t.set(n,e)}),t}function w(e){return"map-image"===e?.layer?.type?c.s.mapImage:"subtype-sublayer"===e?.type?c.s.subtype:"tile"===e?.layer?.type?c.s.tile:"scene"===e?.type?c.s.scene:"ogc-feature"===e?.type?c.s.ogcFeature:"imagery"===e?.type?c.s.imagery:"imagery-tile"===e?.type?c.s.imageryTile:"wfs"===e?.type?c.s.wfs:"wcs"===e?.type?c.s.wcs:"wms"===e?.layer?.type?c.s.wms:"csv"===e?.type?c.s.csv:"geojson"===e?.type?c.s.geojson:"stream"===e?.type?c.s.stream:"oriented-imagery"===e?.type?c.s.orientedImagery:"catalog"===e?.type?c.s.catalog:"catalog-footprint"===e?.type?c.s.catalogFootprint:"knowledge-graph-sublayer"===e?.type?c.s.knowledgeGraphSublayer:"voxel"===e?.type?c.s.voxel:"parquet"===e?.type?c.s.parquet:c.s.feature}function P(e){const t=w(e);let n;return t===c.s.wms||t===c.s.mapImage?n=e?.layer.version:(t===c.s.imagery||t===c.s.feature||t===c.s.scene)&&(n=e.version),Number.parseFloat(n)}function v(e){return"fieldConfigurations"in e&&p.includes(e.type)}async function T(e){return await new Promise((t,n)=>{switch(w(e)){case c.s.feature:case c.s.ogcFeature:case c.s.stream:t(e.fields);break;case c.s.mapImage:{const a=e,r=a?.layer;r?.portalItem&&r.url.includes("https://demographics")&&r.url.includes(".arcgis.com")?r.portalItem?.fetchData().then(e=>{if(e?.thematicGroup){const n=new Map(a.fields.map(e=>[e.name,e])),r=e.thematicGroup.fieldNames,i=[];r.forEach(e=>{n.has(e)&&i.push(n.get(e))}),t(i)}else t(a.fields)}).catch(e=>{n(new Error(e))}):t(a.fields);break}case c.s.imagery:case c.s.imageryTile:case c.s.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}})}function E(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function b(e){return Number((100*(1-e)).toFixed(1))}function x(e){return Number((1-e/100).toFixed(3))}const I=(e,t)=>{const n=[];return e?.fieldInfos?.forEach(e=>{e.fieldName?.includes(c.f.expression)||n.push({name:e.fieldName,alias:e.label,type:"string"})}),n},_=async(e,t)=>{const n=new d.default;return n.geometry=t.extent,n.mapExtent=t.extent,n.returnGeometry=!0,n.tolerance=6,n.layerOption="popup",n.width=t.width,n.height=t.height,n.layerIds=[e.id],(await u.identify(e.layer.url,n))?.results?.[0]?.feature},N=async(e,t,n)=>{const a=await(await e.whenLayerView(t)).queryAggregates();return await F(n,a.features?.[0])},F=async(e,t)=>{let n;if(t)n=t.clone();else{n=new a.default;const t=I(e);if(t?.length){const e={};t.forEach(t=>{e[t.name]=""}),n.attributes=e}const i=new r.default;n.geometry=i}return n};function A(e,t){const n=t.startsWith("#"),a=t.startsWith(".");for((a||n)&&(t=t.slice(1));e;){if(n){if(e.id===t)return e}else if(a){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function L(e){if(w(e)===c.s.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(w(e)===c.s.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find(t=>{if(t.id===e.id)return t})?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function O(e,t,n){let a="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))a="number";else if(t.has(e)){const n=t.get(e);a=n.type?n.type.toLowerCase():""}else if(n.has(e)){const t=n.get(e);a=t.returnType?t.returnType.toLowerCase():""}else a="number";return a}async function M(e,t){try{const n=w(e);if(n===c.s.mapImage&&e.layer.version>=10.5&&!e.layer.capabilities?.operations?.supportsQuery&&e.layer.capabilities?.operations?.supportsIdentify)return{features:[await _(e,t)||await $(e,t)]};if(n===c.s.scene&&!e.capabilities?.operations?.supportsQuery)return{features:[await $(e,t)]};const a=n===c.s.ogcFeature||n===c.s.stream?await t.whenLayerView(e):e,r=a.createQuery();r.where=a.definitionExpression||"1=1",r.outFields=["*"],r.returnM="hasM"in e&&e.hasM,r.returnZ="hasZ"in e&&e.hasZ,r.outSpatialReference=t.spatialReference,r.returnGeometry=!0,(a.sourceJSON?.advancedQueryCapabilities?.supportsPagination||n===c.s.ogcFeature)&&(r.start=0,r.num=1),r.outSpatialReference=t.spatialReference;const i=await a.queryFeatures(r);return i?.features?.length||(i.features[0]=await $(e,t)),i}catch(e){console.error(e)}}async function $(e,t){return await new Promise(n=>{const r=new a.default;if(e.fields?.length){const t={};e.fields.forEach(e=>{t[e.name]=e.defaultValue}),r.attributes=t}const u=t.extent;let d;"polygon"===e.geometryType?d=o.default.fromExtent(u):"point"===e.geometryType?d=u.center.clone():"multipoint"===e.geometryType?d=new i.default({points:[[u.center.x,u.center.y]],spatialReference:u.center.spatialReference.clone()}):"polyline"===e.geometryType?(d=new s.default({spatialReference:t.spatialReference.clone()}),d.addPath([[u.xmin,u.ymin],[u.xmax,u.ymax]])):"mesh"===e.geometryType&&(d=l.default.createBox(u.center.clone(),{size:{width:50,height:50,depth:50}})),r.geometry=d,n(r)})}function R(e){return w(e)===c.s.tile&&"url"in e&&"sublayer"===e.type&&-1===e.url?.indexOf(e.parent.url)&&!!e.fields?.length}function S(e){return w(e)===c.s.tile&&"url"in e&&"sublayer"===e.type&&-1!==e.url?.indexOf(e.parent.url)&&!!e.fields?.length}},71384:(e,t,n)=>{n.d(t,{a:()=>a,g:()=>r});const a="timeProperties";function r(e){return`// To configure a time series visualization using this template, data for this layer should be structured so that\n// each row represents a static feature with a fixed location, such as a country boundary or a city location.\n// The attribute table should have two or more fields that represent the same data attributes at different points in time for each feature.\n// Field names should refer to a specific attribute and a specific point in time, such as population in a specific year.\n// e.g. POP1990, POP2000, POP2010, POP2020, POP2030\n\n// There are four areas of this template where modification is necessary for the template to work with your layer\n// Two are required, and two are optional. \n\n// Examine your data and the details below to edit the template accordingly.\n\nvar FIELD_NAME_PATTERN = "POP{Y}"; // Required - Update this to match your data. See Lines 17-49 for details.\nExpects($feature, "POP*"); // Required - Update this to match your data. See Lines 51-63 for details.\nvar DEFAULT_FIELD_NAME = ""; // Optional - See Lines 65-79 for details.\nvar RESULT_FORMAT_PATTERN = "${e?.resultFormatPattern??"#,###.00"}"; // Optional - Update this to match your data. See Lines 81-93 for details.\n\n// FIELD_NAME_PATTERN\n//\n// The field name pattern is used to create the field name from the time slider values.\n// Patterns are defined using the following syntax: fieldName{pattern}\n//\n// EXAMPLE 1: given fields with names Cases_2023_10_01, Cases_2023_10_02, Cases_2023_10_03, etc., the field name pattern would be:\n// var FIELD_NAME_PATTERN = "Cases_{Y_MM_DD}";\n//\n// EXAMPLE 2: given fields with names POP2000, POP2010, POP2020, etc., the field name pattern would be:\n// var FIELD_NAME_PATTERN = "POP{Y}";\n//\n// The following patterns are supported:\n//\n// D: Day of the month, not padded (1 - 31)\n// DD: Day of the month, padded (01 - 31)\n// DDD: Ordinal day of the year (1 - 365)\n// d: Day of the week (1 - 7)\n// ddd: Abbreviated day of the week (e.g. Mon)\n// dddd: Full day of the week (e.g. Monday)\n// M: Month number (1 - 12)\n// MM: Month number, padded (01 - 12)\n// MMM: Abbreviated month name (e.g. Jan)\n// MMMM: Full month name (e.g. January)\n// Y: Full year\n// YY: Two-digit year\n// h: Civilian hours, not padded (1 - 12)\n// hh: Civilian hours, padded (01 - 12)\n// H: Military hours, not padded (0 - 23)\n// HH: Military hours, padded (00 - 23)\n// m: Minutes, not padded (0 - 59)\n// mm: Minutes, padded (00 - 59)\n// s: Seconds, not padded (0 - 59)\n// ss: Seconds, padded (00 - 59)\n\n// EXPECTS\n//\n// Copy and paste the part of the field pattern common to all fields\n// followed by an asterisk (*) into the second parameter of the Expects function.\n// This must be a raw text value like "POP*", not a variable name like FIELD_NAME_PATTERN.\n// \n// EXAMPLE 1: given fields with names Cases_2023_10_01, Cases_2023_10_02, Cases_2023_10_03, etc.\n//   - Expects($feature, \u201cCases_*\u201d);  // includes all fields that start with "Cases_"\n//   - Expects($feature, \u201cCases_2023*\u201d); // includes all Cases fields for the year 2023\n// \n// EXAMPLE 2: given fields with names POP2000, POP2010, POP2020, etc.\n//   - Expects($feature, "POP*"); // includes all fields that start with "POP"\n//   - Expects($feature, "POP2*"); // includes all "POP" fields for all years after 2000\n\n// DEFAULT_FIELD_NAME\n//\n// The field name to return if the time slider is closed.\n// Suggested values might include the first field in the time series,\n// the most recent field in the time series, or possibly an\n// aggregated value, such as TOTAL_POPULATION.\n// \n// EXAMPLE 1: The first field in the time series. Given fields with names POP2000, POP2010, POP2020, TOTAL_POPULATION,\n// var DEFAULT_FIELD_NAME = "POP2000";\n//\n// EXAMPLE 2: An aggregated value such as the total population. Given fields with names POP2000, POP2010, POP2020, TOTAL_POPULATION,\n// var DEFAULT_FIELD_NAME = "TOTAL_POPULATION";\n//\n// Note - If you defined a default field, be sure to include it in the Expects function as a third parameter.\n// e.g. Expects($feature, "POP*", "TOTAL_POPULATION");\n\n// RESULT_FORMAT_PATTERN\n//\n// The result format pattern is used to format the result of the calculation.\n// Patterns are defined using the following syntax: #,###.00\n// This should only be defined for formatting numeric values in labels or popups.\n// If using for symbology/layer styles, or the field data type\n// is a string, then leave this value empty.\n//\n// EXAMPLE 1: if returning a numeric value in a label,\n// var RESULT_FORMAT_PATTERN = "#,###"; // formats the value with commas and rounded to nearest integer\n// \n// EXAMPLE 2: if returning a numeric value in a popup,\n// var RESULT_FORMAT_PATTERN = "#,###.00"; // formats the value with commas and two decimal places\n\nfunction fieldsWithPatternFilter(field) {\n  var prefix = Front(Split(FIELD_NAME_PATTERN, "{"));\n  var suffix = Back(Split(FIELD_NAME_PATTERN, "}"));\n  var patternToFind = DefaultValue(prefix, suffix);\n  return Find(patternToFind, field.name) > -1;\n}\n\nfunction fieldsWithPatternMap(field) {\n  return field.name;\n}\n\nfunction getAllFieldsFromPattern() {\n  var fields = Schema($feature).fields;\n  return Sort(\n    Map(Filter(fields, fieldsWithPatternFilter), fieldsWithPatternMap)\n  );\n}\n\nfunction getFieldNameFromTimeProperties(dateValue, pattern) {\n  var fieldName = pattern;\n\n  var startPosition = Find("{", fieldName);\n  while (startPosition > -1) {\n    var startIndex = Find("{", fieldName, startPosition);\n    var endIndex = Find("}", fieldName, startIndex);\n    var searchText = Mid(fieldName, startIndex, endIndex - startIndex + 1);\n    var dateText = Text(dateValue, searchText);\n    fieldName = Replace(fieldName, searchText, dateText);\n    startPosition = Find("{", fieldName, endIndex);\n  }\n  fieldName = Replace(Replace(fieldName, "{", ""), "}", "");\n  return fieldName;\n}\n\nvar hasCurrentStart = HasValue($view, ["timeProperties", "currentStart"]);\nvar hasCurrentEnd = HasValue($view, ["timeProperties", "currentEnd"]);\n\nvar hasTimeProperties = hasCurrentStart || hasCurrentEnd;\n\nif (!hasTimeProperties) {\n  if (!IsEmpty(DEFAULT_FIELD_NAME) && HasKey($feature, DEFAULT_FIELD_NAME)) {\n    return $feature[DEFAULT_FIELD_NAME];\n  }\n  var firstField = Front(getAllFieldsFromPattern());\n  return $feature[firstField];\n}\n\nvar currentValue = DefaultValue(\n  $view.timeProperties.currentEnd,\n  $view.timeProperties.currentStart\n);\n\nfunction getValueAtInstant() {\n  var fieldName = getFieldNameFromTimeProperties(\n    currentValue,\n    FIELD_NAME_PATTERN\n  );\n  if (HasValue($feature, fieldName)) {\n    var value = $feature[fieldName];\n    return value;\n  }\n  return null;\n}\n\nfunction formatResult(value) {\n  if (IsEmpty(value)) {\n    return null;\n  }\n  if (IsEmpty(RESULT_FORMAT_PATTERN)) {\n    return value;\n  }\n  return Text(value, RESULT_FORMAT_PATTERN);\n}\n\nvar result = getValueAtInstant();\nreturn formatResult(result);`}}}]);