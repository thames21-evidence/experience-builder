/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-08ca20.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-08ca20"],{3764:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_data_store_databricks_credentials:()=>d});var i=a(87849),c=a(59317),n=a(64589),s=a(47172),r=a(3826),o=a(95878),l=a(86686);a(37762),a(41473),a(60958),a(83692),a(931),a(93814),a(54251),a(1536),a(88878),a(46904),a(72257),a(86562),a(15332),a(15912),a(74695),a(24869),a(27137),a(76246),a(58573),a(29599),a(32478);const d=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.allowedAuthenticationTypes=["oAuthMachineToMachine","personalAccessToken"],this.handleAuthenticationTypeChange=e=>{const t=e.target.selectedOption.value;this.authenticationType!==t&&("oAuthMachineToMachine"===this.authenticationType?(this.clientId=void 0,this.secret=void 0):"personalAccessToken"===this.authenticationType&&(this.token=void 0),this.authenticationType=t)},this.authenticationType="oAuthMachineToMachine",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.server=void 0,this.clientId=void 0,this.secret=void 0,this.token=void 0,this.httpPath=void 0,this.catalog=void 0,this.emptyRequiredFields=new Set,this.error=void 0}async handleNext(){r.a.authenticationType=this.authenticationType,r.a.databricksServer=this.server,r.a.httpPath=this.httpPath,r.a.catalog=this.catalog,"oAuthMachineToMachine"===this.authenticationType?(r.a.clientId=this.clientId,r.a.secret=this.secret):r.a.token=this.token,this.emptyRequiredFields=this.checkValidFields(),this.emptyRequiredFields.size>0?this.handleError({code:"unhandledError"}):await this.validateConnection()}async componentWillLoad(){this.i18n=o.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{server:e,httpPath:t,clientId:a,secret:i,token:c}=this,n=Object.assign({server:e,httpPath:t},"oAuthMachineToMachine"===this.authenticationType?{clientId:a,secret:i}:{token:c});return new Set(Object.entries(n).filter(([e,t])=>!t||""===t.trim()).map(([e])=>e))}populateFields(){var e;this.server=r.a.databricksServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=r.a.authenticationType),this.httpPath=r.a.httpPath,this.catalog=r.a.catalog,"oAuthMachineToMachine"===this.authenticationType?(this.clientId=r.a.clientId,this.secret=r.a.secret):this.token=r.a.token}async validateConnection(){const{authenticationType:e,server:t,httpPath:a,catalog:i,clientId:o,secret:d,token:h}=this,{orgId:u}=c.c.user;this.loading=!0,this.loaderMessage=this.i18n.validating;const p=(0,l.j)({authenticationType:e,server:t,httpPath:a,catalog:i,clientId:o,secret:d,token:h}),{result:b,error:f}=await(0,n.v)(u,c.c.portal,p);"success"===(null==b?void 0:b.status)?(r.a.connectionProperties=p.info.connectionProperties,r.a.typeKeywords=[...r.a.typeKeywords,"CDW","databricks"],r.a.initialTitle=(0,s.f)("databricks"),this.newItemUpdatePage.emit("itemProperties")):this.handleError(f)}handleError(e){this.loading=!1;let t=this.i18n.errors.validationFailedTitle,a=this.i18n.errors.invalidConnection;switch(e.code){case"invalidCredentials":case"unauthorizedCredentials":a=this.i18n.errors[e.code]}this.error={title:t,description:a,details:e.details}}render(){var e;const{i18n:t,authenticationType:a,server:c,httpPath:n,catalog:s,clientId:r,secret:l,token:d,error:h}=this;return(0,i.h)("div",{key:"b0961c336666c78cd0f18d9b11f2221298d6617a"},(0,i.h)("arcgis-new-item-loader",{key:"f42edb9dfd66cca3f74cd7af3d138c6e3e48aa59",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,i.h)("arcgis-new-item-description",{key:"4dbf95c8e06d416169323b3af6eb981485f9baec",header:t.dataStoreConnection,content:t.databricks}),(0,i.h)("div",{key:"a39dcf592b3d926b37a5ec01631965b56bc541e0",class:"configure-form"},(0,i.h)("calcite-label",{key:"199d64eeb7f029ea279de6d79845e858596842fa"},t.server,(0,i.h)("calcite-input",{key:"c0ad1ef8ddd8e7a4ab3c4c794ef99a116460e756",placeholder:"server_name.com",value:c,onCalciteInputInput:e=>this.server=e.target.value.trim(),required:!0}),this.emptyRequiredFields.has("server")&&(0,i.h)("calcite-input-message",{key:"df1510725e9b6b8afca2100ba3faa4ddc55903a1",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noServer)),(0,i.h)("calcite-label",{key:"a0e5ce823caaa2cad1459a5799ad92cac37ce22c"},t.authenticationType,(0,i.h)("calcite-select",{key:"7e7d30b65c0f0a6594c7ac612aca25e5a32bca0e",value:a,label:t.authenticationType,onCalciteSelectChange:this.handleAuthenticationTypeChange},this.allowedAuthenticationTypes.map(e=>(0,i.h)("calcite-option",{value:e,key:e},t[e])))),"oAuthMachineToMachine"===a&&(0,i.h)("div",{key:"06e048aeb2fac73e771a6d58c411073bf336e315"},(0,i.h)("calcite-label",{key:"88677d7ade69c49abb05bcb159a9a43142c416cf"},t.clientId,(0,i.h)("calcite-input",{key:"6f2c5afc93a5ed078666eef1fde046953a3d24d9",value:r,onCalciteInputInput:e=>this.clientId=e.target.value.trim(),required:!0}),this.emptyRequiredFields.has("clientId")&&(0,i.h)("calcite-input-message",{key:"8f440a27d0b56ffedd91e6042a1431dca584aa2b",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noClientId)),(0,i.h)("calcite-label",{key:"398bae6977489f8f00a26e146877b46f47298771"},t.secret,(0,i.h)("calcite-input",{key:"83db42f0cbd03af78608eb67193316244911d486",type:"password",value:l,onCalciteInputInput:e=>this.secret=e.target.value.trim(),required:!0}),this.emptyRequiredFields.has("secret")&&(0,i.h)("calcite-input-message",{key:"987eae8d4b99ff45e71d1199c603cb7d4be5a55f",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noSecret))),"personalAccessToken"===a&&(0,i.h)("calcite-label",{key:"21fe3c734095ed1101b3c3cea89840566bfde5a7"},t.token,(0,i.h)("calcite-input",{key:"e3e2560be4685242a79f1fdcb79bf8949e74bccb",type:"password",value:d,onCalciteInputInput:e=>this.token=e.target.value.trim(),required:!0}),this.emptyRequiredFields.has("token")&&(0,i.h)("calcite-input-message",{key:"4e587547abe48031642bc5b0b4054ef3f962aeaa",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noToken)),(0,i.h)("calcite-label",{key:"234cec1bc21afb4198cf5f9a50db3738d23a6ebb"},t.httpPath,(0,i.h)("calcite-input",{key:"7ed45c8bf5f0bca99bd780f1e3e697127060af13",value:n,onCalciteInputInput:e=>this.httpPath=e.target.value.trim(),required:!0}),this.emptyRequiredFields.has("httpPath")&&(0,i.h)("calcite-input-message",{key:"2b374c81b92a2fc237cb81d9fb84eda05e353e52",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noHttpPath)),(0,i.h)("calcite-label",{key:"b5fc5854ce444c5026178d907b545c4b3ec4f432"},t.catalog,(0,i.h)("calcite-input",{key:"6d9892858bae8503fb641664e4961c732ae34f64",value:s,placeholder:null===(e=null===o.u||void 0===o.u?void 0:o.u.i18n)||void 0===e?void 0:e.singleLayerSelect.default,onCalciteInputInput:e=>this.catalog=e.target.value.trim(),required:!0}))),(0,i.h)("arcgis-new-item-alert",{key:"81faef4ff07647ded422e30e9621c2fc24703d8d",heading:null==h?void 0:h.title,description:null==h?void 0:h.description,details:null==h?void 0:h.details,detailsPopoverLabel:t.errorDetails,active:!!h,onAlertDismiss:()=>this.error=void 0}))}};d.style=".configure-form{margin-top:1.5rem}calcite-label{--calcite-label-margin-bottom:1.25rem}"},47172:(e,t,a)=>{a.d(t,{f:()=>i});const i=(e,t)=>{let a;const i=null!=t?t:"";switch(e){case"amazon":a=`AmazonS3_${i}`;break;case"azure":a=`Microsoft_Azure_Storage_${i}`;break;case"bigquery":a=`BigQuery_${i}`;break;case"databricks":a=i?`Databricks_${i}`:"Databricks";break;case"snowflake":a=`Snowflake_${i}`}return a.replace(/ /g,"_").replace(/-/g,"_")}}}]);