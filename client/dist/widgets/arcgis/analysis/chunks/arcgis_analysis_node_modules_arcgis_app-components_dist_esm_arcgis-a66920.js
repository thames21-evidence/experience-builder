/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a66920.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a66920"],{38092:(e,i,a)=>{a.r(i),a.d(i,{arcgis_new_item_pages_append_match_fields:()=>c});var t=a(87849),n=a(3826),r=a(95878),l=a(69280),s=a(1536),o=a(48538),d=a(59317);a(37762),a(54077),a(1654),a(46904),a(93814),a(41473),a(10578),a(29599),a(83692),a(931),a(54251),a(15912),a(88878),a(72257),a(86562),a(15332),a(74695),a(24869),a(27137),a(76246),a(58573),a(60958),a(32478);const c=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,t.c)(this,"newItemPrevPage",7),this.workflowComplete=(0,t.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,t.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,t.c)(this,"newItemDisableCloseButtons",7),this.validatedFields=[],this.ITEMS_PER_PAGE=15,this.fields=void 0,this.i18n=void 0,this.fieldMatches=[],this.error=void 0,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.currentStart=1,this.filteredFields=[],this.searchTerm=""}handleNext(){const e=this.validateMatchings();e?this.error=e:(n.a.fieldMappings=this.fieldMatches,"add"!==this.appendSelection?this.newItemUpdatePage.emit("appendSelectUpdate"):this.handleAppend())}validateMatchings(){if(!this.fieldMatches.every(e=>e.source===this.noneString)){const e=this.fieldMatches.filter(e=>!e.disabled&&!e.nullable&&e.source===this.noneString),i=e.every(e=>e.defaultValue&&!e.isUniqueIndex);return e.length<=0||"update"===this.appendSelection||i&&"add"===this.appendSelection?null:{title:this.i18n.errors.nonNullableErrorTitle,description:this.i18n.errors.nonNullableErrorDescription}}return{title:this.errorLabel,description:this.i18n.errors.noMatchedFields}}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e;const{sourceDataLayer:i,existingItem:a,timezone:t,analyzeResults:c,type:u,fieldMappings:p,dataLayer:h,id:m,uidPair:g,addAppendSelectOption:y,attachmentsEnabled:f,insertAttachmentsEnabled:F,featureAttachmentOption:T}=n.a,b=()=>{var e;this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,l.h)(null!==(e=null==v?void 0:v.error)&&void 0!==e?e:{code:"unhandledError"},{appendErrorMessages:r.u.i18n.append.appendErrorMessages})};this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=r.u.i18n.append.appendLoadingMessages.appendCloseNotice;const v=await(0,o.a)({portal:null===d.c||void 0===d.c?void 0:d.c.portal,sourceDataLayer:i,existingItem:a,timezone:t,analyzeResults:c,type:u,fieldMappings:p,dataLayer:h,id:m,uidPair:g,addAppendSelectOption:y,attachmentsEnabled:f,insertAttachmentsEnabled:F,featureAttachmentOption:T}),{result:S}=v;if(S){try{await(0,s.d)(n.a.id,{permanentDelete:!0})}catch(e){b()}if("completed"===(null===(e=null==S?void 0:S.status)||void 0===e?void 0:e.toLowerCase())){const e=Object.assign({appendType:n.a.addAppendSelectOption,insertAttachmentsEnabled:n.a.insertAttachmentsEnabled},v);return void this.workflowComplete.emit(e)}b()}else b()}async handlePrev(e){var i;this.loading||"add"!==this.appendSelection||(null===(i=n.a.analyzeResults.publishParameters.layers)||void 0===i?void 0:i.length)>1||(e.preventDefault(),this.newItemPrevPage.emit())}handleFieldChange(e){const i=Object.assign({},e.detail);this.validateFieldMappings(this.validatedFields,i)}sortFields(){this.fieldMatches=this.fieldMatches.sort(function(e,i){const a=e.name.toLowerCase(),t=i.name.toLowerCase();return a<t?-1:a>t?1:0})}validateFieldMappings(e,i){if(i.initialMatch=i.source,i.source!==this.noneString){const a=e.filter(e=>e.source===i.source);if((null==a?void 0:a.length)>0){const i=a[0].idx;e[i].initialMatch=this.noneString,e[i].source=this.noneString}}if(e[i.idx]=i,this.validatedFields=e,this.fieldMatches=[...this.validatedFields],this.sortFields(),this.searchTerm.length>0){const{currentStart:e}=this;this.fetchFields(this.searchTerm),this.currentStart=e}}setNextText(){r.u.nextText="add"===this.appendSelection?"addAndComplete":"next"}componentWillLoad(){const{addAppendSelectOption:e,uidPair:i,sourceDataLayer:a,backupLayerFields:t}=n.a;this.i18n=r.u.i18n.appendMatchFields,this.errorLabel=r.u.i18n.error,this.noneString=`<${r.u.i18n.appendKeyValuePair.noneField}>`,this.appendSelection=e;const l=t,s="csv"===a.type?[a.layerInfo]:a.fields,o="upsert"===this.appendSelection||"update"===this.appendSelection;this.setNextText(),this.selectedKeyPair=i;let d="add"===this.appendSelection?0:1;s.forEach(e=>{"esriFieldTypeOID"===(null==e?void 0:e.type)||"esriFieldTypeGlobalID"===(null==e?void 0:e.type)||!e.editable||o&&e.name===this.selectedKeyPair.name||(this.fieldMatches.push(this.createFieldMapping(e,l,d)),this.validatedFields.push(this.createFieldMapping(e,l,d)),d++)}),"add"!==this.appendSelection&&(this.fieldMatches.unshift(this.selectedKeyPair),this.validatedFields.unshift(this.selectedKeyPair)),this.sortFields()}createFieldMapping(e,i,a){const t=n.a.dataLayer.addressFields?Object.values(n.a.dataLayer.addressFields):null;let r=this.noneString;const s=[{source:this.noneString,name:e.name,type:"None",idx:a}];return i.forEach(i=>{!(0,l.c)(e,i)||"add"!==this.appendSelection&&i.name===this.selectedKeyPair.source||(s.push({source:i.name,name:e.name,type:e.type,idx:a}),e.name.toLowerCase()!==i.name.toLowerCase()||e.type!==i.type&&!(null==t?void 0:t.find(e=>e===i.displayName||e===i.name))||"add"!==this.appendSelection&&i.name===this.selectedKeyPair.source||(r=i.name))}),{source:r,name:e.name,nullable:e.nullable,type:e.type,idx:a,isUniqueIndex:e.isUniqueIndex,defaultValue:e.defaultValue,initialMatch:r,possibleMatches:s}}fetchFields(e){this.searchTerm=e.toLowerCase();const i=this.fieldMatches.filter(e=>e.name.toLowerCase().includes(this.searchTerm,0));this.currentStart=1,this.filteredFields=i}render(){const{i18n:e,error:i,ITEMS_PER_PAGE:a,fieldMatches:l,currentStart:s,filteredFields:o,searchTerm:d}=this,{originalFileName:c,existingItem:u}=n.a;if(!u)return;const p={originalField:{header:e.originalField.header,moreInfo:e.originalField.moreInfo.replace("${featureLayerName}",u.title)},uploadedField:{header:e.uploadedField.header,moreInfo:e.uploadedField.moreInfo.replace("${uploadedFileName}",c)}},h=e.description.replace("${uploadedFileName}",c).replace("${featureLayerName}",u.title),m=d.length>0?o:l,g=m.length>0,y=m.length>a,f=null==m?void 0:m.slice(s-1,s+a-1);return(0,t.h)(t.H,{class:{"overflow-hidden":this.loading}},(0,t.h)("arcgis-new-item-loader",{type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,t.h)("div",{class:"header"}," ",e.header," "),(0,t.h)("div",{class:"description"},h),(0,t.h)("div",{class:"search-bar"},(0,t.h)("calcite-input",{icon:"search",class:"search-match-fields",placeholder:r.u.i18n.layerSearch.search,onCalciteInputInput:e=>{const i=e.target.value;this.fetchFields(i)}})),(0,t.h)("div",{class:"row",role:"row"},Object.keys(p).map(e=>{const{header:i,moreInfo:a}=p[e];return(0,t.h)("span",{class:"header-cell",role:"columnheader","aria-sort":"none"},i,(0,t.h)("arcgis-information",{class:"header-popover",label:a,placement:"top-start",paddedContent:!0},(0,t.h)("p",{class:"popover-content"},a)))})),g?(0,t.h)("div",{class:"fields-scroll-container",role:"table"},f.map(e=>(0,t.h)("arcgis-new-item-append-match-field",{key:e.source,field:e,role:"row",onFieldChange:this.handleFieldChange.bind(this)}))):(0,t.h)("calcite-input-message",{class:"no-fields",icon:!0,status:"valid"},this.i18n.errors.noFields),y&&(0,t.h)("div",{class:"pagination"},(0,t.h)("calcite-pagination",{scale:"m",class:"pagination-component",totalItems:m.length,pageSize:a,startItem:this.currentStart,onCalcitePaginationChange:e=>{this.currentStart=e.target.startItem}})),(0,t.h)("arcgis-new-item-alert",{heading:null==i?void 0:i.title,description:null==i?void 0:i.description,link:{href:null==i?void 0:i.link,title:null==i?void 0:i.linkText},active:!!i,onAlertDismiss:()=>this.error=null}))}get el(){return(0,t.a)(this)}};c.style=".fields-container{display:flex;height:100%;flex-direction:column;overflow-y:auto;overflow-x:hidden}.field-table{margin-bottom:1.5rem;display:flex;flex-direction:column;overflow:auto}.search-container{display:flex;width:100%}.field-search{margin-right:0.5rem;width:50%}.field-select{width:50%}.field-name-column{margin-right:0.5rem;width:50%}.match-field-name-column{width:50%}.fields-scroll-container{margin-bottom:0.75rem;display:flex;flex-direction:column;padding-bottom:0.75rem;border-bottom:0.125rem solid var(--calcite-color-foreground-3)}.header-row{display:flex;align-content:flex-start;justify-content:center;gap:0.25rem;padding:0.25rem;font-size:0.875rem;font-weight:500;color:var(--calcite-color-text-1)}.header-cell{display:flex;width:100%;font-size:1rem}.hide{display:none}.not-visible{visibility:hidden;height:0px}.cell{box-sizing:border-box;width:100%}.cell label{margin-top:0.75rem}.row{margin-bottom:0.75rem;display:flex;align-items:center;justify-content:space-between;gap:0.25rem;padding:0.25rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1);border-bottom:0.125rem solid var(--calcite-color-foreground-3)}.deselected{opacity:var(--calcite-ui-opacity-disabled)}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.label{--calcite-label-margin-bottom:0}.append-timezone{border-top:0.063rem solid var(--calcite-color-foreground-3)}.from-to-fields{display:flex;flex-direction:row}.description{margin-bottom:1rem;font-size:0.875rem;font-weight:300}.header{margin-bottom:0.5rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.no-fields{margin-bottom:1.5rem}.popover-icon{cursor:pointer;color:var(--calcite-color-text-3);margin-inline-start:0.75rem;margin-top:0.125rem}.popover-content{margin:0px;max-width:20rem;font-size:0.75rem;font-weight:400}.header-popover{margin-top:-0.313rem}.search-match-fields{margin-bottom:1rem}.pagination-component{display:flex;justify-content:center}"},48538:(e,i,a)=>{a.d(i,{a:()=>l});var t=a(83692),n=a(69280),r=a(74695);async function l(e){var i,a,l,s;const o=(0,n.g)(e),d=`${null===(i=e.existingItem)||void 0===i?void 0:i.url}/${e.sourceDataLayer.id}/append`;try{const i=await(0,t.r)(d,o,{},"post"),{status:a,recordCount:n,attachmentCount:l}=await(0,r.g)(e.id,{},null==i?void 0:i.statusUrl);return{result:{status:a,recordCount:n,attachmentCount:l}}}catch(e){let i="unhandledError";const t=(null===(s=null!==(l=null!==(a=e.description)&&void 0!==a?a:e.message)&&void 0!==l?l:e.errorMessage)||void 0===s?void 0:s.toLowerCase())||"";switch(!0){case t.includes("the create unique index statement terminated because a duplicate key was found for the object name"):i="invalidUniqueIdentifier";break;case t.includes("does not allow nulls"):i="cannotAddNullData";break;case t.includes("the value violates the maxlength limit of this column"):i="exceededMaxFieldLength";break;case t.includes("input string was not in a correct format"):i="invalidFieldType"}return console.error(e),{error:{code:i,message:JSON.stringify(e)}}}}},54077:(e,i,a)=>{a.d(i,{a:()=>c,b:()=>f,c:()=>s,d:()=>y,e:()=>o,f:()=>p,g:()=>u,i:()=>g});var t=a(4429),n=a(1654),r=a(3826),l=a(10578);const s={WORLD:"World",EU:"Europe",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barth\xe9lemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CD:"Congo, the Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"C\xf4te d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin (French part)",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, the former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PS:"Palestine, State of",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten (Dutch part)",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan, Province of China",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela, Bolivarian Republic of",VG:"Virgin Islands, British",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Republic of Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};function o(e,i){const{sourceCountry:a,locationType:t,analyzeResults:n,candidateFieldsType:l,coordinateFieldType:s,type:o,standardizedFieldNames:u,selectedFields:p}=r.a,h=c(),m=i?r.a.backupLayerFields:Object.values(p),g=Object.assign(Object.assign({locationType:t||"address",sourceCountry:a,candidateFieldsType:l},"coordinates"===t&&function(e,i){return e.reduce((e,a)=>{switch(a.locationType){case"latitude":e.latitudeFieldName=a.name,i||(e.coordinateFieldType="LatitudeAndLongitude");break;case"longitude":e.longitudeFieldName=a.name,i||(e.coordinateFieldType="LatitudeAndLongitude");break;case"mgrs":"MGRS"===i&&(e.coordinateFieldName=a.name,i||(e.coordinateFieldType="MGRS"));break;case"usng":"USNG"===i&&(e.coordinateFieldName=a.name,i||(e.coordinateFieldType="USNG"))}return e},{coordinateFieldType:i})}(m,s)),"address"===t&&{addressFields:d(m,e,u)});let y;return y=i||"Microsoft Excel"!==o?Object.assign(Object.assign({},n.publishParameters),g):Object.assign(Object.assign({},n.publishParameters),{layers:[Object.assign(Object.assign({},h),g)],hasStaticData:!0,maxRecordCount:2e3,layerInfo:{capabilities:"Query"}}),"coordinates"===t&&["USNG","MGRS"].includes(s)&&(delete y.latitudeFieldName,delete y.longitudeFieldName),y}function d(e,i,a){if("Single"===i){const i=Object.keys(a)[0]||"Address",t=e.find(({locationType:e})=>e===i||"address"===(null==e?void 0:e.toLowerCase()));return{[i]:(null==t?void 0:t.name)||""}}return e.reduce((e,i)=>("unknown"!==i.locationType&&(e[i.locationType]=i.name),e),{})}function c(e,i){var a,t,n,l,s,o,d;const{type:c,analyzeResults:u=e,selectedSheet:p}=r.a,h=null==u?void 0:u.publishParameters;if(i)return"CSV"===c?null==h?void 0:h.layerInfo:null!==(t=null===(a=null==h?void 0:h.layers)||void 0===a?void 0:a[p])&&void 0!==t?t:null===(n=null==h?void 0:h.layers)||void 0===n?void 0:n[0];switch(c){case"Microsoft Excel":return null!==(s=null===(l=null==h?void 0:h.layers)||void 0===l?void 0:l[p])&&void 0!==s?s:null===(o=null==h?void 0:h.layers)||void 0===o?void 0:o[0];case"GeoJson":return null===(d=null==h?void 0:h.layers)||void 0===d?void 0:d[0];default:return null==h?void 0:h.layerInfo}}function u(e){switch(e){case"esriFieldTypeBigInteger":return["esriFieldTypeBigInteger","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSmallInteger":return["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeInteger":return["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeSingle":return["esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDouble":return["esriFieldTypeDouble","esriFieldTypeString"];case"esriFieldTypeDate":return["esriFieldTypeDate","esriFieldTypeString"];case"esriFieldTypeDateOnly":return["esriFieldTypeDateOnly","esriFieldTypeString"];case"esriFieldTypeTimeOnly":return["esriFieldTypeTimeOnly","esriFieldTypeString"];case"esriFieldTypeTimestampOffset":return["esriFieldTypeTimestampOffset","esriFieldTypeString"];case"esriFieldTypeOID":return["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeString"];default:return["esriFieldTypeString"]}}function p(e,i){const a=null==i?void 0:i.filter(i=>i.url===e);return(null==a?void 0:a.length)?a.shift():null}function h(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com.*\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi))}function m(e=""){return!!(null==e?void 0:e.match(/(arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi))}function g(e){return!!e&&(m(e)||h(e))}function y(e,i,a){let t=a||e||i||"";return t="wo"===(null==t?void 0:t.toLowerCase())?"world":t,s[t.toUpperCase()]||(t="world"),t}function f(e,i,a){var r;let s=(0,l.m)(i)&&(0,l.o)(i);const o=function(e,i,a){return e.filter(e=>{const n=Object.assign({},e),r=m(null==n?void 0:n.url),l=h(null==n?void 0:n.url);return(r||l)&&((0,t.c)(n.name)?"Esri World Geocoder"!==n.name&&"ArcGIS Geocoding service"!==n.name||(n.name="ArcGIS Geocoding Service"):n.name="ArcGIS World Geocoding Service"),(!r||!a&&!i)&&((0,t.c)(n.batch)?!!n.batch:r||l)})}(e,!s,a),d=null===(r=o[0])||void 0===r?void 0:r.url;if(null==o?void 0:o.length){s=!0;const e=p(o[0].url,o),t=m(null==e?void 0:e.url),r=h(null==e?void 0:e.url),l=t||r;let c=l||!!e.batch;return{allowGeocode:(!(0,n.g)(i)||s)&&(!a&&c||a&&(!t||r)&&c),isAgoWorldGeocodeServer:t,isServiceProxyAgoWorldGeocodeServer:r,isWorldGeocodeServer:l,geocodeServers:o,geocodeServiceUrl:d}}return null}},69280:(e,i,a)=>{a.d(i,{a:()=>c,c:()=>o,g:()=>d,h:()=>u});var t=a(3826),n=a(54077),r=a(15912),l=a(95878),s=function(e,i){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(e);n<t.length;n++)i.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(a[t[n]]=e[t[n]])}return a};function o(e,i){var a;const t=(null==e?void 0:e.type)||null,n=(null==i?void 0:i.type)||null;return n&&(n===t||(null===(a={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[t])||void 0===a?void 0:a.includes(n)))}function d(e){var i;const{timezone:a,analyzeResults:o,type:d,fieldMappings:c,dataLayer:u,id:p,portal:h,uidPair:m,addAppendSelectOption:g,sourceDataLayer:y,attachmentsEnabled:f,insertAttachmentsEnabled:F,featureAttachmentOption:T}=e;let b,v;const{publishParameters:S}=o,I=s(o,["publishParameters"]),M="upsert"===g||"update"===g,w=function(e){const i=e.filter(e=>e.source!==`<${l.u.i18n.appendKeyValuePair.noneField}>`),a=i.map(({source:e,name:i})=>({source:e,name:i}));return a}(c),A=function(e){const i=e.map(e=>e.name);return i}(w),O={dateFieldsTimeReference:Object.assign(Object.assign({},(null==h?void 0:h.isPortal)?{timeZone:a||"UTC"}:{ianaTimeZone:a||"GMT"}),{respectsDaylightSaving:!0})},C={sourceTableName:u.name,fieldMappings:(null==w?void 0:w.length)?JSON.stringify(w):null,upsert:M,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:M&&"esriFieldTypeGlobalID"===(null==m?void 0:m.type),updateGeometry:!M||"attributeAndGeometry"===t.a.addAppendSelectUpdateTypeOption,appendFields:A.length?JSON.stringify(A):null,appendItemId:p,appendUploadFormat:r.a[t.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===y.type&&(S.locationType="none");const G=s(S,["layers"]);if("CSV"===d)S.layerInfo.dateFieldsTimeReference=O.dateFieldsTimeReference,v=Object.assign(Object.assign(Object.assign({},O),S),I);else if("Microsoft Excel"===d){const e=function(e,i){const a=Object.assign({},e);a.locationType=(null==i?void 0:i.locationType)||e.locationType,"address"===a.locationType?(a.addressFields=i.addressFields,a.sourceCountry=i.sourceCountry):"coordinates"===a.locationType&&(a.coordinateFieldType=i.coordinateFieldType,"LatitudeAndLongitude"===a.coordinateFieldType?(a.latitudeFieldName=i.latitudeFieldName,a.longitudeFieldName=i.longitudeFieldName):a.coordinateFieldName=i.coordinateFieldName);return a}((0,n.a)({},!0),G);e.dateFieldsTimeReference=O.dateFieldsTimeReference,G.name=u.name,v=Object.assign(Object.assign(Object.assign(Object.assign({},O),{layers:[e]}),G),I)}else v=Object.assign(Object.assign(Object.assign({},O),S),I);return b=Object.assign(Object.assign(Object.assign({},C),{appendSourceInfo:JSON.stringify(v)}),f&&function({insertAttachmentsEnabled:e}){return e?{skipAttachmentInserts:!1,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}:{skipAttachmentInserts:!0,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}}({appendType:g,insertAttachmentsEnabled:F,featureAttachmentOption:T})),"add"===g?b.upsertMatchingField=y.objectIdField||(null===(i=y.uniqueField)||void 0===i?void 0:i.name):M&&(null==m?void 0:m.isUniqueIndex)&&(b.upsertMatchingField=null==m?void 0:m.name),b}function c(e,i,a){return"File Geodatabase"===e&&a.hasAttachments&&i.hasAttachments}function u(e,i){const a=i.appendErrorMessages;let t=l.u.i18n.error,n=a.appendError;switch(e.code){case"invalidUniqueIdentifier":t=a.invalidUniqueIdentifier.title,n=a.invalidUniqueIdentifier.description;break;case"cannotAddNullData":t=a.cannotAddNullData.title,n=a.cannotAddNullData.description;break;case"exceededMaxFieldLength":t=a.exceededMaxFieldLength.title,n=a.exceededMaxFieldLength.description;break;case"invalidFieldType":t=a.invalidFieldType.title,n=a.invalidFieldType.description}return{title:t,description:n}}}}]);