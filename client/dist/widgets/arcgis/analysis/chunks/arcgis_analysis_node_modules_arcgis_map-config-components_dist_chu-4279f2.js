/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-4279f2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_chu-4279f2"],{5589:(e,t,s)=>{s.d(t,{a:()=>n,b:()=>r,g:()=>l,s:()=>c});var i=s(5294),o=(s(52797),s(54312),s(44345),s(55448),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(66228)),a=(s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(1225));s(83552),s(77462),s(49403),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(6238),s(7299);function r(e){const{mapView:t}=e,s=(0,a.g)(e),i=s.authoringInfo,r="class-breaks"===s.type?s.classBreakInfos:s.uniqueValueInfos,n=(0,a.c)(s,"size"),l=(0,a.p)(s,"reference-size"),d=(0,a.p)(s,"spike"),h=!!n&&!(0,o.i)(n.minSize),p=!!n&&"number"==typeof n.minSize,m="above-and-below"===i?.univariateTheme;let u=2,g=20;if(l)l.referenceSizeScale&&c(e),[u,g]=[l.sizeStops[0].size,l.sizeStops[1].size];else if(d)[u,g]=[d.sizeStops[0].size,d.sizeStops[1].size];else if(n)if(m){const e=n.stops;[u,g]=[e[2].size,Math.max(e[0].size,e[4].size)]}else if(h){const e=n.stops;[u,g]=[e[0].size,e[e.length-1].size]}else if(p)[u,g]=[n.minSize,n.maxSize];else{const e=t.scale,s=n.minSize.stops,i=n.maxSize.stops;[u,g]=[s[s.length-1].size,i[i.length-1].size];for(let t=0;t<s.length;t++){const o=s[t],a=i[t];if(e<=o.value){if(t>0){const r=s[t-1],n=i[t-1],l=(e-r.value)/(o.value-r.value);[u,g]=[r.size+(o.size-r.size)*l,n.size+(a.size-n.size)*l]}else[u,g]=[s[0].size,i[0].size];break}}}else if(r){const e=r[0].symbol,t=r[r.length-1].symbol;[u,g]=[(0,a.w)(e),(0,a.w)(t)],u>g&&([u,g]=[g,u])}return[u,g]}function n(e,t){const{mapView:s}=e,n=(0,a.g)(e),l=(0,a.c)(n,"size");let c=t[0],d=(0,o.i)(t[1])?t[1]:c;if(l){const a="above-and-below"===n.authoringInfo?.univariateTheme,h=!!l&&!(0,o.i)(l.minSize),p=!!l&&"number"==typeof l.minSize,[m,u]=r(e),g=m>u;if(!g&&c>=u?c=u-.75:g&&c>=m&&(c=m-.75),!g&&m>=d?d=m+.75:g&&u>=d&&(d=u+.75),a){const e=l.stops,s=g?t[1]:t[0],i=g?t[0]:t[1],o=Math.max(...e.map(e=>e.value)),a=e[2].value,r=Math.min(...e.map(e=>e.value)),n=Math.abs(o-a),c=Math.abs(r-a),d=n>c?n:c,h=i-s;e.forEach(e=>{const{value:t}=e;e.size=Math.abs(t-a)/d*h+s})}else if(h){const e=l.stops;l.stops=null,l.minSize=c,l.maxSize=d,l.minDataValue=e[0].value,l.maxDataValue=e[e.length-1].value}else if(p)g?(l.maxSize=c,l.minSize=d):(l.minSize=c,l.maxSize=d);else{const e=s.scale;let t=i.clone(l.minSize.stops),o=i.clone(l.maxSize.stops);g&&([t,o]=[o,t]);let a=c/t[t.length-1].size,r=d/o[o.length-1].size;for(let s=0;s<t.length;s++){const i=t[s],n=o[s];if(e<=i.value){if(s>0){const l=t[s-1],h=o[s-1],p=(e-l.value)/(i.value-l.value),[m,u]=[l.size+(i.size-l.size)*p,h.size+(n.size-h.size)*p];a=c/m,r=d/u}else a=c/t[0].size,r=d/o[0].size;break}}t.forEach(e=>e.size=Math.round(a*e.size*10)/10),o.forEach(e=>e.size=Math.round(r*e.size*10)/10),g&&([t,o]=[o,t]),l.minSize.stops=t,l.maxSize.stops=o}}else{const e=n.classBreakInfos[0].symbol,t=n.classBreakInfos[n.classBreakInfos.length-1].symbol;let s=(0,a.w)(e),i=(0,a.w)(t),o=!1;s>i&&([s,i]=[i,s],o=!0),s!==i&&c>i&&(c=i-.75),s=c,s!==i&&s>d&&(d=s+.75),i=d;const r=i-s,l=1===n.classBreakInfos.length?1:r/(n.classBreakInfos.length-1);n.classBreakInfos.forEach((e,t)=>{const r=e.symbol;o?(0,a.u)(r,i-l*t):(0,a.u)(r,s+l*t)})}}function l(e,t){const s=e.stops,i=s.length-1,o=s[0].value,a=s[i].value;if(t<=o)return s[0].size;if(t>=a)return s[i].size;for(let e=0;e<=i;e++){const i=s[e],o=s[e+1];if(t>=i.value&&t<o.value){const e=o.value-i.value,s=i.size-o.size,a=(t-i.value)/e,r=i.size-s*a;return Math.round(100*r)/100}}return 1}function c(e){const{mapView:t}=e,s=(0,a.g)(e),i=(0,a.p)(s,"reference-size"),o=i.referenceSizeScale/t.scale;i.sizeStops.forEach(e=>e.size*=o),i.referenceSizeScale=t.scale}},46317:(e,t,s)=>{s.d(t,{D:()=>r});var i=s(85282),o=s(34670),a=s(42466);const r=(0,o.u$)(class extends o.WL{constructor(){super(...arguments),this.key=i.s6}render(e,t){return this.key=e,t}update(e,[t,s]){return t!==this.key&&((0,a.mY)(e),this.key=t),s}})},60300:(e,t,s)=>{function i(e){return e?e/72*96:0}function o(e){return e?72*e/96:0}s.d(t,{a:()=>o,p:()=>i})},95940:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigSmartMappingSymbolButton:()=>y});var i=s(73679),o=s(4395),a=s(46317),r=s(56451),n=s(41631),l=s(1225),c=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(5294),s(66228)),d=s(44263),h=s(65595),p=s(96333),m=(s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(91914),s(31521),s(86605),s(68196),s(440),s(46547),s(6238),s(7299),s(60300)),u=s(85643),g=s(73801);const b=o.AH`.half{width:49%}.symbol-selector{height:24px;min-height:24px;max-height:24px;display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0 0 0 1px inset;&:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}&:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}&:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}&.selected{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}}.symbol-icon{max-height:30px;overflow:hidden}.symbol-icon.transparent{height:15px;width:100%}.symbol-icon.transparent svg{height:15px;width:95%;stroke:#e0e0e0;stroke-width:1px}.symbol-is-white{background-color:#f3f3f3}.symbol-edit-button{padding:1px;height:18px;width:18px;border:none;cursor:pointer;color:var(--calcite-icon-color);&:focus{outline:none}}.classed-color-icon{width:100%;height:16px;overflow:hidden;border-radius:0}.classed-color-icon-section{height:16px;display:inline-block}`;class y extends g.WF{constructor(){super(...arguments),this.buttonNode=(0,u._)(),this.resizeObserver=new ResizeObserver(e=>{const t=e.pop();this.symbolNodeWidth=t?.contentRect.width}),this.smartMappingState=(0,h.u)(),this.selected=!1,this.hideLabel=!1,this.isReferenceSize=!1,this.arcgisSmartMappingSymbolButtonSymbolChange=(0,g.lh)()}static{this.properties={selected:16,symbolNodeWidth:16,type:1,rampType:1,label:1,hideLabel:5,symbol:0,colors:0,width:1,isReferenceSize:5,popoverReferenceElement:1}}static{this.styles=b}async setFocus(){this.buttonNode.value?.focus()}loaded(){if(this.internalPopoverReferenceElement=this.popoverReferenceElement,!this.internalPopoverReferenceElement){const e=(0,c.q)(this.el,"calcite-panel"),t=(0,c.q)(this.el,"calcite-flow-item");this.internalPopoverReferenceElement=t||e}this.requestUpdate(),this.resizeObserver.observe(this.buttonNode.value)}disconnectedCallback(){super.disconnectedCallback(),this.onPopoverClose(),this.resizeObserver?.disconnect()}symbolDivRefHandler(e){const{symbol:t,colors:s}=this;e&&queueMicrotask(()=>{setTimeout(()=>{const{isReferenceSize:i}=this,o=this.buttonNode.value,a=o?o.getBoundingClientRect().width:0;if(o&&!a)return;if(s){const t=n.renderColorRampPreviewHTML(s,{align:"horizontal",width:a?a-40:150,height:16});e.replaceChildren(t)}else if(t){const s=a?Math.round((0,m.a)(a-40)):110,o="simple-line"===t.type||"cim"===t.type&&t.data.symbol&&"CIMLineSymbol"===t.data.symbol.type,r="simple-fill"===t.type||"cim"===t.type&&t.data.symbol&&"CIMPolygonSymbol"===t.data.symbol.type,l="cim"===t.type&&!o&&!r,c=o?{width:s,height:"simple-line"===t.type?3:6}:r?{width:i?18:s,height:i?18:12}:l?16:14;n.renderPreviewHTML(t,{size:c,symbolConfig:r?{isSquareFill:!0}:void 0}).then(t=>{e.style.height=r?i?"24px":"16px":l?"21px":"auto",e.replaceChildren(t)})}},300)})}async handleClick(){const{internalPopoverReferenceElement:e,label:t,popoverNode:s,buttonNode:{value:i},smartMappingState:a}=this,{_messages:r}=this.smartMappingState;if(s)this.onPopoverClose();else{(0,l.f)(),this.selected=!0,this.popoverNode=(0,g.dN)(o.qy`<arcgis-map-config-smart-mapping-symbol-styler-popover .referenceElement=${"string"==typeof e?document.getElementById(e)||void 0:e} .heading=${t||r.styler.symbolStyle} .smartMappingState=${a} @arcgisSmartMappingSymbolStylerPopoverClose=${()=>{this.onPopoverClose(),setTimeout(()=>i?.focus(),300)}} @arcgisSmartMappingSymbolStylerPopoverDisconnected=${()=>this.onPopoverClose()}></arcgis-map-config-smart-mapping-symbol-styler-popover>`),document.body.appendChild(this.popoverNode);const s=this.getOnClickCall();this.symbolStylerWatchScaleHandle=await s(a,{symbolStylerPopoverNode:this.popoverNode,onChange:()=>{(0,l.l)(a)?(0,l.ag)(a):(0,l.a4)(a),this.arcgisSmartMappingSymbolButtonSymbolChange.emit()}})}}getOnClickCall(){const{type:e}=this;switch(e){case"background":return p.t;case"simple":return p.s;case"size":return p.r;case"color-ramp":return p.q;case"relationship-ramp":return p.p;case"geo-rss-point":return p.o.bind(this,"point");case"geo-rss-line":return p.o.bind(this,"line");case"geo-rss-polygon":return p.o.bind(this,"polygon");case"dot-density-ramp":return p.n;case"dot-density-background":return p.m;case"dot-density-value":return p.d;case"heatmap-ramp":return p.l;case"predominance-ramp":return p.k;case"above":return p.j;case"below":return p.i;case"chart-ramp":return p.h;case"type-ramp":return p.g;case"raster-flow":return d.h;case"raster-stretch":return d.g;case"raster-shaded-relief":return d.f;case"raster-class-breaks":return d.e;case"raster-unique-value":return d.d;default:return p.f}}onPopoverClose(){this.symbolStylerWatchScaleHandle?.remove(),this.selected=!1,this.popoverNode?.remove(),this.popoverNode=void 0}render(){const{label:e,width:t,hideLabel:s,smartMappingState:i}=this,{_messages:a}=i;return o.qy`<div class=${"block-content-padding "+("half"===t?"half":"")}>${!s&&o.qy`<calcite-label id=symbol-button-label>${e||a.styler.symbolStyle}${this.renderSymbolButton()}</calcite-label>`||""}${s&&this.renderSymbolButton()||""}</div>`}renderSymbolButton(){const{rampType:e,symbol:t,colors:s,selected:i,smartMappingState:n}=this;"raster-class-breaks"===((0,l.l)(n)?(0,l.U)(n):(0,l.d)(n))&&s?.forEach((e,t)=>{0===e.r&&0===e.g&&0===e.b&&0===e.a&&(s[t]=new r.default([255,255,255,0]))});const c="discrete"===e&&s?.length?s.map(e=>o.qy`<div class="classed-color-icon-section" style=${(0,g.zl)({width:95/("type-ramp"===this.type?s.length:Math.min(10,s.length))+"%",backgroundColor:e?.toHex()??"#ffffff"})}></div>`):null,d=!e&&(0,l.at)(t),h=(0,l.j)(n)||"point",p={"symbol-selector":!0,"symbol-is-white":(0,l.ad)(t),selected:i};return o.qy`<div class=${(0,g.CP)(p)} @click=${this.handleClick} role=button tabindex=0 aria-labelledby=symbol-button-label aria-haspopup=true .ariaExpanded=${i} @keydown=${e=>{(" "===e.key||"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),this.handleClick())}} ${(0,u.K)(this.buttonNode)}>${d?this.renderTransparentSymbol():"discrete"===e?o.qy`<div class="classed-color-icon" aria-hidden=true>${c}</div>`:(0,a.D)(JSON.stringify(t?.toJSON())+JSON.stringify(s?.map(e=>e.toJSON())),o.qy`<div class=${`symbol-icon ${h}`} style=${(0,g.zl)(this.symbolNodeWidth?{width:.95*this.symbolNodeWidth+"px"}:void 0)} aria-hidden=true ${(0,u.K)(this.symbolDivRefHandler)}></div>`)}<div class="symbol-edit-button"><calcite-icon scale=s icon=pencil></calcite-icon></div></div>`}renderTransparentSymbol(){return o.qy`<div class="symbol-icon transparent" aria-hidden=true style=${(0,g.zl)(this.symbolNodeWidth?{width:.95*this.symbolNodeWidth+"px"}:void 0)}><svg xmlns=http://www.w3.org/2000/svg>${o.JW`<defs><pattern id=16cf9653474-widget-3-bg-fill patternUnits=userSpaceOnUse x=0 y=0 width=15 height=15><image x=0 y=0 width=15 height=15 href=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2Ij48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNjY2MiIC8+PHBhdGggZD0iTTAgMCBMOCAwIEw4IDggTDAgOCBaIiBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDgpIiAvPjxwYXRoIGQ9Ik0wIDAgTDggMCBMOCA4IEwwIDggWiIgZmlsbD0iI2NjYyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCw4KSIgLz48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNmZmYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgsMCkiIC8+PC9zdmc+ /></pattern></defs><rect x=0 y=0 fill=url(#16cf9653474-widget-3-bg-fill) height=100% width=100% /><rect x=0 y=0 fill=url(#16cf9653474-widget-3-ramp-fill) height=100% width=100% />`}</svg></div>`}}(0,i.c)("arcgis-map-config-smart-mapping-symbol-button",y)}}]);