/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f228b6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f228b6"],{16087:(e,r,t)=>{t.r(r),t.d(r,{arcgis_new_item_pages_service_definition_location:()=>v});var i=t(87849),s=t(29599),o=t(59317),a=t(4429),n=t(51632),l=t(3826),c=t(95878),d=t(38409);t(83692),t(931),t(93814),t(41473),t(54251),t(37762),t(74695),t(88878),t(46904),t(24869),t(15912),t(72257),t(86562),t(15332),t(27137),t(76246),t(58573),t(1536),t(60958),t(32478),t(98704),t(82149),t(54077),t(1654),t(10578),t(8417),t(50315),t(26262);const v=class{constructor(e){var r,t;(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.newItemSetButtonState=(0,i.c)(this,"newItemSetButtonState",7),this.newItemPrevPage=(0,i.c)(this,"newItemPrevPage",7),this.serverInfos=null===(r=l.a.serviceDefinitonProperties)||void 0===r?void 0:r.serverInfos,this.serviceInfo=null===(t=l.a.serviceDefinitonProperties)||void 0===t?void 0:t.serviceInfo,this.i18n=void 0,this.i18nTypes=void 0,this.serverFolders=void 0,this.showCreateNewFolder=!1,this.newFolderInput="",this.showError=!1,this.selectedServerFolder="",this.selectedFederatedServer=void 0,this.errorString="",this.portalFolder=void 0,this.newServerFolderInputElement=void 0,this.serviceName=this.serviceInfo.service.serviceName||"",this.showSameServiceError=!1,this.federatedServers=[]}closeNewFolderInput(e){e.stopPropagation(),this.showCreateNewFolder=!1,this.showError=!1,this.selectedServerFolder=""}setNewFolderActive(){var e;null===(e=this.newServerFolderInputElement)||void 0===e||e.setFocus(),this.newServerFolderInputElement||(this.showError=!1,this.newFolderInput="")}handleNext(){var e;l.a.portalFolder=this.portalFolder,l.a.serverFolder=this.selectedServerFolder||"/",l.a.server=this.selectedFederatedServer,l.a.serviceName=this.serviceName,l.a.fileName=this.serviceName,l.a.hostingServer=this.hostingServer,l.a.selectedServerUrl=null===(e=this.federatedServers.find(e=>e.id===this.selectedFederatedServer))||void 0===e?void 0:e.url,this.validate()&&this.newItemUpdatePage.emit("serviceDefinitionConfiguration")}async handlePrev(e){e.preventDefault(),await(0,d.d)(),this.newItemPrevPage.emit()}async handleFederatedServerChange(){this.selectedFederatedServer&&this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!1}})}async componentWillLoad(){var e;this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!0}}),this.federatedServers=await(0,s.b)(o.c.user,o.c.portal),this.hostingServer=this.federatedServers.find(e=>"HOSTING_SERVER"===e.serverRole),this.selectedFederatedServer=null===(e=this.hostingServer)||void 0===e?void 0:e.id,this.i18n=c.u.i18n.serviceDefinitionStrings,this.i18nTypes=c.u.i18n.serverSelection.types,this.appendServerTypes(),await this.setUpServerFolders(),this.populateFields()}validate(){const e=this.serverInfos.find(e=>e.serverId===this.selectedFederatedServer),r=!(null==e?void 0:e.isServiceNameAvailable),t=this.serviceInfo.service.serviceName===this.serviceName,i=this.serviceInfo.folderName===(this.selectedServerFolder||"");return!(r&&t&&i)||(this.showSameServiceError=!0,!1)}populateFields(){const{portalFolder:e,serverFolder:r,server:t,serviceName:i}=l.a;this.portalFolder=e||this.portalFolder,this.selectedServerFolder=r||this.selectedServerFolder,this.selectedFederatedServer=t||this.selectedFederatedServer,this.serviceName=i||this.serviceName}async setUpServerFolders(){var e,r,t,i;const s=await(0,n.c)(`${null===(e=this.hostingServer)||void 0===e?void 0:e.url}/admin/services`);this.serverFolders=(null===(r=null==s?void 0:s.result)||void 0===r?void 0:r.folders)||[];const o=null===(i=null===(t=l.a.serviceDefinitonProperties)||void 0===t?void 0:t.serviceInfo)||void 0===i?void 0:i.folderName;""!==o&&(this.serverFolders.includes(o)||(this.serverFolders=[...this.serverFolders,o]),this.selectedServerFolder=o)}appendServerTypes(){const{notebookServerSetting:e,geoAnalyticsServerSetting:r,rasterAnalysisSetting:t,imageHostingSetting:i,missionServerSetting:s}=this.i18nTypes;this.serverInfos=this.serverInfos.map(o=>{var a;const n=this.federatedServers.find(e=>e.id===o.serverId),l=(null===(a=null==n?void 0:n.serverFunction)||void 0===a?void 0:a.replace(/\s+/g,"").split(","))||[],c=[];"HOSTING_SERVER"===(null==n?void 0:n.serverRole)&&c.push(this.i18nTypes.hostedSetting);const d={NotebookServer:e,GeoAnalytics:r,RasterAnalytics:t,ImageHosting:i,MissionServer:s};return l.forEach(e=>{d[e]&&c.push(d[e])}),Object.assign(Object.assign({},o),{serverType:c.join(", "),url:null==n?void 0:n.url})})}returnServerComboBoxItems(){return this.serverInfos.sort((e,r)=>"Hosting Server"===e.serverType&&"Hosting Server"!==r.serverType?-1:"Hosting Server"!==e.serverType&&"Hosting Server"===r.serverType?1:0).map(e=>{const{serverType:r,serverId:t,canCreateService:s,canCreateReason:o}=e,a=(0,i.h)("calcite-combobox-item",{value:t,heading:`${e.url}${r?` (${r})`:""}`,key:t,selected:t===this.selectedFederatedServer,disabled:!s});return!s&&o?(0,i.h)("div",{class:"server-combobox-item-container"},a,(0,i.h)("arcgis-information",{label:o,placement:"right-end",paddedContent:!0},o)):a})}async createNewFolderAction(){var e,r;const t=await(0,n.d)(`${null===(e=this.hostingServer)||void 0===e?void 0:e.url}/admin/services/createFolder`,this.newFolderInput),{error:i}=t;if(i)throw this.showError=!0,this.errorString=i.message,null===(r=this.newServerFolderInputElement)||void 0===r||r.setFocus(),new Error;this.serverFolders=[...this.serverFolders,this.newFolderInput],this.showCreateNewFolder=!1,this.selectedServerFolder=this.newFolderInput,this.newFolderInput=""}createNewFolder(){const{i18n:e}=this;return(0,i.h)("div",null,(0,i.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{await this.createNewFolderAction()}},(0,i.h)("calcite-label",{slot:"label",for:"serverFolderNameInput"},e.enterFolderName),(0,i.h)("calcite-input",{id:"serverFolderNameInput",placeholder:e.enterFolderName,value:this.newFolderInput,maxLength:250,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:async e=>{switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":await this.createNewFolderAction();break;case"Escape":this.showCreateNewFolder=!1,this.showError=!1,this.selectedServerFolder=""}},ref:e=>this.newServerFolderInputElement=e,status:this.showError?"invalid":"idle"})),this.renderError())}async showCreateNewFolderAction(){var e;this.showCreateNewFolder=!0,await(0,a.t)(100),null===(e=this.newServerFolderInputElement)||void 0===e||e.setFocus()}selectFolderComboBox(){const{i18n:e}=this,{selectOrCreateFolder:r,createNewFolder:t,siteRoot:s}=e,o=this.serverFolders.filter(e=>!["Utilities","System","Hosted"].includes(e));return(0,i.h)("calcite-combobox",{placeholder:r,label:r,selectionMode:"single-persist",onCalciteComboboxChange:e=>this.selectedServerFolder=e.target.value,value:this.selectedServerFolder,"clear-disabled":!0},(0,i.h)("calcite-combobox-item",{value:"createNewFolder",heading:t,icon:"folder-plus",onCalciteComboboxItemChange:()=>this.showCreateNewFolderAction()}),(0,i.h)("calcite-combobox-item",{value:"/",heading:s,icon:"home",selected:""===this.selectedServerFolder||"/"===this.selectedServerFolder}),o.map(e=>(0,i.h)("calcite-combobox-item",{value:e,heading:e,icon:"folder",key:e,"data-id":e,selected:e===this.selectedServerFolder})))}renderError(){return(0,i.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError},this.errorString)}render(){var e,r,t;const{i18n:s}=this,{helpMap:a,helpBase:n}=o.c.config,{name:d,portalFolder:v,selectHostingServer:h,specifyProperties:u,sameServiceError:p,specifyLocation:f,type:m,serviceDefinitionTitle:S,learnMoreAboutServiceDefinition:b}=s,g=null===(t=null===(r=null===(e=null===l.a||void 0===l.a?void 0:l.a.serviceDefinitonProperties)||void 0===e?void 0:e.serviceInfo)||void 0===r?void 0:r.service)||void 0===t?void 0:t.type;return(0,i.h)("div",{key:"5c4ea536facceed4652295f4eff914e04e5df067"},(0,i.h)("div",{key:"ec26e526ce91bad33007c335bc1fe35875b62ea0",class:"specifyProperty-label"},u),(0,i.h)("calcite-label",{key:"4b58fe492977ee81dceb617802f27bc55b973809"},d,(0,i.h)("calcite-input-text",{key:"0f7a9f3c2f138c5c123bf0f0eeaea797a19fa187",value:this.serviceName,onCalciteInputTextChange:e=>this.serviceName=e.target.value})),(0,i.h)("calcite-label",{key:"f2a3fb7b3dfc42f92ca445ad20322bff6571a1fc"},m,(0,i.h)("calcite-input-text",{key:"60152df60bc3f1b6a7840e4965bb73da10453b44",readOnly:!0,value:"GeoDataServer"===g?"GeoData Server":S[g]})),(0,i.h)("calcite-label",{key:"f00b8cbefa061bbc5594da49773c1621166beda8",class:"location-label"},(0,i.h)("div",{key:"f3a0bf705ef96e302e7916b753787c3912dfb892",class:"description-text"},f),(0,i.h)("div",{key:"0208127d405076daa8f5a60854802fcffd3a9fa4",class:"location-div"},(0,i.h)("arcgis-folder-picker",{key:"cf135c27472e18078651ec0087a6652f1a40bd6e",label:v,onArcgisFolderPickerChange:e=>this.portalFolder=e.detail,folder:this.portalFolder,ref:e=>this.portalFolderRef=e,onArcgisFolderPickerLoad:e=>{var r;const t=null===(r=l.a.serviceDefinitonProperties)||void 0===r?void 0:r.portalFolder;t&&(this.portalFolder=e.detail.find(e=>e.title===t)||this.portalFolder,this.portalFolderRef.folder=this.portalFolder)}}),(0,i.h)("calcite-label",{key:"fcae64e7001c9662884b4a6c5d7b3ec0117117d3"},s.serverAndFolder,(0,i.h)("calcite-combobox",{key:"ce5fc0086aa95ac787d7f0661e073819b67d309b",placeholder:h,label:h,placeholderIcon:"server",selectionMode:"single","clear-disabled":!0,onCalciteComboboxChange:e=>this.selectedFederatedServer=e.target.value},this.returnServerComboBoxItems())),(0,i.h)("calcite-label",{key:"e2a40ff854c7199c3cd1b042fcb03178c8b178ce"},this.showCreateNewFolder?this.createNewFolder():this.selectFolderComboBox()))),(0,i.h)("calcite-link",{key:"39fc66b844478aaae45657e88642617f3d78e707",href:`${n}${a[120005523]}`,"aria-label":b,target:"_blank"},c.u.i18n.common.learnMore),(0,i.h)("arcgis-new-item-alert",{key:"4f20a0d25478f4c89a265ed60b84c01889fd7f2b",description:p,active:this.showSameServiceError,onAlertDismiss:()=>this.showSameServiceError=!1}))}get el(){return(0,i.a)(this)}static get watchers(){return{newServerFolderInputElement:["setNewFolderActive"],selectedFederatedServer:["handleFederatedServerChange"]}}};v.style=".location-div{border-width:1px;border-style:solid;border-color:var(--calcite-color-border-1);padding:1rem}.location-label{margin-top:1rem}.description-text{font-weight:700}.specifyProperty-label{margin-bottom:1rem;font-size:1rem;font-weight:700}.server-combobox-item-container{display:flex}"},38409:(e,r,t)=>{t.d(r,{d:()=>a,p:()=>o});var i=t(3826),s=t(1536);function o(e,r,t,i){var s,o;const a={},n=[],l=r.result.ExtensionTypes.filter(e=>{var r,s;return(null===(r=t[i])||void 0===r?void 0:r.includes(e.Name))||(null===(s=e.Info)||void 0===s?void 0:s.SupportsInterceptor)});l.forEach(r=>{var t;const{Info:i,Properties:s,DisplayName:o,Name:l}=r;if(e[l]&&!(null==i?void 0:i.SupportsInterceptor))e[l].displayName=o;else{const r={enabled:(null===(t=e[l])||void 0===t?void 0:t.enabled)||"false",typeName:l,capabilities:(null==i?void 0:i.DefaultWebCapabilities)||"",properties:Object.assign(Object.assign(Object.assign(Object.assign({},s),(null==i?void 0:i.SupportsREST)&&{SupportsREST:i.SupportsREST}),(null==i?void 0:i.SupportsSOAP)&&{SupportsSOAP:i.SupportsSOAP}),(null==i?void 0:i.SupportsInterceptor)&&{SupportsInterceptor:i.SupportsInterceptor}),displayName:o||""};"true"===(null==i?void 0:i.SupportsInterceptor)?(a[l]=r,n.push(l)):e[l]=r}});for(const r in e)"true"===(null===(o=null===(s=e[r])||void 0===s?void 0:s.properties)||void 0===o?void 0:o.supportsInterceptor)&&delete e[r];return{allExtensions:e,updatedInterceptors:a,interceptorOrderList:n}}async function a(){try{i.a.id&&(await(0,s.d)(i.a.id,{permanentDelete:!0}),i.a.id=null)}catch(e){console.warn("Delete item failed",e)}}},51632:(e,r,t)=>{t.d(r,{a:()=>d,b:()=>v,c:()=>l,d:()=>c,e:()=>f,f:()=>p,g:()=>h,s:()=>u});var i=t(54251),s=t(74695),o=t(98704),a=t(1536),n=t(83692);async function l(e){try{const r=await(0,n.r)(e);return{result:{folders:r.folders||[]}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function c(e,r){try{return{result:{status:(await(0,n.r)(e,{folderName:r},{},"post")).status}}}catch(e){return console.error(e),{error:e}}}async function d(e){const r=await(0,s.l)();try{await(0,o.c)(r)}catch(e){return{error:e}}const t=`${e}/content/features/analyze`;try{const e=await(0,n.r)(t,{itemid:r.id,filetype:"Service Definition"},{},"post");return e.id=r.id,{result:e}}catch(e){return await async function(e){try{await(0,a.d)(e,{permanentDelete:!0})}catch(e){console.error("Failed to delete item:",e)}}(r.id),{error:e}}}async function v(e,r){const t=`${e}/content/features/analyze`;try{return{result:await(0,n.r)(t,{itemid:r,filetype:"Service Definition"},{},"post")}}catch(e){return{error:e}}}async function h(e,r){const t=`${e}/types/providers/ArcObjects11/${r}/types?listInterceptors=true`;try{return{result:await(0,n.r)(t)}}catch(e){return{error:e}}}async function u(e,r,t){const i=`${e}/rest/services/System/PublishingTools/GPServer/Publish%20Service%20Definition`;try{const e=await(0,n.r)(`${i}/submitJob`,{in_sdp_id:t,in_config_overwrite:JSON.stringify(r)},{},"post");return{result:(await async function(e,r){const t=`${r}/jobs/${encodeURIComponent(e)}`;try{return{result:await(0,n.p)(t,{pendingStatuses:["esriJobExecuting","esriJobSubmitted","esriJobWaiting"],successStatuses:["esriJobSucceeded"]},"post")}}catch(e){return{error:e}}}(e.jobId,i)).result}}catch(e){return{error:e}}}async function p(e,r,t){var i;const s=`${r}/rest/services/System/PublishingTools/GPServer/Publish%20Service%20Definition/jobs/${t}/${e}`;try{const e=await(0,n.r)(s);if(e){const t=null===(i=null==e?void 0:e.value)||void 0===i?void 0:i.svcConfigInfo,s=`${r}/admin/services/${(null==t?void 0:t.folder)?`${t.folder}/`:""}${t.name}.${t.type}`;return{result:await(0,n.r)(s)}}}catch(e){return{error:e}}}async function f(e,r){var t;const s=`${e}content/items/${r}/info/iteminfo.xml${(0,i.g)()?`?token=${(0,i.g)()}`:""}`;try{const e=await fetch(s,{headers:{Accept:"application/xml"}}),r=await e.text(),i=(new DOMParser).parseFromString(r,"text/xml"),o=Array.from(i.getElementsByTagName("tag")).map(e=>e.textContent);return{result:{tags:o,summary:(null===(t=i.getElementsByTagName("summary")[0])||void 0===t?void 0:t.textContent)||""}}}catch(e){return{error:e}}}}}]);