"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_dist_esm-8c8d01"],{6597:(e,t,i)=>{i.r(t),i.d(t,{rfx_editor_wrapper:()=>a.R});var a=i(61567);i(92265),i(5294),i(13661),i(18423),i(21255),i(35431),i(69843),i(38949),i(32513),i(33752),i(44345),i(588),i(55448),i(2924),i(11840),i(52373),i(440),i(66744),i(42335),i(33797),i(73427),i(71802),i(36596),i(23795),i(17902),i(56451),i(64130),i(69529),i(16035),i(51477),i(85740),i(45253)},61567:(e,t,i)=>{i.d(t,{R:()=>m});var a=i(92265),r=(i(5294),i(13661),i(18423),i(21255),i(35431),i(69843)),s=i(38949),o=(i(588),i(55448),i(2924),i(11840),i(52373),i(33752),i(440),i(66744),i(44345),i(42335)),l=i(33797),n=i(73427),c=(i(23795),i(17902),i(56451),i(64130)),d=i(69529);const h="host",f="dialog",p="dialog-heading",m=class{constructor(e){(0,a.r)(this,e),this.rfxEditorWrapperClose=(0,a.c)(this,"rfxEditorWrapperClose"),this.hasBeenOpened=!1,this.initialDocumentOverflowStyle="",this.initState=()=>{s.s.entryPoint=this.entryPoint??o.E.ANALYSIS,s.s.portal=this.portal,s.s.rftId=this.rftItemId??this.portalItem?.id??s.s.rftId,(0,s.i)(this.user)&&!(0,s.i)(this.portal?.user)&&(this.user=this.portal.user),s.s.isViewerUserType=(0,s.P)(this.user)},this.setScale=()=>{this.scale=s.s.entryPoint===o.E.ITEM?l.C.l:l.U.Scale},this.setUIFlags=()=>{s.s.entryPoint===o.E.ITEM?(this.hideCreateNewTemplate=!0,this.hideEditTemplateProperties=!1):(this.hideCreateNewTemplate=!1,this.hideEditTemplateProperties=!0)},this.showReadOnlyAlert=()=>{this.removeReadOnlyAlert();const e=(0,c.c)({modalStrings:{header:this.strings.readOnlyModeTitle,content:this.strings.readOnlyModeMessage}});this.readOnlyAlertElement=e,document.body.appendChild(e)},this.removeReadOnlyAlert=()=>{this.readOnlyAlertElement?.remove(),this.readOnlyAlertElement=void 0},this.canClose=async()=>new Promise(async e=>{void 0!==this.rftItemId?e(await(this.rfxEditorApp?.onPanelClose(this.rftItemId))):e(!0)}),this.handleClose=async()=>{if(!0!==await this.canClose())throw new Error;this.removeReadOnlyAlert(),this.dialogElement.open=!1,this.rfxEditorWrapperClose.emit(),s.s.entryPoint===o.E.ITEM&&!0===this.newItemCreated&&(window.location.href=(0,n.a)(this.portalItem))},this.getDialogHeadingText=()=>this.rfxTemplateName??this.portalItem?.title??this.strings.defaultTemplateName,this.handleRFxTemplateNameChange=e=>{this.rfxTemplateName=e.detail},this.handleRFxTemplateSaved=e=>{const{portalItem:t,template:i}=e.detail;(0,s.i)(t)||(0,s.i)(i)||(t.id!==this.portalItem?.id&&(this.newItemCreated=!0,this.portalItem=t),this.rfxTemplateName=i.name)},this.handleRftItemDetailsLinkClicked=()=>{setTimeout(()=>{this.newItemCreated=!1,this.handleClose()},1)},this.applyStyleToDialogContainer=e=>{(0,d.n)(e,["shadowRoot","children[0]"],e=>{const t=document.createElement("style");t.innerHTML="div.container { z-index: 150; }",e.appendChild(t)})}}onOpenChange(e){this.updateOverflowHiddenClass(e),!0===e&&!0===s.s.isViewerUserType&&this.showReadOnlyAlert(),!1!==this.hasBeenOpened?!0===e&&!1===s.s.isLoadingRFT&&this.rfxEditorApp?.reloadRFTItem():this.hasBeenOpened=!0}async componentWillLoad(){({strings:this.strings}=await(0,r.c)(this.hostElement,(0,a.d)("."))),this.initState(),this.setScale(),this.setUIFlags()}updateOverflowHiddenClass(e){!0===e?this.addOverflowHiddenClass():this.removeOverflowHiddenClass()}addOverflowHiddenClass(){this.initialDocumentOverflowStyle=document.body.style.overflow,document.body.style.setProperty("overflow","hidden")}removeOverflowHiddenClass(){document.body.style.setProperty("overflow",this.initialDocumentOverflowStyle)}render(){return(0,a.h)(a.H,{key:"8d15ed53f54cc3634d83e115927a65f9e7fd895f",class:h},(0,a.h)("calcite-dialog",{key:"6ff1d9ce82ee2c9bc441c41a03c6165c89ddeeb3",id:"rfx-editor-dialog",class:f,open:!0===this.open,outsideCloseDisabled:!0,scale:"l",placement:"cover",beforeClose:async()=>this.handleClose(),ref:e=>{this.dialogElement=e,this.applyStyleToDialogContainer(e)}},(0,a.h)("div",{key:"d38d00900bd748cc612a596442d5975b2c67118b",class:p,slot:"header-content"},(0,a.h)("calcite-icon",{key:"7b5328c16c1db7ae14019772528d9f4fd7412491",icon:"function-editor",scale:this.scale,"text-label":"Raster Function Editor"}),this.getDialogHeadingText()),(0,a.h)("rfx-editor-app",{key:`rfx-editor-app-${this.rftItemId}`,mapLayers:this.mapLayers,mapView:this.mapView,portal:s.s.portal,rftItemId:s.s.rftId,scale:this.scale,ref:e=>{this.rfxEditorApp=e},onAnalysisTemplateNameChanged:this.handleRFxTemplateNameChange,onAnalysisTemplateSaved:this.handleRFxTemplateSaved,onRftItemDetailsLinkClicked:this.handleRftItemDetailsLinkClicked},(0,a.h)("rfx-editor-header-actions",{key:"8c35eef42eff314176cd0cf921987cd9f3b8cfd8",slot:"action-bar",templateId:s.s.rftId,hideCreateNewTemplate:this.hideCreateNewTemplate,hideRFxNodeActions:!0===s.s.isViewerUserType,hideEditTemplateProperties:this.hideEditTemplateProperties,scale:(0,l.u)(this.scale),expanded:!1===s.s.isViewerUserType}))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}static get watchers(){return{open:["onOpenChange"]}}};m.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.host{height:100%;width:100%}.dialog{--calcite-dialog-content-space:0;z-index:150}.dialog-heading{padding:var(--rfx-three-quarter-spacing);font-size:var(--calcite-font-size-2);font-weight:var(--calcite-font-weight-medium);line-height:var(--calcite-line-height-wrap)}.dialog-heading calcite-icon{padding-left:var(--rfx-quarter-spacing);padding-right:var(--rfx-three-quarter-spacing)}"},73427:(e,t,i)=>{i.d(t,{a:()=>u,c:()=>m,g:()=>p,i:()=>g,l:()=>f});var a=i(588),r=i(71802),s=i(44345),o=i(36596),l=i(38949);const n="ConvertRasterFunctionTemplate",c="https://rasteranalysisdev.arcgis.com/arcgis/rest/services/Utilities/RasterUtilities/GPServer";async function d(e){return(await(0,s.default)(e,{query:{f:"json"}})).data}async function h(e){let t={format:"json",inputRasterFunction:JSON.stringify({itemId:e.id})};const i=await async function(e){!(0,l.i)(e?.url)&&(0,l.i)(e?.user)&&(e=await(0,l.b)(e.url));const t=e.helperServices,i=t&&t.rasterUtilities;return Promise.resolve(`${i?i.url:c}`)}(e.portal);let s;(0,l.i)(i)&&Promise.reject("rasterUtilities server missing");try{const e=`${i}/${n}`,o=await a.default.getCredential(e);void 0!==o?.token&&(t={...t,token:o.token});const l=await r.submitJob(e,t),c={interval:1500,statusCallback:e=>{console.log("status: ",e.jobStatus)}};await l.waitForJobCompletion(c);const d=(await l.fetchResultData("outputRasterFunction")).value;({url:s}=d)}catch{Promise.reject("json conversion failed")}return d(s)}async function f(e,t){if((0,l.i)(e))throw new Error("Invalid Item Id");(0,l.i)(t)&&!(0,l.i)(l.s?.portal)&&(t=l.s.portal);let i=(0,l.g)(e,t);try{await i.load()}catch(a){if(!0===t?.isPortal)try{i=await async function(e){const t=(0,l.a)("https://www.arcgis.com"),i=(0,l.g)(e,t);try{await i.load()}catch(e){throw e}return i}(e)}catch(e){console.error(e)}else console.error(a)}return i}async function p(e,t){let i;const a=await f(e,t),{title:r,snippet:s,id:o}=a;try{const e=`${a.itemUrl}/data`;i=await d(e)}catch(e){if(console.log("Error loading portal item: ",e),!(0,l.i)(e.message))try{i=await h(a)}catch{if(!i)return void console.log("Failed to convert RFT to JSON.")}}return{...i,name:r,description:s??i.description,sourceItemId:o,type:i.type??l.R}}function m(e){return new o.default(e)}function u(e){if((0,l.i)(e))return;return`${e.portal.url.replace("/sharing/rest/","")}/home/item.html?id=${e.id}`}async function g(e){if((0,l.i)(e))return Promise.resolve(!1);let t=!1;const i=await e.fetchData();return 0!==e.size&&!0!==(0,l.i)(i)||(t=!0),Promise.resolve(t)}}}]);