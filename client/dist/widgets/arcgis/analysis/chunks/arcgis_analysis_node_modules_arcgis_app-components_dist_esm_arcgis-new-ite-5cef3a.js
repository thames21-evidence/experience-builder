/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-5cef3a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-5cef3a"],{37374:(e,a,i)=>{i.r(a),i.d(a,{arcgis_new_item_pages_data_store_snowflake_credentials:()=>h});var t=i(87849),s=i(59317),c=i(24869),l=i(64589),n=i(47172),r=i(3826),d=i(95878),o=i(86686);i(37762),i(15912),i(41473),i(60958),i(83692),i(931),i(93814),i(54251),i(1536),i(88878),i(46904),i(72257),i(86562),i(15332),i(74695),i(27137),i(76246),i(58573),i(29599),i(32478);const h=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.allowedAuthenticationTypes=["keyPair","user"],this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.handleAuthenticationTypeChange=e=>{const a=e.target.selectedOption.value;this.authenticationType!==a&&("keyPair"===this.authenticationType?(this.passcode=void 0,this.keyFile=void 0,this.keyFileName=void 0):"user"===this.authenticationType&&(this.password=void 0),this.authenticationType=a)},this.authenticationType="keyPair",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.keyFile=void 0,this.passcode=void 0,this.validKeyFileFormat=!0,this.error=void 0}async handleNext(){r.a.authenticationType=this.authenticationType,r.a.snowflakeServer=this.server,r.a.snowflakeUsername=this.user,r.a.role=this.role,r.a.database=this.database,r.a.schema=this.schema,r.a.warehouse=this.warehouse,"keyPair"===this.authenticationType?(r.a.snowflakeKeyFileName=this.keyFileName,r.a.snowflakeKeyFile=this.keyFile,r.a.passcode=this.passcode):r.a.snowflakePassword=this.password,this.checkValidFields()?await this.validateConnection():this.handleError({code:"unhandledError"})}async componentWillLoad(){this.i18n=d.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{authenticationType:e,server:a,database:i,schema:t,warehouse:s,role:c,user:l,password:n,keyFileName:r}=this,d=[a,i,t,s,c,l,..."keyPair"===e?[r]:[n]];return this.emptyFieldsExist=d.some(e=>!e),!this.emptyFieldsExist}populateFields(){var e;this.server=r.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=r.a.authenticationType),this.user=r.a.snowflakeUsername,this.role=r.a.role,this.database=r.a.database,this.schema=r.a.schema,this.warehouse=r.a.warehouse,"keyPair"===this.authenticationType?(this.keyFileName=r.a.snowflakeKeyFileName,this.keyFile=r.a.snowflakeKeyFile,this.passcode=r.a.passcode):this.password=r.a.snowflakePassword}async validateConnection(){const{user:e,password:a,database:i,role:t,server:c,warehouse:d,schema:h,keyFile:u,passcode:p,authenticationType:b}=this,{orgId:y}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const f=(0,o.k)({authenticationType:b,user:e,database:i,role:t,server:c,warehouse:d,schema:h,password:a,keyFile:u,passcode:p}),{result:k,error:m}=await(0,l.v)(y,s.c.portal,f);"success"===(null==k?void 0:k.status)?(r.a.jdbcConnection=Object.assign({},f.info.JDBCConnection),r.a.typeKeywords=[...r.a.typeKeywords,"CDW","snowflake"],r.a.initialTitle=(0,n.f)("snowflake",i),this.newItemUpdatePage.emit("itemProperties")):this.handleError(m)}processFile(e){if(!e)return;const{extension:a,fileName:i}=(0,c.s)(e);if(this.keyFileName=i,"p8"!==a)return this.validKeyFileFormat=!1,void(this.keyFile=void 0);this.validKeyFileFormat=!0;const t=new FileReader;t.onload=e=>{this.keyFile=String(e.target.result)},t.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let a=this.i18n.errors.validationFailedTitle,i=this.i18n.errors.invalidConnection;switch(e.code){case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidKeyFile":case"invalidCredentials":i=this.i18n.errors[e.code]}this.error={title:a,description:i,details:e.details}}render(){const{i18n:e,authenticationType:a,server:i,role:s,database:c,schema:l,warehouse:n,error:r,invalidLogin:d,validKeyFileFormat:o}=this;return(0,t.h)("div",{key:"0af5d63d15a0cbc566965c2e8964a22729b16799"},(0,t.h)("arcgis-new-item-loader",{key:"8939e418d5399784e125a232abb00a270adc1eb2",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,t.h)("arcgis-new-item-description",{key:"3a74973b1fcb6862326644a0caf4a52cbe2384de",header:e.dataStoreConnection,content:e.snowflake}),(0,t.h)("div",{key:"58aa3d4c4c20b935c0edf86cda7e46391c263999",class:"configure-form"},(0,t.h)("calcite-label",{key:"e1ea1866216e7b7319c7ff7e472d263696421edf"},e.server,(0,t.h)("calcite-input",{key:"a81e291092bafb3654fe027b9d1d49466384ff62",placeholder:"server_name.com",value:i,onCalciteInputInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"85fac99a3dd83a5a21936937180eba9b427b249d",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noServer)),(0,t.h)("calcite-label",{key:"953206a15355be2ef96b62beaee3c30ca8769d70"},e.authenticationType,(0,t.h)("calcite-select",{key:"5ee8819a16c41a5b4b3cd2624eedc11278d90c95",value:a,label:e.authenticationType,onCalciteSelectChange:this.handleAuthenticationTypeChange},this.allowedAuthenticationTypes.map(a=>(0,t.h)("calcite-option",{value:a,key:a},e[a])))),(0,t.h)("div",{key:"f71cd2aca3f95187e6b0ed056bdd73a7c4ef4f26",class:"fill-credentials"},(0,t.h)("calcite-label",{key:"6bfd74778ab1bcbe88ef68c83c78a30a95f4931c",class:"credentials"},(0,t.h)("div",{key:"9e49064b2da4a0c29e60c770bceada84a16c0c26"},e.username," ",(!this.user&&this.emptyFieldsExist||d)&&(0,t.h)("span",{key:"f7e4b5534b247414b0966a87b5a717ad70caaa0d",class:"asterisk"},"*")),(0,t.h)("calcite-input",{key:"bf0541e07689271b3986f95ea1b6e1646b0310e8",onCalciteInputInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||d)&&(0,t.h)("calcite-input-message",{key:"e714cd066338bca0d0f3e31d22902550d8fb7cb4",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.incorrectLogin)),"keyPair"!==this.authenticationType&&(0,t.h)("calcite-label",{key:"dc7dda6468411a1357be6c800cb7c721e6063b1e",class:"credentials"},(0,t.h)("div",{key:"591fa6364ff59acd9c52aa91a720ca10e9ea53be",class:"password"},e.password," ",(!this.password&&this.emptyFieldsExist||d)&&(0,t.h)("span",{key:"de6276c5aca3121387438920e1d91ff7add2f1eb",class:"asterisk"},"*")),(0,t.h)("calcite-input",{key:"9dd242e4885f2f4ef801721d641b93b8c5105d89",class:"credentials password",type:"password",onCalciteInputInput:e=>this.password=this.trimInput(e.target.value),required:!0}))),"keyPair"===this.authenticationType&&(0,t.h)("div",{key:"82bb85ac29b674264af96dbc18772a4e733eeb57"},(0,t.h)("calcite-label",{key:"fbc5f2c0f9e1ece19e0ec4791109aa8352d62910"},e.keyFile,(0,t.h)("calcite-input",{key:"2c970149f20e45c0d2080602b530d62eaa5bea48",status:!o||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid",readOnly:!0,value:this.keyFileName,required:!0},(0,t.h)("calcite-button",{key:"9207d2a0ccc933cc283760f909413237415b50cf",iconStart:"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},e.selectKeyFile)),(0,t.h)("input",{key:"4065c6a8981df8a4037019ac5a671989766068fa",class:"hide",type:"file",accept:".p8",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,t.h)("calcite-input-message",{key:"35242c360a68df9f4c8bd82ca21944864fc8902e",icon:!o||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!o||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?e.errors.noKeyFile:o?e.p8Only:e.notP8)),(0,t.h)("calcite-label",{key:"80d0fd6917fea77b7395b925a5e087011c72d6de"},e.passcode,(0,t.h)("calcite-input",{key:"395ec7a5ee2a1de5762ec656ffe2bed3e467234a",type:"password",onCalciteInputInput:e=>this.passcode=this.trimInput(e.target.value)}),(0,t.h)("calcite-input-message",{key:"8f1037e4b35834b19298c087efbf1ea41de0e24b",icon:"information",status:"idle"},e.passcodeInformation))),(0,t.h)("calcite-label",{key:"ab6d07c28b3a930907ce3c0712b6622425e311bf"},e.database,(0,t.h)("calcite-input",{key:"d5b611978f5614d50bf1280ebda5233dfd42514c",value:c,onCalciteInputInput:e=>this.database=this.trimInput(e.target.value),required:!0}),!this.database&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"e30625855f633fce0cb1768bf7bfd20ede4f264f",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noDatabase)),(0,t.h)("calcite-label",{key:"0a0313debc64119e661765f82cb402a6b0b4b218"},e.schema,(0,t.h)("calcite-input",{key:"966e17b326741d73a6efcb60e4e4d950b0c93a50",value:l,onCalciteInputInput:e=>this.schema=this.trimInput(e.target.value),required:!0}),!this.schema&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"5757b7b7ca589d12eba4f3420962474f3c85d9ed",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noSchema)),(0,t.h)("calcite-label",{key:"8add335969e83d98271ac0db8cd2430d8b4d789b"},e.warehouse,(0,t.h)("calcite-input",{key:"93578be5e5bac37975bae1835c457eab8f2c26e4",value:n,onCalciteInputInput:e=>this.warehouse=this.trimInput(e.target.value),required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"22285a612f1c8611f06449c97926349c83f59af6",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noWarehouse)),(0,t.h)("calcite-label",{key:"e3991c1556dbcf906492da510a83a73ad9c15b58"},e.role,(0,t.h)("calcite-input",{key:"992cefe5c4abbf3e04c2108098bc6f357044b0da",value:s,onCalciteInputInput:e=>this.role=this.trimInput(e.target.value),required:!0}),!this.role&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"20b909c9edf2e7286881010be92156dbffcd9f98",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noRole))),(0,t.h)("arcgis-new-item-alert",{key:"0b24707900fb1e70222b205c646c481dc0f90dcf",heading:null==r?void 0:r.title,description:null==r?void 0:r.description,details:null==r?void 0:r.details,detailsPopoverLabel:e.errorDetails,active:!!r,onAlertDismiss:()=>this.error=null}))}};h.style=".configure-form{margin-top:1.5rem}.hide{display:none}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},47172:(e,a,i)=>{i.d(a,{f:()=>t});const t=(e,a)=>{let i;const t=null!=a?a:"";switch(e){case"amazon":i=`AmazonS3_${t}`;break;case"azure":i=`Microsoft_Azure_Storage_${t}`;break;case"bigquery":i=`BigQuery_${t}`;break;case"databricks":i=t?`Databricks_${t}`:"Databricks";break;case"snowflake":i=`Snowflake_${t}`}return i.replace(/ /g,"_").replace(/-/g,"_")}}}]);