/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-de3729.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-de3729"],{36486:(e,t,i)=>{i.d(t,{u:()=>l});var a=i(83552),s=i(73679);const l=(0,a.yr)(s.g)},43141:(e,t,i)=>{i.r(t),i.d(t,{ArcgisMapConfigTimeSlider:()=>T});var a=i(73679),s=i(4395),l=i(62893),n=i(83552),o=i(66228),r=i(36486),d=i(54312),c=i(23384),m=i(19123),h=i(85643),p=i(73801),g=i(58611);const b=s.AH`import :host{height:100%;width:100%;display:block}.base{height:100%}.base__tabs,.base__info-message,.base__enable-timeslider{padding:var(--calcite-spacing-xxs)}.base__enable-timeslider{--calcite-label-margin-bottom: 0px;margin-top:var(--calcite-spacing-lg);margin-bottom:var(--calcite-spacing-sm);margin-inline-start:var(--calcite-spacing-sm);width:fit-content}.base__playback-position{margin:0 var(--calcite-spacing-xxs);padding:var(--calcite-spacing-xxs)}`,y="base",u={base:y,tabs:`${y}__tabs`,infoMessage:`${y}__info-message`,enableTimeSlider:`${y}__enable-timeslider`,playbackPosition:`${y}__playback-position`};class T extends p.WF{constructor(){super(...arguments),this._direction=(0,n.jH)(),this.startPositionNode=(0,h._)(),this.savedPositionNode=(0,h._)(),this._messages=(0,r.u)({blocking:!0}),this.timeSliderConfigState=(0,l.u)(),this.playRate=l.d,this.noTimeAwareLayersAvailable=!1,this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,this.timeSliderEnabled=!1,this.hideTimeSliderEnableToggle=!1,this.hideInstantMode=!1,this.allowArcadeTime=!1,this.playbackPosition={show:!1,useSavedPosition:!1},this.store=(0,g.y$)({isRTL:!1}),this.arcgisEnableToggle=(0,p.lh)(),this.arcgisFullTimeExtentChange=(0,p.lh)(),this.arcgisNoTimeEnabledLayersFound=(0,p.lh)(),this.arcgisPlayRateChange=(0,p.lh)(),this.arcgisPlaybackPositionChange=(0,p.lh)(),this.arcgisStopsChange=(0,p.lh)(),this.arcgisTimeDisplayModeChange=(0,p.lh)()}static{this.properties={fullTimeExtent:16,timeDisplayMode:16,stops:16,playRate:16,noTimeAwareLayersAvailable:16,fulltimeExtentFromLayersInitialized:16,fullTimeExtentFromViewInitialized:16,view:0,timeSliderEnabled:5,hideTimeSliderEnableToggle:5,hideInstantMode:5,allowArcadeTime:5,playbackPosition:0,store:0}}static{this.styles=b}async load(){await this._loadStore(),await this._loadPersistedTimeSliderPropertiesFromSceneView(),await this._checkFullTimeExtentOfLayers()}loaded(){this.viewHandle=d.watch(()=>this.view,async()=>await this._viewChange()),this.timeZoneHandle=d.watch(()=>this.view?.timeZone,async()=>this.requestUpdate()),this._watchForLayerLoadedAndProperties()}disconnectedCallback(){super.disconnectedCallback(),this.viewHandle?.remove(),this._watchLayerLoadedHandle?.remove(),this._watchWidgetPropertiesHandle?.remove(),this.timeZoneHandle?.remove()}async _viewChange(){this.noTimeAwareLayersAvailable=!1,this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,await this._loadPersistedTimeSliderPropertiesFromSceneView()}_handleTimeDisplayModeChange(e){this._updateTimeDisplayMode(e.detail)}_handleTimeSliderEnableToggled(e){const{timeSliderConfigState:t}=this,i=e?.target?.checked;i&&!this.timeSliderEnabled?(this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,this._loadPersistedTimeSliderPropertiesFromSceneView().then(()=>this.arcgisEnableToggle.emit(i))):this.arcgisEnableToggle.emit(i),this.timeSliderEnabled=i,t.timeSliderEnabled=i}_updateTimeDisplayMode(e){const{timeSliderConfigState:t}=this;t.timeDisplayMode=e,this.timeDisplayMode=t.timeDisplayMode,this.arcgisTimeDisplayModeChange.emit(e),"instant"===this.timeDisplayMode&&(this.playbackPosition.useSavedPosition=!0,this.arcgisPlaybackPositionChange.emit("saved-time")),this.startPositionNode.value&&(this.startPositionNode.value.disabled="instant"===this.timeDisplayMode),this.savedPositionNode.value&&(this.savedPositionNode.value.disabled="instant"===this.timeDisplayMode)}async _handleFullTimeExtentChange(e){const{timeSliderConfigState:t}=this;if(!(0,l.t)(t.fullTimeExtent,e.detail)){const t=await this._validateFullTimeExtent(e.detail);this._updateFullTimeExtent(t)}}_updateFullTimeExtent(e){const{timeSliderConfigState:t}=this;t.fullTimeExtent=e,this.fullTimeExtent=t.fullTimeExtent,this.arcgisFullTimeExtentChange.emit(e)}async _validateFullTimeExtent(e){let t=e?.start?.getTime(),i=e?.end?.getTime();const a=t===i&&"instant"!==this.timeDisplayMode;return t=new Date(t||Date.now()).setSeconds(0,0),i=new Date(i?i+(a?6e4:0):Date.now()+(a?6e4:0)).setSeconds(0,0),e.start=new Date(t),e.end=new Date(i),e&&e.end&&e.start&&e.end.getTime()-e.start.getTime()<l.m&&this._fixFullTimeExtentForSmallTimeRanges(e),new m.default({start:new Date(t),end:new Date(i)})}_handleStopsChange(e){const{timeSliderConfigState:t}=this;(0,l.a)(t.stops,e.detail)||this._updateStops(e.detail)}_updateStops(e){const{timeSliderConfigState:t}=this;t.stops=e,this.stops=t.stops,this.arcgisStopsChange.emit(t.stops)}_handlePlayRateChange(e){const{timeSliderConfigState:t}=this;t.playRate!==e.detail&&this._updatePlayRate(e.detail)}_updatePlayRate(e){const{timeSliderConfigState:t}=this;t.playRate=e,this.playRate=t.playRate,this.arcgisPlayRateChange.emit(t.playRate)}async _loadStore(){const{timeSliderConfigState:e}=this;(0,l.c)(e),e.view=this.view,e._messages=this._messages,e.isRTL="rtl"===this._direction}async _loadPersistedTimeSliderPropertiesFromSceneView(){const{allowArcadeTime:e}=this,t=this.view?.map;if(t){const i=this._getModeFromViewExtent();let a;const s=await c.getTimeSliderSettingsFromWebDocument(t)??{};if(s&&(s.stops&&this._updateStops(s.stops),s.fullTimeExtent&&this._updateFullTimeExtent(s.fullTimeExtent),s.playRate&&this._updatePlayRate(s.playRate),s.mode&&(a=s.mode)),!s.fullTimeExtent&&e){const e=this.view.map.widgets?.timeSlider;e?.stops&&this._updateStops(e.stops),e?.fullTimeExtent&&this._updateFullTimeExtent(e.fullTimeExtent),e?.playRate&&this._updatePlayRate(e.playRate),e?.mode&&(a=e.mode)}(i||a)&&this._updateTimeDisplayMode(i||a)}this.fullTimeExtentFromViewInitialized=!0,this._watchForLayerLoadedAndProperties()}_watchForLayerLoadedAndProperties(){this._watchLayerLoadedHandle?.remove(),this._watchLayerLoadedHandle=d.watch(()=>this.view?Array.from((this.view.map?.allLayers?.toArray()??[]).filter(e=>(0,l.l)(e)||(0,l.b)(e)).map(e=>({loadStatus:e.loadStatus,userViewTime:e?.useViewTime,fullTimeExtent:e?.timeInfo?.fullTimeExtent,visibilityTimeExtentStart:e.visibilityTimeExtent?.start,visibilityTimeExtentEnd:e.visibilityTimeExtent?.end}))):[],async e=>{e.some(e=>"loading"===e.loadStatus)||await this._checkFullTimeExtentOfLayers()})}async _checkFullTimeExtentOfLayers(){const{timeSliderConfigState:e,allowArcadeTime:t}=this,i=this.view?this.view.map?.allLayers.filter(e=>(0,l.i)(e,t))??[]:[],a=this.view?this.view.map?.allLayers.filter(e=>(0,l.e)(e))??[]:[];if(!i?.length&&!a?.length)return this.arcgisNoTimeEnabledLayersFound.emit(),void(this.noTimeAwareLayersAvailable=!0);this.noTimeAwareLayersAvailable=!1;const s=await c.getTimeExtentFromLayers([...i,...a],void 0),n=(0,l.t)(e.fullTimeExtent,s);if(!(0,o.i)(e.fullTimeExtent?.start)&&!(0,o.i)(e.fullTimeExtent?.end)||!t&&!n){const e=await this._validateFullTimeExtent(s);(this.fulltimeExtentFromLayersInitialized||!this.fulltimeExtentFromLayersInitialized&&!(0,o.i)(this.fullTimeExtent))&&this._updateFullTimeExtent(e),this.fulltimeExtentFromLayersInitialized||(this.fulltimeExtentFromLayersInitialized=!0)}}_getModeFromViewExtent(){const e=this.view?.timeExtent;if((0,o.i)(e))return(0,l.g)(e)}_fixFullTimeExtentForSmallTimeRanges(e){e.end=e.start?new Date(e.start.getTime()+l.m):void 0}render(){const{timeSliderConfigState:e}=this;return this.noTimeAwareLayersAvailable?s.qy`<div class=${`${u.base} ${u.infoMessage}`}><calcite-notice open icon=information><div slot=message>${e._messages.noTimeEnabledLayers}</div></calcite-notice></div>`:s.qy`<div class=${(0,p.CP)(u.base)}>${this.renderTabs()}</div>`}renderTabs(){const{timeSliderConfigState:e,playbackPosition:t}=this;return s.qy`${this.renderTimeSliderToggle()}<calcite-tabs class=${(0,p.CP)(u.tabs)} layout=center><calcite-tab-nav slot=title-group><calcite-tab-title selected data-testId=arcgis-map-config-time-slider-tab-title-timeextent .disabled=${!this.timeSliderEnabled}>${e._messages.startEndPoints.title}</calcite-tab-title><calcite-tab-title data-testId=arcgis-map-config-time-slider-tab-title-interval .disabled=${!this.timeSliderEnabled}>${e._messages.timeInterval.title}</calcite-tab-title>${t.show&&s.qy`<calcite-tab-title .disabled=${!this.timeSliderEnabled} data-testId=arcgis-map-config-time-slider-tab-title-playback-position>${e._messages?.playbackPosition?.title}</calcite-tab-title>`||""}<calcite-tab-title .disabled=${!this.timeSliderEnabled} data-testId=arcgis-map-config-time-slider-tab-title-playback>${e._messages?.playback?.title}</calcite-tab-title></calcite-tab-nav><calcite-tab selected>${this.renderTimeExtent()}</calcite-tab><calcite-tab>${this.renderTimeInterval()}</calcite-tab>${t.show&&s.qy`<calcite-tab>${this.renderPlaybackPosition()}</calcite-tab>`||""}<calcite-tab>${this.renderPlayRate()}</calcite-tab></calcite-tabs>`}renderTimeSliderToggle(){const{timeSliderConfigState:e,hideTimeSliderEnableToggle:t}=this;return t?"":s.qy`<calcite-label layout=inline class=${(0,p.CP)(u.enableTimeSlider)} alignment=start><calcite-switch .label=${e._messages.enableTimeSlider} .name=${e._messages.enableTimeSlider} .checked=${this.timeSliderEnabled} @calciteSwitchChange=${this._handleTimeSliderEnableToggled} data-testId=arcgis-map-config-time-slider-enable-timeslider></calcite-switch>${e._messages.enableTimeSlider}</calcite-label>`}renderTimeExtent(){return s.qy`<arcgis-map-config-time-slider-time-extent .timeDisplayMode=${this.timeDisplayMode} .hideInstantMode=${this.hideInstantMode} .start=${this.fullTimeExtent?.start||void 0} .end=${this.fullTimeExtent?.end||void 0} .timeZone=${this.view?.timeZone} .timeSliderEnabled=${this.timeSliderEnabled} @arcgisTimeExtentTimeDisplayModeChange=${this._handleTimeDisplayModeChange} @arcgisTimeExtentFullExtentChange=${this._handleFullTimeExtentChange}></arcgis-map-config-time-slider-time-extent>`}renderTimeInterval(){return s.qy`<arcgis-map-config-time-slider-time-interval .stops=${this.stops} .fullTimeExtent=${this.fullTimeExtent} .timeSliderEnabled=${this.timeSliderEnabled} @arcgisIntervalStopsChange=${this._handleStopsChange}></arcgis-map-config-time-slider-time-interval>`}renderPlaybackPosition(){const{timeSliderConfigState:e,playbackPosition:t}=this;return s.qy`<calcite-radio-button-group class=${(0,p.CP)(u.playbackPosition)} name=playback-position @calciteRadioButtonGroupChange=${e=>this.arcgisPlaybackPositionChange.emit(e.currentTarget.selectedItem.value)}><calcite-label layout=inline><calcite-radio-button .disabled=${"instant"===this.timeDisplayMode} value=start-time scale=s .checked=${!t.useSavedPosition} ${(0,h.K)(this.startPositionNode)}></calcite-radio-button>${e._messages.playbackPosition.startTime}</calcite-label><calcite-label layout=inline><calcite-radio-button .disabled=${"instant"===this.timeDisplayMode} value=saved-time scale=s .checked=${t.useSavedPosition} ${(0,h.K)(this.savedPositionNode)}></calcite-radio-button>${e._messages.playbackPosition.savedTime}</calcite-label></calcite-radio-button-group>`}renderPlayRate(){return s.qy`<arcgis-map-config-time-slider-time-playback .playRate=${this.playRate} .timeSliderEnabled=${this.timeSliderEnabled} @arcgisPlayRateSettingsChange=${this._handlePlayRateChange}></arcgis-map-config-time-slider-time-playback>`}}(0,a.c)("arcgis-map-config-time-slider",T)},58611:(e,t,i)=>{i.d(t,{_i:()=>d,y$:()=>b});i(4713);var a=i(54312),s=i(44319),l=i(93461),n=i(53987),o=i(84577),r=i(60331);const d=(e,t)=>t=>m(t,e);class c extends s.G{constructor(e,t){super(e),this.Y=new Map,this.A=void 0,this.#e=(0,n.createObservable)();const i=this;i.#t=t,i.Z(),i.setProvisionalExports(h(e,new WeakRef(i),e.M.length-1,i.instance,i.Y),!1),(0,s.d)(e,t=>{if(t){const s=(0,a.watch)(()=>e[t],t=>{if(t===i.instance)return;const a=i.instance;i.exports=t,i.instance=t,i.Y.forEach((t,i)=>e.requestUpdate(t,a[i])),i.#i&&a.destroy(),i.#i=!1},{sync:!0});i.onDestroy(s.remove)}},i.exports)}#i;#e;#t;get exports(){return(0,n.trackAccess)(this.#e),super.exports}set exports(e){super.exports=e,this.#e.notify()}Z(){const e=this;e.instance="prototype"in e.#t&&"declaredClass"in e.#t.prototype?new e.#t:e.#t(),e.#i=!0}hostConnected(){this.exports=this.instance}hostDestroy(){this.#i&&this.instance.destroy?.()}}const m=(0,l.p)(c),h=(e,t,i,a,l)=>new Proxy(a,{get:(a,n)=>{const o=a[n];if("symbol"==typeof n||l.has(n))return o;const r=e.M[i];return r.A=n,(0,s.t)(e,a=>{if(r.A=void 0,void 0!==a){const s=a.key;l.set(n,s);const o=e.constructor.getPropertyOptions(s);0;const r=n!==s&&s.toLowerCase().includes("disable");p(t,o,n,s,r),void 0===o.i&&g(o,i,n,r)}},o)}}),p=(e,t,i,s,l,n)=>n=(0,a.watch)(()=>{const t=e.deref();return void 0===t||t.component.manager.destroyed?n=n.remove():t.exports[i]},(i,a)=>{if(!n)return;const o=e.deref().component;o?.requestUpdate(s,l?!a:a),t.c=!1},{sync:!0}),g=(e,t,i,a)=>{e.d.get=function(){const e=this.M[t]?.exports[i];return a?!e:e},e.d.set=function(e){const s=this.M[t];s.A!==i&&(s.exports[i]=a?!e:e)}},b=e=>{const t=class extends r.default{},i="function"==typeof e?e():e,a=Object.getOwnPropertyDescriptors(i);for(const[e,i]of Object.entries(a))Object.defineProperty(t.prototype,e,i),(0,o.property)()(t.prototype,e);return new((0,o.subclass)()(t))}}}]);