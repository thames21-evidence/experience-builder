"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_dist_esm-9f464d"],{32818:(e,t,i)=>{i.r(t),i.d(t,{rfx_analysis_wrapper:()=>a.R});var a=i(58764);i(92265),i(69843),i(51477),i(5294),i(16035),i(38949),i(32513),i(33752),i(44345),i(13661),i(18423),i(21255),i(35431),i(85740),i(588),i(55448),i(2924),i(11840),i(52373),i(440),i(66744),i(42335),i(45253),i(33797),i(80587),i(73427),i(71802),i(36596),i(23795),i(17902),i(56451)},58764:(e,t,i)=>{i.d(t,{R:()=>c});var a=i(92265),s=i(69843),r=i(51477),l=i(33797),n=i(80587),o=(i(5294),i(38949)),h=i(85740);i(23795),i(17902),i(56451),i(588),i(71802),i(44345),i(36596),i(33752);const c=class{constructor(e){(0,a.r)(this,e),this.analysisToolDataChange=(0,a.c)(this,"analysisToolDataChange"),this.analysisToolClose=(0,a.c)(this,"analysisToolclose"),this.analysisUnsupportedFunction=(0,a.c)(this,"analysisUnsupportedFunction"),this.analysisRFTLoadError=(0,a.c)(this,"analysisRFTLoadError"),this.analysisRFxHelpPopoverChange=(0,a.c)(this,"analysisRFxHelpPopoverChange"),this.analysisRFxBrowseLayerClick=(0,a.c)(this,"analysisRFxBrowseLayerClick"),this.resetPreview=!0,this.usePanel=!0,this.showPreview=!0,this.validateOnPreview=!0,this.hideAllArgsHelp=!1,this.hideBrowseLayers=!1,this.hasGlobalFunctionInRFT=!1,this.renderFlag=!1,this.handlePreviewSelectionChange=e=>{this.editorComponent.rfxTemplate=e.detail,setTimeout(()=>{this.validateRFx()},500)},this.handlePreviewHelpClick=e=>{const{referenceElement:t,helpSrcdoc:i,heading:a}=e.detail,l=this.portal?.isPortal,o=this.portal?.sourceJSON?.helpBase||r.a.learnMoreDocBaseURL,h=(0,s.f)(o,this.locale);let c;if(!0===l){const e=r.a.learnMoreDocDefaultEnterpriseHelpID,{restUrl:t}=this.portal;c=`${h}${(0,n.a)(e)}${r.a.learnMoreDocPreviewEnterpriseHelpID}`,c=(0,s.a)(c,t)}else{const e=`${r.a.learnMoreDocDefaultHelpID}${r.a.learnMoreDocPreviewHelpID}`;c=(0,n.f)(h,e)}this.analysisRFxHelpPopoverChange.emit({referenceElement:t,helpSrcdoc:i,heading:a,learnMoreUrl:c})},this.scheduleRenderer=()=>{this.renderFlag=!this.renderFlag}}async onRfxTemplateChange(){!0===this.resetPreview&&(this.hasGlobalFunctionInRFT=await(0,r.h)(this.rfxTemplate,this.locale),this.previewComponent?.clearPreviewLayers())}async onMapLayersChange(){this.resetPreview=!1;try{this.rfxTemplate=await this.getUpdatedRFTWithValues()??this.rfxTemplate}catch(e){this.analysisRFTLoadError.emit()}setTimeout(()=>{this.resetPreview=!0},1)}onPortalChange(e){o.s.portal=e}async getUpdatedRFTWithValues(){return this.editorComponent?.getUpdatedRFTWithValues()}async validateRFx(){return await(this.editorComponent?.checkTemplateValidity())}async reset(){return this.editorComponent.rfxTemplate=this.rfxTemplate,this.editorComponent.resetTraversedList(),this.scheduleRenderer(),Promise.resolve()}async componentWillLoad(){const{locale:e,rtl:t}=(0,s.g)(this.hostElement);this.locale=e,this.dir=(0,s.b)(t),void 0!==this.portal&&this.onPortalChange(this.portal),void 0===this.rfxTemplate&&void 0!==this.functionName&&(this.rfxTemplate=await(0,r.g)(this.functionName)),void 0!==this.rfxTemplate&&void 0===this.rfxTemplate?.arguments&&this.analysisRFTLoadError.emit(),this.hasGlobalFunctionInRFT=await(0,r.h)(this.rfxTemplate,this.locale),o.s.hideAllArgsHelp=!0===this.hideAllArgsHelp,o.s.hideBrowseLayers=!0===this.hideBrowseLayers,o.s.scale=this.scale??l.U.Scale}renderArgsEditor(){const{imageryLayers:e,featureLayers:t}=(0,h.g)(this.mapLayers);return(0,a.h)("rfx-args-editor",{ref:e=>this.editorComponent=e,rfxTemplate:this.rfxTemplate,imageryLayers:e,featureLayers:t,mapView:this.mapView,portal:this.portal,onRfxArgHelpClick:e=>{const{referenceElement:t,helpSrcdoc:i,heading:a}=e.detail;this.analysisRFxHelpPopoverChange.emit({referenceElement:t,helpSrcdoc:i,heading:a})},onRfxBrowseClick:e=>{this.analysisRFxBrowseLayerClick.emit(e.detail)},onRfxUnsupportedFunctionFound:e=>this.analysisUnsupportedFunction.emit(e.detail),onRfxFailedToLoad:()=>this.analysisRFTLoadError.emit()})}renderPreviewElement(){return(0,a.h)("rfx-preview",{mapView:this.mapView,portal:this.portal,getTemplate:()=>this.getUpdatedRFTWithValues(),validateOnPreview:this.validateOnPreview,validateInputValues:()=>this.validateRFx(),onRfxPreviewSelection:this.handlePreviewSelectionChange,onPreviewHelpClick:this.handlePreviewHelpClick,ref:e=>this.previewComponent=e})}render(){return(0,a.h)(a.H,{key:"83053743068c69acc518a8827605e3c1ab8bc324"},!0===this.usePanel?(0,a.h)("calcite-panel",{dir:this.dir,heading:this.rfxTemplate.name,closable:!0,onCalcitePanelClose:()=>this.analysisToolClose.emit()},this.renderArgsEditor()):(0,a.h)("div",null,this.renderArgsEditor(),!0===this.showPreview&&!1===this.hasGlobalFunctionInRFT?this.renderPreviewElement():void 0))}get hostElement(){return(0,a.a)(this)}static get watchers(){return{rfxTemplate:["onRfxTemplateChange"],mapLayers:["onMapLayersChange"],portal:["onPortalChange"]}}}}}]);