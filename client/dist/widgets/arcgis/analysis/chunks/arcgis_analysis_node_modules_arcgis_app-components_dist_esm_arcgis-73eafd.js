/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-73eafd.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-73eafd"],{1654:(e,t,s)=>{s.d(t,{A:()=>w,B:()=>E,C:()=>T,D:()=>k,E:()=>g,F:()=>q,a:()=>a,b:()=>o,c:()=>n,d:()=>b,e:()=>M,f:()=>y,g:()=>O,h:()=>$,i:()=>p,j:()=>S,k:()=>U,l:()=>d,m:()=>c,n:()=>l,o:()=>x,p:()=>h,q:()=>m,r:()=>v,s:()=>z,t:()=>_,u:()=>u,v:()=>I,w:()=>A,x:()=>R,y:()=>B,z:()=>f});var r=s(46904);const i=e=>{var t,s,r;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(s=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==s?s:null===(r=null==e?void 0:e.sourceJSON)||void 0===r?void 0:r.id};function o(e){return e&&!e.orgId}function n(e,t){return(0,r.u)(e,t)||"update"===e.itemControl||(0,r.c)([e],t)&&y(t)}function a(e,t){const s=(0,r.c)([e],t),i=(0,r.u)(e,t)||y(t)&&s,o=O(t)&&C(t);return!!(i||s&&o)}const l=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageLicenses"))},d=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:inviteUsers"))},c=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageRoles"))},u=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:changeUserRoles"))},h=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewGroups"))},m=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewUsers"))};function p(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function g(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}function v(e){return["Geoanalytics Engine","GeoAnalytics MS Fabric"].includes(null==e?void 0:e.type)}const b=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("Developer")},f=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("PublicSharingDisabled")},w=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("HostedServicesPublicSharingDisabled")};function y(e){return"org_admin"===i(e)||"account_admin"===i(e)}function M(e){return["org_admin","account_admin"].includes(i(e))&&!(null==e?void 0:e.roleId)}function O(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function S(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function $(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function x(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:assignToGroups"))}const C=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))};function I(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function A(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function E(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function B(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function T(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function R(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function U(e,t,s,r){const i=r&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(r.type),o=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!y(t)&&!o||!(null==s?void 0:s.isPortal)&&!i)}function q(e){return!!e&&(!O(e)||O(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const k=({items:e,user:t,portal:s})=>{const i=e[0],o=i.owner;if(s.isPortal&&o!==t.username&&o.includes("esri_")&&!["esri_livingatlas"].includes(o))return!1;const a=(0,r.u)(i,t),l=O(t),d=F(t),c=n(i,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!l&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||I(e)||A(e)||!!t.canSharePublic&&E(e)}(t,s)||F(t));return a||c||(0,r.c)(e,t)&&d};function F(e){return R(e)||B(e)||T(e)}const P=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];function _(e){return e.some(e=>P.includes(e))}function z(e){return e.filter(e=>P.includes(e))}},5157:(e,t,s)=>{s.d(t,{D:()=>i,b:()=>r,s:()=>o});const r={xxs:320,xs:480,sm:640,md:768,lg:1024,xl:1280},i=960;function o(e){var t,s;return null!==(t=(s=e.state).resizeObserver)&&void 0!==t||(s.resizeObserver=new ResizeObserver(n)),e.state.resizeObserver}function n(e){e.forEach(e=>{if(e.contentRect.width>0){const t=new CustomEvent("arcgisBrowserResize",{detail:{width:e.contentRect.width,height:e.contentRect.height}});e.target.dispatchEvent(t)}})}},26854:(e,t,s)=>{s.d(t,{a:()=>l,c:()=>d,g:()=>o,h:()=>i,i:()=>n,r:()=>a});var r=s(15332);function i(e){const t=document.createElement("textarea");return t.innerHTML=e,t.innerText}function o(e){return function(e){return null==e?void 0:e.replace(/&#10;&#13;|&#10;|&#13;|\r\n|\r|\n/g,"<br>")}(function(e){return null==e?void 0:e.replace(/(?:\r)/g,"&#10;").replace(/(?:\n)/g,"&#13;")}(function(e){return null==e?void 0:e.replace(/(https?:\/\/[^\s]+)/g,e=>`<a href="${e}" target="_blank">${e}</a>`)}(function(e){return null==e?void 0:e.replace(/(?:&#10;)/g,"\r").replace(/(?:&#13;)/g,"\n")}(e))))}function n(e){return e.replace(/\$\{startSup\}/g,"<sup>").replace(/\$\{endSup\}/g,"</sup>")}function a(e,t,s){return e.replace(/\$\{startLink\}/g,`<calcite-link label="${s}" href="${t}" target="_blank">`).replace(/\$\{endLink\}/g,"</calcite-link>")}function l(e){return e.replace(/\$\{startStrong\}/g,"<strong>").replace(/\$\{endStrong\}/g,"</strong>")}function d(e){return(0,r.s)((null==e?void 0:e.trim())||"").replace(/[!*+\-&|()[\]{}^~?:"\\]/g,"\\$&")}},44388:(e,t,s)=>{s.d(t,{c:()=>i,r:()=>o});var r=s(15332);function i(e=""){return(0,r.s)(e).replace(/[<>\/\\?]/g,"\\$&").trim()}function o(e,{start:t,end:s,total:r}){const i="rtl"===document.documentElement.dir;return e.replace("${start}",i?s:t).replace("${end}",i?t:s).replace("${total}",r)}},46904:(e,t,s)=>{s.d(t,{a:()=>n,b:()=>o,c:()=>d,d:()=>c,e:()=>u,f:()=>h,g:()=>m,i:()=>a,u:()=>l});s(93814);var r=s(41473);function i(e){var t;return!!(null===(t=e.owner)||void 0===t?void 0:t.toLowerCase().includes("esri"))}function o(e){var t;return i(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits"))}function n(e){var t;return i(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription"))}function a(e,t){return e.owner===t.username}function l(e,t){return a(e,t)||function(e,t){var s;if(null!=e.isAdmin)return!!e.isAdmin;const r=e.owner,i="admin"===e.itemControl,o=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(s=e.portal)||void 0===s?void 0:s.isPortal)&&!a(e,t)&&i&&r.includes("esri_")&&!o.includes(r))return!1;return i}(e,t)}const d=(e,t)=>!!t.orgId&&e.every(e=>e.isOrgItem),c=(e,t)=>`${(0,r.a)(t)}item.html?id=${e}`,u=(e,t)=>`${(0,r.g)(t)}/content/users/${e}`,h=e=>e.reduce((e,t)=>(e[t.owner]=e[t.owner]?[...e[t.owner],t.id]:[t.id],e),{}),m=(e,t)=>`${(0,r.a)(t)}content/items/${e}`},52042:(e,t,s)=>{function r(e){var t;const s=null===(t=null==e?void 0:e.sourceJSON)||void 0===t?void 0:t.subscriptionInfo;return s&&["Organizational Plan","Community","In House","ConnectED","ELA","Education Site License","Education","HUP Online Entitlement","Demo and Marketing"].includes(s.type)}s.d(t,{c:()=>r})},83319:(e,t,s)=>{s.r(t),s.d(t,{arcgis_member_browser:()=>S});var r=s(87849),i=s(37762),o=s(3367),n=s(59317),a=s(15332),l=s(4429),d=s(12192),c=s(1654),u=s(5157),h=s(44388),m=s(41473),p=s(94737),g=s(26854),v=s(83692),b=s(52042),f=s(94984);s(46904),s(93814),s(931),s(54251);function w(e,t,s){const r=(0,m.g)(e);return s?`${r}community/groups/${t.groupId}/userlist`:t.includeExternalUsers?`${r}community/users`:`${r}portals/self/users/search`}function y(e,t,s){const r=t?function(e){const{num:t,start:s,sortOrder:r,sortField:i,filters:o,searchTerm:n}=e,a={name:""+(n?`${(0,g.c)(n)}`:"")},l=Object.keys(o||{}).reduce((e,t)=>{const{param:s,value:r,start:i,end:n}=o[t];return e[s]="joined"===t?`000000${i.getTime()},000000${n.getTime()}`:r,e},a);return Object.assign({num:t,start:s,sortField:i,sortOrder:r},l)}(e):function(e,t){var s,r;const{num:i,start:o,sortOrder:n,sortField:a,filters:l,baseQuery:d,searchTerm:c}=e,u=Object.keys(l||{}),h={q:`${d||""} ${c?`(${(0,g.c)(c)}) `:""} `},m=u.reduce((e,t)=>{const{param:s,value:r}=l[t];if("categories"===s)e.categories="null"===r?r:JSON.stringify(r);else if("emailstatus"===s||"mfaenabled"===s)e.q=`${e.q} ${r}`;else if("provider"===s&&r.includes(",")){const t=`(provider:${r.split(",").join(" OR provider:")})`;e.q=`${e.q} ${t}`}else"lastLogin"===s?e.q=`${e.q} ${r}`:"availablecredits"===s&&"-1"===r?e.q=`${e.q} ${s}:"${r}"`:"memberType"!==s&&(e.q=`${e.q} ${s}:${r}`);return e},h);if(e.includeExternalUsers){if("collaboration"===(null===(s=e.group)||void 0===s?void 0:s.membershipAccess)){const s=null===(r=e.partnerCollaborations)||void 0===r?void 0:r.filter(e=>"active"===e.to.state).map(e=>e.to.orgId);m.q=`${m.q} (orgid: ${t.id} OR ${(null==s?void 0:s.length)?` OR orgid:${s.join(" OR orgid:")}`:""})`}else u.some(e=>"orgid"===l[e].param)||(m.q=`${m.q} +(orgid: [0 TO {])`);m.searchUserAccess="includeTrustedOrgs"}e.includeExternalUsers&&e.coordinatorsOnly&&(m.filter=`(username:${e.collaborationCoordinators.map(e=>e.username).join(" OR username:")})`),e.groupId&&(m.q=`${m.q} group:${e.groupId}`);const p=(e.systemUsers||[]).reduce((e,t)=>`${e} -username:${t}`,"");if(p&&(m.q=`${m.q} ${p}`),null==l?void 0:l.groupRole){const t="admin"===l.groupRole.value?"":"-";m.filter+=`(${t}username:${e.groupAdmins.join(` OR ${t}username:`)})`}if(m.q=m.q.trim(),e.appBundleId?m.q=`${m.q} appbundle:${e.appBundleId}`:e.directAppId&&(m.directapp=e.directAppId,e.entitlementKey&&(m.entitlement=e.entitlementKey)),e.doubleAssignedUserTypeIds){const t=`(userlicensetype:${e.doubleAssignedUserTypeIds.map(e=>e).join(" OR userlicensetype:")})`;m.q=`${m.q} ${t}`}return Object.assign({num:i,start:o,sortField:"name"===a?"fullname":a,sortOrder:n},m)}(e,s);return r}function M(e,t,s){s?null==e||e.forEach(e=>{t.groupOwner&&t.groupOwner===e.username&&(e.memberType="owner")}):t.groupId&&t.groupOwner&&(null==e||e.forEach(e=>{var s;e.username===t.groupOwner?e.memberType="owner":(null===(s=t.groupAdmins)||void 0===s?void 0:s.includes(e.username))&&(e.memberType="admin")}))}async function O(e,t){var s,r;const i=Boolean(!t.myOrgView&&t.groupId),o=w(e,t,i),n=y(t,i,e),a=await(0,v.r)(o,n);if(M(a.users||a.results,t,i),t.includeExternalUsers&&!t.coordinatorsOnly&&(!t.filters||0===Object.keys(t.filters).length)){const i=(null===(s=t.searchTerm)||void 0===s?void 0:s.trim().toLowerCase())||"",o=await async function(e,t,s){if(!s||!t||t.length<3)return!1;const r=(0,m.g)(e),i=`${r}community/users`;try{const e=await(0,v.r)(i,{filter:`username:${t} AND group:${s}`,num:1});return(null==e?void 0:e.total)>0}catch(e){return!1}}(e,i,t.groupId),n=(a.users||a.results).some(e=>e.username.toLowerCase()===i);if(i.length>0&&!n&&!o&&1===t.start&&"collaboration"!==(null===(r=t.group)||void 0===r?void 0:r.membershipAccess)){const t=await async function(e,t){const s=(0,m.g)(e),r=`${s}community/users/${t}`;try{const e=await(0,v.r)(r);return!e.username||e.firstName||e.fullName||e.lastName||(e.fullName=e.username,e.firstName=e.username),e}catch(e){}}(e,i);t&&(a.results.unshift(t),a.total++)}}return Object.assign(Object.assign({},a),{q:n.q,queryParams:n})}const S=class{constructor(e){(0,r.r)(this,e),this.arcgisMemberBrowserUpdate=(0,r.c)(this,"arcgisMemberBrowserUpdate",7),this.arcgisMemberBrowserLoading=(0,r.c)(this,"arcgisMemberBrowserLoading",7),this.arcgisMemberBrowserSelect=(0,r.c)(this,"arcgisMemberBrowserSelect",7),this.arcgisMemberBrowserInternalUIAction=(0,r.c)(this,"arcgisMemberBrowserInternalUIAction",7),this.arcgisMemberBrowserPreview=(0,r.c)(this,"arcgisMemberBrowserPreview",7),this.liveRegionUpdate=(0,r.c)(this,"liveRegionUpdate",7),this.allowFetch=!1,this.currentResults=[],this.updateFiltersEmpty=()=>{var e;this.store.state.filtersEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="filters"]'))},this.updateTopbarEmpty=()=>{var e;this.store.state.topbarEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="top-bar"]'))},this.updateSortEmpty=()=>{var e;this.store.state.sortEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="sort"]'))},this.filterMutationObserver=new MutationObserver(this.updateFiltersEmpty),this.topbarMutationObserver=new MutationObserver(this.updateTopbarEmpty),this.sortMutationObserver=new MutationObserver(this.updateSortEmpty),this.loadData=()=>{this.loadUserTypes(),this.loadRoles(),this.loadGroupAdmins()},this.loadGroupAdmins=async()=>{const{portal:e}=n.c;if(e&&this.store.state.groupId){const{admins:t,owner:s}=await(0,o.f)(e,this.store.state.groupId);this.store.state.groupAdmins=t.map(e=>e.username),this.store.state.groupOwner=s}},this.loadUserTypes=async()=>{const{user:e,portal:t}=n.c,s=(0,c.e)(e)||(0,c.l)(e)||(0,c.m)(e)||(0,c.n)(e);!this.store.state.userTypes&&e&&t&&s&&(this.store.state.userTypes=await(0,o.a)(t))},this.loadRoles=async()=>{const{user:e,portal:t}=n.c;if(!this.store.state.roles&&e&&t){let e=await(0,o.b)(t);e.forEach(e=>{"iAAAAAAAAAAAAAAA"===e.id&&(e.name=this.i18n.roles.viewer),"iBBBBBBBBBBBBBBB"===e.id&&(e.name=this.i18n.roles.editor),"iCCCCCCCCCCCCCCC"===e.id&&(e.name=this.i18n.roles.facilitator)}),e=[...e,{id:"org_publisher",name:this.i18n.roles.publisher},{id:"org_admin",name:this.i18n.roles.admin},{id:"org_user",name:this.i18n.roles.user}],e.sort((e,t)=>{const s=e.name.toLowerCase(),r=t.name.toLowerCase();return s>r?1:s<r?-1:0}),this.store.state.roles=e}},this.fetchMembers=(0,l.f)(async()=>{var e;if(this.loading=!0,this.currentResults=[],this.arcgisMemberBrowserLoading.emit(),this.store.state.preview=null,!this.portal||!this.allowFetch)return;let t=this.getQuery();if(this.preflight&&(t=await this.preflight(t)),this.isExternalSearchWithNoFilters=t.includeExternalUsers&&!t.coordinatorsOnly&&!t.searchTerm&&(!t.filters||0===Object.keys(t.filters).length),!this.isExternalSearchWithNoFilters){const s=await(0,l.m)(this.queryMembers(t),500);0===s.total&&(null===(e=s.users)||void 0===e?void 0:e.length)>0&&(s.total=s.users.length),this.arcgisMemberBrowserUpdate.emit(Object.assign(Object.assign(Object.assign({},s),{selectedMembers:this.selectedMembers,filters:Object.assign({},this.store.state.filters),searchTerm:this.searchTerm}),this.sort)),this.currentResponse=s,this.currentResults=s.results||s.users}this.loading=!1},150),this.getCollaborationsData=async()=>{var e;const{portal:t}=null!==n.c&&void 0!==n.c?n.c:{},s=null===(e=null==t?void 0:t.sourceJSON)||void 0===e?void 0:e.subscriptionInfo,r=(0,b.c)(t);if(!s||!r)return void(this.store.state.coordinatorsOnly=!1);const i=await(0,o.c)(t);i.sort((e,t)=>e.to.name>t.to.name?1:e.to.name<t.to.name?-1:0),this.store.state.partnerCollaborations=i;const a=await(0,o.d)(t);this.store.state.collaborationCoordinators=a,0!==i.length&&0!==a.length||(this.store.state.coordinatorsOnly=!1)},this.handleResizeEvent=e=>{this.resize(e)},this.renderSelectedItem=e=>(0,r.h)("arcgis-selected-item",{key:e.id,heading:e.fullName,onArcgisSelectedItemRemove:()=>{this.deselectMember(e),this.arcgisMemberBrowserSelect.emit(this.selectedMembers)}},(0,r.h)("arcgis-user-avatar",{user:e,portal:this.portal})),this.rangeFormatter=async({start:e,end:t,total:s})=>{const{lang:r}=this.store.state,{i18n:i}=this;return"en"===r?[`${e}-${t} of ${s}`,`${e}-${t} of ${s} member${"1"===s?"":"s"}`]:[(0,h.r)(i.memberBrowser.pageRange,{start:e,end:t,total:s}),(0,h.r)(i.memberBrowser.pageRangeAria,{start:e,end:t,total:s})]},this.portal=void 0,this.user=void 0,this.config=void 0,this.selection=void 0,this.view="compact",this.num=100,this.q="",this.selectedMembers=[],this.preflight=void 0,this.fetch=void 0,this.store=(0,i.c)({type:"member-browser",includeExternalUsers:!1,coordinatorsOnly:!0}),this.usePanelLayout=void 0,this.height="full",this.isCollabGroup=!1,this.groupId=void 0,this.group=void 0,this.myOrgView=!1,this.previewEnabled=!1,this.allowSelectAll=!1,this.excludeGroupId=void 0,this.roles=void 0,this.collaborationCoordinators=void 0,this.appBundleId=void 0,this.directAppId=void 0,this.entitlementKey=void 0,this.doubleAssignedUserTypeIds=void 0,this.maxSelected=void 0,this.searchTerm="",this.sort=void 0,this.page={num:this.num,start:1,nextStart:-1},this.loading=!0,this.pageRangeText="",this.formFactor=void 0,this.previewMember=void 0,this.currentResponse=void 0,this.isExternalSearchWithNoFilters=!1}async refresh(e){this.store.state.groupId&&await this.loadGroupAdmins(),e&&(0,v.c)("userItemsTotal"),this.fetchMembers()}async componentWillLoad(){var e,t,s;const{el:r,selectedMembers:i,view:o}=this,n=await(0,d.g)(r);this.i18n=n[0],this.store.state.i18n=n[0],this.store.state.lang=n[1],this.store.state.view=o,this.store.state.selectedMembers=i,this.store.state.isCollabGroup="collaboration"===(null===(e=this.group)||void 0===e?void 0:e.membershipAccess)||this.isCollabGroup,this.store.state.myOrgView=this.myOrgView,this.store.state.groupId=(null===(t=this.group)||void 0===t?void 0:t.id)||this.groupId,this.store.state.selection=this.selection,this.store.state.excludeGroupId=this.excludeGroupId,this.store.state.group=this.group,this.store.state.portal=this.portal,this.roles&&(this.store.state.roles=this.roles),this.maxSelected&&(this.store.state.maxSelected=this.maxSelected),this.filterMutationObserver.observe(r,{childList:!0}),this.topbarMutationObserver.observe(r,{childList:!0}),this.sortMutationObserver.observe(r,{childList:!0}),this.updateFiltersEmpty(),this.updateTopbarEmpty(),this.updateSortEmpty(),this.initializeConfig(),(0,u.s)(this.store).observe(this.el),r.addEventListener("arcgisBrowserResize",this.handleResizeEvent),this.store.state.panel=null!==(s=this.usePanelLayout)&&void 0!==s?s:(0,a.c)(this.el,"calcite-shell-panel"),this.store.state.panel&&(this.store.state.filtersExpanded=!1),this.loadData()}disconnectedCallback(){var e,t;null===(e=this.store.state.resizeObserver)||void 0===e||e.unobserve(this.el),this.filterMutationObserver.disconnect(),this.topbarMutationObserver.disconnect(),this.sortMutationObserver.disconnect(),this.filterClearHandler(!1),null===(t=this.el)||void 0===t||t.removeEventListener("arcgisBrowserResize",this.handleResizeEvent)}updateUser(e){var t;null!==(t=n.c.user)&&void 0!==t||(n.c.user=e),this.loadData()}updatePortal(e){var t;null!==(t=n.c.portal)&&void 0!==t||(n.c.portal=e),this.loadData()}updateConfig(e){var t;null!==(t=n.c.config)&&void 0!==t||(n.c.config=e)}updateSelection(e){this.store.state.selection=e}updateSelectedGroups(e){this.store.state.selectedMembers=e}updateGroup(e){this.store.state.group=e}updateQ(){this.resetPagination(),this.fetchMembers()}updateRoles(e){e&&(this.store.state.roles=e)}updateCoordinators(e){e&&(this.store.state.collaborationCoordinators=e)}async componentDidLoad(){this.initializeConfig(),await(0,l.t)(400),this.allowFetch=!0,n.c.portal?(await this.getCollaborationsData(),this.fetchMembers()):(0,n.o)("portal",async()=>{this.initializeConfig(),await this.getCollaborationsData(),this.fetchMembers()})}handleSearchSwitchChange(e){this.store.state.includeExternalUsers=e.detail.checked,this.resetPagination(),this.fetchMembers()}handleCoordinatorsSwitchChange(){this.resetPagination(),this.fetchMembers()}handleAssignedSwitchCHange(e){this.store.state.licenseAssignedOnly=e.detail.checked,this.resetPagination(),this.fetchMembers()}handleDoubleAssignedSwitchCHange(e){this.store.state.doubleAssignedOnly=e.detail.checked,this.resetPagination(),this.fetchMembers()}handleMyOrgViewSwitchChange(e){this.store.state.myOrgView=e.detail.checked,this.store.state.myOrgView?(this.store.state.columns=["name","membertype","credits","lastlogin","usertype","role"],this.store.state.sort={sortField:"lastlogin",sortOrder:"desc"}):(this.store.state.columns=["name","membertype","affiliation","joined"],this.store.state.sort={sortField:"joined",sortOrder:"desc"}),this.store.state.filters={},this.resetPagination(),this.fetchMembers()}filterHandler(e){const t=Object.assign(Object.assign({},this.store.state.filters),{[e.detail.id]:e.detail});e.detail.value||delete t[e.detail.id],this.store.state.filters=t,this.resetPagination(),this.fetchMembers()}filterRemoveHandler(e){if(!e.detail)return;const t=Object.assign({},this.store.state.filters);delete t[e.detail],this.store.state.filters=t,this.resetPagination(),this.fetchMembers()}filterClearHandler(e=!0){this.store.state.filters={},this.resetPagination(),e&&this.fetchMembers()}genericFilterClearHandler(){this.filterClearHandler()}filterToggleHandler(){this.store.state.preview=null,this.store.state.filtersExpanded=!this.store.state.filtersExpanded}searchHandler(e){this.loading=!0;const t=e.detail;this.searchTerm=t,this.resetPagination(),t?this.fetchMembers():this.fetchMembers.invoke()}sortHandler(e){this.loading=!0,this.sort=e.detail,this.store.state.sort=e.detail,this.fetchMembers()}async pageHandler(e){var t;this.page=e.detail,this.allowFetch&&(await this.fetchMembers(),await(0,l.t)(400),null===(t=this.el.shadowRoot.querySelector(".content__view"))||void 0===t||t.scrollTo({top:0,behavior:"smooth"}))}selectHandler(e){const{selected:t,member:s}=e.detail;switch(this.selection){case"single":this.selectedMembers=[s];break;case"multiple":t?this.selectMember(s):this.deselectMember(s)}this.arcgisMemberBrowserSelect.emit(this.selectedMembers)}async togglePreview({detail:e}){this.previewEnabled&&(this.store.state.filtersExpanded=!1,e&&this.store.state.preview!==e.username?(this.restoreFocusElement=document.activeElement,this.store.state.preview=e.username,this.previewMember=Object.assign({},e),this.arcgisMemberBrowserPreview.emit(Object.assign({},e))):(this.store.state.preview=null,this.previewMember=null,this.arcgisMemberBrowserPreview.emit()),this.arcgisMemberBrowserInternalUIAction.emit({action:this.previewMember?"open panel":"close panel",category:"card action"}))}columnUpdateHandler(e){this.store.state.columns=e.detail}async initializeConfig(){var e,t,s;null!==(e=n.c.user)&&void 0!==e||(n.c.user=this.user),null!==(t=n.c.portal)&&void 0!==t||(n.c.portal=this.portal),null!==(s=n.c.config)&&void 0!==s||(n.c.config=this.config)}resetPagination(){this.page.start=1,this.page.total=0}getQuery(){var e,t;const{includeExternalUsers:s,coordinatorsOnly:r,collaborationCoordinators:i,groupId:o,licenseAssignedOnly:a,doubleAssignedOnly:l}=this.store.state,d=Object.assign(Object.assign({filters:this.store.state.filters,searchTerm:this.searchTerm.trim(),baseQuery:this.q,includeExternalUsers:!o&&(s||!(null===(e=n.c.portal)||void 0===e?void 0:e.id)),coordinatorsOnly:!o&&r&&Boolean(null===(t=n.c.portal)||void 0===t?void 0:t.id),collaborationCoordinators:i,myOrgView:this.store.state.myOrgView,groupId:this.store.state.groupId,groupOwner:this.store.state.groupOwner,groupAdmins:this.store.state.groupAdmins,partnerCollaborations:this.store.state.partnerCollaborations,group:this.store.state.group,systemUsers:this.config.systemUsers},this.store.state.sort),this.page);return(a||l)&&(this.appBundleId?d.appBundleId=this.appBundleId:this.directAppId&&(d.directAppId=this.directAppId,this.entitlementKey&&(d.entitlementKey=this.entitlementKey)),l&&this.doubleAssignedUserTypeIds&&(d.doubleAssignedUserTypeIds=this.doubleAssignedUserTypeIds)),d}queryMembers(e){return this.fetch?this.fetch(e):O(this.portal,e)}restoreFocus(){if(this.restoreFocusElement){const e=this.restoreFocusElement;e.restoreFocus?e.restoreFocus():e.setFocus?e.setFocus():e.focus&&e.focus()}}selectMember(e){this.isSelected(e)||(this.selectedMembers=[...this.selectedMembers,e])}deselectMember(e){this.selectedMembers=this.selectedMembers.filter(({username:t})=>t!==e.username)}isSelected(e){var t;return null===(t=this.selectedMembers)||void 0===t?void 0:t.some(({username:t})=>e.username===t)}resize({detail:{width:e,height:t}}){this.formFactor=e>u.b.md?"large":"small";const s=this.store.state.width>u.b.md?"large":"small";"large"===s&&"small"===this.formFactor&&(this.store.state.panel=this.usePanelLayout,this.store.state.filtersExpanded=!1),"small"===s&&"large"===this.formFactor&&(this.store.state.panel=!1,this.store.state.filtersExpanded=!0),this.store.state.width=e,this.store.state.height=t}renderSelected(){var e,t,s,i,o,n,a,l;const d=this.currentResults.length>0&&(null===(e=this.currentResults)||void 0===e?void 0:e.every(e=>this.isSelected(e))),c=null===(t=this.selectedMembers)||void 0===t?void 0:t.length,u=(null===(s=this.store.state.selectedMembers)||void 0===s?void 0:s.length)||0,h=(null===(o=null===(i=this.currentResults)||void 0===i?void 0:i.filter(e=>this.isSelected(e)))||void 0===o?void 0:o.length)||0,m=(null===(n=this.currentResults)||void 0===n?void 0:n.length)?this.currentResults.length-h:0,g=this.maxSelected&&u+m>this.maxSelected?(0,f.s)(this.i18n.maxSelected,{number:this.maxSelected}):null;return(0,r.h)("arcgis-selected",{slot:"selection",loading:this.loading,total:null===(a=this.currentResults)||void 0===a?void 0:a.length,totalSelected:c,emptyText:this.i18n.memberBrowser.noSelectedMembers,heading:this.i18n.memberBrowser.selectedMembers,checked:!this.loading&&d,indeterminate:!d&&!!c,maxSelectionTooltip:g,allowClearAll:Boolean(this.maxSelected),onArcgisSelectedDeselectAll:()=>{this.selectedMembers=[],this.arcgisMemberBrowserSelect.emit(this.selectedMembers)},onArcgisSelectedSelectPage:async e=>{var t;const s=e.target;if(this.allowSelectAll&&!this.store.state.includeExternalUsers){s.selectingAll=!0;let e=this.getQuery();this.preflight&&(e=await this.preflight(e));const t=await async function(e,t){const s=Boolean(!t.myOrgView&&t.groupId),r=w(e,t,s),i=y(t,s,e),o=await(0,p.f)(r,i,s?"users":"results",!0);return M(o,t,s),o}(this.portal,e);t.forEach(e=>{this.selectMember(e)}),s.selectingAll=!1}else null===(t=this.currentResults)||void 0===t||t.forEach(e=>{this.selectMember(e)});this.arcgisMemberBrowserSelect.emit(this.selectedMembers)}},null===(l=this.selectedMembers)||void 0===l?void 0:l.map(this.renderSelectedItem))}renderSlot(e,t){return(0,r.h)("div",{slot:e},(0,r.h)("slot",{name:e},t))}renderEmptyTextSlot(e,t){return(0,r.h)("div",{slot:e,class:"empty-text-slot"},(0,r.h)("slot",{name:e},(0,r.h)("div",{class:"empty-text-slot__default"},(0,r.h)("p",null,t))))}render(){const{loading:e,i18n:t,selectedMembers:s,selection:i,currentResponse:o,store:n,searchTerm:a,formFactor:l,height:d,renderSlot:c,renderEmptyTextSlot:u}=this;return(0,r.h)("arcgis-browser",{key:"8e91aaddc8c205d0e4ea83a351a6bbc559eba49d",preview:!!this.previewMember,loading:e,selected:s,alwaysShowSelection:"multiple"===i,response:o,store:n,formFactor:l,searchTerm:a,height:d,showPreSearch:this.isExternalSearchWithNoFilters,onAriaUpdate:e=>this.liveRegionUpdate.emit(e.detail),rangeFormatter:this.rangeFormatter},c("top-bar"),c("top-bar-end"),c("view"),c("sort"),this.renderSelected(),c("actions"),c("content-start"),c("content"),c("content-end"),c("pagination"),c("filters-top"),c("filters"),c("scroll-end"),u("no-results",t.memberBrowser.noUsersFound),u("no-content",t.memberBrowser.noUsers),(0,r.h)("div",{key:"5001fc79239256087d73e1e31dd7514307bbf262",slot:"pre-search",class:"empty-text-slot"},(0,r.h)("slot",{key:"82f72c84d29ba37cb7608bdd3ce81b501236afa3",name:"pre-search"},(0,r.h)("div",{key:"ea993065ae180ed5008aae82bc124d62d3cb6eef",class:"empty-text-slot__default"},(0,r.h)("svg",{key:"10a2867cd474cfbe8bea1e4b0347f30e81e264ae",viewBox:"0 0 64 64",width:"128",height:"128",class:"pre-search-icon"},(0,r.h)("path",{key:"790b7478f79c808588b5a5a239c48ffa96caddc8",d:"M16.37 23.071c1.418 4.135 5.303 7.329 7.738 7.329 2.531 0 6.561-3.424 7.858-7.702 3.067-2.303 1.683-8.088.39-10.09l-.326-.513c-1.1-1.74-1.968-3.114-5.152-3.673-3.39-.595-5.45.604-6.624 1.83a1.72 1.72 0 0 0-1.275-.019c-2.742.833-4.323 4.461-4.57 6.772-.164 1.54-.113 4.346 1.96 6.066zm7.738 6.53c-1.888 0-5.622-2.842-6.978-6.779a23.946 23.946 0 0 1 2.205-5.96 12.824 12.824 0 0 0 .824-1.633c3.33 2.389 7.73 1.82 9.02 1.585.207.625.751 2.211 2.026 5.638-1.25 4.153-5.083 7.148-7.097 7.148zM15.205 17.09c.216-2.032 1.64-5.372 4.007-6.091a1.54 1.54 0 0 1 .438-.077.477.477 0 0 1 .369.133l.305.33.292-.342c.988-1.152 2.853-2.408 6.124-1.833 2.835.498 3.543 1.617 4.613 3.312l.331.52c1.14 1.766 2.228 6.654.128 8.746-1.62-4.365-1.975-5.54-1.978-5.552l-.108-.361-.367.086c-.056.013-5.543 1.26-9.12-1.679l-.43-.353-.199.52a12.524 12.524 0 0 1-.959 1.998 23.028 23.028 0 0 0-2.168 5.65 6.431 6.431 0 0 1-1.278-5.007zm21.53 16.773l-.656.459c-1.41-2.01-4.427-3.136-7.72-4.166-.348 2.295-2.808 4.91-4.359 4.91s-4.01-2.615-4.358-4.91c-3.294 1.03-6.31 2.156-7.721 4.166l-.655-.46c1.624-2.314 5.002-3.505 8.616-4.618l.518-.159v.541c0 2.041 2.44 4.64 3.6 4.64s3.6-2.599 3.6-4.64v-.541l.518.16c3.614 1.112 6.992 2.303 8.616 4.618zm23.013 20.606L44.447 39.167l-1.414 1.415-3.801-3.801a19.94 19.94 0 1 0-2.451 2.45l3.803 3.803-1.414 1.415 15.299 15.3a2.382 2.382 0 0 0 1.697.702h.002a2.413 2.413 0 0 0 1.695-.702l1.886-1.886a2.4 2.4 0 0 0 0-3.394zM4.9 24A19.1 19.1 0 1 1 24 43.1 19.122 19.122 0 0 1 4.9 24zm32.474 14.693q.69-.63 1.32-1.32l3.774 3.775-1.32 1.32zm21.81 18.604l-1.887 1.886a1.61 1.61 0 0 1-1.13.468h-.001a1.589 1.589 0 0 1-1.131-.468L40.3 44.449l4.146-4.15 14.736 14.736a1.6 1.6 0 0 1 0 2.262z"})),(0,r.h)("p",{key:"90f2c6793174d0bf1ab0cb6f497273ff6b151c28"},t.memberBrowser.enterTermExternal)))))}get el(){return(0,r.a)(this)}static get watchers(){return{user:["updateUser"],portal:["updatePortal"],config:["updateConfig"],selection:["updateSelection"],selectedMembers:["updateSelectedGroups"],group:["updateGroup"],q:["updateQ"],roles:["updateRoles"],collaborationCoordinators:["updateCoordinators"]}}};S.style=":host{position:relative;display:flex;height:100%;flex-direction:column;overflow-y:auto;overflow-x:hidden;background-color:var(--calcite-color-background);--member-browser-max-width:100%;--member-browser-pane-width:18.75rem;--member-browser-pane-z-index:11;--member-browser-top-bar-background:var(--calcite-color-foreground-1)}arcgis-browser{--arcgis-browser-max-width:var(--member-browser-max-width);--arcgis-browser-pane-width:var(--member-browser-pane-width);--arcgis-browser-pane-z-index:var(--member-browser-pane-z-index);--arcgis-browser-top-bar-background:var(--member-browser-top-bar-background)}.pre-search-icon{fill:var(--calcite-ui-border-1)}::slotted([slot=no-results]){width:100%}::slotted([slot=no-content]){width:100%}.empty-text-slot{display:flex;height:100%;width:100%;justify-content:center}.empty-text-slot__default{margin-left:auto;margin-right:auto;max-width:32rem;padding-left:1.5rem;padding-right:1.5rem;padding-bottom:4rem;margin-top:min(8rem, 30vh)}@media screen and (max-width: 640px){:host{--member-browser-pane-width:100%}}"}}]);