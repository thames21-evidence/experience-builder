"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-tool-app_dist_esm_ana-a9ae5e"],{56471:(t,e,o)=>{o.r(e),o.d(e,{analysis_tool_app_container:()=>T});var s=o(74903),a=o(68810),i=o(190),r=o(78572);function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var l,h={exports:{}};var c=n(function(){if(l)return h.exports;function t(t,e,o,s){var a,i=null==(a=s)||"number"==typeof a||"boolean"==typeof a?s:o(s),r=e.get(i);return void 0===r&&(r=t.call(this,s),e.set(i,r)),r}function e(t,e,o){var s=Array.prototype.slice.call(arguments,3),a=o(s),i=e.get(a);return void 0===i&&(i=t.apply(this,s),e.set(a,i)),i}function o(t,e,o,s,a){return o.bind(e,t,s,a)}function s(s,a){return o(s,this,1===s.length?t:e,a.cache.create(),a.serializer)}function a(){return JSON.stringify(arguments)}function i(){this.cache=Object.create(null)}l=1,i.prototype.has=function(t){return t in this.cache},i.prototype.get=function(t){return this.cache[t]},i.prototype.set=function(t,e){this.cache[t]=e};var r={create:function(){return new i}};return h.exports=function(t,e){var o=e&&e.cache?e.cache:r,i=e&&e.serializer?e.serializer:a;return(e&&e.strategy?e.strategy:s)(t,{cache:o,serializer:i})},h.exports.strategies={variadic:function(t,s){return o(t,this,e,s.cache.create(),s.serializer)},monadic:function(e,s){return o(e,this,t,s.cache.create(),s.serializer)}},h.exports}());const d="esriExecutionTypeAsynchronous",p="GPString",m="esriGPParameterDirectionInput",u="esriGPParameterDirectionOutput",g="esriGPParameterTypeOptional",v="parameterViewModel";var y={map:{OtherHelpLinks:{creditThreshold:"analyze/environment-settings-mv.htm#ESRI_SECTION1_372233651088474E9354BA5C9A73C6E5",errorMessages:{noPermissionToAccessTool:"analyze/custom-web-tools-mv.htm#ESRI_SECTION1_A45007CCCFC6446FB2D268803A80F170",specialCharactersInServiceNameError:"analyze/perform-analysis-mv.htm#ESRI_SECTION1_5EACA346CAB14E699818819B44ACBD01",premiumTool:"analyze/analysis-session-mv.htm#ESRI_SECTION1_8E287CDA9CC344EA8FA45689D1F9C5DE",missingRequiredPrivileges:"analyze/licensing-analysis-mv.htm"}},modelBuilder:{noParameters:"analyze/publish-model-mv.htm#ESRI_SECTION1_F34A8D4672C147D4834CF2FC098FABF1"}}};var S={map:{OtherHelpLinks:{errorMessages:{noPermissionToAccessTool:"120004851",specialCharactersInServiceNameError:"120004279"}}}};const f="tool-footer",b="header-scene-viewer",E="toolbar",T=class{constructor(t){(0,s.r)(this,t),this.analysisToolAppJobStatusChange=(0,s.d)(this,"analysisToolAppJobStatus"),this.analysisToolAppJobResultDataComplete=(0,s.d)(this,"analysisToolAppJobResultDataComplete"),this.analysisToolAppPanelChange=(0,s.d)(this,"analysisToolAppPanelChange"),this.analysisToolAppJobSubmissionAttempt=(0,s.d)(this,"analysisToolAppJobSubmissionAttempt"),this.analysisToolAppDisconnect=(0,s.d)(this,"analysisToolAppDisconnect"),this.analysisToolAppLoaded=(0,s.d)(this,"analysisToolAppLoaded"),this.locale=i.b.EnglishUSA,this.errorStrings={},this.gpMessages={},this.commonStrings={},this.isWebToolOpening=!1,this.runAnalysisDisabled=!1,this.validationStatus=i.X.Valid,this.toolErrorState={toolAppErrorState:[],parameterErrorState:{}},this.showHeader=!0,this.runAnalysisBtnClick=async()=>{const t=[await this.toolElement.validateTool(),await this.toolSettingsElement.validateSettings()];this.validationStatus=(0,i.h)(t),this.toolErrorState=(0,i.c)(this.toolErrorState,t),this.validationStatus!==i.X.Error?this.executeAnalysis(this.portal.isPortal):this.scrollToTop()},this.handleCalciteNoticeClose=()=>{this.validationStatus=i.X.Valid},this.memoizeHelperFetchPath=async t=>{const e=await fetch((0,s.a)(t));return await e.json()},this.getCurrentToolJSONs=c(async(t,e)=>{let o,r,n,l;if(void 0!==this.webToolServerUrl&&void 0===this.webToolJSON){this.isWebToolOpening=!0;try{o=await(0,a.L)(this.webToolServerUrl,e)}catch(t){this.toolErrorState.toolAppErrorState=[(0,i.j)({errorKey:i.m.CannotReopenWebTool,type:i.X.Error})],o=void 0,this.validationStatus=i.X.Error}this.isWebToolOpening=!1}else{const t=c(this.memoizeHelperFetchPath),a=await(0,i.Y)({locale:this.locale,name:e,assetPrefix:(0,s.a)("assets"),analysisEngine:this.analysisEngine,uiMode:i.F.Standalone,memoizedHelper:t});if(o=a.toolJson,r=a.toolT9n,l=a.toolUIJson,void 0!==a.toolHelpFilePath&&(n=(0,s.a)(a.toolHelpFilePath)),void 0!==l&&void 0!==this.travelModeInfo){l.travelModeInfo=this.travelModeInfo;const t=this.travelModeInfo?.travelModes?.filter(t=>t.id===this.travelModeInfo?.defaultTravelModeId)[0];void 0!==l.travelModeInfo&&void 0!==t&&(l.travelModeInfo.defaultTravelMode=t)}}return{toolJson:o??{name:this.toolName,displayName:this.toolName},toolUIJson:l,toolUIStrings:r,toolHelpFilePath:n}}),this.haveWebToolParametersChanged=(t,e)=>{const o=new Map(t.parameters?.filter(t=>"context"!==t.name&&t.direction!==u)?.map(t=>[t.name,t])),s=Object.keys(e);if(o.size!==s.length)return!0;let a=!1;for(const t of s){const s=o.get(t),i=e[t];if(a=void 0===s||s?.dataType!==i.dataType||s?.parameterType!==i.parameterType,a)break}return a},this.onToolDataChange=t=>{const{toolUIStrings:e}=this.currentToolJSONs??{},o=e?.itemProperties,s=t?.detail,a=s?.toolData??{},r=s?.parameterName??"";void 0!==o&&(0,i.P)(a)&&(a.itemProperties=o);const n=(0,i.t)(this.currentToolJSONs?.toolJson,a),l=(0,i.k)(n);this.currentJobParams={...l};const h=(0,i.K)({toolData:a,keysToRemove:Object.keys(this.currentJobParams)});(0,i.P)(h)&&(this.toolUiParameters=h),this.resetParameterErrorState(r)},this.resetParameterErrorState=t=>{delete this.toolErrorState?.parameterErrorState[t]},this.clearCreditsEstimation=()=>{void 0!==this.creditsElement&&this.creditsElement.clearCreditsEstimation()},this.renderAnalysisTool=()=>{const{toolJson:t,toolUIJson:e,toolUIStrings:o,toolHelpFilePath:r}=this.currentToolJSONs??{},n=r?.replace(t.name,"AnalysisEnvironments").replace("_ra","");return(0,s.h)("div",null,(0,s.h)("analysis-tool",{key:t.name,analysisEngine:this.analysisEngine,closable:!1,usePanel:!1,toolJson:t,toolUIJson:e,toolUIStrings:o,toolHelpFilePath:r,isHelpFileExternalAsset:!0,mapLayers:this.currentMapLayers,mapView:this.mapView,portal:this.portal,portalHelpMap:this.portalHelpMap,serviceUrl:this.webToolServerUrl,skipApplyingDefaults:(0,i.P)(this.toolDataFromHistory),supportsUpload:"Uploads"===t.serviceInfo?.capabilities,user:this.portal.user??void 0,toolData:this.toolDataFromHistory,toolHelpPopover:this.toolHelpPopover,parameterNotificationState:this.toolErrorState.parameterErrorState,options:{showNoParametersMessage:!1===this.isToolPreview},environmentSettings:i.a.context,ref:t=>{this.toolElement=t},onAnalysisToolDataChange:this.onToolDataChange,onAnalysisToolHelpPopoverChange:()=>{(0,i.r)(this.toolHelpPopover),this.toolHelpPopover=this.toolElement?.toolHelpPopover},onAnalysisCustomRuleExecuting:t=>this.isWebToolOpening=t.detail}),(0,s.h)("analysis-tool-settings",{analysisEngine:this.analysisEngine,hidden:this.isToolPreview,portal:this.portal,mapLayers:this.currentMapLayers,toolHelpFilePath:n,environmentSettingsFlags:e?.environmentSettings,hideRasterSettings:this.analysisEngine!==a.A.Raster,hideGeoanalyticsSettings:this.analysisEngine!==a.A.GeoAnalytics,ref:t=>{this.toolSettingsElement=t}}))},this.composeErrorMessage=t=>{const{message:e,key:o,variables:s}=t,a="default"in this.errorStrings?this.errorStrings.default:"",r="request:server"===o?this.errorStrings.jobCurrentParameters:void 0,n=e??this.errorStrings?.[o??""]??this.strings?.[o]??r??a,l={docLink:this.getLearnMoreLink(o??""),...s};return(0,i.l)(n,l)},this.getErrorMessages=()=>this.toolErrorState.toolAppErrorState.filter(t=>t.type===this.validationStatus).map(this.composeErrorMessage),this.renderNoticeMessage=()=>{const t=this.getErrorMessages(),e=t.length>1,o=t.map(t=>(0,s.h)("li",null,t));return e?(0,s.h)("ul",{slot:"message"},o):(0,s.h)("div",{slot:"message",innerHTML:t[0]})},this.renderNoticeLink=()=>{if(this.toolErrorState.toolAppErrorState?.[0]?.key!==i.m.toolPreviewNoParameters)return null;const t=(0,i.G)({url:y.map.modelBuilder.noParameters,basePath:(0,i.i)(this.portal),locale:this.locale,portalUrl:this.portal.restUrl});return(0,s.h)("div",{slot:"link",innerHTML:(0,i.l)(this.strings.toolPreviewNoParametersLink,{docLink:t})})},this.renderCreditEstimation=()=>(0,i.P)(this.webToolJSON)||!0===this.portal.isPortal||!0===(0,i.N)(this.portal)?null:(0,s.h)("analysis-tool-credits",{ref:t=>{this.creditsElement=t},toolSettingsElement:this.toolSettingsElement,toolElement:this.toolElement,toolName:this.toolName,analysisEngine:this.analysisEngine??a.A.Standard,toolJson:this.currentToolJSONs?.toolJson,portal:this.portal}),this.getCalciteNoticeKind=()=>({[i.X.Valid]:void 0,[i.X.Info]:"info",[i.X.Error]:"danger",[i.X.Warning]:"warning"}[this.validationStatus]),this.onBackClick=()=>{this.analysisToolAppPanelChange.emit(),this.isWebToolOpening=!1},this.renderPanel=()=>{const{toolUIStrings:t,toolHelpFilePath:e,toolJson:o}=this.currentToolJSONs??{};let a,r;return(0,i.P)(this.toolName)&&(a=`${(0,i.q)(this.toolName)}${(0,i.x)(this.analysisEngine)}`,r=t?.toolInfo?.[a]??this.toolName),(0,s.h)("calcite-panel",{loading:this.isWebToolOpening,dir:this.dir,closable:this.panelClosable??!1,onCalcitePanelClose:()=>this.analysisToolAppPanelChange.emit(),ref:t=>{this.panelElement=t}},(0,s.h)("calcite-action",{class:"analysis-panel-back-button",icon:"rtl"===this.dir?"chevron-right":"chevron-left",onClick:this.onBackClick,scale:"s",slot:"header-actions-start",text:this.strings.backLabel,title:this.strings.backLabel}),(0,s.h)("slot",{name:E}),this.showHeader&&(0,s.h)("div",{slot:"header-content",ref:t=>{this.headerElement=t},class:"SceneViewer"===this.clientMode?b:""},r),this.showHeader&&(0,s.h)("calcite-action",{label:"",text:"",icon:"information",slot:"header-actions-end",onClick:()=>{this.toolHelpPopover=(0,i.s)(this.toolHelpPopover,{helpUrl:e,helpId:"toolDescription",heading:r,referenceElement:this.headerElement,isHelpFileExternalAsset:!0,portal:this.portal,portalHelpMap:this.portalHelpMap,helpFileName:o.name,analysisEngine:this.analysisEngine,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase,offsetDistance:55,offsetSkidding:10})}}),this.validationStatus!==i.X.Valid&&(0,s.h)("calcite-notice",{open:!0,closable:this.validationStatus===i.X.Error,kind:this.getCalciteNoticeKind(),icon:this.validationStatus===i.X.Info,scale:"m",width:"auto",onCalciteNoticeClose:this.handleCalciteNoticeClose,class:i.S.noticeMarginGlobal},this.renderNoticeMessage(),this.renderNoticeLink()),this.renderAnalysisTool(),!1===this.isToolPreview&&(0,s.h)("div",{slot:"footer",class:f},this.renderCreditEstimation(),(0,s.h)("calcite-button",{appearance:"solid",kind:"brand",width:"half",alignment:"center",scale:"m",disabled:this.runAnalysisDisabled,loading:this.runAnalysisDisabled,slot:"footer-actions",onClick:this.runAnalysisBtnClick},this.strings.runAnalysisLabel),(0,s.h)("calcite-button",{appearance:"outline",kind:"brand",width:"half",alignment:"center",scale:"m",disabled:this.runAnalysisDisabled,slot:"footer-actions",onClick:()=>this.analysisToolAppPanelChange.emit()},this.strings.backLabel)))}}async toolNameChange(t,e){(0,i.P)(t)&&!(0,a.i)(t,e)&&(await this.fetchToolJSONs(),(0,r.s)(this.currentToolJSONs?.toolUIJson,this.analysisEngine,this.readEnvironmentSettings))}async onMapLayersChange(t){this.currentMapLayers=await(0,i.A)(t,this.commonStrings)}async onJobParamsChange(t,e){if(null!=t)try{const o=this.portal?.user??void 0,s=void 0!==this.webToolServerUrl&&void 0!==this.webToolJSON;let n,l={},h=[];if(!(0,a.i)(t,e)&&(0,i.P)(this.toolName)){if(s)n=this.webToolJSON;else{const t=(0,i.$)(this.toolName),e=await this.getCurrentToolJSONs(this.locale,t);n=e?.toolJson}if(void 0!==t&&void 0!==n)try{const{convertedJobParams:e,layers:a,resultingErrorState:c}=await(0,i.n)({jobParams:t,toolJSON:n,uiOnlyParams:this.toolUiParameters??{},availableMapLayers:this.currentMapLayers,toolName:this.toolName});if(l=e,h=a,this.toolErrorState=c,this.toolDataFromHistory={...l,userSettings:{unitSystem:o?.units,hasNAPrivilege:(0,i.B)(o)},...this.toolUiParameters},(0,r.a)(this.toolDataFromHistory?.context),this.currentMapLayers=[...this.currentMapLayers??[],...h],s&&void 0!==n&&void 0!==this.toolUiParameters?.[v]){this.haveWebToolParametersChanged(n,this.toolUiParameters[v])&&(this.validationStatus=i.X.Info,this.toolErrorState.toolAppErrorState=[(0,i.j)({errorKey:i.m.WebToolJSONChanged,type:i.X.Info})])}}catch(t){this.validationStatus=i.X.Warning,this.toolErrorState.toolAppErrorState=[(0,i.j)({errorKey:i.m.CannotReopenTool,type:i.X.Warning})]}}}catch(t){console.error(t)}}onMapViewChange(t){i.a.mapView=t}async portalNameChange(){await this.fetchToolJSONs()}portalHelpMapChange(t){i.a.portalHelpMap=t}async webToolJSONChange(t){if(void 0!==t){this.currentToolJSONs={toolJson:t,toolUIJson:await(0,i.o)(t,`${(0,s.a)("assets")}/t9n/common.t9n.${this.locale}.json`,this.memoizeHelperFetchPath)};const e=t.parameters?.some(t=>"context"===t.name&&"GPString"===t.dataType);if(!1===e&&!this.isToolPreview){const t={name:"context",dataType:p,displayName:"context",description:"Additional settings such as processing extent and output spatial reference.",direction:m,defaultValue:"",parameterType:g,category:""};this.currentToolJSONs.toolJson.parameters?.push(t)}(0,r.s)(this.currentToolJSONs?.toolUIJson,this.analysisEngine,this.readEnvironmentSettings),this.isToolPreview&&(this.validationStatus=i.X.Info,this.toolErrorState.toolAppErrorState=[(0,i.j)({errorKey:(0,i.P)(this.webToolJSON?.parameters)?i.m.toolPreviewWebTool:i.m.toolPreviewNoParameters,type:i.X.Info})])}}async componentWillLoad(){const{rtl:t,locale:e}=(0,i.g)(this.hostElement);({strings:this.strings}=await(0,i.u)(this.hostElement,(0,s.a)("."))),this.dir=!0===t?"rtl":"ltr",this.locale=e;const o=`${(0,s.a)("assets")}/t9n/validation/errors.t9n.${e??"en-US"}.json`,a=`${(0,s.a)("assets")}/t9n/gpmessage/gpmessage.t9n.${e??"en-US"}.json`,r=`${(0,s.a)("assets")}/t9n/common.t9n.${e??"en-US"}.json`;try{const t=await fetch(o);this.errorStrings=await t.json()}catch(t){console.error(t)}try{const t=await fetch(a);this.gpMessages=await t.json()}catch(t){console.error(t)}try{const t=await fetch(r);this.commonStrings=await t.json()}catch(t){console.error(t)}void 0!==this.toolName&&void 0===this.webToolJSON&&await this.toolNameChange(this.toolName,void 0),void 0!==this.webToolJSON&&await this.webToolJSONChange(this.webToolJSON),void 0!==this.mapLayers&&await this.onMapLayersChange(this.mapLayers),void 0!==this.jobParams&&await this.onJobParamsChange(this.jobParams,void 0),void 0===this.jobParams&&void 0===this.currentJobParams&&this.onToolDataChange({detail:{toolData:this.toolElement?.toolData,parameterName:void 0}}),this.clearCreditsEstimation(),i.a.mapView=this.mapView,i.a.portal=this.portal,this.portalHelpMapChange(this.portalHelpMap)}componentDidLoad(){setTimeout(()=>requestAnimationFrame(()=>this.panelElement?.setFocus?.()),1),this.analysisToolAppLoaded.emit()}componentDidRender(){void 0!==this.toolElement&&null!==this.toolElement&&(i.a.analysisToolRef=this.toolElement)}disconnectedCallback(){(0,i.r)(this.toolHelpPopover),this.onToolDataChange({detail:{toolData:this.toolElement?.toolData,parameterName:void 0}}),this.analysisToolAppDisconnect.emit({jobParams:(0,i.d)(this.currentJobParams??{},this.toolName,this.toolUiParameters),toolUiParameters:this.toolUiParameters}),i.a.analysisToolRef=void 0,i.a.context={},i.a.settingsSelectedExtentOption=i.E.Default,i.a.settingsSelectedOutSpatialRefOption=i.O.SameAsInput,this.validationStatus=i.X.Valid,this.toolErrorState={toolAppErrorState:[],parameterErrorState:{}}}onAnalysisStudioHistoryOpenTool(){this.clearCreditsEstimation()}onJobStatus(t){this.analysisToolAppJobStatusChange.emit(t.detail),void 0!==t.detail.submissionData&&(this.runAnalysisDisabled=!1)}onJobResultDataComplete(t){this.analysisToolAppJobResultDataComplete.emit(t.detail)}onAnalysisToolCreditsValidationFailure(t){const e=[t.detail];this.validationStatus=(0,i.h)(e),this.toolErrorState=(0,i.c)(this.toolErrorState,e),this.validationStatus===i.X.Error&&this.scrollToTop()}get isToolPreview(){return void 0!==this.webToolJSON&&void 0===this.webToolServerUrl}async fetchToolJSONs(){if((0,i.P)(this.toolName)&&void 0!==this.portal){const t=(0,i.y)(this.webToolServerUrl)?(0,i.$)(this.toolName):this.toolName;if(void 0===this.travelModeInfo&&!0===(0,i.v)(t))try{this.travelModeInfo=await(0,a.M)(this.portal)}catch{}const e=await this.getCurrentToolJSONs(this.locale,t);this.currentToolJSONs={...e}}}generateAnalysisParams(){if(void 0===this.currentJobParams)throw new Error("jobParams are undefined");const t=void 0!==this.webToolServerUrl&&void 0!==this.webToolJSON,e=(0,i.H)(this.currentToolJSONs.toolJson),o=(0,i.d)(this.currentJobParams,this.toolName,this.toolUiParameters);return{jobParamsWithContext:o,jobParamsPayload:(0,i.w)({jobParams:o,toolData:this.toolElement?.toolData??{},toolUIJson:this.currentToolJSONs.toolUIJson?.UIparameters??[],toolName:this.toolName,toolJSON:this.currentToolJSONs?.toolJson,isPortal:this.portal?.isPortal,isWebTool:t}),resultParams:e}}async executeAnalysis(t=!1){if(this.onToolDataChange({detail:{toolData:this.toolElement?.toolData,parameterName:void 0}}),void 0!==this.currentJobParams){this.runAnalysisDisabled=!0,this.analysisToolAppJobSubmissionAttempt.emit(!0);try{const{jobParamsWithContext:e,jobParamsPayload:o,resultParams:s}=this.generateAnalysisParams();let n;n=(0,i.y)(i.a.mapLevelContext.creditUsageSettings)&&!1===this.portal?.isPortal&&!(0,i.N)(this.portal)?i.D:!0===i.a.mapLevelContext?.creditUsageSettings?.askConfirmation?i.a.mapLevelContext?.creditUsageSettings?.creditThreshold:void 0;const l={creditThreshold:n,skipCreditChecks:t};await(0,a.F)({toolName:this.toolName,portal:this.portal,analysisEngine:this.analysisEngine,analysisType:void 0!==this.webToolServerUrl?a.a.WebTool:a.a.Tool,jobParams:(0,r.c)(e),jobParamsPayload:(0,r.c)(o),resultParams:s,containerElement:this.appContainer??this.hostElement,toolUiParameters:this.toolUiParameters??{},gpMessages:s.includes("processInfo")?this.gpMessages:void 0,webToolServerUrl:this.webToolServerUrl,executionType:this.webToolJSON?.executionType??d,webToolJSON:this.webToolJSON,creditCheckOptions:l})}catch(t){this.handleExecutionFailure(t)}}}async handleExecutionFailure(t){const e=t.name;if(e===i.m.CreditThresholdExceededError&&"cause"in t&&void 0!==t.cause&&null!==t.cause&&"object"==typeof t.cause&&"estimatedCredits"in t.cause&&"creditThreshold"in t.cause&&"number"==typeof t.cause.estimatedCredits&&"number"==typeof t.cause.creditThreshold){const{estimatedCredits:e,creditThreshold:o}=t.cause;return void(!0===await this.displayCreditsThresholdModal(e,o)?this.executeAnalysis(!0):(this.runAnalysisDisabled=!1,this.analysisToolAppJobSubmissionAttempt.emit(!1)))}if(e===i.m.NoPermissionToAccessTool){const e=this.getLearnMoreLink(i.m.NoPermissionToAccessTool);void 0!==e&&(t.message=(0,i.l)(t.message,{docLink:e}))}if(this.runAnalysisDisabled=!1,this.analysisToolAppJobSubmissionAttempt.emit(!1),this.validationStatus=i.X.Error,this.toolErrorState.toolAppErrorState=[(0,i.j)({error:t})],"messages"in t&&Array.isArray(t.messages)){!0===t.messages.some(t=>"error"===t.type&&t.description?.startsWith("Failed to execute"))&&(this.toolErrorState.toolAppErrorState=[(0,i.j)({errorKey:i.m.CreditEstimationExecutionFailure})])}this.scrollToTop()}async displayCreditsThresholdModal(t,e){const o=(0,i.G)({url:y.map.OtherHelpLinks.creditThreshold,basePath:(0,i.i)(this.portal),locale:this.locale,portalUrl:this.portal.restUrl}),s={...this.strings.creditThresholdModal,creditEstimate:(0,i.l)(this.strings.creditThresholdModal.creditEstimate,{cost:(0,i.M)(t)}),creditThreshold:(0,i.l)(this.strings.creditThresholdModal.creditThreshold,{threshold:(0,i.M)(e)})},{modalElement:a,modalResult:n}=(0,r.b)(s,o);return(0,i.e)(document,a),n}scrollToTop(){void 0!==this.panelElement&&setTimeout(()=>{this.panelElement?.scrollContentTo({top:0,behavior:"auto"})},250)}getLearnMoreLink(t){const e=!0===this.portal?.isPortal?S.map:y.map;let o;if(t in e.OtherHelpLinks.errorMessages){const s=e.OtherHelpLinks.errorMessages[t];o=(0,i.G)({url:!0===this.portal?.isPortal&&void 0!==this.portalHelpMap?this.portalHelpMap?.m[s]:s,basePath:(0,i.i)(this.portal),locale:this.locale,portalUrl:this.portal.restUrl})}return o}render(){return(0,s.h)(s.H,{key:"0b5e2ca48f87cc86b58e511c69d5c320145f21ed"},!0===this.usePanel?this.renderPanel():this.renderAnalysisTool())}static get assetsDirs(){return["t9n","assets"]}get hostElement(){return(0,s.c)(this)}static get watchers(){return{analysisEngine:["toolNameChange"],toolName:["toolNameChange"],mapLayers:["onMapLayersChange"],jobParams:["onJobParamsChange"],mapView:["onMapViewChange"],portal:["portalNameChange"],portalHelpMap:["portalHelpMapChange"],webToolJSON:["webToolJSONChange"]}}};T.style=":root{display:flex}.control-spacing{margin-bottom:var(--analysis-three-quarter-spacing)}.label-container{display:flex;margin-bottom:var(--analysis-quarter-spacing);gap:var(--analysis-quarter-spacing)}.analysis-border{border:1px solid var(--analysis-ui-border-input)}.notice-margin-global{margin:var(--analysis-full-spacing) var(--analysis-three-quarter-spacing)}.analysis-panel-back-button{border-width:0;border-color:var(--calcite-color-border-3);border-style:solid;border-inline-end-width:1px}:host{display:flex;flex:1 1 auto;overflow:hidden}.tool-footer{width:100%}.header-scene-viewer{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-medium)}";o(32513),o(588),o(44345),o(55448),o(18423),o(91813),o(21255),o(54312),o(34031),o(9316),o(13661),o(43786),o(61320),o(64016),o(56451),o(6550),o(2924),o(5258),o(52373),o(33752),o(53976),o(49403),o(77462),o(23054),o(73645),o(82567),o(28927),o(35970),o(5933),o(57295),o(72349),o(89962),o(97703),o(71802),o(74791),o(43284),o(22741)},78572:(t,e,o)=>{o.d(e,{a:()=>P,b:()=>N,c:()=>S,s:()=>C});var s=o(68810),a=o(190);var i=Date.now;var r,n,l,h=s.f?function(t,e){return(0,s.f)(t,"toString",{configurable:!0,enumerable:!1,value:(o=e,function(){return o}),writable:!0});var o}:function(t){return t},c=(r=h,n=0,l=0,function(){var t=i(),e=16-(t-l);if(l=t,e>0){if(++n>=800)return arguments[0]}else n=0;return r.apply(void 0,arguments)}),d=Math.max;function p(t,e){for(var o=0,a=(e=(0,s.g)(e,t)).length;null!=t&&o<a;)t=t[(0,s.t)(e[o++])];return o&&o==a?t:void 0}var m=s.S?s.S.isConcatSpreadable:void 0;function u(t){return(0,s.h)(t)||(0,s.j)(t)||!!(m&&t&&t[m])}function g(t){return(null==t?0:t.length)?function(t,e,o,a,i){var r=-1,n=t.length;for(o||(o=u),i||(i=[]);++r<n;){var l=t[r];o(l)?(0,s.k)(i,l):i[i.length]=l}return i}(t):[]}var v=1,y=4;function S(t){return(0,s.c)(t,v|y)}function f(t,e){return null!=t&&e in Object(t)}function b(t,e){return null!=t&&function(t,e,o){for(var a=-1,i=(e=(0,s.g)(e,t)).length,r=!1;++a<i;){var n=(0,s.t)(e[a]);if(!(r=null!=t&&o(t,n)))break;t=t[n]}return r||++a!=i?r:!!(i=null==t?0:t.length)&&(0,s.l)(i)&&(0,s.m)(n,i)&&((0,s.h)(t)||(0,s.j)(t))}(t,e,f)}function E(t,e){return function(t,e,o){for(var a=-1,i=e.length,r={};++a<i;){var n=e[a],l=p(t,n);o(l,n)&&(0,s.d)(r,(0,s.g)(n,t),l)}return r}(t,e,function(e,o){return b(t,o)})}var T=function(t){return c(function(t,e,o){return e=d(void 0===e?t.length-1:e,0),function(){for(var s=arguments,a=-1,i=d(s.length-e,0),r=Array(i);++a<i;)r[a]=s[e+a];a=-1;for(var n=Array(e+1);++a<e;)n[a]=s[a];return n[e]=o(r),function(t,e,o){switch(o.length){case 0:return t.call(e);case 1:return t.call(e,o[0]);case 2:return t.call(e,o[0],o[1]);case 3:return t.call(e,o[0],o[1],o[2])}return t.apply(e,o)}(t,this,n)}}(t,void 0,g),t+"")}(function(t,e){return null==t?{}:E(t,e)});function P(t){(0,a.P)(t)?((0,a.P)(t?.outSR)?a.a.settingsSelectedOutSpatialRefOption=a.O.BrowseCS:a.a.settingsSelectedOutSpatialRefOption=a.O.SameAsInput,(0,a.P)(t?.extent)?(a.a.settingsSelectedExtentOption=a.E.Coordinates,a.a.settingsSelectedRasterExtentOption=a.E.Coordinates,a.a.settingsUseDifferentProcessingExtentForRA&&(t.rasterExtent=t.extent)):(a.a.settingsSelectedExtentOption=a.E.Default,a.a.settingsSelectedRasterExtentOption=a.E.Default),a.a.context=t??{}):(a.a.context={},a.a.settingsSelectedOutSpatialRefOption=a.O.SameAsInput,a.a.settingsSelectedExtentOption=a.E.Default,a.a.settingsSelectedRasterExtentOption=a.E.Default)}function C(t,e,o){void 0!==o&&(a.a.mapLevelContext=o);const{settingsSelectedExtentOption:i,settingsSelectedRasterExtentOption:r,settingsUseDifferentProcessingExtentForRA:n,settingsSelectedOutSpatialRefOption:l,context:h}=a.a.mapLevelContext;void 0!==i&&(a.a.settingsSelectedExtentOption=i),void 0!==r&&(a.a.settingsSelectedRasterExtentOption=r),void 0!==n&&(a.a.settingsUseDifferentProcessingExtentForRA=n),void 0!==l&&(a.a.settingsSelectedOutSpatialRefOption=l);const c=t?.environmentSettings,d=[];void 0!==c?(void 0!==c.standard?d.push(...c.standard):d.push(...s.n),void 0!==c.raster?d.push(...c.raster):"raster"===e&&d.push(...s.o)):(d.push(...s.n),"raster"===e&&d.push(...s.o)),a.a.context=T(h??{},d)}const w={modal:{width:"s",kind:"info"},buttonPrimary:{slot:"primary"},buttonSecondary:{slot:"secondary",appearance:"outline"},header:{slot:"header",style:"\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    "},content:{slot:"content"}},A=(t,e,o,s=!1)=>{const a=document.createElement(t);var i,r;return i=a,r=o,Object.keys(r).forEach(t=>{i.setAttribute(t,r[t])}),s?a.innerHTML=e:a.innerText=e,a};function N(t,e){const{modal:o,buttonPrimary:s,buttonSecondary:i,header:r,content:n}=w,{continueRun:l,cancelRun:h,thresholdExceeded:c,creditEstimate:d,creditThreshold:p,heading:m,learnMore:u}=t,g=A("calcite-modal","",o),v=A("div","",r),y=A("div",m,{});v.appendChild(y);const S=A("calcite-button",l,s),f=A("calcite-button",h,i),b=A("div","",n);b.appendChild(A("p",c,{}));const E=document.createElement("ul");E.appendChild(A("li",d,{})),E.appendChild(A("li",p,{})),b.appendChild(E);const T=(0,a.l)(u,{docLink:e}),P=A("calcite-link",T,{"icon-end":"launch",scale:"s",target:"_blank",href:e});b.appendChild(P),g.appendChild(v),g.appendChild(b),g.appendChild(S),g.appendChild(f);const C=new Promise(t=>{const e=o=>{let s=!1;s=o.target.getAttribute("slot")===w.buttonPrimary.slot,g.removeEventListener("calciteModalClose",e),S.removeEventListener("click",e),f.removeEventListener("click",e),g.open=!1,(0,a.r)(g),t(s)};g.addEventListener("calciteModalClose",e),S.addEventListener("click",e),f.addEventListener("click",e)});return{modalElement:g,modalResult:C}}}}]);