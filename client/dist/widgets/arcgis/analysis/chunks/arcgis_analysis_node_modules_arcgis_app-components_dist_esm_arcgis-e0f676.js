/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e0f676.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e0f676"],{931:(e,t,i)=>{i.d(t,{l:()=>a});var n=i(93814);const a=async(e,t)=>(await n.e.exports.loadModules(e,t)).map(e=>e.__esModule&&e.default?e.default:e)},4429:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>d,c:()=>r,d:()=>c,e:()=>a,f:()=>n,g:()=>h,i:()=>p,m:()=>s,t:()=>o,u:()=>u});const n=(e,t)=>{let i,n="idle";const a=(...a)=>new Promise(r=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),r(e(...a))):r(null);break;case"invoked":clearTimeout(i),n="idle",r(e(...a));break;case"cancelled":clearTimeout(i),n="idle",r(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout(()=>(n="idle",r(e(...a))),t)}});return a.flush=function(...e){return n="flushed",a(...e)},a.invoke=function(...e){return n="invoked",a(...e)},a.cancel=function(...e){return n="cancelled",a(...e)},a.getStatus=function(){return n},a};function a(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(e){return null!=e}async function s(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise(t=>setTimeout(t,e))}const l=(e,t)=>Object.fromEntries((e||[]).map(e=>{const{key:i,data:n}=t(e);return[i,n]})),c=(e,t)=>e.length===t.length&&e.reduce((e,i)=>e&&t.indexOf(i)>-1,!0);function u(e,t){const i=[],n={};return e.forEach(e=>{const a=t(e);null==n[a]&&(n[a]=e,i.push(e))}),i}function d(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter(e=>{let n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}const h=(e,t)=>[...Array(Math.ceil(e.length/t))].map((i,n)=>e.slice(t*n,t+t*n)),p=(e,t)=>e.includes(t)},12192:(e,t,i)=>{i.d(t,{a:()=>s,g:()=>c});var n=i(15332),a=i(94984),r=i(87849);function s(e){var t,i,r;const s=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(r=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===r?void 0:r.documentElement,o=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return a.l.has(o)?a.l.get(o):a.l.has(o.slice(0,2))?a.l.get(o.slice(0,2)):"en"}const o={};function l(e,t){const i=`${e}${t}`;return o[i]||(o[i]=function(e,t){return new Promise((i,n)=>{fetch((0,r.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then(e=>{e.ok?i(e.json()):n()},()=>n())})}(e,t)),o[i]}async function c(e,t){const i=t||e.tagName.toLowerCase(),r=s(e),o=function(e){var t,i,r;const s=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(r=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===r?void 0:r.documentElement,o=((null==s?void 0:s.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return a.l.has(o)?a.l.get(o):a.l.has(o.slice(0,2))?o:"en"}(e);let c;try{c=await l(i,r)}catch(e){console.warn(`no locale for ${i} (${r}) loading default locale en.`),c=await l(i,"en")}return[c,r,o]}},54251:(e,t,i)=>{i.d(t,{g:()=>a});var n=i(59317);function a(e){var t,i,a,r;return null!=e||(e=null===n.c||void 0===n.c?void 0:n.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(a=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===a?void 0:a.token)||(null===(r=null==e?void 0:e.portalUser)||void 0===r?void 0:r.token)||""}},66497:(e,t,i)=>{i.r(t),i.d(t,{arcgis_image_upload_from_map:()=>l});var n=i(87849),a=i(94984),r=i(931),s=i(12192),o=i(83692);i(15332),i(93814),i(59317),i(37762),i(41473),i(54251);const l=class{constructor(e){(0,n.r)(this,e),this.arcgisImageUploadFromMapReady=(0,n.c)(this,"arcgisImageUploadFromMapReady",7),this.arcgisMapLoadFail=(0,n.c)(this,"arcgisMapLoadFail",7),this.isRTL=!1,this.lang="en",this.handleBasemapToggle=()=>{const e=this.container.querySelector(".esri-basemap-gallery");"block"===e.style.display?e.style.display="none":e.style.display="block"},this.portal=void 0,this.itemId=void 0,this.changeBasemapText=void 0,this.loadingText=void 0,this.jsapiUrl=void 0,this.loading=!0,this.item=void 0,this.currentItem=void 0}async componentWillLoad(){this.isRTL="rtl"===(0,a.g)(this.el),this.lang=(0,s.a)(this.el)}async componentDidLoad(){var e,t,i;this.el.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${this.jsapiUrl}/themes/light/main.css" />`);try{const[n,a,s,o,l,c,u,d]=await(0,r.l)(["esri/portal/PortalItem","esri/Map","esri/WebMap","esri/layers/Layer","esri/layers/FeatureLayer","esri/layers/GraphicsLayer","esri/rest/featureService/FeatureService","esri/layers/WFSLayer"]);if(this.currentItem=this.item,"Web Scene"!==this.currentItem.type&&(this.map=new a({basemap:"streets-vector"})),"Web Experience"===this.currentItem.type){const i=await this.getSubItemData(),a=(null===(t=null===(e=null==i?void 0:i.dataSources)||void 0===e?void 0:e[Object.keys(i.dataSources)[0]])||void 0===t?void 0:t.itemId)||null;a&&(this.currentItem=new n({id:a,portal:this.portal}),await this.currentItem.load())}const h=["Image Service","Feature Service","Feature Collection","Map Service","Vector Tile Service","WFS"];let p="gray";if(this.portal.defaultBasemap&&(p=this.portal.useVectorBasemaps?this.portal.defaultVectorBasemap:this.portal.defaultBasemap),"Web Scene"===this.currentItem.type)this.makeSceneView();else if("Web Map"!==this.currentItem.type)this.map.basemap=p,this.makeMapView();else{this.map.basemap=p,this.webMap=new s({portalItem:{id:this.currentItem.id},extent:this.currentItem.extent});const e=await this.currentItem.fetchData();if(parseFloat(e.version)<2)this.makeMapView(!0);else try{await this.webMap.load();const e=new c({id:"areaGraphics"});this.map.add(e),this.makeMapView()}catch(e){this.makeMapView(!0)}}if(h.includes(this.currentItem.type))if("WFS"===this.currentItem.type){const e=new d({url:this.currentItem.url,name:this.currentItem.title||"WFS Layer"});this.map.add(e)}else if("Map Service"===this.currentItem.type){const e=new u({url:this.currentItem.url});await e.load(),this.currentItem.extent=e.initExtent||e.fullExtent||this.currentItem.extent,(null===(i=this.mapView)||void 0===i?void 0:i.extent)&&(this.mapView.extent=this.currentItem.extent),e.layerInfos.forEach(e=>{const t=new l({url:e.url});t.visible=!0,this.map.add(t),t.when(()=>{t.popupEnabled=!1,t.queryExtent().then(e=>{try{this.mapView.goTo(e.extent)}catch(e){console.error(e)}})})})}else{const e=await o.fromPortalItem({portalItem:this.currentItem});e.visible=!0,this.map.add(e),e.when(()=>{e.popupEnabled=!1})}this.loading=!1}catch(e){console.error(e),this.arcgisMapLoadFail.emit(),this.loading=!1}}async getSubItemData(){let e;try{const t=`${this.currentItem.itemCdnUrl}/data?f=json`;e=await(0,o.r)(t)}catch(e){console.error(e)}return e}async makeSceneView(){try{const[e]=await(0,r.l)(["esri/WebScene"]),[t]=await(0,r.l)(["esri/views/SceneView"]);this.webScene=new e({portalItem:{id:this.currentItem.id}}),this.sceneView=new t({map:this.webScene,container:this.container}),this.loading=!1,this.addWidgets();const i=this.currentItem.extent||this.portal.defaultExtent;return void(i&&(this.sceneView.extent=i))}catch(e){console.error(e)}}async makeMapView(e){try{const[t]=await(0,r.l)(["esri/views/MapView"]),i=e||!this.webMap?this.map:this.webMap;this.mapView=new t({map:i,zoom:2,center:[0,0],container:this.container}),i.watch("basemap.title",()=>{this.container.querySelector(".esri-basemap-gallery").style.display="none"}),await this.mapView.when(),this.addWidgets();const n=this.currentItem.extent||this.portal.defaultExtent;n&&(this.mapView.extent=n)}catch(e){console.error(e)}}async addWidgets(){try{const[e,t,i]=await(0,r.l)(["esri/widgets/Search","esri/widgets/BasemapGallery","esri/intl"]);this.lang&&i.setLocale(this.lang);const n=new e({view:this.mapView,popupEnabled:!1,resultGraphicEnabled:!1,portal:this.portal}),a=n.viewModel;n.viewModel.allSources.on("change",()=>{a.allSources.forEach(e=>{e.zoomScale=null})}),this.mapView.ui.add(n,this.isRTL?"top-left":"top-right"),n.on("select-result",e=>{this.mapView.goTo(e.result.extent)});const s=new t({view:this.mapView,source:{portal:this.portal}});this.mapView.ui.add(s),this.arcgisImageUploadFromMapReady.emit(this.mapView)}catch(e){}}render(){return(0,n.h)(n.H,{key:"239c1db77bea06bb18bf0cf3dbabe5774a2b8faf"},(0,n.h)("div",{key:"1a133830e8e682e145d006ee7388caf0a61e1a67",class:{"from-map-wrapper":!0,"is-rtl":this.isRTL}},(0,n.h)("div",{key:"194f83050a0491cb6e14cf9fd9f21c7c03b7bf41",class:"map-container",ref:e=>this.container=e}),this.loading?(0,n.h)("div",{class:"loader-container"},(0,n.h)("calcite-loader",{label:this.loadingText})):(0,n.h)("div",{class:"basemap-toggle",onClick:this.handleBasemapToggle},this.changeBasemapText)))}get el(){return(0,n.a)(this)}};l.style=".from-map-wrapper{position:relative;padding:0.5rem}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.map-container{width:600px;height:400px}.esri-zoom{position:absolute;top:50px;left:538px}.is-rtl .esri-zoom{left:0}.basemap-toggle{position:absolute;cursor:pointer;background-color:var(--calcite-color-foreground-1);padding:0.5rem;font-size:0.875rem;top:1.5rem;left:1.5rem;max-width:50%;box-shadow:0 1px 2px rgba(0, 0, 0, 0.3)}.is-rtl .basemap-toggle{right:1.5rem;left:auto}:host .esri-basemap-gallery{display:none;overflow-y:auto;max-height:310px;top:57px;left:15px;min-width:300px}.is-rtl .esri-basemap-gallery{left:auto;right:15px}.esri-basemap-gallery__item-thumbnail{display:none}.esri-search__autocomplete{width:100%}"},83692:(e,t,i)=>{i.d(t,{a:()=>v,b:()=>m,c:()=>p,f:()=>d,g:()=>b,i:()=>h,p:()=>w,r:()=>g});var n=i(59317),a=i(4429),r=i(931),s=i(41473),o=i(54251);const l={},c={},u={};async function d(e,t,i,n){var a,r,s,o;const d=null===(r=null===(a=u[t])||void 0===a?void 0:a[i])||void 0===r?void 0:r.expireAt,h=!!d&&(new Date).getTime()>d;if((null===(s=l[t])||void 0===s?void 0:s[i])&&!h)return l[t][i];c[t]||(c[t]={}),c[t][i]&&!h||(c[t][i]=e());const p=await c[t][i];if(l[t]||(l[t]={}),u[t]||(u[t]={}),l[t][i]=p,n){const{expireAfter:e,getExpireAfterFromResult:a}=n,r=a||e?(new Date).getTime()+(null!==(o=null==a?void 0:a(p))&&void 0!==o?o:e):null;u[t][i]=Object.assign(Object.assign({},u[t][i]),{expireAt:r})}return p}function h(e,t){var i;return null===(i=null==l?void 0:l[e])||void 0===i?void 0:i[t]}const p=(e,t)=>{var i,n;t?(null===(i=l[e])||void 0===i||delete i[t],null===(n=c[e])||void 0===n||delete n[t]):(delete l[e],delete c[e])};function m(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}async function v(e,t,i={},n){const[a]=await(0,r.l)(["esri/request"]);e.includes("f=")||t.append("f","json");const s=(0,o.g)();return s&&!t.has("token")&&t.append("token",s),new Promise((r,s)=>{a(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:n||"auto"})).then(e=>{r(e.data)}).catch(e=>s(e))})}async function g(e,t={},i={},a,s){const[o]=await(0,r.l)(["esri/request"]),{api:l,portal:c}=n.c,{customToken:u,addTokenManually:d,addSSL:h,useProxy:p}=i,m=Object.assign({},t);if(e.includes("f=")||!0===(null==s?void 0:s.excludeJson)||(m.f="json"),u)m.token=u;else if(!1!==d){const e=await b(c);e&&(m.token=e)}const v=!1===h?e:function(e){var t;const{config:i}=n.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}(e);if(3===l){const e=Object.assign({url:v,content:m,timeout:i.timeout||0},null==s?void 0:s.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return o(e,"post"===a?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:m,method:a||"auto"},i),{timeout:i.timeout||0,useProxy:p}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await o(v,e)).data}}const f=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const w=async(e,t,i)=>{var n,r;const s=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],o=null!==(r=null==t?void 0:t.successStatuses)&&void 0!==r?r:["completed","Completed","COMPLETED"];let l=0;const c=async()=>{const n=await g(e,null==t?void 0:t.requestParams,{},i),r=n.status||n.jobStatus;if(s.includes(r))return await(0,a.t)((u=l++,1e3*f[u>-1&&u<f.length-1?u:f.length-1])),c();if(o.includes(r)||"failed"===r||"esriJobFailed"===r)return n;throw n;var u};try{return c()}catch(e){throw console.error(e),e}},b=async e=>{var t;if(!(null==e?void 0:e.isPortal)||!(0,s.i)(e))return(0,o.g)(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,s.i)(e))return;const{token:i}=await d(()=>y(e),"platformSelf",null!==(t=m(e.user))&&void 0!==t?t:e.id,{getExpireAfterFromResult:e=>e.expires_in});return i},y=async e=>{const t=await(async e=>{var t,i;const[n]=await(0,r.l)(["esri/identity/IdentityManager"]);return null!==(i=null===(t=(await d(()=>n.getCredential((0,s.g)(e),{oAuthPopupConfirmation:!1}),"credential",m(e.user))).oAuthState)||void 0===t?void 0:t.appId)&&void 0!==i?i:"arcgisonline"})(e),i={"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return g(`${(0,s.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:i,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:i}})}},94984:(e,t,i)=>{i.d(t,{C:()=>o,a:()=>d,b:()=>u,f:()=>l,g:()=>s,l:()=>r,s:()=>p});var n=i(15332),a=i(931);const r=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function s(e){return function(e,t,i){const a=(0,n.c)(e,`[${t}]`);return a?a.getAttribute(t):i}(e,"dir","ltr")}const o={rtl:"arcgis--rtl"};async function l(e,t){const{api:i,type:n,places:r}=t||{};if(3===i){const[i]=await(0,a.l)(["dojo/number"]);return i.format(e,{type:n,places:r,pattern:null==t?void 0:t.pattern})}const[s]=await(0,a.l)(["esri/intl"]),o=s.convertNumberFormatToIntlOptions({places:r,style:n,digitSeparator:!0});return s.formatNumber(e,Object.assign(Object.assign({},o),{style:n}))}const c={};function u(e,t){let i=document.documentElement.lang;const n="bs"===i;if(n&&(i="hr"),t){const t=`${i}-full`,n={dateStyle:"full",timeStyle:"long"};return c[t]||(c[t]=new Intl.DateTimeFormat(i,n)),c[t].format(e)}const a={year:"numeric",month:n?"numeric":"short",day:"numeric"};return c[i]||(c[i]=new Intl.DateTimeFormat(i,a)),c[i].format(e)}function d(e,t,i,n){const a=null!=e?e:"en";let r=t.unknown;return(1===i||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(a))&&(r=t.single),1!==i&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(a)&&(r=t.multiple),p(r,Object.assign(Object.assign({},n),{number:i}))}const h=/\$\{([^}]+)\}/g;function p(e,t,i=h){let n=e;try{n=e.replace(i,(e,i)=>function(e,t){const i=e.split(".").reduce((e,t)=>e[t],t);return"string"==typeof i||"number"==typeof i?i:e}(i,t).toString())}catch(e){console.error(e)}return n}}}]);