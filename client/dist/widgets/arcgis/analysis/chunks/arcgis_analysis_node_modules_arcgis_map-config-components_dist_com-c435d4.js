/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-c435d4.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-c435d4"],{61789:(e,l,t)=>{t.r(l),t.d(l,{ArcgisMapConfigSmartMappingTypeAddValue:()=>f});var a=t(73679),n=t(4395),i=t(5294),s=t(52797),u=t(56451),o=t(48103),r=t(39423),d=t(24114),p=(t(54312),t(44345),t(55448),t(34031),t(63438),t(5933),t(1225)),c=(t(89704),t(18423),t(96086),t(91813),t(21255),t(13078),t(21303),t(12627),t(31521),t(23054),t(5077),t(23795),t(17902),t(87420),t(30161),t(81734),t(83552),t(77462),t(49403),t(66617),t(10628),t(59640),t(64451),t(6176),t(10454),t(29614),t(94916),t(52554),t(2156),t(4038),t(49851),t(75054),t(15223),t(70169),t(92264)),h=(t(85681),t(18444),t(42411),t(9767),t(38218),t(91914),t(86605),t(68196),t(440),t(46547),t(28927),t(6238),t(7299),t(85643)),m=t(73801);class f extends m.WF{constructor(){super(...arguments),this.popoverNode=(0,h._)(),this.panelNode=(0,h._)(),this.valueInputMessageNode=(0,h._)(),this.labelInputNode=(0,h._)(),this.doneButtonNode=(0,h._)(),this.isInt=!1,this.userTouchedLabel=!1,this.arcgisSmartMappingTypeAddValuePopoverClose=(0,m.lh)(),this.arcgisSmartMappingTypeAddValuePopoverNewValue=(0,m.lh)()}static{this.properties={flowItemNode:0,referenceNode:0,groupIdx:9,smartMappingState:0}}load(){const{smartMappingState:e}=this,{allUniqueValues:l}=e,t=(0,p.g)(e);this.allValues=l?.map(e=>`${e.value}`),t.uniqueValueGroups.forEach(e=>{e.classes.forEach(e=>{const l=e.values?.[0].value;this.allValues.includes(`${l}`)||this.allValues.push(`${l}`)})}),this.field=(0,p.K)(e,t.field),this.isDate=this.field?.simpleFieldType===p.J.DATE,this.isNumber=this.field?.simpleFieldType===p.J.NUMBER,this.isInt=!!this.field&&["small-integer","integer","long"].includes((0,p.L)(e,this.field.layerField)||"string")}loaded(){this.panelNode.value?.setFocus()}divRefHandler(e){if(e){const l=this.flowItemNode?.getBoundingClientRect().width;e.style.padding="15px",e.style.width=`${l?l+20:280}px`}}datePickerRefHandler(e){e&&(this.valueInputNode=e)}numberInputRefHandler(e){e&&(this.valueInputNode=e)}stringInputRefHandler(e){e&&(this.valueInputNode=e)}addValue(e,l){const{smartMappingState:t}=this,a=(0,p.g)(t),n=i.clone(a.uniqueValueInfos.find(e=>["simple-marker","simple-line","simple-fill","cim"].includes(e.symbol?.type??""))?.symbol||(0,p.e)(t,(0,p.d)(t))),s=(0,p.M)(t).colors,c=new u.default(s[a.uniqueValueInfos.length%10]);c&&(0,p.y)(n,c);let h=a.uniqueValueGroups;-2===this.groupIdx&&(h=[new d.default({heading:void 0,classes:[]})],this.groupIdx=0),h[this.groupIdx].classes.push(new r.default({values:[new o.default({value:l})],label:e,symbol:n})),a.uniqueValueGroups=h,this.arcgisSmartMappingTypeAddValuePopoverNewValue.emit()}handleAddDate(e){const{smartMappingState:l}=this,{allUniqueValues:t}=l,a=(0,p.g)(l),n=t?.map(e=>`${e.value}`);a.uniqueValueGroups.forEach(e=>{e.classes.forEach(e=>{const l=e.values?.[0].value;n.includes(`${l}`)||n.push(`${l}`)})});const i=(0,p.K)(l,a.field);this.userTouchedLabel||(this.labelInputNode.value.value=(0,c.g)(l,e,i)),this.valueInputMessageNode.value.hidden=!n.includes(e),this.doneButtonNode.value.disabled=!e.length||n.includes(e)}handleAddNumber(e){if(e.length&&this.isInt){let l=`${Math.round(Number.parseFloat(e))}`;l.includes(".")&&(l=l.substring(0,l.indexOf("."))),l!==e&&(e=l)}if(!this.userTouchedLabel){const l=this.isInt?Number.parseInt(e):Number.parseFloat(e);this.labelInputNode.value.value=s.formatNumber(l)}this.valueInputMessageNode.value.hidden=!this.allValues.includes(e),this.doneButtonNode.value.disabled=!e.length||this.allValues.includes(e)}handleAddString(e){this.userTouchedLabel||(this.labelInputNode.value.value=e),this.valueInputMessageNode.value.hidden=!this.allValues.includes(e),this.doneButtonNode.value.disabled=!e.length||this.allValues.includes(e)}render(){const{_messages:e}=this.smartMappingState;return n.qy`<calcite-popover .referenceElement=${this.referenceNode} placement=bottom-end offset-distance=0 offset-skidding=0 .label=${e.panels.type.addValue} open trigger-disabled ${(0,h.K)(this.popoverNode)}>${this.renderContent()}</calcite-popover>`}renderContent(){const{_messages:e}=this.smartMappingState;return n.qy`<calcite-panel .heading=${e.panels.type.addValue} closable @calcitePanelClose=${()=>this.arcgisSmartMappingTypeAddValuePopoverClose.emit()} ${(0,h.K)(this.panelNode)}><div ${(0,h.K)(this.divRefHandler)}>${this.renderValueInput()}${this.renderLabelInput()}</div>${this.renderDoneButton()}</calcite-panel>`}renderValueInput(){const{_messages:e}=this.smartMappingState,{isDate:l,isInt:t,isNumber:a}=this;return n.qy`<calcite-label>${e.panels.type.value}${l?n.qy`<calcite-input-date-picker overlay-positioning=fixed @calciteInputDatePickerChange=${e=>{const l=e.target;this.handleAddDate(l.value)}} ${(0,h.K)(this.datePickerRefHandler)}></calcite-input-date-picker>`:a?n.qy`<calcite-input-number .step=${t?1:"any"} .integer=${t} .label=${e.panels.type.value} .placeholder=${e.panels.type.storedValue} @calciteInputNumberInput=${()=>{const e=this.valueInputNode.value;""===e||Number.isNaN(Number(e))?(this.doneButtonNode.value.disabled=!0,this.valueInputMessageNode.value.hidden=!0,this.valueInputNode.value="",this.userTouchedLabel||(this.labelInputNode.value.value="")):this.handleAddNumber(e)}} ${(0,h.K)(this.numberInputRefHandler)}></calcite-input-number>`:n.qy`<calcite-input .label=${e.panels.type.value} .placeholder=${e.panels.type.storedValue} @calciteInputInput=${()=>this.handleAddString(this.valueInputNode.value)} ${(0,h.K)(this.stringInputRefHandler)}></calcite-input>`}<calcite-input-message hidden icon=exclamation-mark-triangle status=invalid ${(0,h.K)(this.valueInputMessageNode)}>${e.panels.type.valueNotUnique}</calcite-input-message></calcite-label>`}renderLabelInput(){const{_messages:e}=this.smartMappingState;return n.qy`<calcite-label>${e.panels.type.label}<calcite-input type=text value .placeholder=${e.panels.type.displayedValue} .label=${e.panels.type.label} @calciteInputInput=${()=>this.userTouchedLabel=!0} ${(0,h.K)(this.labelInputNode)}></calcite-input></calcite-label>`}renderDoneButton(){const{smartMappingState:e}=this,{_messages:l}=e,{field:t,isDate:a,isInt:i,isNumber:u}=this;return n.qy`<calcite-button appearance=solid .label=${l.done} width=full slot=footer disabled @click=${()=>{this.popoverNode.value.open=!1;const l=this.valueInputNode.value;let n,o;a?(n=this.labelInputNode.value.value||(0,c.g)(e,l,t),o=l):u?(o=i?Number.parseInt(l):Number.parseFloat(l),n=this.labelInputNode.value.value||s.formatNumber(o)):(n=this.labelInputNode.value.value||l,o=l),this.addValue(n,o)}} ${(0,h.K)(this.doneButtonNode)}>${l.done}</calcite-button>`}}(0,a.c)("arcgis-map-config-smart-mapping-type-add-value",f)},92264:(e,l,t)=>{t.d(l,{a:()=>b,b:()=>v,c:()=>h,d:()=>m,e:()=>I,f:()=>y,g:()=>g,m:()=>c,s:()=>N});var a=t(5294),n=t(52797),i=t(56451),s=t(47207),u=t(70852),o=t(48103),r=t(39423),d=t(1225),p=(t(54312),t(44345),t(55448),t(34031),t(63438),t(5933),t(89704),t(66228));t(31521),t(23054),t(5077),t(23795),t(17902),t(87420),t(30161),t(81734),t(83552),t(77462),t(49403),t(66617),t(10628),t(59640),t(64451),t(6176),t(10454),t(29614),t(94916),t(52554),t(2156),t(4038),t(49851),t(75054),t(15223),t(70169),t(85681),t(18444),t(42411),t(9767),t(38218),t(91914),t(86605),t(68196),t(440),t(46547),t(28927),t(6238),t(7299);const c=500;async function h(e,l){const{layer:t,useFeatureReduction:a,mapImageSublayer:n,mapView:i}=e,u=t;l=l||{};const o=(0,d.a)(e,(0,d.g)(e)),r=l.fieldInfos[0];return await s.createRenderer({layer:u,view:i,field:r.field,valueExpression:r.expression,valueExpressionTitle:r.expressionTitle,numTypes:l.numTypes||10,sortBy:l.sortBy||"count",typeScheme:l.typeScheme||(0,d.I)(e,c),returnAllCodedValues:!0,outlineOptimizationEnabled:!n&&(!(0,p.i)(l.outlineOptimizationEnabled)||l.outlineOptimizationEnabled),sizeOptimizationEnabled:!n&&(!(0,p.i)(l.sizeOptimizationEnabled)||l.sizeOptimizationEnabled),legendOptions:l.legendOptions,defaultSymbolEnabled:!0,forBinning:a}).then(t=>{if(t.excludedUniqueValueInfos.length||(t.renderer.defaultLabel=void 0,t.renderer.defaultSymbol=void 0),I(e,l)){const l=(0,d.g)(e).clone(),a=(0,d.c)(l,"size","auto"),n=(0,d.c)(l,"size","outline"),i=(0,d.p)(l,"spike");if(t.renderer.visualVariables=[],a&&(t.renderer.visualVariables=t.renderer.visualVariables||[],t.renderer.visualVariables.push(a)),n&&(t.renderer.visualVariables=t.renderer.visualVariables||[],t.renderer.visualVariables.push(n)),t.renderer.uniqueValueInfos=l.uniqueValueInfos,t.renderer.field2=l.field2,t.renderer.field3=l.field3,((0,d.o)(e)||i)&&"type-size"===(0,d.d)(e)){const l=(0,d.e)(e),a=t.renderer.uniqueValueInfos?.slice();a?.forEach(e=>{const t=(0,d.i)(e.symbol);e.symbol=l.clone(),(0,d.y)(e.symbol,t)}),t.renderer.uniqueValueInfos=a}}return(0,d.b)(o,t.renderer),t})}async function m(e,l){const{layer:t,useFeatureReduction:a,mapImageSublayer:n,mapView:i}=e,u=t,o=(l=l||[]).fieldInfos?l.fieldInfos[0]:null,r=(0,d.g)(e),h=(0,d.a)(e,r),m=r.uniqueValueInfos?.length?r.uniqueValueInfos[0].symbol:null,f=r.defaultSymbol,g=r.defaultLabel,b=o&&(o.field!==r.field||o.expression!==r.valueExpression);return l=l||{},await s.createRenderer({layer:u,view:i,field:o?o.field:r.field,valueExpression:o?o.expression:r.valueExpression,valueExpressionTitle:o?o.expressionTitle:r.valueExpressionTitle,numTypes:l.numTypes||(b?10:r.uniqueValueInfos.length),sortBy:l.sortBy||"count",typeScheme:(0,d.I)(e,c),outlineOptimizationEnabled:!n&&((0,p.i)(l.outlineOptimizationEnabled)?l.outlineOptimizationEnabled:!!h.sizeOutlineVisVar),sizeOptimizationEnabled:!n&&((0,p.i)(l.sizeOptimizationEnabled)?l.sizeOptimizationEnabled:!!h.sizeAutoVisVar),legendOptions:l.legendOptions||r.legendOptions,defaultSymbolEnabled:(0,p.i)(l.defaultSymbolEnabled)||!!r.defaultSymbol,forBinning:a}).then(e=>{if((0,d.b)(h,e.renderer),m&&e.renderer.uniqueValueInfos?.length){const l=e.renderer.uniqueValueInfos.slice();l.forEach(e=>{const l=m.clone();(0,d.y)(l,(0,d.i)(e.symbol)),e.symbol=l}),e.renderer.uniqueValueInfos=l}return f&&(e.renderer.defaultSymbol=f,e.renderer.defaultLabel=g),e})}const f={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};function g(e,l,t){const{allUniqueValues:a,mapView:i}=e;if(t?.simpleFieldType===d.J.DATE){let e;a&&(e=u.calculateDateFormatInterval(a.map(e=>e.value)));const t=new Date(l);if("unknown"===i.timeZone)return n.formatDate(t,{...n.convertDateFormatToIntlOptions(e?f[e]:"long-month-day-year"),timeZone:"utc",timeZoneName:"shortOffset"});{const l=new Date(t.getTime()+6e4*t.getTimezoneOffset());return n.formatDate(l,{...n.convertDateFormatToIntlOptions(e?f[e]:"long-month-day-year"),timeZone:i.timeZone})}}return n.formatDateOnly(l,n.convertDateFormatToIntlOptions("long-month-day-year"))}function b(e){const{allUniqueValues:l}=e,t=(0,d.g)(e);if(!l?.length||!(0,p.i)(l[0].count))return[];let a=[];return t.uniqueValueGroups.forEach(e=>{const l=[];e.classes?.forEach(e=>e.values?.forEach(e=>l.push(`${e.value}`))),a=a.concat(l)}),l.filter(e=>!a.includes(null===e.value?"<Null>":`${e.value}`)).map(e=>new r.default({label:e.label,symbol:e.symbol,values:[{value:e.value}]}))}function v(e){const{allUniqueValues:l}=e,t=(0,d.g)(e);if(!l?.length||!(0,p.i)(l[0].count))return[];let a=[];return t.uniqueValueGroups.forEach(e=>{const l=[];e.classes.forEach(e=>e.values.forEach(e=>l.push("<Null>"===e.value?"null":`${e.value}`))),a=a.concat(l)}),l.filter(e=>!a.includes(`${e.value}`))}function y(e,l){const{_messages:t}=e;let a=1,n=t.panels.type.defaultGroupName.replace("${number}",a.toString());for(;l.find(e=>e.heading===n);)n=t.panels.type.defaultGroupName.replace("${number}",(++a).toString());return n}function I(e,l){if(["type","type-size"].includes((0,d.d)(e))){const t=(0,d.g)(e),a={field:t.field,expression:t.valueExpression,expressionTitle:t.valueExpressionTitle};if((0,d.N)(l.fieldInfos[0],a))return!0}return!1}function N(e,l,t){const s=(0,d.g)(e),u=(0,d.K)(e,s.field),p=u&&["small-integer","integer","big-integer","long"].includes((0,d.L)(e,u.layerField)),c=u?.simpleFieldType===d.J.DATE,h="date-only"===(0,d.L)(e,u?.layerField),m=[],f=(0,d.I)(e);let b=0;l.classes.forEach((s,v)=>{if(1===s.values.length||t&&!t.includes(v))m.push(s),b++;else if(!t||t.includes(v)){const t=s.symbol?.type,v=null!=t&&["simple-marker","simple-line","simple-fill","cim"].includes(t)?s.symbol:(0,d.e)(e,(0,d.d)(e));s.values.forEach((t,s)=>{const y=a.clone(v);if(s>0)if(f){const e=f.colors[(l.classes.length+b)%f.colors.length];e&&(0,d.y)(y,e)}else{const t=(0,d.M)(e).colors,a=new i.default(t[(l.classes.length+b)%10]);a&&(0,d.y)(y,a)}const I=u?.layerField?.domain,N=I?I.codedValues?.find(e=>e.code===t.value):null,V=N?N.name:c||h?g(e,t.value,u):u?.simpleFieldType===d.J.NUMBER?n.formatNumber(p?Number.parseInt(t.value):Number.parseFloat(t.value)):t.value;m.push(new r.default({values:[new o.default({value:t.value})],label:V,symbol:y})),b++})}}),l.classes=m}}}]);