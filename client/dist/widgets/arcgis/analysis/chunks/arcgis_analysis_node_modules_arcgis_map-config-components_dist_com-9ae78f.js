/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-9ae78f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-9ae78f"],{11751:(e,i,s)=>{s.d(i,{a:()=>d,c:()=>c,g:()=>f});var l=s(5294),o=s(56451),n=s(42411),a=s(1225),r=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(89704),s(66228)),t=(s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(83552),s(77462),s(49403),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(28973));s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(29614),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(28927),s(6238),s(7299);async function d(e,i){const{layer:s,useFeatureReduction:l,mapImageSublayer:o,mapView:d}=e,c=s;i=i||{};const f=(0,a.d)(e),u=(0,a.a)(e,(0,a.g)(e)),m=i.fieldInfos?i.fieldInfos[0]:null,p=i.theme?i.theme:"high-to-low",b={layer:c,view:d,field:m.field,valueExpression:m.expression,valueExpressionTitle:m.expressionTitle,normalizationField:i.normalizationField,theme:p,legendOptions:i.legendOptions,colorOptions:{colorScheme:i.colorScheme||(0,a.a2)(e,p),isContinuous:!!(0,r.i)(i.isContinuous)&&i.isContinuous},symbolOptions:(0,a.n)(e)?void 0:{symbolStyle:i.symbolOptions||"caret"},symbols:i.symbols||void 0,minValue:i.min,maxValue:i.max,sizeOptimizationEnabled:!o&&"above-and-below"!==p&&(!!(0,r.i)(i.sizeOptimizationEnabled)&&i.sizeOptimizationEnabled),defaultSymbolEnabled:!1,forBinning:l};return await n.createContinuousRenderer(b).then(s=>{if(!i.noReuse&&["color","color-size","color-size-age"].includes(f)&&(0,t.s)(e,i)){const i=(0,a.c)((0,a.g)(e),"color"),l=(0,a.p)((0,a.g)(e),"color");i&&l&&p===l.univariateTheme&&(s.renderer.visualVariables=[i],u.sizeOutlineVisVar&&s.renderer.visualVariables.push(u.sizeOutlineVisVar),s.renderer.authoringInfo.visualVariables=[l],(0,a.Q)(e,s.renderer))}return(0,a.b)(u,s.renderer),s})}async function c(e,i){const{layer:s,useFeatureReduction:t,mapImageSublayer:d,mapView:c}=e,f=s;i=i||{};const u=(0,a.g)(e),m=(0,a.c)(u,"color");if(m&&i.fieldInfos?.[0]&&i.fieldInfos?.[0].field===m.field&&i.fieldInfos?.[0].expression===m.valueExpression&&i.normalizationField===m.normalizationField&&(delete i.fieldInfos,(0,a.O)(i)))return{renderer:u.clone()};const p=(0,a.a)(e,u),b=(0,a.c)(u,"size"),y=u.authoringInfo,h=(0,a.p)(u,"size"),g=i.fieldInfos?i.fieldInfos[0]:m?{field:m.field,expression:m.valueExpression,expressionTitle:m.valueExpressionTitle,simpleFieldType:(0,a.K)(e,m.field)?.simpleFieldType||a.J.NUMBER}:{field:u.field,expression:u.valueExpression,expressionTitle:u.valueExpressionTitle,simpleFieldType:(0,a.K)(e,u.field)?.simpleFieldType||a.J.NUMBER},z=null===i.normalizationField?void 0:i.normalizationField?i.normalizationField:m?m.normalizationField:u.normalizationField,v=i.theme?i.theme:y?y.univariateTheme:"high-to-low",I="above-and-below"===y.univariateTheme,S="above-and-below"===v,B="custom"===y.univariateSymbolStyle;"custom"===i.symbolStyle&&!i.symbols&&(1===u.classBreakInfos.length?i.symbols=[l.clone(u.classBreakInfos[0].symbol),l.clone(u.classBreakInfos[0].symbol)]:i.symbols=[l.clone(u.classBreakInfos[0].symbol),l.clone(u.classBreakInfos[1].symbol)]);const k=(0,r.i)(i.isContinuous)?i.isContinuous:!(!I&&S)&&!!m,V="picture-marker"===u.classBreakInfos[0].symbol?.type||"picture-marker"===u.classBreakInfos[2===u.classBreakInfos.length?1:0].symbol?.type,E=!I&&S||V&&k?"caret":S?i.symbolStyle?["single","custom"].includes(i.symbolStyle)?void 0:i.symbolStyle:i.symbols?void 0:"custom"!==y.univariateSymbolStyle?y.univariateSymbolStyle:void 0:void 0,F=!(V&&k)&&("custom"===i.symbolStyle||!i.symbolStyle&&B);let w=S&&!(0,a.n)(e)?{symbolStyle:E,symbols:E?void 0:2===i.symbols?.length?{below:i.symbols[0],above:i.symbols[1]}:1===i.symbols?.length?void 0:F?{below:u.classBreakInfos[0].symbol,above:u.classBreakInfos[2===u.classBreakInfos.length?1:0].symbol}:void 0}:void 0;!w?.symbolStyle&&!w?.symbols&&(w=void 0),k&&w?.symbols&&((0,a.y)(w?.symbols.below,new o.default([0,0,0,.5])),(0,a.y)(w?.symbols.above,new o.default([0,0,0,.5])));const O=u.defaultSymbol,x=u.defaultLabel,M=u.backgroundFillSymbol;let T=!1;v===y?.univariateTheme&&(0,r.i)(b.minSize)&&(T=b.minSize.stops?b.minSize.stops[0].size>b.maxSize.stops[0].size:b.minSize>b.maxSize);let C=!1;(null===i.normalizationField||i.normalizationField||i.fieldInfos?.[0])&&(C=!0);const R=S&&!I||!S&&I,D=i.discardMinMax?void 0:(0,r.i)(i.min)?i.min:C?void 0:h?h.minSliderValue:void 0,N=i.discardMinMax?void 0:(0,r.i)(i.max)?i.max:C?void 0:h?h.maxSliderValue:void 0,_="below"===y.univariateTheme,q="below"===v,P=q&&!_||!q&&_,U=i.colorScheme||!R&&(0,a.a2)(e,v),J={layer:f,view:c,field:g.field,valueExpression:g.expression,valueExpressionTitle:g.expressionTitle,theme:v,legendOptions:i.legendOptions||b.legendOptions,colorOptions:{colorScheme:U,isContinuous:k},symbolOptions:w,normalizationField:z,minValue:D,maxValue:N,sizeOptimizationEnabled:!d&&"above-and-below"!==v&&((0,r.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:!!p.sizeAutoVisVar),defaultSymbolEnabled:(0,r.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!u.defaultSymbol,forBinning:t};return await n.createContinuousRenderer(J).then(e=>{if(i.discardMinMax){const i=(0,a.c)(u,"color"),s=(0,a.c)(e.renderer,"color");i?.stops.forEach((e,i)=>e.value=s?.stops[i].value);const l=(0,a.c)(u,"size"),o=(0,a.c)(e.renderer,"size");"above-and-below"===y.univariateTheme?l.stops?.forEach((e,i)=>{o.stops&&(e.value=o.stops[i].value)}):(l.minDataValue=o.minDataValue,l.maxDataValue=o.maxDataValue)}if((0,a.b)(p,e.renderer),S){const s=(0,a.i)(e.renderer.classBreakInfos[0].symbol),n=e.renderer.classBreakInfos[1]?(0,a.i)(e.renderer.classBreakInfos[1].symbol):s;if(!E)if(1===i.symbols?.length&&1===e.renderer.classBreakInfos.length)e.renderer.classBreakInfos[0].symbol=i.symbols[0];else if(2===i.symbols?.length&&1===e.renderer.classBreakInfos.length){const i=l.clone(u.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=i}else if("single"===i.symbolStyle&&2===e.renderer.classBreakInfos.length){const i=l.clone(u.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=i.clone(),(0,a.y)(i,(0,a.i)(e.renderer.classBreakInfos[1].symbol)),e.renderer.classBreakInfos[1].symbol=i,e.renderer.authoringInfo.univariateSymbolStyle=void 0}else{let i=l.clone(u.classBreakInfos[0].symbol);e.renderer.classBreakInfos[0].symbol=i,e.renderer.classBreakInfos[1]&&(i=u.classBreakInfos[1]?l.clone(u.classBreakInfos[1].symbol):l.clone(u.classBreakInfos[0].symbol),e.renderer.classBreakInfos[1].symbol=i)}const r=(0,a.c)(e.renderer,"color");if(r){const i=new o.default([0,0,0,.5]);(0,a.y)(e.renderer.classBreakInfos[0].symbol,i),e.renderer.classBreakInfos[1]&&(0,a.y)(e.renderer.classBreakInfos[1].symbol,i)}else m||r?((0,a.y)(e.renderer.classBreakInfos[0].symbol,s),e.renderer.classBreakInfos[1]&&(0,a.y)(e.renderer.classBreakInfos[1].symbol,n)):((0,a.y)(e.renderer.classBreakInfos[0].symbol,(0,a.i)(u.classBreakInfos[0].symbol)),(0,a.y)(e.renderer.classBreakInfos[1].symbol,(0,a.i)(u.classBreakInfos[1].symbol)))}else S||(1===i.symbols?.length?e.renderer.classBreakInfos[0].symbol=i.symbols[0]:1===u.classBreakInfos?.length&&(e.renderer.classBreakInfos[0].symbol=u.classBreakInfos[0].symbol));if(I&&S&&!C){const i=(0,a.c)(e.renderer,"size"),s=(0,a.c)(e.renderer,"color");i.stops=l.clone(b.stops),s&&s.stops.forEach((e,i)=>{e.value=b.stops[i].value}),2===e.renderer.classBreakInfos.length&&(e.renderer.classBreakInfos[0].maxValue=b.stops[2].value,e.renderer.classBreakInfos[1].minValue=b.stops[2].value)}if(P&&U&&m){const i=(0,a.c)(e.renderer,"color"),s=m.stops.length-1;i.stops.forEach((e,i)=>{e.color=m.stops[s-i].color})}if(O&&(e.renderer.defaultSymbol=O,e.renderer.defaultLabel=x),e.renderer.backgroundFillSymbol=M||void 0,T){const i=(0,a.c)(e.renderer,"size"),s=i.minSize;i.minSize=i.maxSize,i.maxSize=s}return e})}function f(e){const{mapView:i}=e,s=(0,a.g)(e),l=(0,a.c)(s,"color"),o=(0,a.c)(s,"size"),n=i.scale,{minSize:r,maxSize:t}=o;let d;if(o.stops)d=l.stops.map((e,i)=>{const s=o.stops[i];return{color:e.color,size:s.size,value:s.value}});else{const e=l.stops.length-1;if("number"==typeof r)d=l.stops.map((i,s)=>({color:i.color,value:i.value,size:0===s?r:s===e?t:null}));else{let i,s;const a=r.stops.length-1;n>r.stops[a].value?(i=r.stops[a].size,s=t.stops[a].size):r.stops.forEach((e,l)=>{n<=e.value&&(i=e.size,s=t.stops[l].size)});const c=o.minDataValue,f=o.maxDataValue,u=(f-c)/4;d=l.stops.map((l,o)=>({color:l.color,value:0===o?c:o===e?f:c+o*u,size:0===o?i:o===e?s:void 0}))}}return d}},65868:(e,i,s)=>{s.r(i),s.d(i,{ArcgisMapConfigSmartMappingDividedBy:()=>p});var l=s(73679),o=s(4395),n=(s(52797),s(20936)),a=(s(54312),s(44345),s(55448),s(34031),s(63438),s(5933),s(1225)),r=s(75518),t=(s(89704),s(5294),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(65595)),d=(s(77462),s(49403),s(10281),s(83930),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(28973)),c=s(87735),f=(s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(29614),s(47207),s(70852),s(48103),s(39423),s(78778)),u=(s(18444),s(11751)),m=(s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(28927),s(6238),s(7299),s(73801));class p extends m.WF{constructor(){super(...arguments),this.smartMappingState=(0,t.u)(),this.arcgisSmartMappingDividedByChange=(0,m.lh)(),this.arcgisSmartMappingDividedByError=(0,m.lh)()}static{this.properties={rendererSubtype:1,normalizationField:1,fieldPos:9}}load(){this.flowItemNode=(0,n.el)(this.el,"calcite-flow-item")}handleNormalize(e){const{smartMappingState:i}=this,s=(0,a.g)(i),l=(0,a.d)(i),o=s.authoringInfo,n="univariate-color-size"===o?.type,t="class-breaks-color"===o?.type,m="class-breaks-size"===o?.type,p="relationship"===l||"relationship"===this.rendererSubtype,b=(0,a.p)(s,"reference-size"),y=(0,a.p)(s,"spike");let h;if(t?h=d.c:m?h=c.c:n?h=u.c:"color"===this.rendererSubtype?(h=d.a,["color-age","color-age-size"].includes(l)&&(h=d.b)):"size"===this.rendererSubtype?(h=c.d,["size-age","color-size-age","type-size-age"].includes(l)&&(h=c.e)):p&&(h=f.c),!h)return;const g={};p?0===this.fieldPos?g.normalizationField1=e:g.normalizationField2=e:g.normalizationField=e,(0,r.r)(h(i,g),this.flowItemNode).then(e=>{if(n||t||m||p){if("relationship-size"===l){e.renderer.backgroundFillSymbol=s.backgroundFillSymbol;const i=(0,a.c)(s,"size"),l=(0,a.p)(s,"size");e.renderer.visualVariables=e.renderer.visualVariables||[],e.renderer.visualVariables.push(i),e.renderer.authoringInfo=e.renderer.authoringInfo||{},e.renderer.authoringInfo.visualVariables=e.renderer.authoringInfo.visualVariables||[],e.renderer.authoringInfo.visualVariables.push(l)}(0,a.a4)(i,e.renderer)}else if("color"===this.rendererSubtype)["color-size","color-age-size","color-size-age"].includes(l)?(this.switchOutVisualVariable(e),(0,a.a4)(i)):(0,a.a4)(i,e.renderer);else if("size"===this.rendererSubtype)if(["color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].includes(l))b?(0,c.a)(i).then(e=>(0,a.a4)(i,e),e=>this.arcgisSmartMappingDividedByError.emit(e)):y?(0,c.b)(i).then(e=>(0,a.a4)(i,e),e=>this.arcgisSmartMappingDividedByError.emit(e)):(this.switchOutVisualVariable(e),(0,a.a4)(i));else if(b){const l=(0,a.p)(e.renderer,"reference-size");s.authoringInfo.visualVariables=(0,a.P)(s,"reference-size")||[],s.authoringInfo.visualVariables.push(l),(0,c.a)(i).then(e=>(0,a.a4)(i,e),e=>this.arcgisSmartMappingDividedByError.emit(e))}else if(y){const l=(0,a.p)(e.renderer,"spike");s.authoringInfo.visualVariables=(0,a.P)(s,"spike")||[],s.authoringInfo.visualVariables.push(l),(0,c.b)(i).then(e=>(0,a.a4)(i,e),e=>this.arcgisSmartMappingDividedByError.emit(e))}else(0,a.a4)(i,e.renderer);else(0,a.a4)(i);this.requestUpdate(),this.arcgisSmartMappingDividedByChange.emit()},e=>this.arcgisSmartMappingDividedByError.emit(e))}switchOutVisualVariable(e){const{smartMappingState:i}=this,s=(0,a.g)(i);s.visualVariables=(0,a.H)(s,this.rendererSubtype)||[];const l=(0,a.c)(e.renderer,this.rendererSubtype);s.visualVariables.push(l),s.authoringInfo.visualVariables=(0,a.P)(s,this.rendererSubtype)||[];const o=(0,a.p)(e.renderer,this.rendererSubtype);o&&s.authoringInfo.visualVariables.push(o),(0,a.Q)(i,s)}render(){const{smartMappingState:e}=this,{fields:i,_messages:s}=e,l=(0,a.g)(e),n=(0,a.d)(e),r=l.authoringInfo,t=(0,a.c)(l,this.rendererSubtype),d=(0,a.p)(l,"reference-size"),c=(0,a.p)(l,"spike"),f="relationship"===n||"relationship"===this.rendererSubtype,u=f?0===this.fieldPos?r.field1.field:r.field2.field:t?t.field:l.field,m=f?0===this.fieldPos?r.field1.normalizationField:r.field2.normalizationField:t?t.normalizationField:d?d.normalizationField:c?c.normalizationField:l.normalizationField;return o.qy`<arcgis-map-config-smart-mapping-attribute-input .fieldList=${i.filter(e=>e.layerField.name!==u&&e.simpleFieldType===a.J.NUMBER)} .popoverReferenceElement=${this.flowItemNode} .label=${s.transparency.dividedBy} mode=remove .selectedField=${m?{field:m,simpleFieldType:a.J.NUMBER}:void 0} @arcgisSmartMappingAttributeInputChange=${e=>{if(e.detail){const i=e.detail;this.handleNormalize(i.field??void 0)}else this.handleNormalize(e.detail)}}></arcgis-map-config-smart-mapping-attribute-input>`}}(0,l.c)("arcgis-map-config-smart-mapping-divided-by",p)},75518:(e,i,s)=>{let l,o;function n(e){e.loading=!1}async function a(e,i){return function(e){e.loading=!0,o=!1,l&&clearTimeout(l),l=setTimeout(()=>{n(e),o=!0},6e4)}(i),await e.then(e=>{if(n(i),o)throw new Error("timeout");return e}).catch(e=>{throw n(i),e})}s.d(i,{r:()=>a})},78778:(e,i,s)=>{s.d(i,{a:()=>a,c:()=>r,u:()=>t});var l=s(85681),o=s(1225),n=(s(54312),s(44345),s(55448),s(52797),s(34031),s(63438),s(5933),s(89704),s(5294),s(66228));s(56451),s(31521),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(83552),s(77462),s(49403),s(66617),s(10628),s(59640),s(64451),s(6176),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(18444),s(42411),s(9767),s(38218),s(91914),s(86605),s(68196),s(440),s(46547),s(28927),s(6238),s(7299);async function a(e,i){const{layer:s,useFeatureReduction:a,mapImageSublayer:r,mapView:t}=e,d=s,c=(0,o.d)(e);let f=i.relationshipScheme;if(!f&&["relationship","relationship-size"].includes(c)&&(f=(0,o.S)(e)),i=i||{},"relationship-size"===c){const s=(0,o.g)(e).clone(),l=s.authoringInfo,n=(0,o.p)(s,"spike");if(l&&i.fieldInfos?.length>1&&i.fieldInfos[0].field===l.field1.field&&i.fieldInfos[1].field===l.field2.field){if(s.visualVariables=(0,o.H)(s,"size"),s.authoringInfo.visualVariables=(0,o.P)(s,"size"),(0,o.o)(e)||n){const i=(0,o.e)(e),l=s.uniqueValueInfos.slice();l.forEach(e=>{const s=(0,o.i)(e.symbol);e.symbol=i.clone(),(0,o.y)(e.symbol,s)}),s.uniqueValueInfos=l}return{renderer:s}}}const u=(0,o.a)(e,(0,o.g)(e)),m={layer:d,view:t,field1:{field:i.fieldInfos[0].field},field2:{field:i.fieldInfos[1].field},classificationMethod:"quantile",numClasses:3,focus:"HH",relationshipScheme:f,outlineOptimizationEnabled:!r&&(!(0,n.i)(i.outlineOptimizationEnabled)||i.outlineOptimizationEnabled),sizeOptimizationEnabled:!r&&(!(0,n.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:a};return await l.createRenderer(m).then(e=>((0,o.b)(u,e.renderer),e))}async function r(e,i){const{layer:s,useFeatureReduction:a,mapImageSublayer:r,mapView:t}=e,d=s;i=i||{};const c=(0,o.g)(e),f=(0,o.d)(e),u=c.authoringInfo,m=(0,o.c)(c,"size");if(i.fieldInfos&&i.fieldInfos.length>1&&i.fieldInfos[0].field===u.field1.field&&i.normalizationField1===u.field1.normalizationField&&i.fieldInfos[1].field===u.field2.field&&i.normalizationField2===u.field2.normalizationField&&(delete i.fieldInfos,delete i.normalizationField1,delete i.normalizationField2,(0,o.O)(i)&&!m))return{renderer:c.clone()};let p=i.relationshipScheme;!p&&["relationship","relationship-size"].includes(f)&&(p=(0,o.S)(e));const b=(0,o.a)(e,c),y=i.fieldInfos?i.fieldInfos[0]:{field:u.field1.field,simpleFieldType:o.J.NUMBER},h=i.fieldInfos?i.fieldInfos[1]:{field:u.field2.field,simpleFieldType:o.J.NUMBER},g=void 0!==i.normalizationField1?i.normalizationField1:u.field1.normalizationField,z=void 0!==i.normalizationField2?i.normalizationField2:u.field2.normalizationField,v=c.uniqueValueInfos?.length?c.uniqueValueInfos[0].symbol:null,I=c.defaultSymbol,S=c.defaultLabel,B=i.numClasses?i.numClasses:u.numClasses,k={layer:d,view:t,field1:{field:y?y.field:c.field,normalizationField:g},field2:{field:h?h.field:c.field,normalizationField:z},classificationMethod:i.classificationMethod?i.classificationMethod:"manual"!==u.classificationMethod?u.classificationMethod:"quantile",numClasses:B,focus:i.focus?i.focus:u.focus,relationshipScheme:p,outlineOptimizationEnabled:!r&&((0,n.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!b.sizeOutlineVisVar),sizeOptimizationEnabled:!r&&((0,n.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:!!b.sizeAutoVisVar),legendOptions:i.legendOptions?i.legendOptions:c.legendOptions,defaultSymbolEnabled:(0,n.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!c.defaultSymbol,forBinning:a};return await l.createRenderer(k).then(i=>((0,o.b)(b,i.renderer),v&&i.renderer.uniqueValueInfos.forEach(e=>{const i=v.clone();(0,o.y)(i,(0,o.i)(e.symbol)),e.symbol=i}),(0,o.g)(e).uniqueValueInfos.forEach(e=>{const s=i.renderer.uniqueValueInfos.find(i=>e.value===i.value);s&&(s.label=e.label)}),I&&(i.renderer.defaultSymbol=I,i.renderer.defaultLabel=S),i))}async function t(e,i){i=i||{};const s=(0,o.g)(e),n=s.authoringInfo;return await l.updateRenderer({field1:n.field1,field2:n.field2,numClasses:i.numClasses?i.numClasses:n.numClasses,focus:i.focus?"none"===i.focus?null:i.focus:n.focus,colors:i.colors,renderer:s})}}}]);