/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-460af2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-460af2"],{22777:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_data_store_select:()=>d});var r=a(87849),i=a(29599),n=a(59317),o=a(3826),s=a(95878),c=a(86686),l=a(27095);a(83692),a(931),a(93814),a(41473),a(54251),a(37762),a(58573),a(76246),a(15912),a(36443),a(88878),a(46904),a(72257),a(86562),a(15332),a(82149),a(74695),a(24869),a(27137),a(1536),a(60958),a(32478),a(51632),a(98704),a(54077),a(1654),a(10578),a(8417),a(50315),a(26262),a(68466);const d=class{constructor(e){(0,r.r)(this,e),this.newItemUpdatePage=(0,r.c)(this,"newItemUpdatePage",7),this.options={folder:{page:"dataStoreSelectFolder",enabled:!0},database:{page:"dataStoreSelectDatabaseType",enabled:!0},cloud:{page:"dataStoreSelectCloud",enabled:!0}},this.cloudOptions=["amazon","azure"],this.databaseOptions=["bigquery","databricks","snowflake"],this.selected="folder",this.pipelineCloudSelection="amazon",this.pipelineDatabaseSelection="bigquery",this.serverList=[]}async componentWillLoad(){const e=n.c.portal,t=n.c.user;(0,l.a)({portal:n.c.portal}),this.i18n=s.u.i18n.dataStoreSelect,this.isPortal=n.c.portal.isPortal,this.isPortal?this.selected="folder":this.selected="database",this.tileStrings=s.u.i18n.dataStoreSelectDatabase.pipelineProviders,this.serverList=await(0,i.b)(t,e),this.filterServers();(await(0,i.e)(e)).blockBetaApps&&(this.databaseOptions=this.databaseOptions.filter(e=>"databricks"!==e))}filterServers(){if(!n.c.portal.isPortal)return this.options.folder.enabled=!1,this.options.database.enabled=!0,void(this.options.cloud.enabled=!0);const e=this.serverList.filter(function(e){return"HOSTING_SERVER"===e.serverRole.toUpperCase()});e.length&&(o.a.hostingServer=e[0]);const t=this.serverList.filter(function(e){return e.serverFunction.toUpperCase().indexOf("KNOWLEDGE")>-1}),a=n.c.config.noSQLEnabled;o.a.noSqlEnabled=!!(null==t?void 0:t.length)&&a&&!(0,c.i)()}handleNext(){let e;const t=this.selected;if(o.a.addDataStoreType=t,o.a.dataStoreSelectServerList=this.serverList,this.isPortal)e=this.options[t].page;else if("cloud"===this.selected)o.a.addDataStoreType="cloud",o.a.provider=this.pipelineCloudSelection,e="dataStoreSelectCloudCredentials";else switch(o.a.addDataStoreType="database",o.a.databaseProvider=this.pipelineDatabaseSelection,this.pipelineDatabaseSelection){case"bigquery":e="dataStoreBigQueryCredentials";break;case"databricks":e="dataStoreDatabricksCredentials";break;case"snowflake":e="dataStoreSnowflakeCredentials"}this.newItemUpdatePage.emit(e)}render(){const{i18n:e,options:t,cloudOptions:a,databaseOptions:i,tileStrings:n}=this;let s="cloud"===this.selected?a:i;return(0,r.h)("div",{key:"828c9e515aba027e20115192911d181c80c83f2c"},(0,r.h)("arcgis-new-item-description",{key:"3c7001ff940b1dcb5662af60a285edf882adb345",header:e.heading}),(0,r.h)("calcite-tile-select-group",{key:"d25ce770e006c964633013b5bfd010e41dd4faff",layout:"vertical",class:"tile-select-group"},Object.keys(t).map(a=>{let i;return i=this.isPortal?o.a.noSqlEnabled?e.options.database.descriptionNoSql:e.options.database.description:e.databaseDescriptionForOnline,t[a].enabled&&(0,r.h)("calcite-tile-select",{key:a,class:"tile-select",checked:this.selected===a,heading:e.options[a].title,description:"database"===a?i:e.options[a].description,name:"data-store-selection","input-enabled":!0,width:"full",type:"radio",value:a,onCalciteTileSelectChange:e=>{this.selected=e.currentTarget.value}})})),!this.isPortal&&(0,r.h)("div",{key:"131864860d87a5d1e04aaa33ad0cb5168f0cc815",class:"dynamic-select"},(0,r.h)("arcgis-new-item-description",{key:"6bec4cdc48edc584782e71692f54ff39738bc26d",class:"dynamic-header",header:"cloud"===this.selected?e.subOptionsCloudDescription:e.subOptionsDatabaseDescription}),(0,r.h)("calcite-tile-select-group",{key:"0a12d7aad5aabc3e16ac1c6fa39926271dd43308",layout:"vertical"},s.map(e=>(0,r.h)("calcite-tile-select",{key:e,"input-enabled":!0,checked:s[0]===e,width:"full",type:"radio",value:e,heading:n[e].title,description:n[e].description,onCalciteTileSelectChange:e=>{"cloud"===this.selected?this.pipelineCloudSelection=e.currentTarget.value:this.pipelineDatabaseSelection=e.currentTarget.value}})))))}};d.style=".tile-select-group{margin-top:1.25rem}.tile-select{margin-bottom:0.125rem}.dynamic-header{margin-bottom:1.5rem;margin-top:1.5rem;display:block}"},27095:(e,t,a)=>{a.d(t,{a:()=>f,h:()=>g,i:()=>b});var r=a(36443),i=a(88878),n=a(59317),o=a(41473),s=a(5821),c=a(72257),l=a(3826),d=a(15912),p=a(82149),u=a(74695),h=a(51632),y=a(68466);const b=async(e,t)=>{var a;const{existingItemType:r,portal:s,existingItemPublishType:b}=t;n.c.initialFolder=null!==(a=await(0,i.b)(e,e.itemOwner))&&void 0!==a?a:(0,i.d)(e.itemOwner);let f=e.type;"GeoJSON"===f&&(f="GeoJson"),l.a.classification=e.classification,l.a.initialTitle=e.title,c.i.categories=e.categories,c.i.snippet=e.snippet;const g=e.tags;switch(Array.isArray(g)?c.i.tags=g||[]:c.i.tags=(null!=g?g:"").split(","),l.a.id=e.id,l.a.type=f,l.a.fileName=e.name,l.a.existingItem=e,l.a.enablePublishing=!0,l.a.newItemMode=r,r){case"file":if(l.a.extension=d.a[f].fileExt[0],"Service Definition"===f&&s.isPortal){const{result:t}=await(0,h.b)(n.c.config.restBaseUrl,e.id);l.a.serviceDefinitonProperties=t}break;case"tileLayer":const{id:t,url:a,title:r}=e,[{layers:i,tables:c,serviceInfo:g}]=await Promise.all([(0,u.o)({serviceUrl:a,restBaseUrl:(0,o.g)(s),forceAddToken:!0})]),{result:v}=await(0,y.f)({itemId:t,itemUrl:a,publishType:"vectorTiles"===b?"vector":"raster",portal:s,fullLayers:i});if(l.a.sourceTitle=r,l.a.tileLayerPublishType=b,"3dTiles"===l.a.tileLayerPublishType){l.a.tilesLayer3dType=p.D;break}l.a.tileLayerData=v,l.a.tileAutoCreation=!s.isPortal,l.a.tileLayerBasemapType="standard",l.a.tileLayerBasemapUrl="",l.a.tileLayerFromFeatureLayer=!0,l.a.tileLayerLayers=i,l.a.tileLayerTables=c,l.a.tileLayerServiceInfo=g}},f=e=>{l.a.newItemMode="dataStore",l.a.type="Data Store",(null==e?void 0:e.portal.isPortal)||(l.a.typeKeywords=["Data Store connection"])},g=async(e,t)=>{var a,i;l.a.newItemMode="developerCredentials",l.a.type="Application";const{result:n}=await(0,r.g)(t,e),o=!(null===(a=null==n?void 0:n.options)||void 0===a?void 0:a.includes("NoApiKeys"))&&(null===(i=null==e?void 0:e.privileges)||void 0===i?void 0:i.includes("portal:user:generateApiTokens")),c=!((0,s.g)("oauth_only_register_app",!0)||window.localStorage.getItem("oauth_only_register_app"));return o?"developerCredentialsSelect":(l.a.developerCredentialsType="oauth",c?"developerCredentialsSelect":(l.a.breadcrumbs=["oauthCredentialType"],"developerCredentialsInput"))}},36443:(e,t,a)=>{a.d(t,{a:()=>n,g:()=>o});var r=a(83692),i=a(41473);const n=async e=>{try{return{result:await(0,r.r)(`${(0,i.g)(e)}portals/self/subscriptionInfo`)}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},o=async(e,t)=>await(0,r.f)(()=>n(e),"subscriptionType",(0,r.b)(t))},51632:(e,t,a)=>{a.d(t,{a:()=>d,b:()=>p,c:()=>c,d:()=>l,e:()=>b,f:()=>y,g:()=>u,s:()=>h});var r=a(54251),i=a(74695),n=a(98704),o=a(1536),s=a(83692);async function c(e){try{const t=await(0,s.r)(e);return{result:{folders:t.folders||[]}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}async function l(e,t){try{return{result:{status:(await(0,s.r)(e,{folderName:t},{},"post")).status}}}catch(e){return console.error(e),{error:e}}}async function d(e){const t=await(0,i.l)();try{await(0,n.c)(t)}catch(e){return{error:e}}const a=`${e}/content/features/analyze`;try{const e=await(0,s.r)(a,{itemid:t.id,filetype:"Service Definition"},{},"post");return e.id=t.id,{result:e}}catch(e){return await async function(e){try{await(0,o.d)(e,{permanentDelete:!0})}catch(e){console.error("Failed to delete item:",e)}}(t.id),{error:e}}}async function p(e,t){const a=`${e}/content/features/analyze`;try{return{result:await(0,s.r)(a,{itemid:t,filetype:"Service Definition"},{},"post")}}catch(e){return{error:e}}}async function u(e,t){const a=`${e}/types/providers/ArcObjects11/${t}/types?listInterceptors=true`;try{return{result:await(0,s.r)(a)}}catch(e){return{error:e}}}async function h(e,t,a){const r=`${e}/rest/services/System/PublishingTools/GPServer/Publish%20Service%20Definition`;try{const e=await(0,s.r)(`${r}/submitJob`,{in_sdp_id:a,in_config_overwrite:JSON.stringify(t)},{},"post");return{result:(await async function(e,t){const a=`${t}/jobs/${encodeURIComponent(e)}`;try{return{result:await(0,s.p)(a,{pendingStatuses:["esriJobExecuting","esriJobSubmitted","esriJobWaiting"],successStatuses:["esriJobSucceeded"]},"post")}}catch(e){return{error:e}}}(e.jobId,r)).result}}catch(e){return{error:e}}}async function y(e,t,a){var r;const i=`${t}/rest/services/System/PublishingTools/GPServer/Publish%20Service%20Definition/jobs/${a}/${e}`;try{const e=await(0,s.r)(i);if(e){const a=null===(r=null==e?void 0:e.value)||void 0===r?void 0:r.svcConfigInfo,i=`${t}/admin/services/${(null==a?void 0:a.folder)?`${a.folder}/`:""}${a.name}.${a.type}`;return{result:await(0,s.r)(i)}}}catch(e){return{error:e}}}async function b(e,t){var a;const i=`${e}content/items/${t}/info/iteminfo.xml${(0,r.g)()?`?token=${(0,r.g)()}`:""}`;try{const e=await fetch(i,{headers:{Accept:"application/xml"}}),t=await e.text(),r=(new DOMParser).parseFromString(t,"text/xml"),n=Array.from(r.getElementsByTagName("tag")).map(e=>e.textContent);return{result:{tags:n,summary:(null===(a=r.getElementsByTagName("summary")[0])||void 0===a?void 0:a.textContent)||""}}}catch(e){return{error:e}}}},86686:(e,t,a)=>{a.d(t,{a:()=>s,b:()=>u,c:()=>o,d:()=>p,e:()=>m,f:()=>c,g:()=>y,h:()=>S,i:()=>v,j:()=>l,k:()=>d});var r=a(83692),i=a(59317),n=a(58573);function o(e,t){const a={type:"folder",path:`/fileShares/${t}`,info:{dataStoreConnectionType:"shared",path:e.publisherFolderPath,hostName:e.publisherFolderPathHostname}};return"newPath"===e.serverFolderPath?(a.clientPath=e.publisherFolderPath,a.info.path=e.newServerFolderPath,a.info.dataStoreConnectionType="replicated"):"nfsHostAndPath"===e.serverFolderPath&&(a.clientPath=e.publisherFolderPath,a.provider="UserManaged",a.info.dataStoreConnectionType="replicated",a.info.fileServerPath=e.nfsSharePath,a.info.fileServerHost=e.nfsHostName,a.info.fileServerType="nfs"),a}function s(e,t){const a={type:"egdb",path:"/enterpriseDatabases/"+t,info:{dataStoreConnectionType:"shared"}};return"newConnection"===e.serverDatabaseOption?(a.info.connectionString=e.serverConnectionString,a.info.clientConnectionString=e.publisherConnectionString,a.info.dataStoreConnectionType="replicated"):"bigquery"===e.databaseProvider||"snowflake"===e.databaseProvider?(a.info.JDBCConnection=e.jdbcConnection,a.info.implementation=e.databaseProvider):"databricks"===e.databaseProvider?(a.provider=e.databaseProvider,a.info.connectionProperties=e.connectionProperties,a.info.implementation=e.databaseProvider):a.info.connectionString=e.publisherConnectionString,a}const c=async(e,t,a,r)=>{let i,n;if((null==a?void 0:a.length)>0){try{n=JSON.parse(a)}catch(e){return{error:{code:"invalidJSON"}}}i=function(e,t){const{type:a,project_id:r,private_key_id:i,private_key:n,client_email:o,client_id:s,auth_uri:c,token_uri:l,auth_provider_x509_cert_url:d,client_x509_cert_url:p}=t,u={oAuthType:0,projectId:e,url:"jdbc:bigquery://https://www.googleapis.com/bigquery/v2:443",oAuthPvtKeyFile:{type:a,project_id:r,private_key_id:i,private_key:n,client_email:o,client_id:s,auth_uri:c,token_uri:l,auth_provider_x509_cert_url:d,client_x509_cert_url:p}};return u}(e,n)}else(null==r?void 0:r.length)>0&&(i=function(e,t,a){const r={name:"BigqueryArcgisPlatform_RefreshToken",className:"com.esri.sds.bigquery.jdbc.GBQDataSource",oAuthType:2,projectId:e,defaultDataset:t,url:"jdbc:bigquery://https://www.googleapis.com/bigquery/v2:443",oAuthRefreshToken:a};return r}(e,t,r));return{result:{type:"egdb",path:"/enterpriseDatabases/bigQuerySvrDevDataJdbc",id:null,clientPath:null,info:{implementation:"bigquery",JDBCConnection:i}}}};function l(e){let t;const{server:a,httpPath:r,catalog:i,clientId:n,secret:o,token:s,authenticationType:c}=e,l=Object.assign({hostname:a,port:443,httpPath:r},i?{catalog:i}:{});return"oAuthMachineToMachine"===c?t=Object.assign({authenticationScheme:"oauth2",authenticationFlow:"machineToMachine",oauth2ClientId:n,oauth2Secret:o},l):"personalAccessToken"===c&&(t=Object.assign({authenticationScheme:"personalAccessToken",token:s},l)),{path:"/enterpriseDatabases/databricks",type:"egdb",provider:"databricks",info:{implementation:"databricks",connectionProperties:t}}}function d(e){let t;const{authenticationType:a,user:r,database:i,role:n,server:o,warehouse:s,schema:c,password:l,keyFile:d,passcode:p}=e,u={user:r,database:i,role:n,connectionUrl:`jdbc:snowflake://${o}`,warehouse:s,schema:c};return t="keyPair"===a?Object.assign(Object.assign({},u),{passcode:p||void 0,authenticator:"snowflake_jwt",keyfile:d}):Object.assign(Object.assign({},u),{password:l,authenticator:"snowflake"}),{path:"/enterpriseDatabases/snowflakeJdbc",type:"egdb",info:{implementation:"snowflake",JDBCConnection:t}}}function p(e,t){if("Arango"===e.noSqlProvider){const t={type:"nosql",path:"/nosqlDatabases/Arango_enterprise",info:{systemManaged:!1,dsFeature:"graphStore",isManagedData:!1,category:"database",factory:"nosql",provider:"ArangoDB",implementation:"ArangoDB",purposes:["knowledge-graph"],connectionProperties:{hosts:[],useSsl:e.useSsl,username:e.username,password:e.password,database:e.database}}};return""!==e.hosts?t.info.connectionProperties.hosts=e.hosts.split(","):delete t.info.connectionProperties.hosts,t}const a={type:"nosql",path:`/nosqlDatabases/${t}`,info:{provider:"Neo4J",isManaged:!1,dsFeature:"graphStore",factory:"nosql",implementation:"Neo4j",category:"database",systemManaged:!1,isManagedData:!1,purposes:["knowledge-graph"],connectionProperties:{connectionUri:e.connectionUri,username:e.username,password:e.password,database:e.database,fallbackServerAddresses:[]}}};return""!==e.fallBackServers?a.info.connectionProperties.fallbackServerAddresses.push(e.fallBackServers.split(",")):delete a.info.connectionProperties.fallbackServerAddresses,a}function u(e,t){const a=e.provider,r={info:{}},i={credentialType:"accesskey"};return"amazon"===a&&("accessKey"===e.credentialType?(i.accessKeyId=e.accessKey,i.secretAccessKey=e.secretKey):i.credentialType=e.credentialType,"custom"===e.selectedRegion.id?i.regionEndpointUrl=e.storageURL:(i.regionEndpointUrl=h(e.regions,e.selectedRegion),i.region=e.selectedRegion.id),r.info.objectStore=e.bucketName,r.provider="amazon"),"google"===a&&(i.accessKeyId=e.accessKey,i.secretAccessKey=e.secretKey,i.regionEndpointUrl="https://storage.googleapis.com",r.info.objectStore=e.bucketName,r.provider="Google"),"azure"!==a&&"azuredatalakegen2store"!==a||("sharedKey"===e.azureAuthenticationType?(i.credentialType="accessKey",i.accountKey=e.accountKey):"activeDirectory"===e.azureAuthenticationType?(i.credentialType=e.azureIdentityType,"servicePrincipal"===e.azureIdentityType?(i.tenantId=e.tenantId,i.clientId=e.clientId,i.clientSecret=e.clientSecret,i.authorityHost=e.authorityHost):"userAssignedIdentity"===e.azureIdentityType&&(i.managedIdentityClientId=e.clientId)):"sasToken"===e.azureAuthenticationType?(i.credentialType=e.azureAuthenticationType,i.sasToken=e.token):"anonymous"===e.azureAuthenticationType&&(i.credentialType=e.azureAuthenticationType),"other"===e.environment.id||"anonymous"===e.azureAuthenticationType?i.regionEndpointUrl=e.endpoint:i.accountEndpoint=h(e.regions,e.environment),"azure"===a?(r.info.objectStore=e.containerName,r.provider="azure"):(r.info.folder=e.cloudFolder?`${e.containerName}/${(0,n.j)(e.cloudFolder)}`:e.containerName,r.provider="azureDataLakeStore"),"azureGeocatalog"===e.selectedServiceType?(i.tokenGenerationUrl=e.tokenGenerationUrl,i.scopes=[e.scope]):"microsoftPlanetaryComputers"===e.selectedServiceType&&(i.tokenGenerationUrl=e.tokenGenerationUrl),"anonymous"===e.azureAuthenticationType&&"microsoftPlanetaryComputers"!==e.selectedServiceType||(i.accountName=e.accountName)),"alibaba"===a&&(i.accessKeyId=e.accessKey,i.secretAccessKey=e.secretKey,r.info.objectStore=e.bucketName,r.provider="Alibaba",i.regionEndpointUrl="custom"===e.selectedRegion.id?e.storageURL:h(e.regions,e.selectedRegion)),i.defaultEndpointsProtocol="https",e.cloudFolder&&"azuredatalakegen2store"!==a&&(r.info.objectStore=r.info.objectStore+"/"+(0,n.j)(e.cloudFolder)),r.type="cloudStore",["azureGeocatalog","microsoftPlanetaryComputers"].includes(e.selectedServiceType)&&("azureGeocatalog"===e.selectedServiceType?r.path="/cloudStores/azureGeocatalog":r.path="/cloudStores/microsoftPlanetaryComputers"),r.path="/cloudStores/"+t,r.info.connectionString=JSON.stringify(i),r}function h(e,t){let a;return e.forEach(function(e){e.id===t.id&&(a=e.blobStoreEndpoint||e.storageEndpointSuffix)}),a}const y=async(e,t)=>{const a=e.results.out_connectionString.paramUrl,i=`${t}/Get%20Database%20Connection%20String/jobs/${e.jobId}/${a}`,n=await(0,r.r)(i);return b(n)},b=e=>{const t=e.value;return{connectionStringProps:f(t),connectionString:t}},f=e=>{let t=[];return e&&e.split(";").forEach(e=>{const a=e.split("=");2!==a.length||g(t,a[0])||t.push({key:a[0],value:a[1]})}),t},g=(e,t)=>e.some(e=>e.key===t),v=()=>{var e;const t=i.c.portal,a=null===(e=t.sourceJSON)||void 0===e?void 0:e.portalDeploymentType;return t.isPortal&&"ArcGISEnterpriseOnKubernetes"===a},m=e=>{if(!e)return"";return`${e}/rest/services/System/PublishingTools/GPServer`},S=(e,t,a,r)=>{var i;return Object.assign(Object.assign({},e),{children:null===(i=e.children)||void 0===i?void 0:i.filter(e=>{const i=e.type;let n=!1;return"folder"===i||("tile-layer"===a?n||(n="tiles"===r&&"cacheDataset"===i||"vectorTiles"===r&&"vectorCacheDataset"===i):"scene-layer"===a&&(n=k(e,i,t,r)),n)})})},k=(e,t,a,r)=>{let i=!1;return a?"lasd"===e.path.split(".").pop().toLowerCase()?i=!1:i||(i="LASDataset"===t||"LIDARExchangeFile"===t):"3dTiles"===r&&"3DTilesDataset"===t?i=!0:i||(i="extractedScenePackage"===t||"i3sRestCache"===t),i}}}]);