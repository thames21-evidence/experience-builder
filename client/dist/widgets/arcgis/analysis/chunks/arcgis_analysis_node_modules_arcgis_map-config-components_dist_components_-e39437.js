/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-e39437.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-e39437"],{29862:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigEffectPopovers:()=>P});var a=s(73679),l=s(4395),i=s(90628),c=s(52797),r=s(83552),n=s(60300),o=s(66228),p=s(85643),u=s(73801);const h="panel",d="auto",f="effects-content",g="bottom-space",m="switch",$=e=>{e.stopPropagation()},v=e=>{e.target.setFocus?.(),e.preventDefault()},b=e=>{const{disabled:t,min:s,max:a,step:i,value:c,units:r,classNames:n,label:o}=e;return l.qy`<div class=${`select-number ${n}`}><calcite-slider .disabled=${t} .min=${s} .max=${a} .value=${c} .step=${i} snap label-ticks .ticks=${a-s} .minLabel=${o} @calciteSliderInput=${t=>y(t,e)}></calcite-slider><calcite-input type=number @click=${$} .disabled=${t} .min=${s} .max=${a} .value=${`${c}`} scale=s .step=${i} .suffixText=${r} @calciteInputInput=${t=>y(t,e)} class="select-number__input" .label=${o}></calcite-input></div>`};function y(e,t){const s=e.currentTarget,a=s.parentElement.querySelector("calcite-slider"),l=s.parentElement.querySelector("calcite-input"),i=Number(s.value),r=Math.min(t.max,Math.max(t.min,i));if(r===a.value&&`${r}`===l.value)return;a.value=r,l.value=`${r}`;const n=r.toLocaleString(c.getLocale());l.querySelectorAll("input").forEach(e=>e.value=n),t.onValueChange(r,s)}const x=l.AH`.popover{--calcite-popover-z-index: 99}.panel{width:291px}.panel.filter{min-height:500px;background-color:var(--calcite-color-background)}.effects-content{padding:1rem;background-color:#fff;max-height:80vh}.bottom-space{margin-bottom:1.8rem}.bottom-space-little{margin-bottom:.5rem}.switch{width:100%;display:flex;justify-content:space-between}.reset{display:flex;align-items:center}.sub-header{margin-left:.75rem;margin-right:0}:dir(rtl){.sub-header{margin-right:.75rem;margin-left:0}}.select-number{display:flex;align-items:center;justify-content:space-between;position:relative;calcite-slider{width:58%;height:30px;margin:0 4px;overflow-wrap:normal;word-break:normal}}.offset-div{align-items:center;display:flex;justify-content:space-between;gap:16px;margin-bottom:var(--calcite-spacing-md)}`;class P extends u.WF{constructor(){super(...arguments),this._direction=(0,r.jH)(),this.defaultExpression=!1,this.popoverNode=(0,p._)(),this.panelNode=(0,p._)(),this.closeNode=(0,p._)(),this.sqlExpressionConfigNode=(0,p._)(),this.xySliderNode=(0,p._)(),this.xOffsetNode=(0,p._)(),this.yOffsetNode=(0,p._)(),this.open=!1,this.arcgisApplyLayerEffect=(0,u.lh)(),this.arcgisClose=(0,u.lh)(),this.arcgisFilterChange=(0,u.lh)(),this.arcgisReady=(0,u.lh)()}static{this.properties={props:0,type:1,open:5,referenceElement:0}}static{this.styles=x}async callQuerySelector(e){return this.el.shadowRoot?this.el.shadowRoot.querySelector(e):null}async callQuerySelectorAll(e){return this.el.shadowRoot?this.el.shadowRoot?.querySelectorAll(e):[]}async reposition(){this.popoverNode.value?.reposition()}async setFocus(){(this.sqlExpressionConfigNode.value||this.closeNode.value)?.setFocus()}async updateHeader(e){const{props:t,sqlExpressionConfigNode:{value:s}}=this,{_messages:a}=t;if(s){const t=e.replace("_light","").replace("_dark","");s.panelHeading=a.featureEffectsTitle[t]||a.effectsTitle[e]}}load(){const{props:e}=this,{layer:t}=e;t.featureEffect||(this.defaultExpression=!0)}loaded(){this.arcgisReady.emit(this.type)}onOpen(){setTimeout(()=>requestAnimationFrame(()=>this.closeNode.value?.setFocus()),1)}onPropChange(){const{type:e}=this;this.arcgisApplyLayerEffect.emit({type:e})}onReset(){const{type:e,props:t,popoverNode:{value:s}}=this,a=i.l[e];switch(e){case"bloom":{const e=s.querySelectorAll("calcite-input");e[0].value=`${a.strength}`,e[1].value=`${(0,n.p)(a.radius)}`,e[2].value=`${Math.round(100*a.threshold)}`;const t=s.querySelectorAll("calcite-slider");t[0].value=a.strength,t[1].value=(0,n.p)(a.radius),t[2].value=Math.round(100*a.threshold);break}case"dropShadow":{const e=(0,i.g)(t);s.querySelector("calcite-color-picker").value=this.rgb2Hex(a[e].color);const l=s.querySelectorAll("calcite-input");l[0].value=`${Math.round((0,n.p)(a[e].blurRadius))}`,l[1].value=`${Math.round((0,n.p)(a[e].xoffset))}`,l[2].value=""+-Math.round((0,n.p)(a[e].yoffset)),l[3].value=""+a[e].color[3]/255*100;const c=s.querySelectorAll("calcite-slider");c[0].value=Math.round((0,n.p)(a[e].blurRadius)),c[1].value=a[e].color[3]/255*100;const r=s.querySelectorAll("arcgis-map-config-xy-slider")[0];r.x=Math.round((0,n.p)(a[e].xoffset)),r.y=Math.round((0,n.p)(a[e].yoffset));break}case"blur":s.querySelector("calcite-input").value=`${(0,n.p)(a.radius)}`,s.querySelector("calcite-slider").value=(0,n.p)(a.radius);break;case"brightnessContrast":{const e=i.l.brightness,t=i.l.contrast,a=s.querySelectorAll("calcite-input");a[0].value=`${Math.round(100*e.amount)}`,a[1].value=`${Math.round(100*t.amount)}`;const l=s.querySelectorAll("calcite-slider");l[0].value=Math.round(100*e.amount),l[1].value=Math.round(100*t.amount);break}case"grayscale":case"saturate":case"invert":case"sepia":s.querySelector("calcite-input").value=""+100*a.amount,s.querySelector("calcite-slider").value=100*a.amount;break;case"hueRotate":s.querySelector("calcite-input").value=`${a.angle}`,s.querySelector("calcite-slider").value=a.angle}this.arcgisApplyLayerEffect.emit({type:e})}rgb2Hex(e){return`#${this.componentToHex(Math.max(0,Math.min(255,e[0])))}${this.componentToHex(Math.max(0,Math.min(255,e[1])))}${this.componentToHex(Math.max(0,Math.min(255,e[2])))}`}componentToHex(e){const t=e.toString(16);return 1===t.length?`0${t}`:t}waitOnUser(e,t,s){const a=e.target;this.typingHandle&&(clearTimeout(this.typingHandle),this.typingHandle=void 0);const l=a.value,i=Number.parseFloat(l);l?(0,o.i)(a.min)&&(0,o.i)(a.max)&&(a.min>i||a.max<i)?this.typingHandle=setTimeout(()=>{this.typingHandle=void 0,a.min>i?(a.value=`${a.min}`,t(a)):a.max<i&&(a.value=`${a.max}`,t(a))},750):(!l.startsWith("-")||0!==i&&!Number.isNaN(i))&&t(a):this.typingHandle=setTimeout(()=>{this.typingHandle=void 0,a.value=`${s}`,t(a)},2e3)}render(){const{props:e,referenceElement:t,type:s,open:a}=this,{_messages:i}=e,c=["featureEffect","dropShadow"].includes(s);return this.el.classList.add("js-app-flyout"),l.qy`<calcite-popover pointer-disabled .label=${i.effectsTitle[s]} offset-distance=10 .offsetSkidding=${c?10:100} .open=${a} placement=leading-start trigger-disabled class="arcgis-map-config-effect-popover popover" .referenceElement=${t} @calcitePopoverOpen=${this.onOpen} ${(0,p.K)(this.popoverNode)}>${"featureEffect"===s?this.renderFeatureEffectProps():this.renderLayerEffectProps()}</calcite-popover>`}renderLayerEffectProps(){const{props:e,referenceElement:t,type:s}=this,{_messages:a}=e,c="rtl"===this._direction,r=t.getBoundingClientRect();return l.qy`<calcite-panel .heading=${a.effectsTitle[s]} class=${(0,u.CP)(h)} style=${(0,u.zl)({maxHeight:.9*r.height+"px"})} ${(0,p.K)(this.panelNode)}>${i.a.includes(s)?l.qy`<calcite-action .text=${a.effectsProps.reset} scale=s slot=header-actions-end title=${a.effectsProps.reset??u.s6} @click=${this.onReset}><calcite-icon scale=s .icon=${c?"redo":"undo"}></calcite-icon></calcite-action>`:null}<calcite-action .text=${a.general.close} icon=x slot=header-actions-end title=${a.general.close??u.s6} @click=${()=>{this.arcgisClose.emit(),this.open=!1,this.popoverNode.value.open=!1,this.panelNode.value.closed=!1}} ${(0,p.K)(this.closeNode)}></calcite-action>${"bloom"===s?this.renderBloom():null}${"dropShadow"===s?this.renderDropShadow():null}${"blur"===s?this.renderBlur():null}${"brightnessContrast"===s?this.renderBrightnessContrast():null}${"grayscale"===s?this.renderGrayscale():null}${"hueRotate"===s?this.renderHueRotate():null}${"saturate"===s?this.renderSaturate():null}${"invert"===s?this.renderInvert():null}${"sepia"===s?this.renderSepia():null}</calcite-panel>`}renderBloom(){const{props:e,type:t}=this,{layer:s,_messages:a}=e,c=s,r=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${a.effectsProps.strength}</calcite-label>${b({min:0,max:5,step:.1,value:Math.round(10*r.strength)/10,classNames:g,label:a.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}<calcite-label scale=s @click=${v}>${a.effectsProps.radius}</calcite-label>${b({min:0,max:5,step:.1,value:Math.round(10*(0,n.p)(r.radius))/10,classNames:g,label:a.effectsProps.radius,onValueChange:this.onPropChange.bind(this)})}<calcite-label scale=s @click=${v}>${a.effectsProps.threshold}</calcite-label>${b({min:0,max:100,step:1,value:Math.round(100*r.threshold),classNames:g,label:a.effectsProps.threshold,onValueChange:this.onPropChange.bind(this)})}<calcite-label layout=inline-space-between scale=s class=${(0,u.CP)(m)}>${a.effectsProps.autoAdjust}<calcite-switch .checked=${!c.effect||"string"!=typeof c.effect} scale=s class=${(0,u.CP)(d)} @calciteSwitchChange=${this.onPropChange}></calcite-switch></calcite-label></div>`}renderDropShadow(){const{props:e,type:t}=this,{layer:s,_messages:a}=e,c=s,r=(0,i.h)(t,e),o=this.rgb2Hex(r.color);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s>${a.effectsProps.color}<calcite-color-picker scale=m .value=${o} saved-disabled @calciteColorPickerInput=${this.onPropChange}></calcite-color-picker></calcite-label><calcite-label scale=s>${a.effectsProps.width}</calcite-label>${b({min:0,max:20,step:1,value:Math.round((0,n.p)(r.blurRadius)),classNames:g,label:a.effectsProps.width,onValueChange:this.onPropChange.bind(this)})}<calcite-label scale=s>${a.effectsProps.offset}<div class="offset-div"><arcgis-map-config-xy-slider .x=${Math.round((0,n.p)(r.xoffset))} .y=${Math.round((0,n.p)(r.yoffset))} min-x=-20 min-y=-20 max-x=20 max-y=20 step=1 snappable @arcgisInput=${e=>{e.stopPropagation();const t=e.currentTarget;this.xOffsetNode.value.value=`${Math.round(t.x)}`,this.yOffsetNode.value.value=`${Math.round(-t.y)}`,this.onPropChange()}} ${(0,p.K)(this.xySliderNode)}></arcgis-map-config-xy-slider><div><calcite-label scale=s>${a.effectsProps.xOffset}<calcite-input scale=s type=number .placeholder=${a.effectsProps.xOffset} .value=${`${Math.round((0,n.p)(r.xoffset))}`} min=-20 max=20 @calciteInputInput=${e=>{const t=e.currentTarget;this.waitOnUser(e,()=>{this.xySliderNode.value.x=Number.parseInt(t.value),this.onPropChange()},0)}} ${(0,p.K)(this.xOffsetNode)}></calcite-input></calcite-label><calcite-label scale=s>${a.effectsProps.yOffset}<calcite-input scale=s type=number .placeholder=${a.effectsProps.yOffset} .value=${""+-Math.round((0,n.p)(r.yoffset))} min=-20 max=20 @calciteInputInput=${e=>{const t=e.currentTarget;this.waitOnUser(e,()=>{this.xySliderNode.value.y=-Number.parseInt(t.value),this.onPropChange()},0)}} ${(0,p.K)(this.yOffsetNode)}></calcite-input></calcite-label></div></div></calcite-label><calcite-label scale=s @click=${v}>${a.effectsProps.opacity}</calcite-label>${b({min:0,max:100,step:1,value:Math.round(r.color[3]/255*100),classNames:g,label:a.effectsProps.opacity,onValueChange:this.onPropChange.bind(this)})}<calcite-label layout=inline-space-between scale=s class=${(0,u.CP)(m)}>${a.effectsProps.autoAdjust}<calcite-switch .checked=${!c.effect||"string"!=typeof c.effect} scale=s class=${(0,u.CP)(d)} @calciteSwitchChange=${this.onPropChange}></calcite-switch></calcite-label></div>`}renderBlur(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.strength}</calcite-label>${b({min:0,max:30,step:.1,value:Math.round(10*(0,n.p)(a.radius))/10,classNames:g,label:s.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}</div>`}renderBrightnessContrast(){const{props:e}=this,{_messages:t}=e,s=(0,i.h)("brightness",e),a=(0,i.h)("contrast",e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${t.effectsProps.brightness}</calcite-label>${b({min:0,max:300,step:1,value:Math.round(100*s.amount),classNames:g,label:t.effectsProps.brightness,onValueChange:this.onPropChange.bind(this)})}<calcite-label scale=s @click=${v}>${t.effectsProps.contrast}</calcite-label>${b({min:0,max:300,step:1,value:Math.round(100*a.amount),classNames:g,label:t.effectsProps.contrast,onValueChange:this.onPropChange.bind(this)})}</div>`}renderGrayscale(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.strength}</calcite-label>${b({min:0,max:100,step:1,value:Math.round(100*a.amount),classNames:g,label:s.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}</div>`}renderHueRotate(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.degrees}</calcite-label>${b({min:0,max:360,step:1,value:a.angle,classNames:g,label:s.effectsProps.degrees,onValueChange:this.onPropChange.bind(this)})}</div>`}renderSaturate(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.strength}</calcite-label>${b({min:0,max:200,step:1,value:100*a.amount,classNames:g,label:s.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}</div>`}renderInvert(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.strength}</calcite-label>${b({min:0,max:100,step:1,value:Math.round(100*a.amount),classNames:g,label:s.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}</div>`}renderSepia(){const{props:e,type:t}=this,{_messages:s}=e,a=(0,i.h)(t,e);return l.qy`<div class=${(0,u.CP)(f)}><calcite-label scale=s @click=${v}>${s.effectsProps.strength}</calcite-label>${b({min:0,max:100,step:1,value:Math.round(100*a.amount),classNames:g,label:s.effectsProps.strength,onValueChange:this.onPropChange.bind(this)})}</div>`}renderFeatureEffectProps(){const{props:e,defaultExpression:t}=this,{view:s,layer:a,_messages:i}=e,c=function(e){const{layer:t}=e,{renderer:s}=t;if(s)switch(s.type){case"unique-value":return"predominance"===s.authoringInfo?.type?s.uniqueValueInfos[0].value:"relationship"===s.authoringInfo?.type?s.authoringInfo.field1.field:s.field;case"class-breaks":if(!s.visualVariables)return s.field;{let e=s.visualVariables.find(e=>"color"===e.type)?.field;if(e||(e=s.visualVariables.find(e=>"size"===e.type&&!e.target&&"$view.scale"!==e.valueExpression)?.field,e))return e}break;case"dot-density":return s.attributes?.[0].field}}(e);return l.qy`<arcgis-common-sql-expression-config class=${`${h} filter`} .view=${s} .layer=${a} hide-layer-title .noFilterMsg=${i.filter.tipMsg} .invalidHeading=${i.filter.invalidHeading} .invalidMsg=${i.filter.invalidMsg} mode=effects .defaultFieldName=${c} default-operator=&gt; .defaultExpression=${!!c&&t} hide-buttons closable panel-max-height=80vh @arcgisClose=${()=>{this.arcgisClose.emit(),this.popoverNode.value.open=!1,this.open=!1,setTimeout(()=>this.sqlExpressionConfigNode.value?.openPanel(),1)}} @arcgisChange=${e=>this.arcgisFilterChange.emit(e.detail)} ${(0,p.K)(this.sqlExpressionConfigNode)}></arcgis-common-sql-expression-config>`}}(0,a.c)("arcgis-map-config-effect-popovers",P)}}]);