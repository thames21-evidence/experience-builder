/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-287b95.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-287b95"],{42855:(e,t,s)=>{s.d(t,{a:()=>n,f:()=>a,l:()=>r,s:()=>i});var a=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(a||{}),r=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(r||{}),i=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(i||{}),n=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(n||{})},51956:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigTableColumnInfo:()=>c});var a=s(73679),r=s(4395),i=s(66228),n=s(85643),o=s(73801);const l=r.AH`.popover{--calcite-popover-z-index: 100}.panel{max-height:400px;max-width:420px}.info{background-color:var(--calcite-color-foreground-1);max-height:400px;max-width:420px;min-width:240px;overflow-x:hidden}`;class c extends o.WF{constructor(){super(...arguments),this.popoverNode=(0,n._)(),this.closeButtonNode=(0,n._)(),this.arcgisClose=(0,o.lh)(),this.arcgisSetupComplete=(0,o.lh)()}static{this.properties={props:0,fieldName:1,popoverReferenceElement:0,_messages:0}}static{this.styles=l}async reposition(){this.popoverNode.value?.reposition()}async load(){const{layer:e}=this.props;this.fieldsMap=await(0,i.g)(e)}loaded(){this.closeButtonNode.value?.setFocus()}render(){const{_messages:e,fieldName:t,fieldsMap:s,popoverReferenceElement:a}=this,i=s.get(t);return this.el.classList.add("js-app-flyout"),r.qy`<calcite-popover placement=leading .referenceElement=${a} offset-distance=-30 offset-skidding=0 open pointer-disabled overlay-positioning=fixed class="popover" .label=${e.fieldInfo} ${(0,n.K)(this.popoverNode)}><calcite-panel .heading=${i.alias||i.name} .description=${t} class="panel">${this.renderCloseButton()}${this.renderInfo()}</calcite-panel></calcite-popover>`}renderCloseButton(){const{_messages:e}=this;return r.qy`<calcite-action slot=header-actions-end scale=s .text=${e.close} icon=x @click=${()=>this.arcgisClose.emit()} ${(0,n.K)(this.closeButtonNode)}></calcite-action>`}renderInfo(){const{layer:e,view:t}=this.props,{fieldName:s}=this;return r.qy`<arcgis-field-info .fieldName=${s} .layer=${e} .view=${t} class="info" @arcgisFieldInfoComplete=${()=>{this.reposition(),this.arcgisSetupComplete.emit()}}></arcgis-field-info>`}}(0,a.c)("arcgis-map-config-table-column-info",c)},66228:(e,t,s)=>{s.d(t,{a:()=>w,b:()=>_,c:()=>P,d:()=>F,e:()=>$,f:()=>O,g:()=>g,h:()=>h,i:()=>d,j:()=>y,k:()=>v,l:()=>E,m:()=>N,n:()=>f,o:()=>I,p:()=>L,q:()=>T,r:()=>q,s:()=>x,t:()=>C,u:()=>b});var a=s(63438),r=s(18423),i=s(96086),n=s(91813),o=s(21255),l=s(13078),c=s(21303),p=s(12627),u=s(42855);const f=["feature","scene","geojson","csv","subtype-sublayer","oriented-imagery","catalog-footprint","sublayer"],m=["feature"];function d(e){return null!=e}function y(e,t,s){const a=t.fieldName;if(a.includes(u.f.expression)){const e=s.get(a);return e?.title?e.title:a}return x(e)&&e.getFieldConfiguration(a)?e.getFieldAlias(a)||a:t.label||a}async function g(e){return new Map((await v(e)).filter(e=>e.visible).map(e=>[e.name,e]))}function h(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach(e=>{const s=`${u.f.expression}${e.name}`;t.set(s,e)}),t}function w(e){return"map-image"===e?.layer?.type?u.s.mapImage:"subtype-sublayer"===e?.type?u.s.subtype:"tile"===e?.layer?.type?u.s.tile:"scene"===e?.type?u.s.scene:"ogc-feature"===e?.type?u.s.ogcFeature:"imagery"===e?.type?u.s.imagery:"imagery-tile"===e?.type?u.s.imageryTile:"wfs"===e?.type?u.s.wfs:"wcs"===e?.type?u.s.wcs:"wms"===e?.layer?.type?u.s.wms:"csv"===e?.type?u.s.csv:"geojson"===e?.type?u.s.geojson:"stream"===e?.type?u.s.stream:"oriented-imagery"===e?.type?u.s.orientedImagery:"catalog"===e?.type?u.s.catalog:"catalog-footprint"===e?.type?u.s.catalogFootprint:"knowledge-graph-sublayer"===e?.type?u.s.knowledgeGraphSublayer:"voxel"===e?.type?u.s.voxel:"parquet"===e?.type?u.s.parquet:u.s.feature}function b(e){const t=w(e);let s;return t===u.s.wms||t===u.s.mapImage?s=e?.layer.version:(t===u.s.imagery||t===u.s.feature||t===u.s.scene)&&(s=e.version),Number.parseFloat(s)}function x(e){return"fieldConfigurations"in e&&m.includes(e.type)}async function v(e){return await new Promise((t,s)=>{switch(w(e)){case u.s.feature:case u.s.ogcFeature:case u.s.stream:t(e.fields);break;case u.s.mapImage:{const a=e,r=a?.layer;r?.portalItem&&r.url.includes("https://demographics")&&r.url.includes(".arcgis.com")?r.portalItem?.fetchData().then(e=>{if(e?.thematicGroup){const s=new Map(a.fields.map(e=>[e.name,e])),r=e.thematicGroup.fieldNames,i=[];r.forEach(e=>{s.has(e)&&i.push(s.get(e))}),t(i)}else t(a.fields)}).catch(e=>{s(new Error(e))}):t(a.fields);break}case u.s.imagery:case u.s.imageryTile:case u.s.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}})}function I(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function N(e){return Number((100*(1-e)).toFixed(1))}function C(e){return Number((1-e/100).toFixed(3))}const F=(e,t)=>{const s=[];return e?.fieldInfos?.forEach(e=>{e.fieldName?.includes(u.f.expression)||s.push({name:e.fieldName,alias:e.label,type:"string"})}),s},_=async(e,t)=>{const s=new p.default;return s.geometry=t.extent,s.mapExtent=t.extent,s.returnGeometry=!0,s.tolerance=6,s.layerOption="popup",s.width=t.width,s.height=t.height,s.layerIds=[e.id],(await c.identify(e.layer.url,s))?.results?.[0]?.feature},$=async(e,t,s)=>{const a=await(await e.whenLayerView(t)).queryAggregates();return await k(s,a.features?.[0])},k=async(e,t)=>{let s;if(t)s=t.clone();else{s=new a.default;const t=F(e);if(t?.length){const e={};t.forEach(t=>{e[t.name]=""}),s.attributes=e}const i=new r.default;s.geometry=i}return s};function T(e,t){const s=t.startsWith("#"),a=t.startsWith(".");for((a||s)&&(t=t.slice(1));e;){if(s){if(e.id===t)return e}else if(a){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function P(e){if(w(e)===u.s.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(w(e)===u.s.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find(t=>{if(t.id===e.id)return t})?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function E(e,t,s){let a="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))a="number";else if(t.has(e)){const s=t.get(e);a=s.type?s.type.toLowerCase():""}else if(s.has(e)){const t=s.get(e);a=t.returnType?t.returnType.toLowerCase():""}else a="number";return a}async function O(e,t){try{const s=w(e);if(s===u.s.mapImage&&e.layer.version>=10.5&&!e.layer.capabilities?.operations?.supportsQuery&&e.layer.capabilities?.operations?.supportsIdentify)return{features:[await _(e,t)||await R(e,t)]};if(s===u.s.scene&&!e.capabilities?.operations?.supportsQuery)return{features:[await R(e,t)]};const a=s===u.s.ogcFeature||s===u.s.stream?await t.whenLayerView(e):e,r=a.createQuery();r.where=a.definitionExpression||"1=1",r.outFields=["*"],r.returnM="hasM"in e&&e.hasM,r.returnZ="hasZ"in e&&e.hasZ,r.outSpatialReference=t.spatialReference,r.returnGeometry=!0,(a.sourceJSON?.advancedQueryCapabilities?.supportsPagination||s===u.s.ogcFeature)&&(r.start=0,r.num=1),r.outSpatialReference=t.spatialReference;const i=await a.queryFeatures(r);return i?.features?.length||(i.features[0]=await R(e,t)),i}catch(e){console.error(e)}}async function R(e,t){return await new Promise(s=>{const r=new a.default;if(e.fields?.length){const t={};e.fields.forEach(e=>{t[e.name]=e.defaultValue}),r.attributes=t}const c=t.extent;let p;"polygon"===e.geometryType?p=o.default.fromExtent(c):"point"===e.geometryType?p=c.center.clone():"multipoint"===e.geometryType?p=new i.default({points:[[c.center.x,c.center.y]],spatialReference:c.center.spatialReference.clone()}):"polyline"===e.geometryType?(p=new n.default({spatialReference:t.spatialReference.clone()}),p.addPath([[c.xmin,c.ymin],[c.xmax,c.ymax]])):"mesh"===e.geometryType&&(p=l.default.createBox(c.center.clone(),{size:{width:50,height:50,depth:50}})),r.geometry=p,s(r)})}function q(e){return w(e)===u.s.tile&&"url"in e&&"sublayer"===e.type&&-1===e.url?.indexOf(e.parent.url)&&!!e.fields?.length}function L(e){return w(e)===u.s.tile&&"url"in e&&"sublayer"===e.type&&-1!==e.url?.indexOf(e.parent.url)&&!!e.fields?.length}}}]);