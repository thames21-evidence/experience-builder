/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-030ddd.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-030ddd"],{35799:(e,t,s)=>{s.r(t),s.d(t,{ArcgisMapConfigSmartMappingRasterPresetRendererDialog:()=>h});var a=s(73679),r=s(4395),i=s(5724),n=s(31521),l=(s(52797),s(54312),s(44345),s(55448),s(34031),s(63438),s(5933),s(28927),s(83368),s(89704),s(5294),s(18423),s(96086),s(91813),s(21255),s(13078),s(21303),s(12627),s(1225)),o=(s(56451),s(23054),s(5077),s(23795),s(17902),s(87420),s(30161),s(81734),s(75698),s(10628),s(59640),s(64451),s(6176),s(83552),s(77462),s(49403),s(10281),s(83930),s(66617),s(10454),s(29614),s(94916),s(52554),s(2156),s(4038),s(49851),s(75054),s(15223),s(70169),s(47207),s(70852),s(48103),s(39423),s(85681),s(18444),s(42411),s(9767),s(38218),s(86605),s(68196),s(440),s(46547),s(6238),s(7299),s(91914),s(73801));const c=e=>{const{serviceRasterInfo:t}=e;return t?.multidimensionalInfo?.variables?.map(({name:e})=>e)??[]},d=(e,t)=>p(e)&&!t?.presetRenderers?.find(({name:t})=>t===e),p=e=>!!e?.trim().length;class h extends o.WF{constructor(){super(...arguments),this.presetRendererName="",this.styleOptions=[],this.processingOptions=[],this.rasterFunctionNames=[],this.variableNames=[],this.showDialog=!1,this.open=!1,this.arcgisClose=(0,o.lh)()}static{this.properties={state:16,showDialog:16,currentInternalMode:16,layer:0,mode:1,open:5,originalRasterProps:0,smartMappingState:0}}load(){this.init(),this.showDialog=this.open}async init(){const{smartMappingState:e}=this;this.presetRendererName=this.layer.activePresetRendererName??"",this.styleOptions=this.getRendererOptions(),this.rasterFunctionNames=(0,l.aA)(this.layer),this.variableNames=c(this.layer),this.processingOptions=this.getProcessingTypeOptions(),this.rasterFunctionNames.length||(this.processingOptions=this.processingOptions.filter(({type:e})=>"raster-function-template"!==e)),this.variableNames.length||(this.processingOptions=this.processingOptions.filter(({type:e})=>"variable"!==e)),this.currentInternalMode=this.mode,this.state=((e,t,s,a)=>{if("edit"===t){const t=s.presetRenderers?.find(({name:e})=>e===a),{name:r,method:i="none",renderer:n,value:o=""}=t??{};return{styleName:r??"",isValidName:!0,styleType:(0,l.az)(e,t)?"raster-rgb":n?.type,processingType:i,processingValue:o,isValidProcessingValue:!0}}{const{renderer:t,rasterFunction:a,type:r}=s,i=a?.functionName??(0,l.aA)(s)?.[0],n=("imagery"===r?s.mosaicRule?.multidimensionalDefinition:s?.multidimensionalDefinition)?.[0]?.variableName??c(s)?.[0],o=i&&"None"!==i;return{styleName:"",isValidName:!0,styleType:(0,l.az)(e)?"raster-rgb":t?.type,processingType:o?"raster-function-template":n?"variable":"none",processingValue:o?i:n??"",isValidProcessingValue:!0}}})(e,this.mode,this.layer,this.presetRendererName)}handleStyleNameChange(e){const{layer:t,currentInternalMode:s,presetRendererName:a}=this,r=e.target.value?.trim();this.state="edit"!==s||r!==a?{...this.state,styleName:r,isValidName:!!r&&d(r,t)}:{...this.state,isValidName:!0}}async handleProcessingTypeChange(e){const{rasterFunctionNames:t,variableNames:s}=this,a=e.target.value;let r="",i=!0;"raster-function-template"===a?(r=t?.[0],i=await this.isValidRFT(r)):"variable"===a&&(r=s?.[0]),this.state={...this.state,processingType:a,processingValue:r,isValidProcessingValue:i}}async handleProcessingValueChange(e){const t=e.target.value,s=await this.isValidRFT(t);this.state={...this.state,processingValue:t,isValidProcessingValue:s}}handleDelete(){const{presetRendererName:e}=this;((e,t)=>{e&&(t.presetRenderers=t.presetRenderers?.filter(({name:t})=>t!==e),t.bandIds=[],t.activePresetRendererName=void 0)})(e,this.layer),this.showDialog=!1,this.arcgisClose.emit("delete")}handleRegister(){const{styleName:e,processingType:t,processingValue:s}=this.state,a=e.trim();if(!a)return void(this.state={...this.state,isValidName:!1});const r=new i.default({method:t,name:a,value:s});if(this.layer.renderer)if(d(a,this.layer)){if(r.bandIds=this.layer.bandIds??[],r.renderer=this.layer.renderer.clone(),"edit"===this.mode&&"save-as"===this.currentInternalMode){const e=this.layer.presetRenderers?.find(({name:e})=>e===this.presetRendererName),t=(0,l.U)(this.smartMappingState);e&&(["raster-flow","raster-rgb","raster-stretch"].includes(t)&&(this.layer.effect=this.originalRasterProps?.originalEffect,("raster-rgb"===t||"raster-stretch"===t)&&(this.layer.bandIds=this.originalRasterProps?.originalBandCombination)),(0,l.ag)(this.smartMappingState,this.originalRasterProps?.originalRendererObj))}((e,t)=>{!e||(e.name=e.name?.trim(),!d(e?.name,t))||(t.presetRenderers=t.presetRenderers??[],t.presetRenderers.push(e))})(r,this.layer),(0,l.aB)(r.name,this.layer),this.arcgisClose.emit("register"),this.showDialog=!1}else this.state={...this.state,isValidName:!1};else this.showDialog=!1}async handleSave(){const{styleName:e,processingType:t,processingValue:s}=this.state,a=e.trim();if(!a)return void(this.state={...this.state,isValidName:!1});const r=new i.default({method:t,name:a,value:s}),n=this.layer.presetRenderers?.find(({name:e})=>e===this.presetRendererName);n?(r.bandIds=n.bandIds,r.renderer=n.renderer,((e,t,s)=>{s.presetRenderers?.find(({name:t})=>t===e)&&(s.presetRenderers=s.presetRenderers?.map(s=>s?.name===e?t:s),s.activePresetRendererName===e&&(0,l.aB)(t.name,s))})(this.presetRendererName,r,this.layer),this.smartMappingState.rasterInfo=await(0,l.a5)(this.layer),this.showDialog=!1,this.arcgisClose.emit("save")):this.showDialog=!1}handleSaveAs(){this.state={...this.state,styleName:"",isValidName:!0},this.currentInternalMode="save-as"}handleCancel(){this.showDialog=!1,this.arcgisClose.emit("cancel")}getRendererOptions(){const{smartMappingState:{_messages:e}}=this;return[{type:"class-breaks",label:e.tile.symbologyClassBreaksStyle},{type:"unique-value",label:e.tile.symbologyUniqueValuesStyle},{type:"raster-stretch",label:e.tile.symbologyStretchStyle},{type:"raster-rgb",label:e.tile.symbologyRGBStyle},{type:"raster-shaded-relief",label:e.tile.symbologyShadedReliefStyle},{type:"raster-colormap",label:e.tile.symbologyColormapStyle},{type:"vector-field",label:e.tile.symbologyVectorFieldStyle},{type:"flow",label:e.tile.rasterFlowStyle}]}getProcessingTypeOptions(){const{smartMappingState:{_messages:e}}=this;return[{type:"raster-function-template",label:e.rasterPresetRenderer.rasterFunctionTemplate},{type:"variable",label:e.rasterPresetRenderer.variable},{type:"none",label:e.rasterPresetRenderer.none}]}async isValidRFT(e){const{smartMappingState:t,state:s}=this,{layer:a}=t,r=a,{processingType:i}=s,o=(0,l.U)(t),c="raster-function-template"===i?{functionName:e}:void 0;return!!(await n.getSupportedRendererInfo({layer:r,rasterFunction:c}))?.supportedTypes?.includes(o)}render(){const{currentInternalMode:e,state:t,smartMappingState:{_messages:s}}=this,a="register"===e?s.rasterPresetRenderer.registerStyle:"edit"===e?s.rasterPresetRenderer.editStyle:s.rasterPresetRenderer.registerStyle;if(!this.showDialog)return"";if(!t)return r.qy`<calcite-dialog .heading=${a} modal open width=s>${this.renderLoader()}${this.renderFooterAction({disabled:!0})}</calcite-dialog>`;const{isValidName:i,isValidProcessingValue:n}=t;return r.qy`<calcite-dialog id=imagery-preset-style .heading=${a} modal open width=s @calciteDialogClose=${()=>this.handleCancel()}>${this.renderStyleNameInput()}${this.renderStyleTypeSelect()}${this.renderProcessingTypeSelect()}${this.renderProcessingValue()}${this.renderFooterAction({disabled:!i||!n})}</calcite-dialog>`}renderStyleNameInput(){const{state:e,smartMappingState:{_messages:t}}=this,{styleName:s,isValidName:a}=e;return r.qy`<calcite-label>${t.rasterPresetRenderer.styleName}<calcite-input-text .value=${s} .placeholder=${t.rasterPresetRenderer.enterStyleName} @calciteInputTextInput=${this.handleStyleNameChange} .status=${a?"valid":"invalid"} validation-icon=exclamation-mark-triangle .validationMessage=${s?t.rasterPresetRenderer.duplicateNameError.replace("${name}",s):t.rasterPresetRenderer.emptyNameError}></calcite-input-text></calcite-label>`}renderStyleTypeSelect(){const{state:e,smartMappingState:{_messages:t}}=this,{styleType:s}=e;return r.qy`<calcite-label>${t.rasterPresetRenderer.styleType}<calcite-select disabled .label=${t.rasterPresetRenderer.styleType} .value=${s}>${this.styleOptions.map(({type:e,label:t})=>r.qy`<calcite-option .value=${e}>${t}</calcite-option>`)}</calcite-select></calcite-label>`}renderProcessingTypeSelect(){const{currentInternalMode:e,state:t,smartMappingState:{_messages:s}}=this,{processingType:a}=t;return r.qy`<calcite-label>${s.rasterPresetRenderer.processingType}<calcite-select .label=${s.rasterPresetRenderer.processingType} .disabled=${"register"===e||"save-as"===e} .value=${a} @calciteSelectChange=${async e=>await this.handleProcessingTypeChange(e)}>${this.processingOptions.map(({type:e,label:t})=>r.qy`<calcite-option .value=${e}>${t}</calcite-option>`)}</calcite-select></calcite-label>`}renderProcessingValue(){const{currentInternalMode:e,rasterFunctionNames:t,state:s,smartMappingState:{_messages:a},variableNames:i}=this,{processingType:n,processingValue:l,isValidProcessingValue:o}=s;if("none"===n)return"";const c="raster-function-template"===n?t:i;return r.qy`<calcite-label>${a.rasterPresetRenderer.name}<calcite-select .label=${a.rasterPresetRenderer.name} .disabled=${"register"===e||"save-as"===e} .value=${l} .status=${o?"valid":"invalid"} validation-icon=exclamation-mark-triangle .validationMessage=${a.rasterPresetRenderer.rftError} @calciteSelectChange=${async e=>await this.handleProcessingValueChange(e)}>${c.map(e=>r.qy`<calcite-option .value=${e}>${e}</calcite-option>`)}</calcite-select></calcite-label>`}renderFooterAction({disabled:e=!1}){const{currentInternalMode:t,smartMappingState:{_messages:s}}=this;return r.qy`${"edit"===t&&r.qy`<calcite-button slot=footer-end kind=danger appearance=outline @click=${()=>this.handleDelete()}>${s.rasterPresetRenderer.deleteRegisteredStyle}</calcite-button>`||""}<calcite-button slot=footer-end kind=brand appearance=outline @click=${()=>this.handleCancel()}>${s.rasterPresetRenderer.cancel}</calcite-button>${("register"===t||"save-as"===t)&&r.qy`<calcite-button slot=footer-end .disabled=${e} kind=brand @click=${()=>this.handleRegister()}>${s.rasterPresetRenderer.save}</calcite-button>`||""}${"edit"===t&&r.qy`<calcite-split-button slot=footer-end .disabled=${e} .primaryText=${s.rasterPresetRenderer.save} overlay-positioning=fixed @calciteSplitButtonPrimaryClick=${()=>this.handleSave()}><calcite-dropdown-item @calciteDropdownItemSelect=${()=>this.handleSaveAs()}>${s?.rasterPresetRenderer.saveAs}</calcite-dropdown-item></calcite-split-button>`||""}`}renderLoader(){const{smartMappingState:{_messages:e}}=this;return r.qy`<calcite-loader .label=${e.rasterPresetRenderer.imagePresetStyleLoader}></calcite-loader>`}}(0,a.c)("arcgis-map-config-smart-mapping-raster-preset-renderer-dialog",h)}}]);