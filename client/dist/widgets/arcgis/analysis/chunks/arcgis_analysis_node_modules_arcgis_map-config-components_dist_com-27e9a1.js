/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-27e9a1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-27e9a1"],{3782:(e,t,a)=>{a.r(t),a.d(t,{ArcgisMapConfigSmartMappingPanelsRasterUniqueValue:()=>v});var l=a(73679),s=a(4395),i=a(46317),o=a(5294),n=a(56451),r=a(41631),d=a(77462),u=a(81734),c=a(1225),p=(a(54312),a(44345),a(55448),a(52797),a(34031),a(63438),a(5933),a(75518)),h=(a(89704),a(18423),a(96086),a(91813),a(21255),a(13078),a(21303),a(12627),a(44263)),m=a(65595),g=(a(23054),a(49403),a(5077),a(30161),a(66617),a(10628),a(59640),a(64451),a(6176),a(10454),a(29614),a(94916),a(52554),a(2156),a(4038),a(49851),a(75054),a(15223),a(70169),a(47207),a(70852),a(48103),a(39423),a(85681),a(18444),a(42411),a(9767),a(38218),a(91914),a(31521),a(86605),a(68196),a(440),a(46547),a(28927),a(6238),a(32173)),b=a(85643),f=a(73801);const y=s.AH`:host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.unique-value-block{overflow-x:hidden;overflow-wrap:anywhere}.label{padding:5px auto}.symbol{width:19px;height:19px}.symbol:focus,.label:focus{outline:2px solid var(--calcite-color-brand)}.symbol-container{cursor:pointer}.selected{outline:1px solid var(--calcite-color-brand)}.hidden{display:none}.gray-border{border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0}.checkbox{margin:0 5.5px}.default-list-padding{padding-top:8px}.footer-buttons{width:100%;display:flex;flex-direction:column;gap:var(--calcite-spacing-sm)}`;class v extends f.WF{constructor(){super(...arguments),this.flowItemNode=(0,b._)(),this.listNode=(0,b._)(),this.defaultListNode=(0,b._)(),this.manageStyleButtonNode=(0,b._)(),this.registerStyleButtonNode=(0,b._)(),this.symbolButtonNode=(0,b._)(),this.inputNodes=[],this.labelNodes=[],this.colorNodes=[],this.otherValuesListNode=(0,b._)(),this.smartMappingState=(0,m.u)(),this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.arcgisSmartMappingPanelsRasterUniqueValueBackClick=(0,f.lh)(),this.arcgisSmartMappingPanelsRasterUniqueValueClose=(0,f.lh)(),this.arcgisSmartMappingPanelsRasterUniqueValueError=(0,f.lh)()}static{this.properties={menuOpen:5,showBackButton:5,selected:7,beforeBack:0}}static{this.styles=y}async setFocus(){await(this.flowItemNode.value?.setFocus())}load(){const{_messages:e}=this.smartMappingState,t=(0,c.T)(this.smartMappingState),a=(0,c.U)(this.smartMappingState);this.smartMappingState.lastDefault={defaultSymbol:t.defaultSymbol||(0,c.e)(this.smartMappingState,a),defaultLabel:t.defaultLabel||e.panels.uniqueValue.other},this.originalRendererObj=o.clone((0,c.T)(this.smartMappingState))}async loaded(){requestAnimationFrame(async()=>await(this.flowItemNode.value?.setFocus()))}updated(){this.updateNodeHandles(this.listNode.value),this.updateNodeHandles(this.defaultListNode.value)}disconnectedCallback(){super.disconnectedCallback(),this.popoverNode?.remove(),(0,g.r)()}updateNodeHandles(e){e&&queueMicrotask(()=>{e.querySelectorAll(".symbol").forEach(e=>{const t=Number.parseInt(e.getAttribute("data-value"));-1===t?this.defaultColorNode=e:this.colorNodes[t]=e}),e.querySelectorAll(".input").forEach(e=>{const t=Number.parseInt(e.getAttribute("data-value"));-1===t?this.defaultInputNode=e:this.inputNodes[t]=e,this.defaultInputNode?.classList.add("default-input-padding")}),e.querySelectorAll(".label").forEach(e=>{if(e){const t=Number.parseInt(e.getAttribute("data-value"));-1===t?this.defaultLabelNode=e:this.labelNodes[t]=e}}),e.querySelectorAll(".inner-div").forEach(e=>{const{smartMappingState:t}=this,a=Number.parseInt(e.getAttribute("data-value")),l=(0,c.T)(t),s=(0,c.U)(t),i=-1===a?l.defaultSymbol||(0,c.e)(t,s):l.uniqueValueInfos[a].symbol.clone();-1===a&&i.outline&&(i.outline.width=0),(0,c.ad)(i)&&(i.outline=new d.default({color:"#bdc3c7",width:.75})),i&&r.renderPreviewHTML(i,{size:(0,c.ac)(i),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then(t=>e?.replaceChildren(t))})})}symbolClickHandler(e){this.popoverNode?((-1===this.selectedPopoverIdx?this.defaultColorNode:this.colorNodes[this.selectedPopoverIdx]).classList.remove("selected"),this.selectedPopoverIdx===e?((0,c.f)(),this.popoverNode=void 0,this.selectedPopoverIdx=void 0):(this.selectedPopoverIdx=e,this.handleColorClick(e))):(this.selectedPopoverIdx=e,this.handleColorClick(e))}labelClickHandler(e){const t=-1===e?this.defaultInputNode:this.inputNodes[e];t.classList.remove("hidden"),t.setFocus(),(-1===e?this.defaultLabelNode:this.labelNodes[e]).classList.add("hidden")}defaultSymbolCheckboxRefHandler(e){e&&(this.checkboxNode=e)}handleDone(){this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("save")}handleCancel(){const{originalRendererObj:e,smartMappingState:t}=this;(0,c.ag)(t,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("cancel")}handleFieldChange(e){const{smartMappingState:t}=this,a=(0,c.T)(t);if(!a.uniqueValueInfos.length)return;const l={field:e};!(0,c.I)(t)&&a.authoringInfo?.colorRamp&&(l.colorRamp=a.authoringInfo.colorRamp),(0,p.r)((0,c.ai)(t,l),this.flowItemNode.value).then(e=>{(0,c.ag)(t,e.renderer),this.requestUpdate()},e=>{this.fieldNode.value=a.field,this.arcgisSmartMappingPanelsRasterUniqueValueError.emit(e)})}handleSortValues(e){const{smartMappingState:t}=this,{_messages:a}=t,l=(0,c.U)(t),s=(0,c.T)(t);(0,c.f)();const i=e.map(e=>e.value),n=s.uniqueValueInfos.map(e=>o.clone(e));n.sort((e,t)=>i.indexOf(`${e.value}`)-i.indexOf(`${t.value}`)),n.length?s.uniqueValueInfos=n:(s.defaultSymbol=(0,c.e)(t,l),s.defaultLabel=a.panels.uniqueValue.other),(0,c.ag)(t),this.requestUpdate()}handleColorClick(e){(0,c.f)();const{smartMappingState:t}=this,{_messages:a}=t,l=(0,f.dN)(s.qy`<arcgis-map-config-smart-mapping-symbol-styler-popover .referenceElement=${this.flowItemNode.value} .heading=${a.panels.uniqueValue.colorScheme} .smartMappingState=${t} @arcgisSmartMappingSymbolStylerPopoverClose=${()=>this.handleRemoveColorFocus(l,e,!1)} @arcgisSmartMappingSymbolStylerPopoverDisconnected=${()=>this.handleRemoveColorFocus(l,e,!0)}></arcgis-map-config-smart-mapping-symbol-styler-popover>`);document.body.appendChild(l),this.smartMappingState.selectedValue=e,(0,h.b)(t,{symbolStylerPopoverNode:l,onChange:()=>{const l=(0,c.T)(t);-1===e&&!l.defaultLabel&&(l.defaultLabel=a.panels.uniqueValue.other),(0,c.ag)(t),this.requestUpdate(),this.symbolButtonNode.value&&this.symbolButtonNode.value.manager.component.requestUpdate()}}),this.popoverNode=l,-1===e?this.defaultColorNode.classList.add("selected"):this.colorNodes[e].classList.add("selected")}handleRemoveColorFocus(e,t,a){e.remove(),this.popoverNode=void 0,setTimeout(()=>{const e=-1===t?this.defaultColorNode:this.colorNodes[t];a||e.focus(),e.classList.remove("selected")},300)}handleValueTextChange(e,t){const{smartMappingState:a}=this,{_messages:l}=a,s=(0,c.T)(a);if(-1===e&&!s.defaultLabel)return void(0,c.ag)(a);const i=t.target;-1===e?s.defaultLabel=i.value:s.uniqueValueInfos[e].label=i.value,""===i.value&&(-1===e?s.defaultLabel=l.panels.uniqueValue.other:(s.uniqueValueInfos[e].label=`${s.uniqueValueInfos[e].value}`,this.inputNodes[e].value=s.uniqueValueInfos[e].label)),(0,c.ag)(a)}handleCheckboxClick(e){const{smartMappingState:t}=this,{lastDefault:a}=t,l=(0,c.T)(t);this.popoverNode?.remove(),this.popoverNode=void 0,(0,c.f)(),l.uniqueValueInfos.length?(l.defaultSymbol?(l.defaultSymbol=void 0,l.defaultLabel=void 0):(l.defaultSymbol=a.defaultSymbol,l.defaultLabel=this.defaultLabelNode.textContent),(0,c.ag)(t)):e.target.checked=!0}render(){const{hideLayerTitle:e,layer:t,_messages:a}=this.smartMappingState,l=t.title;return this.el.classList.add("calcite-match-height"),s.qy`<calcite-flow-item .heading=${a.panels.uniqueValue.styleOptions} .description=${e?void 0:l} class="flow-item" .closable=${(0,c.aa)(this.el)} .showBackButton=${this.showBackButton} .selected=${this.selected} @calciteFlowItemClose=${this.handleDone} @calciteFlowItemBack=${()=>this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit()} ${(0,b.K)(this.flowItemNode)}>${this.renderVisualization()}${this.renderFooterButtons()}</calcite-flow-item>`}renderVisualization(){const{smartMappingState:e}=this,{_messages:t}=e,a=(0,c.ah)(e,t.panels.uniqueValue.uniqueValue);return s.qy`<calcite-block class="unique-value-block" .heading=${a} expanded>${this.renderManageStyleButton()}${this.renderFieldSelector()}${this.renderColorScheme()}${this.renderValues()}</calcite-block>`}renderManageStyleButton(){return s.qy`<arcgis-map-config-smart-mapping-raster-preset-renderer-button mode=edit .originalRasterProps=${{originalRendererObj:this.originalRendererObj}} @arcgisDone=${e=>{"delete"!==e.detail?this.requestUpdate():this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit("delete")}} ${(0,b.K)(this.manageStyleButtonNode)}></arcgis-map-config-smart-mapping-raster-preset-renderer-button>`}renderFieldSelector(){const{smartMappingState:e}=this,{_messages:t}=e,a=(0,c.T)(e).field||t.panels.uniqueValue.value,l=(0,c.aj)(e),i=l.map(e=>({label:e.alias,layerField:e,simpleFieldType:c.J.STRING})),o=l.find(e=>e.name===a);return s.qy`<arcgis-map-config-smart-mapping-attribute-input .label=${t.panels.uniqueValue.field} .fieldList=${i} .selectedField=${{field:o?.name??t.panels.uniqueValue.value,simpleFieldType:c.J.STRING}} mode=simple .popoverReferenceElement=${this.flowItemNode.value} @arcgisSmartMappingAttributeInputChange=${e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}}></arcgis-map-config-smart-mapping-attribute-input>`}renderColorScheme(){const{smartMappingState:e}=this,{mapView:t,_messages:a}=e,l=(0,c.T)(e),i=l.uniqueValueInfos;if(!i.length)return"";const r=u.getSchemes({basemap:t.map?.basemap,geometryType:"polygon"}),d=(0,c.k)(r,Math.min(i.length,10))[0].colors,p=[];return l.authoringInfo?.colorRamp?p.push(...(0,c.ak)(l.authoringInfo.colorRamp)):p.push(...i?.length?i.map((e,t)=>(0,c.i)(e.symbol)||new n.default(d[t%d.length])):[]),s.qy`<arcgis-map-config-smart-mapping-symbol-button .label=${a.panels.uniqueValue.colorScheme} type=raster-unique-value ramp-type=continuous .colors=${o.clone(p).reverse()} @arcgisSmartMappingSymbolButtonSymbolChange=${()=>{(0,c.ag)(e),this.requestUpdate(),this.symbolButtonNode.value.manager.component.requestUpdate()}} ${(0,b.K)(this.symbolButtonNode)}></arcgis-map-config-smart-mapping-symbol-button>`}renderValues(){const{smartMappingState:e}=this,{_messages:t}=e,a=(0,c.T)(e),l=a.uniqueValueInfos?.map(e=>e.label+(e.symbol?.color?e.symbol.color?.toString():"")).toString();return s.qy`<calcite-label>${a.field}</calcite-label>${(0,i.D)(l,s.qy`<calcite-list .label=${t.panels.uniqueValue.uniqueValue} group=unique-value-items class="gray-border" drag-enabled @calciteListOrderChange=${e=>{if(e.detail.toEl){const t=e.detail.dragEl;if("other-values-list"===e.detail.toEl.id){const e=a.uniqueValueInfos.filter((e,a)=>a!==Number.parseInt(t.label));a.uniqueValueInfos=e}}const t=Array.from(e.target.children);this.handleSortValues(t)}} @calciteListDragEnd=${()=>{this.otherValuesListNode.value.querySelectorAll("calcite-list-item").forEach(e=>e.remove())}} ${(0,b.K)(this.listNode)}>${a.uniqueValueInfos.map((e,t)=>this.renderValue(e,t))}</calcite-list>`)}${this.renderDefaultValue()}<calcite-list .label=${t.panels.uniqueValue.uniqueValue} id=other-values-list drag-enabled group=unique-value-items ${(0,b.K)(this.otherValuesListNode)}></calcite-list>`}renderValue(e,t){return s.qy`<calcite-list-item .value=${`${e.value}`} .label=${`${t}`}><div slot=actions-start>${this.renderColorNode(e,t)}</div>${this.renderTextNode(e,t)}</calcite-list-item>`}renderColorNode(e,t){const{smartMappingState:a}=this,{_messages:l}=a,i=e.symbol.clone(),o={"symbol-is-white":(0,c.ad)(i),symbol:!0};return s.qy`<div class=${(0,f.CP)(o)} tabindex=0 .ariaLabel=${l.panels.uniqueValue.accessibility.editColorFor.replace("${value}",e.label)} aria-haspopup=true data-value=${t??f.s6} @click=${()=>this.symbolClickHandler(t)} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),this.symbolClickHandler(t))}}><div class="inner-div" data-value=${t??f.s6}></div></div>`}renderTextNode(e,t){const{_messages:a}=this.smartMappingState;return s.qy`<div class=${(-1===t?"default-label":"")+" label"} slot=content tabindex=0 data-value=${t??f.s6} .ariaLabel=${a.panels.uniqueValue.accessibility.editLabelFor.replace("${value}",e.label)} @click=${()=>this.labelClickHandler(t)} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&this.labelClickHandler(t)}}>${e.label}</div><calcite-input slot=content class="input hidden" scale=s data-value=${t??f.s6} .value=${e.label??void 0} @calciteInputChange=${e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],l=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),l.classList.remove("hidden"),this.handleValueTextChange(t,e),l.focus()}} @focusout=${e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],l=-1===t?this.defaultLabelNode:this.labelNodes[t];if(a.classList.add("hidden"),l.classList.remove("hidden"),this.handleValueTextChange(t,e),e.relatedTarget?.className.includes("label")){const t=Number.parseInt(e.relatedTarget.getAttribute("data-value"));this.labelClickHandler(t)}else if(e.relatedTarget?.className.includes("symbol")){const t=Number.parseInt(e.relatedTarget.getAttribute("data-value"));this.symbolClickHandler(t)}else l.focus()}} @keydown=${a=>{if(a.stopPropagation(),"Escape"===a.key){(-1===t?this.defaultInputNode:this.inputNodes[t]).classList.add("hidden");const l=a.currentTarget;l.value=e.label||"",l.disabled=!0,this.handleValueTextChange(t,a);const s=-1===t?this.defaultLabelNode:this.labelNodes[t];s.classList.remove("hidden"),l.disabled=!1,s.focus()}}}></calcite-input>`}renderDefaultValue(){const{smartMappingState:e}=this,{_messages:t}=e,a=(0,c.T)(e),l=(0,c.U)(e),o=a.defaultSymbol||(0,c.e)(e,l),n=a.defaultLabel||t.panels.uniqueValue.other,r={symbol:o,label:n};return s.qy`<calcite-list class="default-list-padding" .label=${n} ${(0,b.K)(this.defaultListNode)}><calcite-list-item>${(0,i.D)(a.defaultLabel,s.qy`<calcite-checkbox class="checkbox" slot=actions-start tabindex=0 .checked=${!!a.defaultSymbol} @click=${this.handleCheckboxClick} @keydown=${e=>{(" "===e.key||"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),this.handleCheckboxClick(e))}} @mouseover=${()=>(0,g.b)(this.checkboxNode,t.panels.uniqueValue.otherTooltip)} @mouseout=${()=>(0,g.r)()} @focus=${()=>(0,g.b)(this.checkboxNode,t.panels.uniqueValue.otherTooltip)} @focusout=${()=>(0,g.r)()} ${(0,b.K)(this.defaultSymbolCheckboxRefHandler)}></calcite-checkbox>`)}<div slot=content-start class="symbol-container">${this.renderColorNode(r,-1)}</div>${this.renderTextNode(r,-1)}</calcite-list-item></calcite-list>`}renderFooterButtons(){return s.qy`<div class="footer-buttons" slot=footer>${this.renderDoneButton()}${this.renderRegisterStyleButton()}${this.renderCancelButton()}</div>`}renderRegisterStyleButton(){return s.qy`<arcgis-map-config-smart-mapping-raster-preset-renderer-button mode=register @arcgisDone=${e=>{const{smartMappingState:t}=this;if(this.requestUpdate(),"register"===e.detail){const e=(0,c.T)(t);this.originalRendererObj=o.clone(e)}this.manageStyleButtonNode.value&&this.manageStyleButtonNode.value.manager.component.requestUpdate(),this.registerStyleButtonNode.value.manager.component.requestUpdate()}} ${(0,b.K)(this.registerStyleButtonNode)}></arcgis-map-config-smart-mapping-raster-preset-renderer-button>`}renderDoneButton(){const{_messages:e}=this.smartMappingState;return s.qy`<calcite-button .label=${e.done} @click=${this.handleDone} appearance=solid width=full>${e.done}</calcite-button>`}renderCancelButton(){const{_messages:e}=this.smartMappingState;return s.qy`<calcite-button .label=${e.cancel} @click=${this.handleCancel} appearance=outline-fill width=full>${e.cancel}</calcite-button>`}}(0,l.c)("arcgis-map-config-smart-mapping-panels-raster-unique-value",v)},32173:(e,t,a)=>{a.d(t,{A:()=>i,a:()=>r,b:()=>o,r:()=>n});var l=a(4395),s=a(73801);function i(e,t,a,i=!0){const o=document.getElementById(a);o&&o.remove();const n=(0,s.dN)(l.qy`<calcite-tooltip class="smart-mapping-tooltip" id=${a??s.s6} .referenceElement=${e} .open=${i} .innerHTML=${t??""}></calcite-tooltip>`);document.body.append(n)}function o(e,t,a=!0,i){const o=(0,s.dN)(l.qy`<calcite-tooltip class="smart-mapping-tooltip" .referenceElement=${e} .open=${a} .placement=${i??"auto"} .innerHTML=${t??""}></calcite-tooltip>`);document.body.append(o)}function n(){document.querySelectorAll(".smart-mapping-tooltip").forEach(e=>e.remove())}function r(e){const t=document.getElementById(e);"smart-mapping-tooltip"===t?.className&&t.remove()}},46317:(e,t,a)=>{a.d(t,{D:()=>o});var l=a(85282),s=a(34670),i=a(42466);const o=(0,s.u$)(class extends s.WL{constructor(){super(...arguments),this.key=l.s6}render(e,t){return this.key=e,t}update(e,[t,a]){return t!==this.key&&((0,i.mY)(e),this.key=t),a}})},75518:(e,t,a)=>{let l,s;function i(e){e.loading=!1}async function o(e,t){return function(e){e.loading=!0,s=!1,l&&clearTimeout(l),l=setTimeout(()=>{i(e),s=!0},6e4)}(t),await e.then(e=>{if(i(t),s)throw new Error("timeout");return e}).catch(e=>{throw i(t),e})}a.d(t,{r:()=>o})}}]);