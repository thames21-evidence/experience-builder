/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-4b6417.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_com-4b6417"],{16608:(e,t,a)=>{a.d(t,{o:()=>s,s:()=>i});const i=["csv","feature","geojson","oriented-imagery","stream","subtype","wfs","knowledge-graph-sublayer"],s={minOffsetX:-20,minOffsetY:-20,maxOffsetX:20,maxOffsetY:20}},27155:(e,t,a)=>{a.d(t,{i:()=>s});var i=a(12762);function s(e){if(!e)return;let t=i.default.assetsPath;t.endsWith("/")||(t+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${t}esri/themes/light/main.css" />`)}},34216:(e,t,a)=>{a.d(t,{a:()=>c,b:()=>d,g:()=>l,s:()=>o});var i=a(43811),s=a(20880),n=a(42855),r=a(66228);async function l(e,t,a){if(a===n.l.feature){const a=await(0,r.k)(e);if(t?.fieldInfos){let e=[];return a.filter(e=>["string","small-integer","big-integer","integer","single","double","long","date","date-only","time-only","timestamp-offset","oid","guid","global-id"].includes(e.type)).forEach(a=>{e=[...e,a.clone()];const i=t.fieldInfos.find(e=>e.fieldName===a.name);i&&(e[e.length-1].alias=i.label)}),e}return a}return(0,r.d)(t)}async function o(e,t,a,n){let r;r="binning"===e.featureReduction?.type?await s.getLabelSchemes({layer:e,field:a}):await i.getLabelSchemes({layer:e,renderer:e?.renderer,view:t,field:a}),[r?.primaryScheme,...r?.secondarySchemes??[]].forEach(e=>{e&&n.set(e?.fieldName,e?.labelingInfo?.[0]?.labelExpressionInfo?.expression??"")})}function c(e,t,a,i){const s=a===n.l.cluster?d(t,a,i):t.getLabelExpressionSingleField();return e.find(e=>e.name===s)?.alias||t.labelExpressionInfo?.title||s}function d(e,t,a){if(t===n.l.cluster)for(const[t,i]of a)if(i===e?.labelExpressionInfo?.expression)return t}},42855:(e,t,a)=>{a.d(t,{a:()=>r,f:()=>i,l:()=>s,s:()=>n});var i=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(i||{}),s=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(s||{}),n=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(n||{}),r=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(r||{})},51074:(e,t,a)=>{a.r(t),a.d(t,{ArcgisMapConfigLabelContent:()=>g});var i=a(73679),s=a(4395),n=a(54312),r=a(52096),l=a(73801),o=a(85643),c=a(42855),d=a(66228),u=a(27155),p=a(16608),f=a(34216),m=a(71384);const h=s.AH`.field-expression-div{align-items:center;display:flex;justify-content:space-between;width:100%;border:1px solid var(--calcite-color-foreground-3);border-radius:var(--calcite-border-width-md)}.field-expression-div calcite-action{flex:0 0 auto}.label-content-button{background:var(--calcite-color-foreground-1);border:1px solid var(--calcite-color-foreground-3);border-radius:var(--calcite-border-width-md);display:flex;align-items:center;justify-content:space-between;padding:var(--calcite-spacing-sm) var(--calcite-spacing-xxs);cursor:pointer;width:100%;text-align:unset;transition:background-color 75ms ease-in-out,border-color 75ms ease-in-out}.label-content-button:hover{background-color:var(--calcite-color-foreground-3);border-color:var(--calcite-color-border-3)}.non-simple-field-button{width:calc(100% - 32px);border:none;border-radius:0;border-right:1px solid var(--calcite-color-foreground-3)}.simple-field-button{border:none}.label-content-button-text{font-family:var(--calcite-font-family);font-size:var(--calcite-font-size);flex:0 1 auto;overflow:hidden;padding:0 var(--calcite-spacing-xxs);text-overflow:ellipsis;white-space:nowrap}.label-content-button-icon{flex:0 0 0%;padding:0 var(--calcite-spacing-sm)}.esri-scale-range-slider{min-width:100%}:dir(rtl){.non-simple-field-button{border-left:1px solid var(--calcite-color-foreground-3);border-right:0}}`;class g extends l.WF{constructor(){super(...arguments),this.attributesButtonNode=(0,o._)(),this.arcadeButtonNode=(0,o._)(),this.filterButtonNode=(0,o._)(),this.styleButtonNode=(0,o._)(),this.layerDisplayType=c.l.feature,this.blockOpen=!1,this.allowTimeSeriesConfiguration=!1,this.arcgisChange=(0,l.lh)(),this.arcgisDelete=(0,l.lh)(),this.arcgisDisablePanel=(0,l.lh)(),this.arcgisDuplicate=(0,l.lh)()}static{this.properties={mapView:0,layer:0,portal:0,_messages:0,layerDisplayType:0,serviceType:0,calciteFlowItem:0,labelFields:0,labelClass:0,aggregationExpressionMapping:0,blockOpen:5,allowTimeSeriesConfiguration:5}}static{this.styles=h}async closeAllPopovers(){this.closePopovers()}async load(){const{layer:e,layerDisplayType:t}=this;this.popupTemplate=t===c.l.feature?e.popupTemplate:e.featureReduction.popupTemplate}loaded(){(0,u.i)(this.el.shadowRoot)}disconnectedCallback(){super.disconnectedCallback(),this.fieldPickListNode?.remove(),this.labelContentFilterNode?.remove(),this.labelStyleNode?.remove(),this.scaleRangeSliderHandle?.remove()}divRefHandler(e){e&&this.addScaleRangeSlider(e)}async openFieldPickList(){const{mapView:e,layer:t,labelClass:a,labelFields:i,layerDisplayType:n,calciteFlowItem:r,aggregationExpressionMapping:o}=this;if(this.closePopovers(),this.calciteFlowItem.loading=!0,!this.fieldPickListNode){const d=a.getLabelExpressionSingleField()||(0,f.b)(a,n,o);this.fieldPickListNode=(0,l.dN)(s.qy`<arcgis-field-pick-list .popoverProps=${{triggerDisabled:!0,refElement:r,offsetSkidding:50}} .fields=${i} .layer=${t} .mapView=${e} .showFieldInfo=${n===c.l.feature} .selectedFields=${d?[d]:[]} @arcgisClose=${e=>{e.stopPropagation();const t=e.detail?.selectedFields?.[0];this.handleFieldPickListChange(t),setTimeout(()=>this.attributesButtonNode.value?.focus(),300)}}></arcgis-field-pick-list>`),document.body.appendChild(this.fieldPickListNode),this.fieldPickListNode.setFocus(),this.arcgisDisablePanel.emit(!0)}this.calciteFlowItem.loading=!1}handleFieldPickListChange(e){const{layer:t,labelClass:a,layerDisplayType:i,serviceType:s}=this;if(e){if(s===c.s.mapImage)a.labelExpression=`[${e}]`;else if(i===c.l.cluster)if(this.aggregationExpressionMapping.has(e))a.labelExpressionInfo.expression=this.aggregationExpressionMapping.get(e);else for(const[t,i]of this.aggregationExpressionMapping)t===e&&(a.labelExpressionInfo.expression=i);else{const i=t.fields.find(t=>t.name===e);a.labelExpressionInfo="coded-value"===i?.domain?.type?{expression:`$feature["${e}"]\nDomainName($feature, "${e}")`,title:void 0}:{expression:`$feature["${e}"]`,title:void 0}}this.arcgisChange.emit(),this.requestUpdate()}this.closePopovers()}openFilter(){const{_messages:e,mapView:t,layer:a,labelClass:i,layerDisplayType:n,calciteFlowItem:r}=this;this.labelContentFilterNode=(0,l.dN)(s.qy`<arcgis-map-config-label-content-filter .referenceElement=${r} .labelClass=${i} ._messages=${e} .layer=${a} .mapView=${t} .layerDisplayType=${n} @arcgisChange=${e=>{e.stopPropagation(),this.arcgisChange.emit(),this.requestUpdate()}} @arcgisClose=${e=>{e.stopPropagation(),this.closePopovers(),setTimeout(()=>this.filterButtonNode.value?.focus(),300)}}></arcgis-map-config-label-content-filter>`),document.body.appendChild(this.labelContentFilterNode),this.arcgisDisablePanel.emit(!0)}openLabelStyleNode(){const{_messages:e,mapView:t,layer:a,labelClass:i,portal:n,layerDisplayType:r,serviceType:o,calciteFlowItem:c}=this;this.closePopovers(),this.labelStyleNode||(this.labelStyleNode=(0,l.dN)(s.qy`<arcgis-map-config-label-content-style .referenceElement=${c} .view=${t} .labelClass=${i} ._messages=${e} .layer=${a} .portal=${n} .layerDisplayType=${r} .serviceType=${o} @arcgisChange=${e=>{e.stopPropagation(),this.arcgisChange.emit(),this.requestUpdate()}} @arcgisClose=${e=>{e.stopPropagation(),this.closePopovers(),setTimeout(()=>this.styleButtonNode.value?.focus(),300)}}></arcgis-map-config-label-content-style>`),document.body.appendChild(this.labelStyleNode),this.arcgisDisablePanel.emit(!0))}async openArcadeEditor(){const{_messages:e,layer:t,portal:a,labelClass:i,serviceType:n,allowTimeSeriesConfiguration:r}=this;if(this.closePopovers(),!this.arcadeEditorNode){this.calciteFlowItem.disabled=!0;const o=this.getArcadeProfile(),d=await this.getArcadeTestData(),u=i.labelExpressionInfo?.expression||"";if(this.arcadeEditorNode=(0,l.dN)(s.qy`<arcgis-map-config-modal-arcade .arcadeProfile=${o} .testData=${d} .arcadeScript=${u} .layer=${t} .portal=${a} .arcadeTitle=${i.labelExpressionInfo?.title||e.newExpression} arcade-title-editable .arcadeTitleEditingEnabled=${!i.labelExpressionInfo?.title} add-existing-expressions @arcgisClose=${e=>this.arcadeSetup(e.detail)}></arcgis-map-config-modal-arcade>`),r&&n!==c.s.mapImage){const t=[{label:e.timeSeries,description:e.timeSeriesDescription,code:(0,m.g)()}];this.arcadeEditorNode.suggestions=[{label:e.suggestions,suggestions:t}]}document.body.appendChild(this.arcadeEditorNode)}}getArcadeProfile(){const{layer:e,popupTemplate:t,layerDisplayType:a}=this;return{id:"labeling",definitions:{$feature:a===c.l.cluster?{fields:(0,d.d)(t)}:e}}}async getArcadeTestData(){const{mapView:e,layer:t,popupTemplate:a,layerDisplayType:i}=this;try{if(i===c.l.cluster)return{profileVariableInstances:{$feature:await(0,d.e)(e,t,a),$view:{scale:"scale"in e?e.scale:void 0,timeProperties:e.timeExtent?{currentStart:e.timeExtent.start,currentEnd:e.timeExtent.end,startIncluded:!0,endIncluded:!0}:void 0}},spatialReference:e.spatialReference,timeZone:e.timeZone};let s;return s="subtype-sublayer"===t.type?t.parent.url:t.url,{profileVariableInstances:{$feature:(await(0,d.f)(t,e)).features[0],$layer:t,$map:e.map,$view:{scale:"scale"in e?e.scale:void 0,timeProperties:e.timeExtent?{currentStart:e.timeExtent.start,currentEnd:e.timeExtent.end,startIncluded:!0,endIncluded:!0}:void 0},$datastore:s},spatialReference:e.spatialReference,timeZone:e.timeZone}}catch(e){console.log(e)}}arcadeSetup(e){const{labelClass:t}=this;e&&(t.labelExpressionInfo?.expression?(t.labelExpressionInfo.expression=e.script,t.labelExpressionInfo.title=e.title):t.labelExpressionInfo={expression:e.script,title:e.title},this.arcgisChange.emit(),this.requestUpdate()),this.calciteFlowItem.disabled=!1,this.arcadeEditorNode&&(this.arcadeEditorNode.remove(),this.arcadeEditorNode=void 0),this.arcadeButtonNode.value?.setFocus()}addScaleRangeSlider(e){const{mapView:t,portal:a,labelClass:i,scaleRangeSlider:s}=this;s||(this.scaleRangeSlider=new r.default({view:t,region:a.region||"wo",minScale:i.minScale||0,maxScale:i.maxScale||0,container:e}),this.scaleRangeSliderHandle?.remove(),this.scaleRangeSliderHandle=n.watch(()=>[this.scaleRangeSlider.minScale,this.scaleRangeSlider.maxScale],e=>{i.minScale=e[0],i.maxScale=e[1],this.closePopovers(),this.arcgisChange.emit()}))}closePopovers(){this.fieldPickListNode&&(this.fieldPickListNode.remove(),this.fieldPickListNode=void 0,this.attributesButtonNode.value?.focus()),this.labelContentFilterNode&&(this.labelContentFilterNode.remove(),this.labelContentFilterNode=void 0,this.filterButtonNode.value?.focus()),this.labelStyleNode&&(this.labelStyleNode.remove(),this.labelStyleNode=void 0,this.styleButtonNode.value?.focus()),this.arcgisDisablePanel.emit(!1)}render(){return s.qy`${this.renderField()}${this.renderFilter()}${this.renderStyle()}${this.renderSlider()}`}renderField(){const{_messages:e,layer:t,labelFields:a,labelClass:i,layerDisplayType:n,serviceType:r,aggregationExpressionMapping:d}=this,u=p.s.includes(r)||r===c.s.mapImage&&t.layer.capabilities?.exportMap?.supportsArcadeExpressionForLabeling;return s.qy`<calcite-label>${e.labelAttribute}<div class="field-expression-div"><button class=${(u?"non-simple-field-button":"simple-field-button")+" label-content-button"} title=${e.field??l.s6} @click=${e=>{e.stopPropagation(),this.openFieldPickList()}} ${(0,o.K)(this.attributesButtonNode)}><span class="label-content-button-text">${(0,f.a)(a,i,n,d)||i.labelExpressionInfo?.title||e.newExpression}</span><span class="label-content-button-icon"><calcite-icon scale=s icon=chevron-down></calcite-icon></span></button>${u&&s.qy`<calcite-action scale=s .text=${e.expression} @click=${e=>{e.stopPropagation(),this.openArcadeEditor()}} ${(0,o.K)(this.arcadeButtonNode)}><calcite-icon scale=s icon=code></calcite-icon></calcite-action>`||""}</div></calcite-label>`}renderFilter(){const{_messages:e,serviceType:t}=this;return t===c.s.ogcFeature||t===c.s.parquet||t===c.s.wfs||t===c.s.subtype?"":s.qy`<calcite-label>${e.filter}<button class="label-content-button" title=${e.editLabelFilter??l.s6} @click=${e=>{e.stopPropagation(),this.closePopovers(),this.labelContentFilterNode||this.openFilter()}} ${(0,o.K)(this.filterButtonNode)}><span class="label-content-button-text">${e.editLabelFilter}</span><span class="label-content-button-icon"><calcite-icon scale=s icon=chevron-down></calcite-icon></span></button></calcite-label>`}renderStyle(){const{_messages:e}=this;return s.qy`<calcite-label>${e.labelStyle}<button class="label-content-button" title=${e.editLabelStyle??l.s6} @click=${e=>{e.stopPropagation(),this.openLabelStyleNode()}} ${(0,o.K)(this.styleButtonNode)}><span class="label-content-button-text">${e.editLabelStyle}</span><span class="label-content-button-icon"><calcite-icon scale=s icon=chevron-down></calcite-icon></span></button></calcite-label>`}renderSlider(){const{_messages:e}=this;return s.qy`<calcite-label>${e.visibleRange}<div ${(0,o.K)(this.divRefHandler)}></div></calcite-label>`}}(0,i.c)("arcgis-map-config-label-content",g)},66228:(e,t,a)=>{a.d(t,{a:()=>b,b:()=>F,c:()=>L,d:()=>N,e:()=>_,f:()=>A,g:()=>g,h:()=>y,i:()=>m,j:()=>h,k:()=>w,l:()=>S,m:()=>x,n:()=>p,o:()=>E,p:()=>M,q:()=>I,r:()=>O,s:()=>P,t:()=>T,u:()=>v});var i=a(63438),s=a(18423),n=a(96086),r=a(91813),l=a(21255),o=a(13078),c=a(21303),d=a(12627),u=a(42855);const p=["feature","scene","geojson","csv","subtype-sublayer","oriented-imagery","catalog-footprint","sublayer"],f=["feature"];function m(e){return null!=e}function h(e,t,a){const i=t.fieldName;if(i.includes(u.f.expression)){const e=a.get(i);return e?.title?e.title:i}return P(e)&&e.getFieldConfiguration(i)?e.getFieldAlias(i)||i:t.label||i}async function g(e){return new Map((await w(e)).filter(e=>e.visible).map(e=>[e.name,e]))}function y(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach(e=>{const a=`${u.f.expression}${e.name}`;t.set(a,e)}),t}function b(e){return"map-image"===e?.layer?.type?u.s.mapImage:"subtype-sublayer"===e?.type?u.s.subtype:"tile"===e?.layer?.type?u.s.tile:"scene"===e?.type?u.s.scene:"ogc-feature"===e?.type?u.s.ogcFeature:"imagery"===e?.type?u.s.imagery:"imagery-tile"===e?.type?u.s.imageryTile:"wfs"===e?.type?u.s.wfs:"wcs"===e?.type?u.s.wcs:"wms"===e?.layer?.type?u.s.wms:"csv"===e?.type?u.s.csv:"geojson"===e?.type?u.s.geojson:"stream"===e?.type?u.s.stream:"oriented-imagery"===e?.type?u.s.orientedImagery:"catalog"===e?.type?u.s.catalog:"catalog-footprint"===e?.type?u.s.catalogFootprint:"knowledge-graph-sublayer"===e?.type?u.s.knowledgeGraphSublayer:"voxel"===e?.type?u.s.voxel:"parquet"===e?.type?u.s.parquet:u.s.feature}function v(e){const t=b(e);let a;return t===u.s.wms||t===u.s.mapImage?a=e?.layer.version:(t===u.s.imagery||t===u.s.feature||t===u.s.scene)&&(a=e.version),Number.parseFloat(a)}function P(e){return"fieldConfigurations"in e&&f.includes(e.type)}async function w(e){return await new Promise((t,a)=>{switch(b(e)){case u.s.feature:case u.s.ogcFeature:case u.s.stream:t(e.fields);break;case u.s.mapImage:{const i=e,s=i?.layer;s?.portalItem&&s.url.includes("https://demographics")&&s.url.includes(".arcgis.com")?s.portalItem?.fetchData().then(e=>{if(e?.thematicGroup){const a=new Map(i.fields.map(e=>[e.name,e])),s=e.thematicGroup.fieldNames,n=[];s.forEach(e=>{a.has(e)&&n.push(a.get(e))}),t(n)}else t(i.fields)}).catch(e=>{a(new Error(e))}):t(i.fields);break}case u.s.imagery:case u.s.imageryTile:case u.s.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}})}function E(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function x(e){return Number((100*(1-e)).toFixed(1))}function T(e){return Number((1-e/100).toFixed(3))}const N=(e,t)=>{const a=[];return e?.fieldInfos?.forEach(e=>{e.fieldName?.includes(u.f.expression)||a.push({name:e.fieldName,alias:e.label,type:"string"})}),a},F=async(e,t)=>{const a=new d.default;return a.geometry=t.extent,a.mapExtent=t.extent,a.returnGeometry=!0,a.tolerance=6,a.layerOption="popup",a.width=t.width,a.height=t.height,a.layerIds=[e.id],(await c.identify(e.layer.url,a))?.results?.[0]?.feature},_=async(e,t,a)=>{const i=await(await e.whenLayerView(t)).queryAggregates();return await $(a,i.features?.[0])},$=async(e,t)=>{let a;if(t)a=t.clone();else{a=new i.default;const t=N(e);if(t?.length){const e={};t.forEach(t=>{e[t.name]=""}),a.attributes=e}const n=new s.default;a.geometry=n}return a};function I(e,t){const a=t.startsWith("#"),i=t.startsWith(".");for((i||a)&&(t=t.slice(1));e;){if(a){if(e.id===t)return e}else if(i){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function L(e){if(b(e)===u.s.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(b(e)===u.s.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find(t=>{if(t.id===e.id)return t})?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function S(e,t,a){let i="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))i="number";else if(t.has(e)){const a=t.get(e);i=a.type?a.type.toLowerCase():""}else if(a.has(e)){const t=a.get(e);i=t.returnType?t.returnType.toLowerCase():""}else i="number";return i}async function A(e,t){try{const a=b(e);if(a===u.s.mapImage&&e.layer.version>=10.5&&!e.layer.capabilities?.operations?.supportsQuery&&e.layer.capabilities?.operations?.supportsIdentify)return{features:[await F(e,t)||await C(e,t)]};if(a===u.s.scene&&!e.capabilities?.operations?.supportsQuery)return{features:[await C(e,t)]};const i=a===u.s.ogcFeature||a===u.s.stream?await t.whenLayerView(e):e,s=i.createQuery();s.where=i.definitionExpression||"1=1",s.outFields=["*"],s.returnM="hasM"in e&&e.hasM,s.returnZ="hasZ"in e&&e.hasZ,s.outSpatialReference=t.spatialReference,s.returnGeometry=!0,(i.sourceJSON?.advancedQueryCapabilities?.supportsPagination||a===u.s.ogcFeature)&&(s.start=0,s.num=1),s.outSpatialReference=t.spatialReference;const n=await i.queryFeatures(s);return n?.features?.length||(n.features[0]=await C(e,t)),n}catch(e){console.error(e)}}async function C(e,t){return await new Promise(a=>{const s=new i.default;if(e.fields?.length){const t={};e.fields.forEach(e=>{t[e.name]=e.defaultValue}),s.attributes=t}const c=t.extent;let d;"polygon"===e.geometryType?d=l.default.fromExtent(c):"point"===e.geometryType?d=c.center.clone():"multipoint"===e.geometryType?d=new n.default({points:[[c.center.x,c.center.y]],spatialReference:c.center.spatialReference.clone()}):"polyline"===e.geometryType?(d=new r.default({spatialReference:t.spatialReference.clone()}),d.addPath([[c.xmin,c.ymin],[c.xmax,c.ymax]])):"mesh"===e.geometryType&&(d=o.default.createBox(c.center.clone(),{size:{width:50,height:50,depth:50}})),s.geometry=d,a(s)})}function O(e){return b(e)===u.s.tile&&"url"in e&&"sublayer"===e.type&&-1===e.url?.indexOf(e.parent.url)&&!!e.fields?.length}function M(e){return b(e)===u.s.tile&&"url"in e&&"sublayer"===e.type&&-1!==e.url?.indexOf(e.parent.url)&&!!e.fields?.length}},71384:(e,t,a)=>{a.d(t,{a:()=>i,g:()=>s});const i="timeProperties";function s(e){return`// To configure a time series visualization using this template, data for this layer should be structured so that\n// each row represents a static feature with a fixed location, such as a country boundary or a city location.\n// The attribute table should have two or more fields that represent the same data attributes at different points in time for each feature.\n// Field names should refer to a specific attribute and a specific point in time, such as population in a specific year.\n// e.g. POP1990, POP2000, POP2010, POP2020, POP2030\n\n// There are four areas of this template where modification is necessary for the template to work with your layer\n// Two are required, and two are optional. \n\n// Examine your data and the details below to edit the template accordingly.\n\nvar FIELD_NAME_PATTERN = "POP{Y}"; // Required - Update this to match your data. See Lines 17-49 for details.\nExpects($feature, "POP*"); // Required - Update this to match your data. See Lines 51-63 for details.\nvar DEFAULT_FIELD_NAME = ""; // Optional - See Lines 65-79 for details.\nvar RESULT_FORMAT_PATTERN = "${e?.resultFormatPattern??"#,###.00"}"; // Optional - Update this to match your data. See Lines 81-93 for details.\n\n// FIELD_NAME_PATTERN\n//\n// The field name pattern is used to create the field name from the time slider values.\n// Patterns are defined using the following syntax: fieldName{pattern}\n//\n// EXAMPLE 1: given fields with names Cases_2023_10_01, Cases_2023_10_02, Cases_2023_10_03, etc., the field name pattern would be:\n// var FIELD_NAME_PATTERN = "Cases_{Y_MM_DD}";\n//\n// EXAMPLE 2: given fields with names POP2000, POP2010, POP2020, etc., the field name pattern would be:\n// var FIELD_NAME_PATTERN = "POP{Y}";\n//\n// The following patterns are supported:\n//\n// D: Day of the month, not padded (1 - 31)\n// DD: Day of the month, padded (01 - 31)\n// DDD: Ordinal day of the year (1 - 365)\n// d: Day of the week (1 - 7)\n// ddd: Abbreviated day of the week (e.g. Mon)\n// dddd: Full day of the week (e.g. Monday)\n// M: Month number (1 - 12)\n// MM: Month number, padded (01 - 12)\n// MMM: Abbreviated month name (e.g. Jan)\n// MMMM: Full month name (e.g. January)\n// Y: Full year\n// YY: Two-digit year\n// h: Civilian hours, not padded (1 - 12)\n// hh: Civilian hours, padded (01 - 12)\n// H: Military hours, not padded (0 - 23)\n// HH: Military hours, padded (00 - 23)\n// m: Minutes, not padded (0 - 59)\n// mm: Minutes, padded (00 - 59)\n// s: Seconds, not padded (0 - 59)\n// ss: Seconds, padded (00 - 59)\n\n// EXPECTS\n//\n// Copy and paste the part of the field pattern common to all fields\n// followed by an asterisk (*) into the second parameter of the Expects function.\n// This must be a raw text value like "POP*", not a variable name like FIELD_NAME_PATTERN.\n// \n// EXAMPLE 1: given fields with names Cases_2023_10_01, Cases_2023_10_02, Cases_2023_10_03, etc.\n//   - Expects($feature, \u201cCases_*\u201d);  // includes all fields that start with "Cases_"\n//   - Expects($feature, \u201cCases_2023*\u201d); // includes all Cases fields for the year 2023\n// \n// EXAMPLE 2: given fields with names POP2000, POP2010, POP2020, etc.\n//   - Expects($feature, "POP*"); // includes all fields that start with "POP"\n//   - Expects($feature, "POP2*"); // includes all "POP" fields for all years after 2000\n\n// DEFAULT_FIELD_NAME\n//\n// The field name to return if the time slider is closed.\n// Suggested values might include the first field in the time series,\n// the most recent field in the time series, or possibly an\n// aggregated value, such as TOTAL_POPULATION.\n// \n// EXAMPLE 1: The first field in the time series. Given fields with names POP2000, POP2010, POP2020, TOTAL_POPULATION,\n// var DEFAULT_FIELD_NAME = "POP2000";\n//\n// EXAMPLE 2: An aggregated value such as the total population. Given fields with names POP2000, POP2010, POP2020, TOTAL_POPULATION,\n// var DEFAULT_FIELD_NAME = "TOTAL_POPULATION";\n//\n// Note - If you defined a default field, be sure to include it in the Expects function as a third parameter.\n// e.g. Expects($feature, "POP*", "TOTAL_POPULATION");\n\n// RESULT_FORMAT_PATTERN\n//\n// The result format pattern is used to format the result of the calculation.\n// Patterns are defined using the following syntax: #,###.00\n// This should only be defined for formatting numeric values in labels or popups.\n// If using for symbology/layer styles, or the field data type\n// is a string, then leave this value empty.\n//\n// EXAMPLE 1: if returning a numeric value in a label,\n// var RESULT_FORMAT_PATTERN = "#,###"; // formats the value with commas and rounded to nearest integer\n// \n// EXAMPLE 2: if returning a numeric value in a popup,\n// var RESULT_FORMAT_PATTERN = "#,###.00"; // formats the value with commas and two decimal places\n\nfunction fieldsWithPatternFilter(field) {\n  var prefix = Front(Split(FIELD_NAME_PATTERN, "{"));\n  var suffix = Back(Split(FIELD_NAME_PATTERN, "}"));\n  var patternToFind = DefaultValue(prefix, suffix);\n  return Find(patternToFind, field.name) > -1;\n}\n\nfunction fieldsWithPatternMap(field) {\n  return field.name;\n}\n\nfunction getAllFieldsFromPattern() {\n  var fields = Schema($feature).fields;\n  return Sort(\n    Map(Filter(fields, fieldsWithPatternFilter), fieldsWithPatternMap)\n  );\n}\n\nfunction getFieldNameFromTimeProperties(dateValue, pattern) {\n  var fieldName = pattern;\n\n  var startPosition = Find("{", fieldName);\n  while (startPosition > -1) {\n    var startIndex = Find("{", fieldName, startPosition);\n    var endIndex = Find("}", fieldName, startIndex);\n    var searchText = Mid(fieldName, startIndex, endIndex - startIndex + 1);\n    var dateText = Text(dateValue, searchText);\n    fieldName = Replace(fieldName, searchText, dateText);\n    startPosition = Find("{", fieldName, endIndex);\n  }\n  fieldName = Replace(Replace(fieldName, "{", ""), "}", "");\n  return fieldName;\n}\n\nvar hasCurrentStart = HasValue($view, ["timeProperties", "currentStart"]);\nvar hasCurrentEnd = HasValue($view, ["timeProperties", "currentEnd"]);\n\nvar hasTimeProperties = hasCurrentStart || hasCurrentEnd;\n\nif (!hasTimeProperties) {\n  if (!IsEmpty(DEFAULT_FIELD_NAME) && HasKey($feature, DEFAULT_FIELD_NAME)) {\n    return $feature[DEFAULT_FIELD_NAME];\n  }\n  var firstField = Front(getAllFieldsFromPattern());\n  return $feature[firstField];\n}\n\nvar currentValue = DefaultValue(\n  $view.timeProperties.currentEnd,\n  $view.timeProperties.currentStart\n);\n\nfunction getValueAtInstant() {\n  var fieldName = getFieldNameFromTimeProperties(\n    currentValue,\n    FIELD_NAME_PATTERN\n  );\n  if (HasValue($feature, fieldName)) {\n    var value = $feature[fieldName];\n    return value;\n  }\n  return null;\n}\n\nfunction formatResult(value) {\n  if (IsEmpty(value)) {\n    return null;\n  }\n  if (IsEmpty(RESULT_FORMAT_PATTERN)) {\n    return value;\n  }\n  return Text(value, RESULT_FORMAT_PATTERN);\n}\n\nvar result = getValueAtInstant();\nreturn formatResult(result);`}}}]);