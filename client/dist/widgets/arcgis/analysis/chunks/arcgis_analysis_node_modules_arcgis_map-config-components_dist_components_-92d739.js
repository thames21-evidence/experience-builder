/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-92d739.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_components_-92d739"],{2079:(e,t,i)=>{i.d(t,{a:()=>o,i:()=>s});var a=i(42855);function s(e,t,i,s){const{layer:o}=e;switch(t){case a.l.feature:return!!(o&&i===a.s.wms||o&&o.popupTemplate)&&o.popupEnabled;case a.l.cluster:return!!o&&o.featureReduction.popupEnabled;case a.l.mapNotes:return s;default:return!!o?.popupEnabled}}function o(e,t){const i="CALCITE-INPUT"===e.tagName,a=i?e.shadowRoot.querySelector("input"):e.shadowRoot.querySelector("textarea"),s=a.selectionStart,o=[e.value.slice(0,s),`{${t}}`,e.value.slice(s)].join("");e.value=o;const n=s+2+t.length;setTimeout(()=>{i?e.setFocus():(a?.setSelectionRange(n,n),a?.focus()),a?.setSelectionRange(n,n)},1)}},10763:(e,t,i)=>{i.d(t,{c:()=>o,u:()=>n});var a=i(83552),s=i(20936);function o(e){e.mapView=void 0,e.portal=void 0,e.config=void 0,e.layerDisplayType=void 0,e.serviceType=void 0,e.layerHasAttributes=!0,e.layerSupportsAttachments=!1,e.layerHasCharts=!0,e.layerHasImages=!0,e.layerHasText=!0,e.layerSupportsArcade=!1,e.layerHasRelatedRecords=!1,e.layerIsUNLayer=!1,e.layerHasEditInfo=!1,e.blockFeatureReductionArcade=!1,e.allowTimeSeriesConfiguration=!1}function n(){const e=(0,a.Gk)(),t=e;e.manager.onLoad(()=>{t.popupState=function(e,t){const i=l.get(e);if(i)return i;const a=(0,s.el)(e,t);return a&&"store"in a?(l.set(e,a.store),a.store):null}(e.el,"arcgis-map-config-popup")})}const l=new WeakMap},42855:(e,t,i)=>{i.d(t,{a:()=>n,f:()=>a,l:()=>s,s:()=>o});var a=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(a||{}),s=(e=>(e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes",e))(s||{}),o=(e=>(e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.parquet="parquet",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms",e))(o||{}),n=(e=>(e.bigInteger="big-integer",e.blob="blob",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e))(n||{})},73788:(e,t,i)=>{i.r(t),i.d(t,{ArcgisMapConfigPopupMultimedia:()=>f});var a=i(73679),s=i(4395),o=i(13416),n=i(50893),l=i(42106),p=i(50335),d=i(54312),c=i(85643),r=i(73801),h=(i(9923),i(42097),i(63438),i(18423),i(96086),i(91813),i(21255),i(13078),i(21303),i(12627),i(81565),i(2079)),u=i(98295),m=i(10763);const g=s.AH`.add-media-button{display:flex;justify-content:center;margin-top:var(--calcite-spacing-sm)}.form-input-button{display:flex}.input{width:100%}calcite-text-area{width:100%;--calcite-text-area-min-width: 0;--calcite-text-area-min-height: 42px}.disable-spacing{--calcite-label-margin-bottom: 0}`;class f extends r.WF{constructor(){super(),this.addMediaButtonNode=(0,c._)(),this.listNode=(0,c._)(),this.listItems=[],this.popupState=(0,m.u)(),this.blockOpen=!1,this.arcgisChange=(0,r.lh)(),this.arcgisDelete=(0,r.lh)(),this.closePopupPopovers=(0,r.lh)(),this.disablePopupPanel=(0,r.lh)(),this.listenOn(window,"arcadeChangeNotification",this.arcadeChangeNotificationHandler),this.listenOn(window,"closePopupPopovers",this.closePopupPopoversHandler)}static{this.properties={popupFlowItem:0,blockOpen:5,mediaContent:0}}static{this.styles=g}async resetMultimediaIndex(){this.setActiveMediaInfoIndex(0)}load(){d.watch(()=>this.popupState.mapView.popup?.selectedFeature,()=>this.setActiveMediaInfoIndex(0)),d.watch(()=>this.popupState.mapView.popup?.visible,()=>this.setActiveMediaInfoIndex(0)),this.mediaContent.title=this.mediaContent.title||"",this.mediaContent.description=this.mediaContent.description||"",this.syncDisplayWithCurrentPopupElementInfo()}updated(){this.arcgisChange.emit()}loaded(){this.blockOpen&&(this.addMediaButtonNode.value?.scrollIntoView({behavior:"auto",block:"nearest",inline:"start"}),1===this.mediaContent.mediaInfos.length&&this.openMediaInfoPopover(this.mediaContent.mediaInfos[0],0))}disconnectedCallback(){super.disconnectedCallback(),this.imageNode?.remove(),this.chartNode?.remove(),this.mediaContentPopoverNode?.remove(),this.pickListNode?.remove()}syncDisplayWithCurrentPopupElementInfo(){this.listItems=[],this.mediaContent.mediaInfos.forEach(e=>{this.listItems.push(this.renderListItem(e))})}arcadeChangeNotificationHandler(){this.requestUpdate()}closePopupPopoversHandler(){this.imageNode&&(this.imageNode.remove(),this.imageNode=void 0,this.addMediaButtonNode.value?.setFocus(),this.disablePopupPanel.emit(!1)),this.chartNode&&(this.chartNode.remove(),this.chartNode=void 0,this.addMediaButtonNode.value?.setFocus(),this.disablePopupPanel.emit(!1)),this.mediaContentPopoverNode&&(this.mediaContentPopoverNode.remove(),this.mediaContentPopoverNode=void 0,this.addMediaButtonNode.value.disabled=!1,this.addMediaButtonNode.value?.setFocus(),this.disablePopupPanel.emit(!1)),this.pickListNode&&(this.pickListNode.remove(),this.pickListNode=void 0,this.disablePopupPanel.emit(!1))}async handleAddMultimediaContentToExistingContent(e){let t;this.closePopupPopovers.emit(),e===u.C.IMAGES?t=new l.default({title:"",caption:"",altText:"",value:new p.default({sourceURL:"",linkURL:""})}):e===u.C.CHARTS&&(t=new n.default({title:"",caption:"",altText:"",value:new o.default({fields:[]})})),this.mediaContent.mediaInfos.push(t),this.requestUpdate(),this.openMediaInfoPopover(t,this.mediaContent.mediaInfos.length-1)}getMultimediaTypeString(e){const{popupState:t}=this,{_messages:i}=t;return e===u.P.IMAGE?i.image:e===u.P.BAR_CHART||e===u.P.COLUMN_CHART?i.barChart:e===u.P.LINE_CHART?i.lineChart:e===u.P.PIE_CHART?i.pieChart:i.image}setActiveMediaInfoIndex(e){this.mediaContent.activeMediaInfoIndex=e||0,this.arcgisChange.emit()}openMediaInfoPopover(e,t){const{popupState:i}=this;e.type===u.P.IMAGE?(this.imageNode=(0,r.dN)(s.qy`<arcgis-map-config-popup-image .referenceElement=${this.popupFlowItem} .imageMediaInfo=${e} .mediaIndexPosition=${t} .popupState=${i} @arcgisMultimediaChange=${e=>{const t=e.detail;this.setActiveMediaInfoIndex(t),this.syncDisplayWithCurrentPopupElementInfo(),this.requestUpdate()}}></arcgis-map-config-popup-image>`),document.body.appendChild(this.imageNode)):(this.chartNode=(0,r.dN)(s.qy`<arcgis-map-config-popup-chart .referenceElement=${this.popupFlowItem} .chartMediaInfo=${e} .mediaContent=${this.mediaContent} .mediaIndexPosition=${t} .popupState=${i} @arcgisMultimediaChange=${e=>{const t=e.detail;this.setActiveMediaInfoIndex(t),this.syncDisplayWithCurrentPopupElementInfo(),this.requestUpdate()}}></arcgis-map-config-popup-chart>`),document.body.appendChild(this.chartNode)),this.disablePopupPanel.emit(!0)}handlePickListChange(e,t){"title"===t?((0,h.a)(this.titleNode,e),this.mediaContent.title=this.titleNode.value):"description"===t&&((0,h.a)(this.descriptionNode,e),this.mediaContent.description=this.descriptionNode.value),this.closePopupPopovers.emit(),this.requestUpdate()}render(){const{popupState:e}=this,{_messages:t}=e;return s.qy`${this.renderFormInput("title",t.title,this.mediaContent.title,t.enterTitle,e=>this.titleNode=e)}${this.renderFormInput("description",t.desc,this.mediaContent.description,t.enterDescription,e=>this.descriptionNode=e)}<calcite-label class="disable-spacing" scale=s>${t.mediaContent}</calcite-label><calcite-list .label=${t.mediaContent} drag-enabled @calciteListOrderChange=${e=>{const t=e.detail.oldIndex,i=e.detail.newIndex,a=this.mediaContent.mediaInfos.splice(t,1)[0];this.mediaContent.mediaInfos.splice(i,0,a),this.listItems=[...this.listNode.value.children],this.setActiveMediaInfoIndex(0),this.arcgisChange.emit(),this.requestUpdate()}} ${(0,c.K)(this.listNode)}>${this.listItems}</calcite-list><calcite-button title=${t.addMedia??r.s6} appearance=outline-fill round scale=s class="add-media-button" icon-start=plus @click=${e=>{const{popupState:t}=this;e.stopPropagation(),this.closePopupPopovers.emit(),this.mediaContentPopoverNode||(this.mediaContentPopoverNode=(0,r.dN)(s.qy`<arcgis-map-config-popup-add-content-popover .referenceElement=${this.addMediaButtonNode.value} .popupState=${t} is-multimedia-content .popoverPanelWidth=${this.el.getBoundingClientRect().width} @arcgisAddMultimediaContent=${e=>{const t=e.detail;this.handleAddMultimediaContentToExistingContent(t),this.syncDisplayWithCurrentPopupElementInfo()}}></arcgis-map-config-popup-add-content-popover>`),document.body.appendChild(this.mediaContentPopoverNode),this.addMediaButtonNode.value.disabled=!0,this.disablePopupPanel.emit(!0))}} ${(0,c.K)(this.addMediaButtonNode)}></calcite-button>`}renderFormInput(e,t,i,a,o){return s.qy`<calcite-label scale=s>${t}<div class="form-input-button">${"title"===e?s.qy`<calcite-input class="input" type=text autofocus .value=${i} .placeholder=${a} @calciteInputInput=${e=>{e.stopPropagation();const t=e.target.value;this.mediaContent.title=t,this.requestUpdate()}} @click=${()=>this.closePopupPopovers.emit()} ${(0,c.K)(o)}></calcite-input>`:s.qy`<calcite-text-area resize=vertical autofocus .value=${i} .placeholder=${a} @calciteTextAreaInput=${e=>{e.stopPropagation();const t=e.target.value;this.mediaContent.description=t,this.requestUpdate(),this.arcgisChange.emit()}} ${(0,c.K)(o)}></calcite-text-area>`}${this.popupState.popupTemplate.fieldInfos?.length&&s.qy`<calcite-action .text=${this.popupState._messages.attributes} scale=s icon=brackets-curly @click=${()=>{const{popupState:t}=this;this.closePopupPopovers.emit(),this.pickListNode||(this.pickListNode=(0,r.dN)(s.qy`<arcgis-map-config-popup-field-pick-list .popoverProps=${{refElement:this.popupFlowItem}} .heading=${t._messages.addField} .popupState=${t} @arcgisChange=${t=>{t.stopPropagation();const i=t.detail.selectedFields[0];this.handlePickListChange(i,e)}} @arcgisClose=${e=>{e.stopPropagation(),this.closePopupPopovers.emit()}}></arcgis-map-config-popup-field-pick-list>`),document.body.appendChild(this.pickListNode),this.disablePopupPanel.emit(!0))}}></calcite-action>`||""}</div></calcite-label>`}renderListItem(e){const{popupState:t}=this,{_messages:i}=t;return s.qy`<calcite-list-item .label=${e.title&&`${e.title.substring(0,25)}${e.title.length>25?"...":""}`||i.noTitle} .description=${this.getMultimediaTypeString(e.type)} @click=${t=>{if(this.closePopupPopovers.emit(),!t.composedPath().some(e=>"CALCITE-SORT-HANDLE"===e.tagName)){const i=t.currentTarget,a=Array.from(this.listNode.value.querySelectorAll("calcite-list-item")).indexOf(i);this.openMediaInfoPopover(e,a)}}}><calcite-action slot=actions-end appearance=transparent .text=${i.remove} @click=${t=>{t.stopPropagation(),this.closePopupPopovers.emit();const i=this.mediaContent.mediaInfos.find(t=>t.type===e.type);if(i){const e=this.mediaContent.mediaInfos.indexOf(i);this.mediaContent.mediaInfos.splice(e,1),this.listItems.splice(e,1)}0===this.mediaContent.mediaInfos.length?this.arcgisDelete.emit():(this.setActiveMediaInfoIndex(0),this.arcgisChange.emit()),this.requestUpdate()}}><calcite-icon scale=s icon=x></calcite-icon></calcite-action></calcite-list-item>`}}(0,a.c)("arcgis-map-config-popup-multimedia",f)},98295:(e,t,i)=>{i.d(t,{A:()=>s,C:()=>a,I:()=>n,P:()=>o});var a=(e=>(e.ATTRIBUTES="attributes",e.ATTACHMENTS="attachments",e.CHARTS="charts",e.IMAGES="images",e.RICH_TEXT="richText",e.ARCADE="arcade",e.RELATIONSHIP="relationship",e.ASSOCIATIONS="associations",e.EDIT_INFO_SUMMARY="editInfoSummary",e))(a||{}),s=(e=>(e.PREVIEW="preview",e.LIST="list",e.AUTO="auto",e))(s||{}),o=(e=>(e.IMAGE="image",e.BAR_CHART="bar-chart",e.COLUMN_CHART="column-chart",e.LINE_CHART="line-chart",e.PIE_CHART="pie-chart",e))(o||{}),n=(e=>(e.SOURCE_URL="sourceUrl",e.TITLE="title",e.CAPTION="caption",e.LINK_URL="linkUrl",e.ALT_TEXT="altText",e))(n||{})}}]);