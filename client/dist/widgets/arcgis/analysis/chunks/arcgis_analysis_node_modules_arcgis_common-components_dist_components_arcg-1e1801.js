/*! For license information please see arcgis_analysis_node_modules_arcgis_common-components_dist_components_arcg-1e1801.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_common-components_dist_components_arcg-1e1801"],{42984:(e,t,i)=>{i.d(t,{u:()=>o});var s=i(83552),l=i(22229);const o=(0,s.yr)(l.g)},46317:(e,t,i)=>{i.d(t,{D:()=>a});var s=i(85282),l=i(34670),o=i(42466);const a=(0,l.u$)(class extends l.WL{constructor(){super(...arguments),this.key=s.s6}render(e,t){return this.key=e,t}update(e,[t,i]){return t!==this.key&&((0,o.mY)(e),this.key=t),i}})},59099:(e,t,i)=>{i.r(t),i.d(t,{ArcgisFieldPickList:()=>p});var s=i(22229),l=i(46317),o=i(73801),a=i(85643),n=i(4395),h=i(95437),r=i(42984);const c=new Map;c.set("oid","key"),c.set("guid","key"),c.set("global-id","key"),c.set("blob","binary"),c.set("integer","integer"),c.set("small-integer","integer"),c.set("big-integer","integer"),c.set("single","number"),c.set("double","number"),c.set("long","number"),c.set("number","number"),c.set("date","date-time"),c.set("date-only","calendar"),c.set("time-only","clock"),c.set("timestamp-offset","time-zone"),c.set("string","string");const d=n.AH`.panel{min-height:250px}.content{max-height:50vh}.field-icons{display:flex;align-items:center}.field-icons-end{padding:0 var(--calcite-spacing-lg)}.selection-button-div{padding:var(--calcite-spacing-xxs) var(--calcite-spacing-sm-plus)}.no-match-text{padding:var(--calcite-spacing-md)}`;class p extends o.WF{constructor(){super(...arguments),this._messages=(0,r.u)({blocking:!0}),this.popoverNode=(0,a._)(),this.listNode=(0,a._)(),this.flowElement=(0,a._)(),this.panelElement=(0,a._)(),this.dropdownNode=(0,a._)(),this.fieldInfoFlowItemEl=(0,a._)(),this.fieldsOnly=[],this.expressionsOnly=[],this.filterText="",this.panelCutOffHeight=0,this.fields=[],this.selectedFields=[],this.showFieldInfo=!1,this.showFieldTypeIcon=!1,this.showFieldName=!1,this.showDescription=!1,this.showSelectionAll=!1,this.showCancel=!0,this.hideCancel=!1,this.showSort=!0,this.hideSort=!1,this.showFilterLength=10,this.multiple=!1,this.sortBy="default",this.groupFieldsAndExpressions=!1,this.arcgisChange=(0,o.lh)(),this.arcgisClose=(0,o.lh)(),this.arcgisFieldPickListChange=(0,o.lh)(),this.arcgisFieldPickListDismissed=(0,o.lh)(),this.arcgisFieldPickListSortByChange=(0,o.lh)(),this.arcgisSortByChange=(0,o.lh)()}static{this.properties={lastSortBy:16,filterFields:16,mapView:0,view:0,layer:0,fields:0,selectedFields:0,popoverProps:0,showFieldInfo:5,showFieldTypeIcon:5,showFieldName:5,showDescription:5,showSelectionAll:5,showCancel:5,hideCancel:5,showSort:5,hideSort:5,showFilterLength:9,multiple:5,heading:1,okBtnText:1,filterPlaceholderText:1,filterNoResultsText:1,sortBy:1,groupFieldsAndExpressions:5,fieldsGroupHeading:1,expressionsGroupHeading:1,customExpressionCheck:0}}static{this.styles=d}async reposition(){await(this.popoverNode.value?.reposition())}async setFocus(){setTimeout(()=>requestAnimationFrame(()=>{this.panelElement.value?.setFocus()}),1)}load(){!this.view&&this.mapView&&(this.view=this.mapView),!this.showCancel&&!this.hideCancel&&(this.hideCancel=!0),!this.showSort&&!this.hideSort&&(this.hideSort=!0),!this.multiple&&this.selectedFields.length>1&&(this.selectedFields=[this.selectedFields[0]]),this.lastSortBy=this.sortBy??this.lastSortBy,this.updateGroupedLists()}willUpdate(e){(e.has("fields")||e.has("lastSortBy")||e.has("customExpressionCheck"))&&this.updateGroupedLists()}loaded(){this.setUpObserver(),this.flowElement.value?.setFocus(),this.checkMaxHeight()}disconnectedCallback(){super.disconnectedCallback(),this.observer?.disconnect()}setUpObserver(){this.observer=new MutationObserver(e=>{for(const t of e)"style"===t.attributeName&&this.popoverNode.value&&this.dropdownNode.value&&"hidden"===this.popoverNode.value.style.visibility&&(this.dropdownNode.value.open=!1)})}checkMaxHeight(){setTimeout(()=>this.checkPanelMaxHeight(),200),setTimeout(()=>this.checkPanelMaxHeight(),500),setTimeout(()=>this.checkPanelMaxHeight(),1e3),setTimeout(()=>this.checkPanelMaxHeight(),1500)}checkPanelMaxHeight(){if(0===this.panelCutOffHeight){const e=this.panelElement.value?.getBoundingClientRect();if(e&&e.bottom>window.innerHeight){this.panelCutOffHeight=e.height-(e.bottom-window.innerHeight)-5;const t=this.listNode.value?.getBoundingClientRect();t&&(this.listNode.value.style.maxHeight=t.height-(e.bottom-window.innerHeight)-5+"px")}}}getSortedList(){let e=[...this.fields];const t=e.filter(e=>"none"===e.type);return e=e.filter(e=>"none"!==e.type),"display"===this.lastSortBy?e.sort((e,t)=>e.alias.localeCompare(t.alias)):"field"===this.lastSortBy?e.sort((e,t)=>e.name.localeCompare(t.name)):"type"===this.lastSortBy&&e.sort((e,t)=>e.type.localeCompare(t.type)),e=e.concat(t),e}isExpression(e){return this.customExpressionCheck?this.customExpressionCheck(e):e.name.includes(h.f.expression)}canDeselectAll(){return this.filterFields?.length?this.filterContainsAll():this.selectedFields.length===this.fields.length}filterContainsAll(){return!!this.filterFields?.every(e=>this.selectedFields.some(t=>t===e))}showFieldInfoCheck(e){const{layer:t}=this;return!!this.showFieldInfo&&!(!t||this.isExpression(e)||e.name.includes(h.f.relationship)||"none"===e.type)}updateGroupedLists(){this.fields&&(this.fieldsOnly=[...this.getSortedList()].filter(e=>!this.isExpression(e)),this.expressionsOnly=[...this.getSortedList()].filter(e=>this.isExpression(e)))}addFieldInfoFlowItem(e,t){const i=this.flowElement.value,s=(0,o.dN)(n.qy`<calcite-flow-item selected .heading=${e.alias??e.name} .description=${e.name} class="panel" style=${(0,o.zl)(this.panelCutOffHeight>0?`max-height: ${this.panelCutOffHeight}px`:"max-height: 50vh")} @calciteFlowItemBack=${e=>{const i=e.currentTarget;i.parentElement?.removeChild(i),this.fieldInfoFlowItemEl.value.selected=!1,this.panelElement.value.selected=!0,setTimeout(()=>{t.setFocus()},300)}} ${(0,a.K)(this.fieldInfoFlowItemEl)}><arcgis-field-info lang=${this._messages._lang??o.s6} .fieldName=${e.name} .layer=${this.layer} .view=${this.view} class="content"></arcgis-field-info></calcite-flow-item>`);i.appendChild(s),this.panelElement.value.selected=!1,this.fieldInfoFlowItemEl?.value.setFocus()}render(){const e=this.heading||(this.multiple?this._messages.headerSelect:this._messages.header),t=this.fields.length>=this.showFilterLength;return this.el.classList.add("js-app-flyout"),n.qy`<calcite-popover style=${(0,o.zl)({"--calcite-popover-z-index":`${this.popoverProps.zIndex??100}`})} .placement=${this.popoverProps.placement??"leading-start"} open pointer-disabled .referenceElement=${this.popoverProps.refElement} .offsetDistance=${this.popoverProps.offsetDistance??-Math.round(this.popoverProps.refElement.getBoundingClientRect().width)} .offsetSkidding=${this.popoverProps.offsetSkidding??0} .overlayPositioning=${this.popoverProps.overlayPositioning} trigger-disabled .autoClose=${this.popoverProps.autoClose} .label=${this.heading??(this.multiple?this._messages.headerSelect:this._messages.header)??""} @calcitePopoverClose=${()=>{this.arcgisClose.emit(),this.arcgisFieldPickListDismissed.emit()}} ${(0,a.K)(this.popoverNode)}><calcite-flow style=${(0,o.zl)({width:`${this.popoverProps.popoverWidth??this.popoverProps.refElement.getBoundingClientRect().width}px`})} ${(0,a.K)(this.flowElement)}><calcite-flow-item class="panel" .heading=${e} closable @calciteFlowItemClose=${()=>{this.arcgisClose.emit(),this.arcgisFieldPickListDismissed.emit()}} ${(0,a.K)(this.panelElement)}><slot slot=content-top name=content-top></slot>${!this.fields.length&&n.qy`<slot name=no-fields></slot>`||""}<calcite-list .label=${e} .selectionMode=${this.multiple?"multiple":"single"} class="content" .filterEnabled=${t} .filterPlaceholder=${this.filterPlaceholderText??this._messages.filter} @calciteListChange=${()=>{const e=this.listNode.value.selectedItems.map(e=>e.value),t=this.selectedFields.filter(t=>e.includes(t)),i=e.filter(e=>!this.selectedFields.includes(e));this.selectedFields=[...new Set([...t,...i])],this.arcgisChange.emit({selectedFields:this.selectedFields}),this.arcgisFieldPickListChange.emit({selectedFields:this.selectedFields}),this.multiple||(this.arcgisClose.emit({selectedFields:this.selectedFields}),this.arcgisFieldPickListDismissed.emit({selectedFields:this.selectedFields}))}} @calciteListFilter=${e=>{e.stopPropagation(),this.filterFields=this.listNode.value.filteredItems?.map(e=>e.value),this.filterText=this.listNode.value.filterText}} ${(0,a.K)(this.listNode)}>${this.renderSortButton()}<slot name=content-center></slot>${this.multiple&&this.showSelectionAll&&this.fields.length&&(!t||!this.filterText||this.filterFields?.length)?this.renderSelectionButton():null}${this.renderListItems()}</calcite-list>${this.filterFields&&!this.filterFields.length&&this.listNode.value&&0!==this.filterNoResultsText?.length?n.qy`<div class="no-match-text">${this.filterNoResultsText??this._messages.noMatches}</div>`:null}<slot slot=content-bottom name=content-bottom></slot>${this.renderAddButton()}${this.renderCancelButton()}</calcite-flow-item></calcite-flow></calcite-popover>`}renderSortButton(){if(!(this.fields.length>=this.showFilterLength)||this.hideSort)return;const e=this.fields.every(e=>!!e.type);return n.qy`<calcite-dropdown slot=filter-actions-end placement=bottom-end overlay-positioning=fixed .disabled=${!!this.filterFields&&this.filterFields.length<4} @calciteDropdownOpen=${()=>{this.observer?.disconnect(),this.popoverNode.value&&this.observer?.observe(this.popoverNode.value,{attributes:!0})}} @calciteDropdownClose=${()=>this.observer?.disconnect()} ${(0,a.K)(this.dropdownNode)}><calcite-action slot=trigger .text=${this._messages.sort??""} title=${this._messages.sort??o.s6}><calcite-icon scale=s icon=sortDescending flip-rtl></calcite-icon></calcite-action><calcite-dropdown-group><calcite-dropdown-item .selected=${"default"===this.lastSortBy} @click=${()=>{this.lastSortBy="default",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy)}} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&(this.lastSortBy="default",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy))}}>${this._messages.default}</calcite-dropdown-item><calcite-dropdown-item .selected=${"display"===this.lastSortBy} @click=${()=>{this.lastSortBy="display",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy)}} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&(this.lastSortBy="display",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy))}}>${this._messages.displayName}</calcite-dropdown-item>${e&&n.qy`<calcite-dropdown-item .selected=${"type"===this.lastSortBy} @click=${()=>{this.lastSortBy="type",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy)}} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&(this.lastSortBy="type",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy))}}>${this._messages.type}</calcite-dropdown-item>`||""}<calcite-dropdown-item .selected=${"field"===this.lastSortBy} @click=${()=>{this.lastSortBy="field",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy)}} @keydown=${e=>{e.stopPropagation(),(" "===e.key||"Enter"===e.key)&&(this.lastSortBy="field",this.arcgisSortByChange.emit(this.lastSortBy),this.arcgisFieldPickListSortByChange.emit(this.lastSortBy))}}>${this._messages.fieldName}</calcite-dropdown-item></calcite-dropdown-group></calcite-dropdown>`}renderSelectionButton(){return n.qy`<div class="selection-button-div"><calcite-button appearance=transparent scale=s width=full @click=${()=>{this.canDeselectAll()?this.selectedFields=this.filterFields?.length?this.selectedFields.filter(e=>!this.filterFields?.includes(e)):[]:this.selectedFields=this.filterFields?.length?[...new Set([...this.selectedFields,...this.filterFields])]:this.fields.map(e=>e.name),this.arcgisChange.emit({selectedFields:this.selectedFields}),this.arcgisFieldPickListChange.emit({selectedFields:this.selectedFields})}}>${this.canDeselectAll()?this._messages.deselectAll:this._messages.selectAll}</calcite-button></div>`}renderListItems(){return this.groupFieldsAndExpressions?n.qy`${this.expressionsOnly.length>0&&n.qy`<calcite-list-item-group .heading=${this.expressionsGroupHeading}>${this.expressionsOnly.map(e=>this.renderCalciteListItem(e))}</calcite-list-item-group>`||""}${this.fieldsOnly.length>0&&n.qy`<calcite-list-item-group .heading=${this.fieldsGroupHeading}>${this.fieldsOnly.map(e=>this.renderCalciteListItem(e))}</calcite-list-item-group>`||""}`:[...this.getSortedList()].map(e=>this.renderCalciteListItem(e))}renderCalciteListItem(e){const t=this.showFieldInfoCheck(e),i=this.showFieldTypeIcon&&!!e.type;return(0,l.D)(e.name,n.qy`<calcite-list-item .label=${e.alias||e.name} .description=${(()=>this.showFieldName&&!0!==e.hideFieldName?`{${e.name}}`:this.showDescription&&!0!==e.hideDescription&&e.description?e.description:void 0)()} .value=${e.name} .selected=${!this.multiple&&e.name===this.selectedFields[0]||this.multiple&&this.selectedFields.includes(e.name)} .metadata=${{label:e.alias,fieldName:e.name}}>${i&&n.qy`<div .slot=${t?"actions-start":"actions-end"} class=${"field-icons "+(t?"":"field-icons-end")}>${(({fieldType:e})=>n.qy`<calcite-icon scale=s .icon=${c.get(e)}></calcite-icon>`)({fieldType:e.type})}</div>`||""}${t&&n.qy`<calcite-action slot=actions-end .text=${this._messages.info??""} title=${this._messages.info??o.s6} scale=s icon=information @click=${t=>{t.stopPropagation();const i=t.currentTarget;this.addFieldInfoFlowItem(e,i)}}></calcite-action>`||""}</calcite-list-item>`)}renderAddButton(){if(this.multiple)return n.qy`<calcite-button slot=footer .appearance=${this.hideCancel?"outline-fill":"solid"} .width=${this.hideCancel?"full":"half"} @click=${()=>{this.arcgisClose.emit({selectedFields:this.selectedFields}),this.arcgisFieldPickListDismissed.emit({selectedFields:this.selectedFields})}}>${this.okBtnText||(this.multiple?this._messages.done:this._messages.ok)}</calcite-button>`}renderCancelButton(){if(!this.hideCancel)return n.qy`<calcite-button slot=footer appearance=outline-fill .width=${this.multiple?"half":"full"} @click=${()=>{this.arcgisClose.emit(),this.arcgisFieldPickListDismissed.emit()}}>${this._messages.cancel}</calcite-button>`}}(0,s.c)("arcgis-field-pick-list",p)},95437:(e,t,i)=>{i.d(t,{f:()=>s});var s=(e=>(e.expression="expression/",e.raster="Raster.",e.relationship="relationships/",e))(s||{})}}]);