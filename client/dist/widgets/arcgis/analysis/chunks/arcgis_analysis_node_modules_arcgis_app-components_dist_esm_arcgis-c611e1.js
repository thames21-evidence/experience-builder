/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c611e1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c611e1"],{931:(e,t,n)=>{n.d(t,{l:()=>o});var r=n(93814);const o=async(e,t)=>(await r.e.exports.loadModules(e,t)).map(e=>e.__esModule&&e.default?e.default:e)},1654:(e,t,n)=>{n.d(t,{A:()=>w,B:()=>E,C:()=>_,D:()=>W,E:()=>m,F:()=>M,a:()=>a,b:()=>i,c:()=>l,d:()=>f,e:()=>$,f:()=>b,g:()=>S,h:()=>k,i:()=>p,j:()=>C,k:()=>D,l:()=>u,m:()=>c,n:()=>s,o:()=>O,p:()=>g,q:()=>v,r:()=>h,s:()=>L,t:()=>R,u:()=>d,v:()=>T,w:()=>j,x:()=>A,y:()=>P,z:()=>y});var r=n(46904);const o=e=>{var t,n,r;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(n=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==n?n:null===(r=null==e?void 0:e.sourceJSON)||void 0===r?void 0:r.id};function i(e){return e&&!e.orgId}function l(e,t){return(0,r.u)(e,t)||"update"===e.itemControl||(0,r.c)([e],t)&&b(t)}function a(e,t){const n=(0,r.c)([e],t),o=(0,r.u)(e,t)||b(t)&&n,i=S(t)&&I(t);return!!(o||n&&i)}const s=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageLicenses"))},u=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:inviteUsers"))},c=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageRoles"))},d=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:changeUserRoles"))},g=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewGroups"))},v=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:viewUsers"))};function p(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function m(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}function h(e){return["Geoanalytics Engine","GeoAnalytics MS Fabric"].includes(null==e?void 0:e.type)}const f=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("Developer")},y=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("PublicSharingDisabled")},w=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("HostedServicesPublicSharingDisabled")};function b(e){return"org_admin"===o(e)||"account_admin"===o(e)}function $(e){return["org_admin","account_admin"].includes(o(e))&&!(null==e?void 0:e.roleId)}function S(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function C(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function k(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function O(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:assignToGroups"))}const I=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))};function T(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function j(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function E(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function P(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function _(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function A(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function D(e,t,n,r){const o=r&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(r.type),i=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!b(t)&&!i||!(null==n?void 0:n.isPortal)&&!o)}function M(e){return!!e&&(!S(e)||S(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const W=({items:e,user:t,portal:n})=>{const o=e[0],i=o.owner;if(n.isPortal&&i!==t.username&&i.includes("esri_")&&!["esri_livingatlas"].includes(i))return!1;const a=(0,r.u)(o,t),s=S(t),u=N(t),c=l(o,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!s&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||T(e)||j(e)||!!t.canSharePublic&&E(e)}(t,n)||N(t));return a||c||(0,r.c)(e,t)&&u};function N(e){return A(e)||P(e)||_(e)}const x=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];function R(e){return e.some(e=>x.includes(e))}function L(e){return e.filter(e=>x.includes(e))}},4429:(e,t,n)=>{n.d(t,{a:()=>s,b:()=>d,c:()=>i,d:()=>u,e:()=>o,f:()=>r,g:()=>g,i:()=>v,m:()=>l,t:()=>a,u:()=>c});const r=(e,t)=>{let n,r="idle";const o=(...o)=>new Promise(i=>{switch(r){case"flushed":r="idle",n?(clearTimeout(n),i(e(...o))):i(null);break;case"invoked":clearTimeout(n),r="idle",i(e(...o));break;case"cancelled":clearTimeout(n),r="idle",i(null);break;default:n&&clearTimeout(n),r="pending",n=setTimeout(()=>(r="idle",i(e(...o))),t)}});return o.flush=function(...e){return r="flushed",o(...e)},o.invoke=function(...e){return r="invoked",o(...e)},o.cancel=function(...e){return r="cancelled",o(...e)},o.getStatus=function(){return r},o};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function i(e){return null!=e}async function l(e,t){return await Promise.all([e,a(t)]),e}function a(e){return new Promise(t=>setTimeout(t,e))}const s=(e,t)=>Object.fromEntries((e||[]).map(e=>{const{key:n,data:r}=t(e);return[n,r]})),u=(e,t)=>e.length===t.length&&e.reduce((e,n)=>e&&t.indexOf(n)>-1,!0);function c(e,t){const n=[],r={};return e.forEach(e=>{const o=t(e);null==r[o]&&(r[o]=e,n.push(e))}),n}function d(e){const t={boolean:{},number:{},string:{}},n=[];return e.filter(e=>{let r=typeof e;return r in t?!t[r].hasOwnProperty(e)&&(t[r][e]=!0):!(n.indexOf(e)>=0)&&n.push(e)})}const g=(e,t)=>[...Array(Math.ceil(e.length/t))].map((n,r)=>e.slice(t*r,t+t*r)),v=(e,t)=>e.includes(t)},12192:(e,t,n)=>{n.d(t,{a:()=>l,g:()=>u});var r=n(15332),o=n(94984),i=n(87849);function l(e){var t,n,i;const l=null!==(t=(0,r.c)(e,"[lang]"))&&void 0!==t?t:null===(i=null===(n=e.shadowRoot)||void 0===n?void 0:n.ownerDocument)||void 0===i?void 0:i.documentElement,a=((null==l?void 0:l.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return o.l.has(a)?o.l.get(a):o.l.has(a.slice(0,2))?o.l.get(a.slice(0,2)):"en"}const a={};function s(e,t){const n=`${e}${t}`;return a[n]||(a[n]=function(e,t){return new Promise((n,r)=>{fetch((0,i.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then(e=>{e.ok?n(e.json()):r()},()=>r())})}(e,t)),a[n]}async function u(e,t){const n=t||e.tagName.toLowerCase(),i=l(e),a=function(e){var t,n,i;const l=null!==(t=(0,r.c)(e,"[lang]"))&&void 0!==t?t:null===(i=null===(n=e.shadowRoot)||void 0===n?void 0:n.ownerDocument)||void 0===i?void 0:i.documentElement,a=((null==l?void 0:l.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return o.l.has(a)?o.l.get(a):o.l.has(a.slice(0,2))?a:"en"}(e);let u;try{u=await s(n,i)}catch(e){console.warn(`no locale for ${n} (${i}) loading default locale en.`),u=await s(n,"en")}return[u,i,a]}},26262:(e,t,n)=>{n.d(t,{a:()=>o,g:()=>i,i:()=>l});var r=n(41473);const o=(e,t)=>(0,r.a)(`${(0,r.g)(e)}community/groups/${t.id}`),i=(e,t)=>`${((e,t)=>(0,r.a)(`${(0,r.g)(e)}content/groups/${t.id}`))(e,t)}search`,l=e=>{var t;return null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.includes("distributed")}},29797:(e,t,n)=>{n.r(t),n.d(t,{arcgis_member_category_schema_editor:()=>g});var r=n(87849),o=n(50315),i=n(41473),l=n(83692),a=n(37362),s=n(12192),u=n(1654);n(59317),n(37762),n(26262),n(931),n(93814),n(54251),n(15332),n(94984),n(46904);const c=async({path:e,portal:t,updateInfo:n})=>{try{const r=(await d({category:e,portal:t,num:1})).total;if(0===r)return console.warn(`No items found with category ${e} when updating schema`),{};const o=100,s=Math.ceil(r/o),u=[];for(let r=0;r<s;r++)u.push(d({category:e,portal:t,start:r*o,num:o}).then(({results:t})=>{const r={};return t.forEach(t=>{const o="change-title"===n.type?t.categories.map(t=>{const r=(0,a.g)(e,n.newTitle);return t===e?r:t.replace(`${e}/`,`${r}/`)}):t.categories.filter(t=>!t.startsWith(e));r[t.username]=o}),r}));const c=await Promise.all(u);let g={};return c.forEach(e=>{g=Object.assign(Object.assign({},g),e)}),await Promise.all(Object.keys(g).map(e=>async function({categories:e,username:t,portal:n}){try{const r=`${(0,i.g)(n)}community/users/${t}/update`;return{result:await(0,l.r)(r,{categories:JSON.stringify(e)},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}({categories:g[e],username:e,portal:t}))),{}}catch(t){return console.error(`Error ${n.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}};const d=({category:e,portal:t,start:n,num:r})=>{const o={start:n,num:r,categories:JSON.stringify([e])};return(0,l.r)(`${(0,i.g)(t)}portals/${t.id}/users/search`,o)},g=class{constructor(e){(0,r.r)(this,e),this.workflowCancel=(0,r.c)(this,"workflowCancel",7),this.newSchemaWorkflowComplete=(0,r.c)(this,"newSchemaWorkflowComplete",7),this.deleteAllSchema=(0,r.c)(this,"deleteAllSchema",7),this.arcgisMemberCategoryEditorRowWarningClick=(0,r.c)(this,"arcgisMemberCategoryEditorRowWarningClick",7),this.getCategorySchema=()=>{const{portal:e,user:t}=this;return(0,o.e)({portal:e,user:t})},this.getCategoryAggregation=()=>{const{portal:e}=this;return(async e=>{const t=`${(0,i.g)(e)}/portals/${e.id}/users/`,n={q:`orgid:${e.id}`,countFields:"categories"};try{const{aggregations:e}=await(0,l.r)(`${t}search`,Object.assign(Object.assign({},n),{countSize:200,num:0,f:"json"}));return{result:e.counts[0]}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}})(e)},this.getDisabledWarning=e=>{const{defaultMemberCategories:t,i18n:n}=this;if(t.some(t=>{const n=t.toLowerCase();return n===e||n.includes(`${e}/`)}))return n.defaultCategoryWarning},this.updateSchema=e=>{const{portal:t}=this;return(async({categorySchema:e,portal:t})=>{try{const n=`${(0,i.g)(t)}portals/${t.id}/assignMemberCategorySchema`;return await(0,l.r)(n,{memberCategorySchema:JSON.stringify({memberCategorySchema:e})},{},"post"),{}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}})({categorySchema:e,portal:t})},this.deleteSchema=()=>{const{portal:e}=this;return(async e=>{try{const t=`${(0,i.g)(e)}/portals/${e.id}/deleteMemberCategorySchema`;return await(0,l.r)(t,{},{},"post"),{}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}})(e)},this.updateSchemaFromPath=({path:e,updateInfo:t})=>{const{portal:n}=this;return c({path:e,updateInfo:t,portal:n})},this.user=void 0,this.portal=void 0,this.config=void 0,this.defaultMemberCategories=[],this.isActive=void 0}handleRowWarningClick(){this.arcgisMemberCategoryEditorRowWarningClick.emit()}async componentWillLoad(){const e=await(0,s.g)(this.el);this.i18n=e[0]}render(){const{user:e,portal:t,config:n,i18n:o,isActive:i,getDisabledWarning:l,getCategorySchema:a,getCategoryAggregation:s,updateSchema:c,deleteSchema:d,updateSchemaFromPath:g}=this,v=!(0,u.b)(e);return(0,r.h)("arcgis-category-schema-editor",{key:"221a5b3850a6672498d48c9841b9b77b2b08b86e",user:e,portal:t,config:n,isActive:i,canFetchCategories:v,dialogHeading:o.dialogHeading,noticeTitle:o.noticeTitle,noticeDescription:o.noticeDescription,deleteConfirmMessage:o.warning.deleteInUseCategory.message,changeTitleConfirmMessage:o.warning.changeTitleInUseCategory.message,getDisabledWarning:l,getCategorySchema:a,getCategoryAggregation:s,updateSchema:c,deleteSchema:d,updateSchemaFromPath:g,alwaysShowInfoNotice:!0,onWorkflowCancel:e=>{this.workflowCancel.emit(e.detail)},onNewSchemaWorkflowComplete:e=>{this.newSchemaWorkflowComplete.emit(e.detail)},onDeleteAllSchema:()=>{this.deleteAllSchema.emit()}})}get el(){return(0,r.a)(this)}}},37362:(e,t,n)=>{n.d(t,{U:()=>r,a:()=>i,b:()=>o,g:()=>l});const r="/Categories",o=(e,t,n=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${n?t.title.toLocaleLowerCase():t.title}`};function i(e){var t;let n=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return n&&"/"!==n.charAt(0)&&(n=`/${n}`),n||r}const l=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},46904:(e,t,n)=>{n.d(t,{a:()=>l,b:()=>i,c:()=>u,d:()=>c,e:()=>d,f:()=>g,g:()=>v,i:()=>a,u:()=>s});n(93814);var r=n(41473);function o(e){var t;return!!(null===(t=e.owner)||void 0===t?void 0:t.toLowerCase().includes("esri"))}function i(e){var t;return o(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits"))}function l(e){var t;return o(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription"))}function a(e,t){return e.owner===t.username}function s(e,t){return a(e,t)||function(e,t){var n;if(null!=e.isAdmin)return!!e.isAdmin;const r=e.owner,o="admin"===e.itemControl,i=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(n=e.portal)||void 0===n?void 0:n.isPortal)&&!a(e,t)&&o&&r.includes("esri_")&&!i.includes(r))return!1;return o}(e,t)}const u=(e,t)=>!!t.orgId&&e.every(e=>e.isOrgItem),c=(e,t)=>`${(0,r.a)(t)}item.html?id=${e}`,d=(e,t)=>`${(0,r.g)(t)}/content/users/${e}`,g=e=>e.reduce((e,t)=>(e[t.owner]=e[t.owner]?[...e[t.owner],t.id]:[t.id],e),{}),v=(e,t)=>`${(0,r.a)(t)}content/items/${e}`},50315:(e,t,n)=>{n.d(t,{a:()=>p,b:()=>d,c:()=>v,d:()=>h,e:()=>g,f:()=>c,g:()=>u,u:()=>m});var r=n(83692),o=n(37362),i=n(59317),l=n(26262),a=n(41473),s=n(1654);const u=async({portal:e,user:t,group:n,useCache:r=!1})=>{var o;try{const i=await(n?d(n.id,e,r):c(e,t,r));return{result:null!==(o=null==i?void 0:i.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function c(e,t,n=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.b)(t))return null;const o=()=>(0,r.r)(`${(0,a.g)(e)}portals/${e.id}/categorySchema`);return n?(0,r.f)(o,"categorySchema",e.id):o()}async function d(e,t,n=!0){if(null!=t||(t=null===i.c||void 0===i.c?void 0:i.c.portal),!e||!t)return null;const o=()=>(0,r.r)(`${(0,l.a)(t,{id:e})}categorySchema`);return n?(0,r.f)(o,"categorySchema",e):o()}const g=async({user:e,portal:t,useCache:n=!1})=>{var r;const o=await v(t,e,n);return{result:null!==(r=null==o?void 0:o.memberCategorySchema)&&void 0!==r?r:null}};async function v(e,t,n=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.b)(t))return null;const o=()=>(0,r.r)(`${(0,a.g)(e)}portals/${e.id}/memberCategorySchema`);return n?(0,r.f)(o,"memberCategorySchema",e.id):o()}async function p(e,t,n=!0){const o=()=>async function(e,t){var n;const o=(0,a.g)(e),i=(0,a.b)(e),s=await(0,r.r)(`${o}portals/self?culture=${i}`),u=await(0,r.r)(`${o}community/groups?q=${s.contentCategorySetsGroupQuery}`),c=null===(n=null==u?void 0:u.results)||void 0===n?void 0:n[0],d=(await(0,r.r)((0,l.g)(e,c),{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${o}content/items/${d.id}/data`)}(e,t);return n?(0,r.f)(o,"categorySchema",t):o()}async function m({categories:e,itemIds:t,portal:n,group:o}){try{const i=`${(0,a.g)(n)}/content/${o?`groups/${o.id}/updateCategories`:"updateItems"}`,l=JSON.stringify(t.map(t=>{const n=Array.isArray(e)?e:e[t];return{[t]:o?n:{categories:n}}}));return{result:await(0,r.r)(i,{items:l},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const h=async({path:e,portal:t,group:n,updateInfo:r})=>{try{const i=(await f({category:e,portal:t,group:n,num:1})).total;if(0===i)return console.warn(`No items found with category ${e} when updating schema`),{};const l=100,a=Math.ceil(i/l),s=[];for(let i=0;i<a;i++)s.push(f({category:e,portal:t,group:n,start:i*l,num:l}).then(({results:t})=>{const i={};return t.forEach(t=>{var l;const a=null!==(l=n?t.groupCategories:t.categories)&&void 0!==l?l:[],s="change-title"===r.type?a.map(t=>{const n=(0,o.g)(e,r.newTitle);return t===e?n:t.replace(`${e}/`,`${n}/`)}):a.filter(t=>!t.startsWith(e));i[t.id]=s}),i}));const u=await Promise.all(s);return await Promise.all(u.map(e=>m({categories:e,itemIds:Object.keys(e),portal:t,group:n}))),{}}catch(t){return console.error(`Error ${r.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},f=({category:e,num:t=100,start:n=0,portal:o,group:i})=>{const s={start:n,num:t,categories:JSON.stringify([e])},u=i?(0,l.g)(o,i):`${(0,a.g)(o)}search`;return(0,r.r)(u,Object.assign(Object.assign({},s),{q:i?void 0:`orgid: ${o.id}`}))}},54251:(e,t,n)=>{n.d(t,{g:()=>o});var r=n(59317);function o(e){var t,n,o,i;return null!=e||(e=null===r.c||void 0===r.c?void 0:r.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(o=null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.credential)||void 0===o?void 0:o.token)||(null===(i=null==e?void 0:e.portalUser)||void 0===i?void 0:i.token)||""}},83692:(e,t,n)=>{n.d(t,{a:()=>m,b:()=>p,c:()=>v,f:()=>d,g:()=>w,i:()=>g,p:()=>y,r:()=>h});var r=n(59317),o=n(4429),i=n(931),l=n(41473),a=n(54251);const s={},u={},c={};async function d(e,t,n,r){var o,i,l,a;const d=null===(i=null===(o=c[t])||void 0===o?void 0:o[n])||void 0===i?void 0:i.expireAt,g=!!d&&(new Date).getTime()>d;if((null===(l=s[t])||void 0===l?void 0:l[n])&&!g)return s[t][n];u[t]||(u[t]={}),u[t][n]&&!g||(u[t][n]=e());const v=await u[t][n];if(s[t]||(s[t]={}),c[t]||(c[t]={}),s[t][n]=v,r){const{expireAfter:e,getExpireAfterFromResult:o}=r,i=o||e?(new Date).getTime()+(null!==(a=null==o?void 0:o(v))&&void 0!==a?a:e):null;c[t][n]=Object.assign(Object.assign({},c[t][n]),{expireAt:i})}return v}function g(e,t){var n;return null===(n=null==s?void 0:s[e])||void 0===n?void 0:n[t]}const v=(e,t)=>{var n,r;t?(null===(n=s[e])||void 0===n||delete n[t],null===(r=u[e])||void 0===r||delete r[t]):(delete s[e],delete u[e])};function p(e){var t,n;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(n=null==e?void 0:e.sourceJSON)||void 0===n?void 0:n.id}async function m(e,t,n={},r){const[o]=await(0,i.l)(["esri/request"]);e.includes("f=")||t.append("f","json");const l=(0,a.g)();return l&&!t.has("token")&&t.append("token",l),new Promise((i,l)=>{o(e,Object.assign(Object.assign({body:t},n),{timeout:n.timeout||0,method:r||"auto"})).then(e=>{i(e.data)}).catch(e=>l(e))})}async function h(e,t={},n={},o,l){const[a]=await(0,i.l)(["esri/request"]),{api:s,portal:u}=r.c,{customToken:c,addTokenManually:d,addSSL:g,useProxy:v}=n,p=Object.assign({},t);if(e.includes("f=")||!0===(null==l?void 0:l.excludeJson)||(p.f="json"),c)p.token=c;else if(!1!==d){const e=await w(u);e&&(p.token=e)}const m=!1===g?e:function(e){var t;const{config:n}=r.c;return"https:"===window.location.protocol||!0===(null===(t=null==n?void 0:n.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}(e);if(3===s){const e=Object.assign({url:m,content:p,timeout:n.timeout||0},null==l?void 0:l.v3Request);n.withCredentials&&(e.withCredentials=n.withCredentials);return a(e,"post"===o?Object.assign({usePost:!0},n):n)}{const e=Object.assign(Object.assign(Object.assign({query:p,method:o||"auto"},n),{timeout:n.timeout||0,useProxy:v}),(null==n?void 0:n.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await a(m,e)).data}}const f=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const y=async(e,t,n)=>{var r,i;const l=null!==(r=null==t?void 0:t.pendingStatuses)&&void 0!==r?r:["processing","partial","Pending","InProgress","EXECUTING"],a=null!==(i=null==t?void 0:t.successStatuses)&&void 0!==i?i:["completed","Completed","COMPLETED"];let s=0;const u=async()=>{const r=await h(e,null==t?void 0:t.requestParams,{},n),i=r.status||r.jobStatus;if(l.includes(i))return await(0,o.t)((c=s++,1e3*f[c>-1&&c<f.length-1?c:f.length-1])),u();if(a.includes(i)||"failed"===i||"esriJobFailed"===i)return r;throw r;var c};try{return u()}catch(e){throw console.error(e),e}},w=async e=>{var t;if(!(null==e?void 0:e.isPortal)||!(0,l.i)(e))return(0,a.g)(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,l.i)(e))return;const{token:n}=await d(()=>b(e),"platformSelf",null!==(t=p(e.user))&&void 0!==t?t:e.id,{getExpireAfterFromResult:e=>e.expires_in});return n},b=async e=>{const t=await(async e=>{var t,n;const[r]=await(0,i.l)(["esri/identity/IdentityManager"]);return null!==(n=null===(t=(await d(()=>r.getCredential((0,l.g)(e),{oAuthPopupConfirmation:!1}),"credential",p(e.user))).oAuthState)||void 0===t?void 0:t.appId)&&void 0!==n?n:"arcgisonline"})(e),n={"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return h(`${(0,l.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:n,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:n}})}},94984:(e,t,n)=>{n.d(t,{C:()=>a,a:()=>d,b:()=>c,f:()=>s,g:()=>l,l:()=>i,s:()=>v});var r=n(15332),o=n(931);const i=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function l(e){return function(e,t,n){const o=(0,r.c)(e,`[${t}]`);return o?o.getAttribute(t):n}(e,"dir","ltr")}const a={rtl:"arcgis--rtl"};async function s(e,t){const{api:n,type:r,places:i}=t||{};if(3===n){const[n]=await(0,o.l)(["dojo/number"]);return n.format(e,{type:r,places:i,pattern:null==t?void 0:t.pattern})}const[l]=await(0,o.l)(["esri/intl"]),a=l.convertNumberFormatToIntlOptions({places:i,style:r,digitSeparator:!0});return l.formatNumber(e,Object.assign(Object.assign({},a),{style:r}))}const u={};function c(e,t){let n=document.documentElement.lang;const r="bs"===n;if(r&&(n="hr"),t){const t=`${n}-full`,r={dateStyle:"full",timeStyle:"long"};return u[t]||(u[t]=new Intl.DateTimeFormat(n,r)),u[t].format(e)}const o={year:"numeric",month:r?"numeric":"short",day:"numeric"};return u[n]||(u[n]=new Intl.DateTimeFormat(n,o)),u[n].format(e)}function d(e,t,n,r){const o=null!=e?e:"en";let i=t.unknown;return(1===n||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(o))&&(i=t.single),1!==n&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(o)&&(i=t.multiple),v(i,Object.assign(Object.assign({},r),{number:n}))}const g=/\$\{([^}]+)\}/g;function v(e,t,n=g){let r=e;try{r=e.replace(n,(e,n)=>function(e,t){const n=e.split(".").reduce((e,t)=>e[t],t);return"string"==typeof n||"number"==typeof n?n:e}(n,t).toString())}catch(e){console.error(e)}return r}}}]);