System.register(["jimu-core/emotion","jimu-core","jimu-arcgis","jimu-theme","jimu-ui","jimu-ui/advanced/setting-components","esri/core/Collection"],function(e,l){var n={},t={},i={},a={},o={},s={},d={};return{setters:[function(e){n.jsx=e.jsx,n.jsxs=e.jsxs},function(e){t.Immutable=e.Immutable,t.React=e.React,t.classNames=e.classNames,t.css=e.css,t.hooks=e.hooks,t.polished=e.polished},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.MapViewManager=e.MapViewManager},function(e){a.useTheme=e.useTheme},function(e){o.Alert=e.Alert,o.MultiRangeSlider=e.MultiRangeSlider,o.Option=e.Option,o.Select=e.Select,o.Switch=e.Switch,o.defaultMessages=e.defaultMessages},function(e){s.MapWidgetSelector=e.MapWidgetSelector,s.MultipleJimuMapConfig=e.MultipleJimuMapConfig,s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection},function(){}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=o},23321:e=>{"use strict";e.exports=d},31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},62686:e=>{"use strict";e.exports=i},67386:e=>{"use strict";e.exports=n},79244:e=>{"use strict";e.exports=t},79298:e=>{"use strict";e.exports=s}},l={};function u(n){var t=l[n];if(void 0!==t)return t.exports;var i=l[n]={exports:{}};return e[n](i,i.exports,u),i.exports}u.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return u.d(l,{a:l}),l},u.d=(e,l)=>{for(var n in l)u.o(l,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:l[n]})},u.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var r={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(r),u.d(r,{__set_webpack_public_path__:()=>R,default:()=>j});var e=u(67386),l=u(79244),n=u(62686),t=u(1888),i=u(14321),a=u(79298);const o={ds:"Data source",mapSettings:"Map settings",mapSettingsTip:"Click a map below to customize the building explorer settings.",noMapTips:"The Map widget does not contain a web scene. Please select another map for configurations.",mapNotSupportedTips:"Web maps are not supported.",noBuildingLayerTips:"The web scene does not contain any building scene layers.",generalSetting:"General settings",zoomToLayer:"Zoom to layer on selection",applyFilterOnDs:"Apply filter to data sources",layerMode:"Layer selection mode",level:"Level",levelRange:"Level range",defaultLevel:"Default level",buildingPhase:"Building phase",buildingPhaseTips:"Building Phase tool is not applicable on the selected data.",phaseRange:"Phase range",defaultPhase:"Default phase",noPhaseTips:"Building Phase tool is not applicable on the selected data.",disciplinesCategories:"Disciplines & Categories",layerOnLoading:"Building Layer on loading"};var s;u(23321);function d(e,l){const t=n.MapViewManager.getInstance().getJimuMapViewGroup(e[0]),i=null==t?void 0:t.jimuMapViews,a=i&&Object.keys(i),o=null==a?void 0:a.find(e=>i[e].dataSourceId===l);return o?i[o]:null}function c(e){const l=n.MapViewManager.getInstance().getJimuMapViewGroup(e[0]),t=null==l?void 0:l.jimuMapViews,i=t&&Object.keys(t);return null==i?void 0:i.some(e=>"3d"===t[e].view.type)}function g(e){var l;const n=[];return null===(l=null==e?void 0:e.getAllJimuLayerViews())||void 0===l||l.forEach(e=>{"building-scene"===e.type&&n.push(e)}),n}function p(e){let l=[];return l=null==e?void 0:e.filter(e=>!e.fromRuntime),l}!function(e){e.Single="SINGLE"}(s||(s={}));const v=l.React.memo(n=>{var t,s,d,u;const r=l.hooks.useTranslation(o,i.defaultMessages),{config:c,viewModelResult:g,isEnableLevel:p,isMultipleMode:v,currentDSIdState:m,getCurrentSetting:h,handEnableChanged:S,onMapSettingsChanged:x}=n,f=l.React.useCallback(()=>{var e,l,n,t,i,a;const{currentSetting:o}=h(),s=null===(e=o.level)||void 0===e?void 0:e.min,d=null===(l=o.level)||void 0===l?void 0:l.max;let u=null!==(t=null===(n=o.level)||void 0===n?void 0:n.defaultValue)&&void 0!==t?t:null===(i=null==g?void 0:g.level)||void 0===i?void 0:i.defaultValue;return void 0===u&&(u=""),{min:s,max:d,allowedValuesLimit:(null===(a=null==g?void 0:g.level)||void 0===a?void 0:a.allowedValuesLimit)||null,defaultValue:u}},[g,h]),b=l.React.useCallback(e=>{var l,n,t,i,a,o,s;const d=Math.max(null!==(l=(null==e?void 0:e.min)||f().min)&&void 0!==l?l:0,null!==(t=null===(n=null==g?void 0:g.level)||void 0===n?void 0:n.min)&&void 0!==t?t:0),u=Math.min(null!==(i=(null==e?void 0:e.max)||f().max)&&void 0!==i?i:0,null!==(o=null===(a=null==g?void 0:g.level)||void 0===a?void 0:a.max)&&void 0!==o?o:0),r=null===(s=null==g?void 0:g.level)||void 0===s?void 0:s.allowedValuesLimit,c=[];for(let e=d;e<=u;e++){(null===r||(null==r?void 0:r.includes(e)))&&c.push(e)}return c},[null==g?void 0:g.level,f]);const M=l.React.useCallback(e=>{let n=c.getIn(["mapSettings"]),t=n[m];t||(t=(0,l.Immutable)({})),n=n.setIn([m],t),x(n)},[c,m,x]);return(0,e.jsxs)(a.SettingSection,{children:[(0,e.jsx)(a.SettingRow,{tag:"label",label:r("level"),children:(0,e.jsx)(i.Switch,{checked:p,onChange:e=>{S("enableLevel",e)}})}),v&&p&&(0,e.jsxs)(l.React.Fragment,{children:[(0,e.jsx)(a.SettingRow,{label:r("levelRange"),className:"mt-4"}),(0,e.jsx)(a.SettingRow,{children:(0,e.jsx)(i.MultiRangeSlider,{"aria-label":r("levelRange"),tooltip:!0,defaultMinValue:null===(t=null==g?void 0:g.level)||void 0===t?void 0:t.min,defaultMaxValue:null===(s=null==g?void 0:g.level)||void 0===s?void 0:s.max,min:null===(d=null==g?void 0:g.level)||void 0===d?void 0:d.min,max:null===(u=null==g?void 0:g.level)||void 0===u?void 0:u.max,minValue:f().min,maxValue:f().max,step:1,onChange:(e,l)=>{M({min:e,max:l})},disabled:!g})}),(0,e.jsx)(a.SettingRow,{label:r("defaultLevel")}),(0,e.jsx)(a.SettingRow,{children:(0,e.jsx)(i.Select,{size:"sm",value:f().defaultValue,placeholder:r("none"),disabled:!g,onChange:e=>{M({defaultValue:e.target.value})},children:function(){const l=[];return l.push((0,e.jsx)(i.Option,{value:"",children:r("none")},"")),b().forEach(n=>{l.push((0,e.jsx)(i.Option,{value:n,children:n},n))}),l}()})})]})]})}),m=l.React.memo(n=>{var t,s,d,u;const r=l.hooks.useTranslation(o,i.defaultMessages),{config:c,viewModelResult:g,isEnablePhase:p,isShowPhaseSetting:v,isMultipleMode:m,currentDSIdState:h,getCurrentSetting:S,handEnableChanged:x,onMapSettingsChanged:f}=n,b=l.React.useCallback(()=>{var e,l,n,t,i,a;const{currentSetting:o}=S(),s=null===(e=o.phase)||void 0===e?void 0:e.min,d=null===(l=o.phase)||void 0===l?void 0:l.max;let u=null!==(t=null===(n=o.phase)||void 0===n?void 0:n.defaultValue)&&void 0!==t?t:null===(i=null==g?void 0:g.phase)||void 0===i?void 0:i.defaultValue;return void 0===u&&(u=""),{min:s,max:d,allowedValuesLimit:(null===(a=null==g?void 0:g.phase)||void 0===a?void 0:a.allowedValuesLimit)||null,defaultValue:u}},[g,S]),M=l.React.useCallback(e=>{var l,n,t,i,a,o,s;const d=Math.max(null!==(l=(null==e?void 0:e.min)||b().min)&&void 0!==l?l:0,null!==(t=null===(n=null==g?void 0:g.phase)||void 0===n?void 0:n.min)&&void 0!==t?t:0),u=Math.min(null!==(i=(null==e?void 0:e.max)||b().max)&&void 0!==i?i:0,null!==(o=null===(a=null==g?void 0:g.phase)||void 0===a?void 0:a.max)&&void 0!==o?o:0),r=null===(s=null==g?void 0:g.phase)||void 0===s?void 0:s.allowedValuesLimit,c=[];for(let e=d;e<=u;e++){(null===r||(null==r?void 0:r.includes(e)))&&c.push(e)}return c},[null==g?void 0:g.phase,b]);const w=l.React.useCallback(e=>{let n=c.getIn(["mapSettings"]),t=n[h];t||(t=(0,l.Immutable)({})),n=n.setIn([h],t),f(n)},[c,h,f]);return(0,e.jsxs)(a.SettingSection,{children:[(0,e.jsx)(a.SettingRow,{tag:"label",label:r("buildingPhase"),children:(0,e.jsx)(i.Switch,{checked:p,onChange:e=>{x("enablePhase",e)}})}),m&&p&&(0,e.jsxs)("div",{className:v?"d-block":"d-none",children:[(0,e.jsx)(a.SettingRow,{label:r("phaseRange"),className:"mt-4"}),(0,e.jsx)(a.SettingRow,{children:(0,e.jsx)(i.MultiRangeSlider,{disabled:!g&&!v,"aria-label":r("phaseRange"),tooltip:!0,defaultMinValue:null===(t=null==g?void 0:g.phase)||void 0===t?void 0:t.min,defaultMaxValue:null===(s=null==g?void 0:g.phase)||void 0===s?void 0:s.max,min:null===(d=null==g?void 0:g.phase)||void 0===d?void 0:d.min,max:null===(u=null==g?void 0:g.phase)||void 0===u?void 0:u.max,minValue:b().min,maxValue:b().max,step:1,onChange:(e,l)=>{w({min:e,max:l})}})}),(0,e.jsx)(a.SettingRow,{label:r("defaultPhase")}),(0,e.jsx)(a.SettingRow,{children:(0,e.jsx)(i.Select,{size:"sm",value:b().defaultValue,placeholder:r("none"),onChange:e=>{w({defaultValue:e.target.value})},disabled:!g,children:function(){const l=[];return l.push((0,e.jsx)(i.Option,{value:"",children:r("none")},"")),M().forEach(n=>{l.push((0,e.jsx)(i.Option,{value:n,children:n},n))}),l}()})})]})]})}),h=l.React.memo(n=>{var u,r,h,S;(0,t.useTheme)();const x=l.hooks.useTranslation(o,i.defaultMessages),{onMapSettingsChanged:f,config:b}=n,M=x("none"),[w,j]=l.React.useState(""),R=l.React.useCallback(()=>{const e=n.config.getIn(["mapSettings"]);return{currentSetting:e.getIn([w]),mapsSettings:e}},[n.config,w]),C=n.viewModelResult,y=l.React.useCallback(()=>{const{currentSetting:e}=R(),l=null==e?void 0:e.layerMode;return null!=l?l:s.Single},[R]),I=l.React.useCallback(e=>{const l=null!=e?e:w;if(!l)return[];return g(d(n.useMapWidgetIds,l))},[w,n.useMapWidgetIds]),V=e=>{let l=I(e);return l=p(l),(null==l?void 0:l.length)>0},k=e=>{var l;return"3d"===(null===(l=d(n.useMapWidgetIds,e).view)||void 0===l?void 0:l.type)},O=l.React.useCallback(()=>{let e=I();return e=p(e),e?(e.unshift({id:"",layer:{title:M}}),e):null},[M,I]),L=O(),T=l.React.useCallback(()=>{var e;const{currentSetting:t}=R();return!(i=null==t?void 0:t.layersOnLoad)||(null==i?void 0:i.length)<=0||i&&1===i.length&&""===i[0]?O():function(e,l){var n;const t=[];return null===(n=null==l?void 0:l.getAllJimuLayerViews())||void 0===n||n.forEach(l=>{(null==e?void 0:e.includes(l.id))&&t.push(l)}),t}(null!==(e=t.layersOnLoad)&&void 0!==e?e:l.Immutable[""],n.activatedJimuMapView);var i},[n.activatedJimuMapView,R,O]),P=l.React.useCallback(()=>T().at(0),[T]),N=l.React.useCallback(e=>{const n=e.target.value;let t=b.getIn(["mapSettings"]),i=t[w];i||(i=(0,l.Immutable)({})),i=i.setIn(["layersOnLoad"],[n]),t=t.setIn([w],i),f(t)},[b,w,f]),W=l.React.useCallback(e=>{const{currentSetting:l}=R(),n=l&&l[e];return null==n||n},[R]),J=(e,t)=>{let i=b.getIn(["mapSettings"]),a=i[w];a||(a=(0,l.Immutable)({})),a=a.setIn([e],t.target.checked),i=i.setIn([w],a),n.onMapSettingsChanged(i)},E=y()!==s.Single,z=W("enableLevel"),D=W("enablePhase"),_=!((null===(u=null==C?void 0:C.phase)||void 0===u?void 0:u.min)===(null===(r=null==C?void 0:C.phase)||void 0===r?void 0:r.max));return(0,e.jsxs)(a.SettingSection,{title:x("mapSettings"),"aria-label":x("mapSettings")+" "+x("mapSettingsTip"),role:"group",children:[c(n.useMapWidgetIds)&&(0,e.jsx)(l.React.Fragment,{children:(0,e.jsx)(a.SettingRow,{label:x("mapSettingsTip"),className:"mapSettingsTip d-block",css:l.css`
    label {
      max-width: 100% !important;
    }
  `,flow:"wrap",children:(0,e.jsx)(a.MultipleJimuMapConfig,{mapWidgetId:null===(h=n.useMapWidgetIds)||void 0===h?void 0:h[0],onClick:e=>{j(e)},isDataSourceValid:e=>k(e)?V(e)?{isValid:!0}:{isValid:!1,invalidMessage:x("noBuildingLayerTips")}:{isValid:!1,invalidMessage:x("mapNotSupportedTips")},keepLastTimeMap:!0,sidePopperContent:(0,e.jsxs)("div",{className:"side-popper-container",children:[(0,e.jsx)(a.SettingSection,{children:(0,e.jsx)(a.SettingRow,{label:x("layerOnLoading"),"aria-label":x("layerOnLoading"),flow:"wrap",children:n.activatedJimuMapView&&(0,e.jsx)(i.Select,{value:null===(S=P())||void 0===S?void 0:S.id,onChange:N,size:"sm",placeholder:M,children:L&&L.map((l,n)=>{var t,a;return(0,e.jsx)(i.Option,{tabIndex:0,role:"option","aria-label":null===(t=l.layer)||void 0===t?void 0:t.title,value:l.id,children:null===(a=l.layer)||void 0===a?void 0:a.title},n)})})})}),(0,e.jsx)(v,{config:b,getCurrentSetting:R,viewModelResult:C,currentDSIdState:w,isEnableLevel:z,isMultipleMode:E,onMapSettingsChanged:f,handEnableChanged:J}),(0,e.jsx)(m,{config:b,getCurrentSetting:R,viewModelResult:C,currentDSIdState:w,isEnablePhase:D,isShowPhaseSetting:_,isMultipleMode:E,onMapSettingsChanged:f,handEnableChanged:J}),(0,e.jsx)(a.SettingSection,{children:(0,e.jsx)(a.SettingRow,{tag:"label",label:x("disciplinesCategories"),children:(0,e.jsx)(i.Switch,{checked:W("enableCtegories"),onChange:e=>{J("enableCtegories",e)}})})})]})})})}),!c(n.useMapWidgetIds)&&(0,e.jsx)(a.SettingRow,{children:(0,e.jsx)(i.Alert,{tabIndex:0,className:"warningMsg",type:"warning",withIcon:!0,onClose:function(){},open:!0,text:x("noMapTips")})})]})}),S=l.React.memo(n=>{const t=l.hooks.useTranslation(o,i.defaultMessages),s=(e,l)=>{const t=n.config.setIn(["general",e],l.target.checked);n.onGeneralSettingChanged(t.general)};return(0,e.jsxs)(a.SettingSection,{title:t("generalSetting"),"aria-label":t("generalSetting"),children:[(0,e.jsx)(a.SettingRow,{tag:"label",label:t("zoomToLayer"),children:(0,e.jsx)(i.Switch,{checked:n.config.general.zoomToLayer,onChange:e=>{s("zoomToLayer",e)}})}),(0,e.jsx)(a.SettingRow,{tag:"label",label:t("applyFilterOnDs"),children:(0,e.jsx)(i.Switch,{checked:n.config.general.applyFilterOnDs,onChange:e=>{s("applyFilterOnDs",e)}})})]})});var x=u(31027),f=u.n(x),b=function(e,l){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&l.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)l.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(n[t[i]]=e[t[i]])}return n};const M=n=>{const t=window.SVG,{className:i}=n,a=b(n,["className"]),o=(0,l.classNames)("jimu-icon jimu-icon-component",i);return t?(0,e.jsx)(t,Object.assign({className:o,src:f()},a)):(0,e.jsx)("svg",Object.assign({className:o},a))};var w=function(e,l,n,t){return new(n||(n=Promise))(function(i,a){function o(e){try{d(t.next(e))}catch(e){a(e)}}function s(e){try{d(t.throw(e))}catch(e){a(e)}}function d(e){var l;e.done?i(e.value):(l=e.value,l instanceof n?l:new n(function(e){e(l)})).then(o,s)}d((t=t.apply(e,l||[])).next())})};const j=s=>{var d;(0,t.useTheme)();const u=l.hooks.useTranslation(o,i.defaultMessages),r=null===(d=s.useMapWidgetIds)||void 0===d?void 0:d[0],c=l.React.useMemo(()=>{var e;return(null===(e=s.useMapWidgetIds)||void 0===e?void 0:e.length)>0},[s.useMapWidgetIds]),[g,p]=l.React.useState(null),v=l.React.useCallback(e=>w(void 0,void 0,void 0,function*(){var l;"3d"===(null===(l=null==e?void 0:e.view)||void 0===l?void 0:l.type)?(yield e.whenJimuMapViewLoaded(),p(e)):p(null)}),[]),[m]=l.React.useState(null);return(0,e.jsxs)("div",{className:"widget-setting-directions jimu-widget-setting",css:l.css`
      font-size: 13px;
      font-weight: lighter;

      .jimu-widget-setting--section {
        padding: 18px 16px;
      }

      .placeholder-container{
        height: calc(100% - 180px);

        .placeholder-icon{
          color: var(--ref-palette-neutral-800);
        }
        .placeholder-hint{
          font-size: ${l.polished.rem(14)};
          font-weight: 500;
          color: var(--ref-palette-neutral-1000);
          max-width: ${l.polished.rem(160)};
        }
      }
  `,children:[(0,e.jsxs)(a.SettingSection,{title:u("ds"),"aria-label":u("ds"),className:(0,l.classNames)({"border-0":!c}),children:[(0,e.jsx)(a.SettingRow,{label:u("selectMapWidget"),className:"mb-2"}),(0,e.jsx)("div",{children:(0,e.jsx)(a.MapWidgetSelector,{onSelect:e=>{s.onSettingChange({id:s.id,useMapWidgetIds:e})},useMapWidgetIds:s.useMapWidgetIds})}),r&&(0,e.jsx)(n.JimuMapViewComponent,{useMapWidgetId:r,onActiveViewChange:v})]}),!c&&(0,e.jsx)("div",{className:"d-flex justify-content-center align-items-center placeholder-container",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)(M,{size:48,className:"d-inline-block placeholder-icon mb-2"}),(0,e.jsx)("p",{className:"placeholder-hint",children:u("selectMapHint")})]})}),c&&(0,e.jsxs)(l.React.Fragment,{children:[(0,e.jsx)(h,{widgetId:s.id,useMapWidgetIds:s.useMapWidgetIds,activatedJimuMapView:g,config:s.config,onMapSettingsChanged:e=>{s.onSettingChange({id:s.id,config:s.config.setIn(["mapSettings"],e)})},viewModelResult:m}),(0,e.jsx)(S,{config:s.config,onGeneralSettingChanged:e=>{s.onSettingChange({id:s.id,config:s.config.setIn(["general"],e)})}})]})]})};function R(e){u.p=e}})(),r})())}}});