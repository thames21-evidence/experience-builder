System.register(["jimu-core","jimu-core/emotion","jimu-ui","jimu-ui/advanced/site-components"],function(e,t){var s={},i={},a={},o={};return{setters:[function(e){s.Immutable=e.Immutable,s.React=e.React,s.SessionManager=e.SessionManager,s.classNames=e.classNames,s.css=e.css,s.defaultMessages=e.defaultMessages,s.getAppStore=e.getAppStore,s.hooks=e.hooks,s.moduleLoader=e.moduleLoader,s.polished=e.polished,s.privilegeUtils=e.privilegeUtils,s.queryString=e.queryString,s.urlUtils=e.urlUtils},function(e){i.jsx=e.jsx,i.jsxs=e.jsxs},function(e){a.AlertPopup=e.AlertPopup,a.Button=e.Button,a.Loading=e.Loading,a.LoadingType=e.LoadingType,a.Nav=e.Nav,a.NavItem=e.NavItem,a.NavLink=e.NavLink,a.Navbar=e.Navbar,a.TextInput=e.TextInput,a.defaultMessages=e.defaultMessages},function(e){o.ALL_FOLDERS=e.ALL_FOLDERS,o.ALL_GROUPS=e.ALL_GROUPS,o.AppAccessTypes=e.AppAccessTypes,o.ClassifyDropdown=e.ClassifyDropdown,o.FilterItemsBar=e.FilterItemsBar,o.ITEM_MARGIN_X=e.ITEM_MARGIN_X,o.ITEM_WIDTH=e.ITEM_WIDTH,o.ImportApp=e.ImportApp,o.ListContext=e.ListContext,o.ListEmpty=e.ListEmpty,o.ListViews=e.ListViews,o.ListViewsItemType=e.ListViewsItemType,o.ListViewsViewType=e.ListViewsViewType,o.ROOT_FOLDER=e.ROOT_FOLDER,o.SortField=e.SortField,o.TemplateList=e.TemplateList,o.UserRole=e.UserRole,o.getSortOderBySortField=e.getSortOderBySortField}],execute:function(){e((()=>{var e={170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},244:e=>{"use strict";e.exports=s},321:e=>{"use strict";e.exports=a},386:e=>{"use strict";e.exports=i},545:e=>{"use strict";e.exports=o},662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var n={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(n),r.d(n,{__set_webpack_public_path__:()=>N,default:()=>M});var e=r(386),t=r(244);const s={_widgetLabel:"App List"};var i=r(321),a=r(170),o=r.n(a),l=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(s[i[a]]=e[i[a]])}return s};const p=s=>{const i=window.SVG,{className:a}=s,r=l(s,["className"]),n=(0,t.classNames)("jimu-icon jimu-icon-component",a);return i?(0,e.jsx)(i,Object.assign({className:n,src:o()},r)):(0,e.jsx)("svg",Object.assign({className:n},r))};var c=r(662),h=r.n(c),d=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(s[i[a]]=e[i[a]])}return s};const u=s=>{const i=window.SVG,{className:a}=s,o=d(s,["className"]),r=(0,t.classNames)("jimu-icon jimu-icon-component",a);return i?(0,e.jsx)(i,Object.assign({className:r,src:h()},o)):(0,e.jsx)("svg",Object.assign({className:r},o))};var m=r(838),g=r.n(m),v=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(s[i[a]]=e[i[a]])}return s};const f=s=>{const i=window.SVG,{className:a}=s,o=v(s,["className"]),r=(0,t.classNames)("jimu-icon jimu-icon-component",a);return i?(0,e.jsx)(i,Object.assign({className:r,src:g()},o)):(0,e.jsx)("svg",Object.assign({className:r},o))};var y=r(545),A=function(e,t,s,i){return new(s||(s=Promise))(function(a,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function n(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(r,n)}l((i=i.apply(e,t||[])).next())})};class w extends t.React.PureComponent{constructor(e){super(e),this.contentNode=t.React.createRef(),this.appListContainer=t.React.createRef(),this.searchPromise=null,this.isLoadModuleForBuilder=!0,this.scrollPosition=0,this.nextStart=null,this.appListTotal=null,this.updateNavAndSearchPosition=(e=!1)=>{var t;if(!this.navContainer||!this.searchContainer)return;if(this.state.showLargeSearchInput)return;const s=this.navContainer.clientWidth||0;if(s===this.navContainerWidth&&!e)return;this.navContainerWidth=s;const i=(null===(t=this.navContainer.querySelector(".jimu-nav"))||void 0===t?void 0:t.clientWidth)||0;if(s>0&&s<240+i){if(!this.state.showSearchButton)return void this.setState({showSearchButton:!0},()=>{this.updateNavAndSearchPosition(!0)});const e=this.searchContainer.getBoundingClientRect();if(this.navContainer.getBoundingClientRect().right>e.left-10){const t=[],s=this.navContainer.querySelectorAll(".jimu-nav-item[data-id]");for(let i=s.length-1;i>=0;i--){const a=s[i],o=a.getBoundingClientRect().right,r=t.length>0?35:0;if(!(o>e.left-10-r))break;{const e=a.dataset.id;t.push(e)}}this.setState({hiddenNavItems:t})}}else this.state.showSearchButton?this.setState({showSearchButton:!1}):this.state.hiddenNavItems.length>0&&this.setState({hiddenNavItems:[]})},this.preloadData=()=>{this.props.user&&this.props.portalUrl&&(this.checkUserPrivilege(),this.getFoldersAndGroup(),this.getParamsAndRefresh())},this.preloadModule=()=>{if(!this.isLoadModuleForBuilder)return!1;const e=[t.moduleLoader.loadModule("jimu-layouts/layout-builder.js"),t.moduleLoader.loadModule("jimu-ui/advanced/style-setting-components.js"),t.moduleLoader.loadModule("jimu-ui/basic/color-picker.js"),t.moduleLoader.loadModule("jimu-ui/advanced/setting-components.js"),t.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector.js"),t.moduleLoader.loadModule("jimu-ui/basic/item-selector.js"),t.moduleLoader.loadModule("jimu-ui/advanced/resource-selector.js"),t.moduleLoader.loadModule("jimu-data-source"),t.moduleLoader.loadModule("jimu-ui/basic/imagecrop.js"),t.moduleLoader.loadModule("jimu-core/react-dom/server.js")];Promise.all(e).then(e=>{this.isLoadModuleForBuilder=!1})},this.getRole=()=>{var e,t;let s;switch(null===(t=null===(e=this.props)||void 0===e?void 0:e.user)||void 0===t?void 0:t.role){case y.UserRole.OrgAdmin:s=y.UserRole.OrgAdmin;break;case y.UserRole.OrgPublisher:s=y.UserRole.OrgPublisher;break;case y.UserRole.OrgUser:s=y.UserRole.OrgUser;break;default:s=y.UserRole.CustomRoles}return s},this.getGroupList=()=>{var e;const s=(null===(e=this.props.user)||void 0===e?void 0:e.groups)||(0,t.Immutable)([]),i=[{value:y.ALL_GROUPS,text:this.nls("all",!0)}],{updateGroupIdData:a}=this.state;s.forEach(e=>{const t={value:e.id,text:e.title};e.capabilities.indexOf("updateitemcontrol")>-1&&a.push(e.id),i.push(t)}),this.setState({groupDropdownData:i,updateGroupIdData:a})},this.getFolderList=()=>{var e;return null===(e=this.state.jimuForBuilderService)||void 0===e?void 0:e.appServices.getFolders({num:1}).then(e=>{const t=e||[];this.initFolderListData(t)},e=>Promise.reject(new Error(e)))},this.initFolderListData=e=>{const{user:t}=this.props,s=(null==t?void 0:t.username)||"",i=[{value:y.ALL_FOLDERS,text:this.nls("all",!0)}];s&&i.push({value:y.ROOT_FOLDER,text:s}),e.forEach(e=>{const t={value:e.id,text:e.title};i.push(t)}),this.setState({folderDropdownData:i})},this.nls=(e,s,a)=>s?this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:i.defaultMessages[e]},a):e:this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:t.defaultMessages[e]},a):e,this.getRequestOption=(e,s,i=!1,a=y.AppAccessTypes.My)=>{let o=(0,t.Immutable)({});o=o.merge({q:this.getSharedRequestOptionAttrQ(a)}),e&&(o=o.merge({sortField:e,sortOrder:s})),window.jimuConfig.isDevEdition&&(o=o.merge({portalUrl:this.props.portalUrl}));const r=this.getPageNumAndStartNum(i);return o=o.merge({num:r.num,start:r.start}),o},this.getPageNumAndStartNum=e=>{const t={num:30,start:1},{apps:s}=this.state;return e&&(t.start=s.length+1),t},this.getSharedRequestOptionAttrQ=e=>{var s,i,a;const{searchTextForRequest:o,folderId:r,groupId:n}=this.state,{isExpressMode:l,user:p}=this.props,c=this.getRole(),h=t.SessionManager.getInstance().getMainSession(),d=this.getExperienceType(),u=o?`(${o})`:"";if(!h||!p)return`type: ${d} ${u}`;const m=(null==h?void 0:h.username)||"",g=(null===(s=null==p?void 0:p.groups)||void 0===s?void 0:s.reduce((e,t)=>e?`${e} OR ${t.id}`:t.id,""))||"",v=(null==p?void 0:p.favGroupId)||"";let f=`${`type: ${this.getExperienceType()}`} ${l?'typekeywords: "ExpressExperienceApp"':'NOT typekeywords: "ExpressExperienceApp"'}`;if(e!==y.AppAccessTypes.MyGroups){c===y.UserRole.OrgAdmin||!1!==(null===(i=(0,t.getAppStore)().getState().portalSelf)||void 0===i?void 0:i.canSearchPublic)||(f+=` AND orgid:${null===(a=(0,t.getAppStore)().getState().portalSelf)||void 0===a?void 0:a.id}`)}switch(e){case y.AppAccessTypes.My:return r&&r!==y.ALL_FOLDERS?`${f} ownerfolder: ${r} AND owner:${m} ${u}`:`${f} orgid:${p.orgId} AND owner:${m} ${u}`;case y.AppAccessTypes.MyOrganization:const e=c===y.UserRole.OrgAdmin?"(access:org OR access:private)":"access:org";return`orgid:${p.orgId} ${f} ${e} ${u}`;case y.AppAccessTypes.MyGroups:const t="(access:shared OR access:public OR access:org)";return n&&n!==y.ALL_GROUPS?`group:(${n}) ${f} ${t} ${u}`:`group:(${g}) ${f} ${t} ${u}`;case y.AppAccessTypes.MyFavorites:return`group: "${v}" ${f} ${u}`}},this.refresh=(e,t=!1)=>{e&&this.state.jimuForBuilderService&&(this.searchPromise=null,this.searchPromise=this.appServiceSearchApp(e),this.setState({showSkeleton:!0}),this.searchPromise.then(e=>{const s=e.results;this.searchPromise?(this.refreshSetState(s,t),this.nextStart=e.nextStart>0?e.nextStart:null,this.appListTotal=e.total,this.setState({showSkeleton:!1,count:e.total||null})):this.setState({showSkeleton:!1})},()=>{this.setState({showSkeleton:!1})}))},this.refreshSetState=(e,t=!1)=>{const s=t?this.state.apps:[];e=this.initAppInfo(e),this.setState({apps:s.concat(e)},()=>{this.getItemsGroups(e,!1,t),this.getItemsGroups(e,!0,t)}),clearTimeout(this.preloadModulesTimeout),this.preloadModulesTimeout=setTimeout(()=>{this.preloadModule()},1e3)},this.initAppInfo=e=>{const t=this.getRole();return e.map(e=>{var s;return e.isLocalApp=window.jimuConfig.isDevEdition,e.portalUrl=this.props.portalUrl,e.userRole=t,e.userName=null===(s=this.props.user)||void 0===s?void 0:s.username,e})},this.getItemsGroups=(e,t=!1,s=!1)=>{var i;if(window.jimuConfig.isDevEdition)return!1;const a=this.props.user,o=null==a?void 0:a.favGroupId,{updateGroupIdData:r,accessType:n}=this.state,l=s?this.state.allFavoritesIdData:[],p=s?this.state.updateGroupItemId:[];if(n===y.AppAccessTypes.My&&t||0===e.length||t&&0===r.length)return!1;let c=t?p:l;const h={items:e.map(e=>e.id).join(","),groups:t?r.join(","):o};null===(i=this.state.jimuForBuilderService)||void 0===i||i.appServices.getAppGroups(h).then(e=>{var s,i;for(const t in e)null===(i=null===(s=e[t])||void 0===s?void 0:s.items)||void 0===i||i.forEach(e=>{c=c.concat([e.itemId])});t?this.setState({updateGroupItemId:c}):this.setState({allFavoritesIdData:c})})},this.appServiceSearchApp=e=>A(this,void 0,void 0,function*(){var t,s;return null===(t=this.state.jimuForBuilderService)||void 0===t?void 0:t.appServices.searchApp(e,null===(s=this.state.jimuForBuilderService)||void 0===s?void 0:s.SearchType.Other)}),this.newApp=()=>{let e=`${window.jimuConfig.mountPath}builder/`;const s=this.getFolderIdForCreateApp();e=window.jimuConfig.useStructuralUrl?`${e}page/template`:`${e}?page=template`;const i=this.getQueryString("locale");i&&(e=t.urlUtils.appendQueryParam(e,"locale",i)),s&&(e=t.urlUtils.appendQueryParam(e,"folderId",s)),this.props.isExpressMode&&(e=t.urlUtils.appendQueryParam(e,"mode","express")),e=t.urlUtils.appendQueryParam(e,"redirect","homePage"),this.getQueryString("__env__")&&(e=t.urlUtils.appendQueryParam(e,"__env__",this.getQueryString("__env__"))),window.location.assign(e)},this.deleteApps=(e=[])=>this.checkAndShowReadOnlyRemind()?Promise.resolve():(this.setState({loading:!0}),Promise.all(e.map(e=>{var t;return null===(t=this.state.jimuForBuilderService)||void 0===t?void 0:t.appServices.deleteApp(e)})).then(()=>{this.setState({loading:!1}),this.removeItems(e)},e=>{const t="CONT_0048"===(null==e?void 0:e.code)?this.nls("unableDelete",!0):this.nls("deleteError",!0);this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})),this.refreshList=(e=!0)=>{e&&this.setState({searchText:""}),setTimeout(()=>{this.getParamsAndRefresh()},1e3)},this.duplicateAppItem=e=>{var t;if(this.checkAndShowReadOnlyRemind())return;this.setState({loading:!0});const s=this.getFolderIdForCreateApp();null===(t=this.state.jimuForBuilderService)||void 0===t||t.appServices.duplicateApp(e,s).then(e=>{this.setState({loading:!1}),e&&this.refreshList(!1)},e=>{const t=e&&e.indexOf("Resource does not exist")>-1?this.nls("noResource",!0):this.nls("duplicateError",!0);this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})},this.toggleLoadingForImport=e=>{this.setState({loading:e})},this.createApp=e=>{var t;if(this.checkAndShowReadOnlyRemind())return;let s=this.getQueryString("locale");s=s?`&locale=${s}`:"",this.setState({loading:!0});const i=this.getFolderIdForCreateApp();null===(t=this.state.jimuForBuilderService)||void 0===t||t.appServices.createAppByItemTemplateInfo(e,i).then(e=>{if(e){const t=window.jimuConfig.mountPath+"builder/?id="+e+s;window.location.href=t}this.setState({loading:!1})},e=>{const t=e&&e.indexOf("Resource does not exist")>-1?this.nls("noResource",!0):this.nls("createApplicationError",!0);this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})},this.checkAndShowReadOnlyRemind=()=>{const e=(0,t.getAppStore)().getState().portalSelf;return(null==e?void 0:e.isReadOnly)&&this.setState({isShowAlertPopup:!0,alertPopupMessage:this.nls("remindTextForReadonlyMode",!0)}),null==e?void 0:e.isReadOnly},this.switchListView=e=>{this.setState({isDetailView:e})},this.sortFieldAndOrderChange=(e,t)=>{this.setState({sortField:e,sortOrder:t},()=>{this.getParamsAndRefresh()})},this.folderIdChange=e=>{this.setState({folderId:e},()=>{this.getParamsAndRefresh()})},this.groupIdChange=e=>{this.setState({groupId:e},()=>{this.getParamsAndRefresh()})},this.handleKeydown=e=>{const t=e.target.value;"Enter"===e.key&&t&&this.setState({searchTextForRequest:t},()=>{clearTimeout(this.onSearchTextInputTimer),this.getParamsAndRefresh()})},this.searchTextChange=e=>{const t=e.target.value,s=t.length<3&&t.length>0;let{searchTextForRequest:i}=this.state;i=s?i:t,this.setState({searchText:t,searchTextForRequest:i},()=>{if(s)return!1;clearTimeout(this.onSearchTextInputTimer),this.onSearchTextInputTimer=setTimeout(()=>{this.getParamsAndRefresh()},500)})},this.favoriteToggle=(e,t)=>{if(this.checkAndShowReadOnlyRemind())return;const s=this.props.user,i={everyone:!1,org:!1,groups:null==s?void 0:s.favGroupId,items:t};return this.setState({loading:!0}),e?this.removeFromFavorites(i):this.addToFavorite(i)},this.addToFavorite=e=>{var t;const s=this.state.allFavoritesIdData;return null===(t=this.state.jimuForBuilderService)||void 0===t?void 0:t.appServices.addToFavorites(e).then(t=>{const i=s.concat(e.items);return this.setState({allFavoritesIdData:i,count:this.state.accessType===y.AppAccessTypes.MyFavorites?this.state.count?this.state.count+1:1:this.state.count,loading:!1}),Promise.resolve(t)},e=>(this.setState({loading:!1}),Promise.reject(new Error(e))))},this.removeFromFavorites=e=>A(this,void 0,void 0,function*(){var t;const{accessType:s,allFavoritesIdData:i}=this.state,a=i.filter(t=>t!==e.items);return null===(t=this.state.jimuForBuilderService)||void 0===t?void 0:t.appServices.removeFromFavorites(e).then(t=>A(this,void 0,void 0,function*(){return this.setState({loading:!1,allFavoritesIdData:a}),s===y.AppAccessTypes.MyFavorites&&this.removeItems([e.items]),Promise.resolve(t)}),e=>A(this,void 0,void 0,function*(){return this.setState({loading:!1}),Promise.reject(new Error(e))}))}),this.removeItems=e=>{var t,s;const i=null===(t=this.state.apps)||void 0===t?void 0:t.filter(t=>!e.includes(t.id)),a=null===(s=this.state.selectedApps)||void 0===s?void 0:s.filter(t=>!e.includes(t.id));this.setState({apps:i,count:this.state.count&&this.state.count-e.length>0?this.state.count-e.length:null,selectedApps:a})},this.checkUserPrivilege=()=>A(this,void 0,void 0,function*(){const{CheckTarget:e}=t.privilegeUtils,{capabilities:s}=this.state;yield t.privilegeUtils.checkExbAccess(e.AppList).then(e=>{this.setState({valid:null==e?void 0:e.valid,invalidMessage:null==e?void 0:e.invalidMessage,capabilities:(null==e?void 0:e.capabilities)||s,hasPrivilegeCheckCompleted:!0})})}),this.toggleAlertPopup=()=>{this.setState({isShowAlertPopup:!this.state.isShowAlertPopup,alertPopupMessage:""})},this.clearSelectedApps=()=>{this.setState({selectedApps:[]})},this.deleteSelectedApps=()=>{this.setState({isDeleteInfoOpen:!0})},this.toggleDeleteInfo=()=>{this.setState({isDeleteInfoOpen:!this.state.isDeleteInfoOpen})},this.updateAppList=(e,t)=>{if(!e)return;const s=this.state.apps,i=s[t];s[t]=Object.assign(Object.assign({},i),e),this.setState({apps:s.slice()})},this.getItemRowNumber=()=>{if(!this.navContainer)return null;const e=this.navContainer.clientWidth+24;return Math.floor(e/(y.ITEM_WIDTH+2*y.ITEM_MARGIN_X))},this.onAppAccessTypeChange=e=>{this.setState({accessType:e,count:null,selectedApps:[],isDetailView:!0},()=>{this.getParamsAndRefresh()})},this.onSelectedAppsChange=e=>{this.setState({selectedApps:e})},this.onStartSearchClick=()=>{this.setState({showLargeSearchInput:!0})},this.onClearSearchClick=()=>{const e=""===this.state.searchText;this.setState({showLargeSearchInput:!1,searchText:"",searchTextForRequest:""},()=>{if(e)return!1;clearTimeout(this.onSearchTextInputTimer),this.onSearchTextInputTimer=setTimeout(()=>{this.getParamsAndRefresh()},500)})},this.getAccessTypeLabel=e=>{switch(e){case y.AppAccessTypes.My:return this.nls("myContent",!0);case y.AppAccessTypes.MyOrganization:return this.nls("myOrganization",!0);case y.AppAccessTypes.MyGroups:return this.nls("myGroup",!0);case y.AppAccessTypes.MyFavorites:return this.nls("myFavorites",!0)}},this.getMoreDropdownNavItemPositionLeft=e=>{if(!this.navContainer)return 0;const t=this.navContainer.getBoundingClientRect(),s=this.navContainer.querySelectorAll(".jimu-nav-item[data-id]");let i;for(let t=s.length-1;t>=0;t--){const a=s[t];if(!e.includes(a.dataset.id)){i=a;break}}if(!i)return 0;const a=i.getBoundingClientRect().left-t.left+i.clientWidth+10;return Math.floor(a)},this.state={apps:[],selectedApps:[],hiddenNavItems:[],isDetailView:!0,isDeleteInfoOpen:!1,accessType:y.AppAccessTypes.My,sortField:y.SortField.Modified,sortOrder:(0,y.getSortOderBySortField)(y.SortField.Modified),searchText:"",searchTextForRequest:"",loading:!1,showSkeleton:!0,isRoleViewer:!0,showLargeSearchInput:!1,showSearchButton:!1,folderId:y.ALL_FOLDERS,groupId:y.ALL_GROUPS,folderDropdownData:[],groupDropdownData:[],allFavoritesIdData:[],updateGroupIdData:[],updateGroupItemId:[],valid:!0,invalidMessage:"",isShowAlertPopup:!1,alertPopupMessage:"",hasPrivilegeCheckCompleted:!1,capabilities:{canCreateExperience:!1,canDeleteExperience:!1,canShareExperience:!1,canUpdateExperience:!1,canViewExperience:!1},count:null,jimuForBuilderService:null}}componentDidMount(){this.resizeObserver=new ResizeObserver(()=>{this.updateNavAndSearchPosition()}),this.resizeObserver.observe(this.navContainer),this.contentNode.current&&!this.contentNode.current.onscroll&&(this.contentNode.current.onscroll=this.onScrollHandle.bind(this)),t.moduleLoader.loadModule("jimu-for-builder/service").then(e=>{this.setState({jimuForBuilderService:e},()=>{this.preloadData()})})}componentDidUpdate(e){var t,s;const{portalUrl:i,isExpressMode:a}=this.props;(null===(t=e.user)||void 0===t?void 0:t.username)===(null===(s=this.props.user)||void 0===s?void 0:s.username)&&(null==e?void 0:e.portalUrl)===i||this.preloadData(),a!==e.isExpressMode&&this.getParamsAndRefresh(),this.contentNode.current&&!this.contentNode.current.onscroll&&(this.contentNode.current.onscroll=this.onScrollHandle.bind(this))}componentWillUnmount(){this.contentNode.current&&(this.contentNode.current.onscroll=null)}getFoldersAndGroup(){this.getFolderList(),this.getGroupList()}onScrollHandle(e){const t=e.target.clientHeight,s=e.target.scrollHeight-2,i=e.target.scrollTop;if(i>this.scrollPosition){const e=t+i>=s;!this.state.showSkeleton&&e&&0!==this.state.apps.length&&"number"==typeof this.nextStart&&this.getParamsAndRefresh(!0)}this.scrollPosition=i}getExperienceType(){var e;return`"${null===(e=this.state.jimuForBuilderService)||void 0===e?void 0:e.AppType.ExperienceType}"`}getQueryString(e){return t.queryString.parse(window.location.search)[e]||""}getParamsAndRefresh(e=!1){const t=this.nextStart,s=this.appListTotal,i=t&&s&&(t>s||t<0)&&e;if(!this.props.user||i)return;e||(this.nextStart=null,this.appListTotal=null,this.setState({apps:[]}));const a=this.getRequestOption(this.state.sortField,this.state.sortOrder,e,this.state.accessType);this.refresh(a,e)}getFolderIdForCreateApp(){const{folderId:e}=this.state,t=!e.includes(y.ROOT_FOLDER),s=!e.includes(y.ALL_FOLDERS);return e&&!window.jimuConfig.isDevEdition&&t&&s?e:null}render(){const s=this.getItemRowNumber(),a={deleteApps:this.deleteApps,refreshList:this.refreshList,duplicateAppItem:this.duplicateAppItem,createApp:this.createApp,favoriteToggle:this.favoriteToggle,getFolderList:this.getFolderList,checkAndShowReadOnlyRemind:this.checkAndShowReadOnlyRemind,theme:this.props.theme,skeletonNum:s};if(!this.state.valid&&!this.props.isTest)return(0,e.jsx)("div",{css:S(this.props.theme),className:"invalid-message position-absolute",children:this.state.invalidMessage});const o=this.getAccessTypeLabel(y.AppAccessTypes.My),r=this.getAccessTypeLabel(y.AppAccessTypes.MyOrganization),n=this.getAccessTypeLabel(y.AppAccessTypes.MyGroups),l=this.getAccessTypeLabel(y.AppAccessTypes.MyFavorites),c=this.nls("search",!1),h=this.nls("clear",!0),d=this.nls("more",!0);return(0,e.jsx)(y.ListContext.Provider,{value:a,children:(0,e.jsxs)("div",{css:S(this.props.theme),className:"h-100 w-100","data-testid":"app-list",children:[(0,e.jsxs)("div",{className:"app-list h-100",children:[(0,e.jsxs)("div",{className:"w-responsive",children:[(0,e.jsxs)("div",{className:"app-list-banner d-flex justify-content-between",children:[(0,e.jsx)("div",{className:"list-title flex-grow-1",children:this.nls("experiences",!0)}),this.state.capabilities.canCreateExperience&&(0,e.jsxs)(i.Button,{className:"float-left btn-lg px-3 py-2 app-list-new-app",size:"lg",type:"primary",onClick:this.newApp,children:[(0,e.jsx)(u,{autoFlip:!0,className:"app-list-new-app-icon"}),this.nls("newApp",!0)]}),window.jimuConfig.isDevEdition&&(0,e.jsx)("div",{className:"ml-2",children:(0,e.jsx)(y.ImportApp,{folderDropdownData:this.state.folderDropdownData,groupDropdownData:this.state.groupDropdownData,isExperiencesTemplate:!1,portalUrl:this.props.portalUrl,folderUrl:this.props.context.folderUrl,intl:this.props.intl,theme:this.props.theme,refreshAppList:this.refreshList,toggleLoading:this.toggleLoadingForImport})})]}),(0,e.jsxs)("div",{className:"header-nav-bar mt-6",ref:e=>{this.navContainer=e},children:[(0,e.jsx)(i.Navbar,{className:"header-nav-bar-con",border:!1,light:!0,children:(0,e.jsxs)(i.Nav,{underline:!0,navbar:!0,justified:!0,fill:!0,"data-testid":"app-menu",className:"position-relative",children:[(0,e.jsx)(i.NavItem,{"data-id":y.AppAccessTypes.My,className:(0,t.classNames)("tap-link",{invisible:this.state.hiddenNavItems.includes(y.AppAccessTypes.My)}),title:o,onClick:()=>{this.onAppAccessTypeChange(y.AppAccessTypes.My)},children:(0,e.jsx)(i.NavLink,{tag:"button",active:!this.state.showLargeSearchInput&&this.state.accessType===y.AppAccessTypes.My,children:o})}),!window.jimuConfig.isDevEdition&&(0,e.jsx)(i.NavItem,{"data-id":y.AppAccessTypes.MyOrganization,className:(0,t.classNames)("tap-link",{invisible:this.state.hiddenNavItems.includes(y.AppAccessTypes.MyOrganization)}),title:r,onClick:()=>{this.onAppAccessTypeChange(y.AppAccessTypes.MyOrganization)},children:(0,e.jsx)(i.NavLink,{tag:"button",active:!this.state.showLargeSearchInput&&this.state.accessType===y.AppAccessTypes.MyOrganization,children:r})}),!window.jimuConfig.isDevEdition&&(0,e.jsx)(i.NavItem,{"data-id":y.AppAccessTypes.MyGroups,className:(0,t.classNames)("tap-link",{invisible:this.state.hiddenNavItems.includes(y.AppAccessTypes.MyGroups)}),title:n,onClick:()=>{this.onAppAccessTypeChange(y.AppAccessTypes.MyGroups)},children:(0,e.jsx)(i.NavLink,{tag:"button",active:!this.state.showLargeSearchInput&&this.state.accessType===y.AppAccessTypes.MyGroups,children:n})}),!window.jimuConfig.isDevEdition&&(0,e.jsx)(i.NavItem,{"data-id":y.AppAccessTypes.MyFavorites,className:(0,t.classNames)("tap-link",{invisible:this.state.hiddenNavItems.includes(y.AppAccessTypes.MyFavorites)}),title:l,onClick:()=>{this.onAppAccessTypeChange(y.AppAccessTypes.MyFavorites)},children:(0,e.jsx)(i.NavLink,{tag:"button",active:!this.state.showLargeSearchInput&&this.state.accessType===y.AppAccessTypes.MyFavorites,children:l})}),this.state.hiddenNavItems.length>0&&(0,e.jsx)(i.NavItem,{className:"tap-link dropdown-item-more position-absolute p-1",style:{left:this.getMoreDropdownNavItemPositionLeft(this.state.hiddenNavItems)+"px",top:"-4px"},"aria-label":d,title:d,children:(0,e.jsx)(y.ClassifyDropdown,{onChange:this.onAppAccessTypeChange,value:this.state.accessType,useMoreIcon:!0,isShowSelectIcon:!0,intl:this.props.intl,theme:this.props.theme,dropDownData:this.state.hiddenNavItems.map(e=>({text:this.getAccessTypeLabel(e),value:e}))})})]})}),(0,e.jsxs)("div",{className:(0,t.classNames)("search-con d-flex justify-content-end align-items-center",{"large-search-con":this.state.showLargeSearchInput}),ref:e=>{this.searchContainer=e},children:[(!this.state.showSearchButton||this.state.showLargeSearchInput)&&(0,e.jsx)(i.TextInput,{className:(0,t.classNames)("float-left app-list-searchbox app-list-h1 flex-sm-fill search-input",{"large-search-input":this.state.showLargeSearchInput}),placeholder:c,"aria-label":c,onChange:this.searchTextChange,value:this.state.searchText,prefix:(0,e.jsx)(p,{autoFlip:!1,className:"app-list-search-icon-fill"}),allowClear:!0,ref:e=>{this.searchInput=e},onKeyDown:e=>{this.handleKeydown(e)}}),this.state.showSearchButton&&(this.state.showLargeSearchInput?(0,e.jsx)(i.Button,{type:"tertiary","aria-label":h,title:h,className:"search-con-btn search-con-clear-btn ml-2",onClick:this.onClearSearchClick,children:(0,e.jsx)(f,{autoFlip:!1,className:"app-list-search-icon-fill m-0"})}):(0,e.jsx)(i.Button,{type:"tertiary","aria-label":c,title:c,className:"search-con-btn search-con-search-btn mt-2",onClick:this.onStartSearchClick,children:(0,e.jsx)(p,{autoFlip:!1,className:"app-list-search-icon-fill m-0"})}))]})]}),(0,e.jsx)(y.FilterItemsBar,{itemType:y.ListViewsItemType.App,count:this.state.count,isDetailView:this.state.isDetailView,selectedApps:this.state.selectedApps,selectedSortField:this.state.sortField,selectedSortOrder:this.state.sortOrder,selectedFolder:this.state.folderId,selectedGroup:this.state.groupId,folderDropdownData:!window.jimuConfig.isDevEdition&&this.state.accessType===y.AppAccessTypes.My&&this.state.folderDropdownData,groupDropdownData:!window.jimuConfig.isDevEdition&&this.state.accessType===y.AppAccessTypes.MyGroups&&this.state.groupDropdownData,clearSelectedApps:this.clearSelectedApps,deleteSelectedApps:this.deleteSelectedApps,onIsDetailViewChange:this.switchListView,onSortChange:this.sortFieldAndOrderChange,onFolderChange:this.folderIdChange,onGroupChange:this.groupIdChange,intl:this.props.intl,theme:this.props.theme})]}),(0,e.jsxs)("div",{className:"tab-content",children:[!this.props.onlyFetchData&&(this.state.apps.length>0||this.state.showSkeleton||this.state.loading)&&(0,e.jsx)(y.ListViews,{className:"list-scroll-container pt-1",innerRef:this.contentNode,listInnerRef:this.appListContainer,tabIndex:-1,viewType:this.state.isDetailView?y.ListViewsViewType.Detail:y.ListViewsViewType.List,portalUrl:this.props.portalUrl,intl:this.props.intl,folderUrl:this.props.context.folderUrl,apps:this.state.apps,selectedApps:this.state.selectedApps,switchListView:this.switchListView,allFavoritesIdData:this.state.allFavoritesIdData,capabilities:this.state.capabilities,updateGroupItemId:this.state.updateGroupItemId,folderListData:this.state.folderDropdownData,hasPrivilegeCheckCompleted:this.state.hasPrivilegeCheckCompleted,updateAppList:this.updateAppList,deleteApps:this.deleteApps,deleteSelectedApps:this.deleteSelectedApps,itemType:y.ListViewsItemType.App,onSelectedAppsChange:this.onSelectedAppsChange,isSelectable:this.state.accessType===y.AppAccessTypes.My,isDeleteInfoOpen:this.state.isDeleteInfoOpen,toggleDeleteInfo:this.toggleDeleteInfo,showSkeleton:this.state.showSkeleton}),this.state.jimuForBuilderService&&0===this.state.apps.length&&!this.state.loading&&!this.state.showSkeleton&&(0,e.jsx)(y.ListEmpty,{searchText:this.state.searchText,accessType:this.state.accessType,intl:this.props.intl,isTemplateList:!1,hasOtherSearchParams:!!(this.state.accessType===y.AppAccessTypes.My&&this.state.folderId!==y.ALL_FOLDERS||this.state.accessType===y.AppAccessTypes.MyGroups&&this.state.groupId!==y.ALL_GROUPS)})]})]}),this.state.loading&&!this.state.showSkeleton&&(0,e.jsx)(i.Loading,{width:32,height:32,type:i.LoadingType.Secondary}),(0,e.jsx)(i.AlertPopup,{isOpen:this.state.isShowAlertPopup,title:this.nls("warningPopUpTitle",!0),hideCancel:!0,toggle:this.toggleAlertPopup,children:(0,e.jsx)("div",{style:{fontSize:"1rem"},children:this.state.alertPopupMessage})})]})})}}function S(e){return t.css`
    .app-list-search-icon-fill {
      color: #A8A8A8;
    }
    &.invalid-message {
      text-align: center;
      top: 50%;
      font-size: ${t.polished.rem(16)};
      color: ${e.ref.palette.neutral[1e3]};
      min-width: ${t.polished.rem(800)};
      width: 100%;
      box-sizing: border-box;
      padding:0 ${t.polished.rem(50)};
    }
    .header-nav-bar {
      font-size: 16px;
      position: relative;
      border-bottom: 1px solid ${e.sys.color.divider.secondary};
    }
    .search-con {
      position: absolute;
      right: 0;
      top: -12px;
    }
    .search-input {
      width: 240px;
    }
    .header-nav-bar-con {
      padding:0;
      margin-bottom: -1px;
      .nav-item {
        flex: auto;
      }
      .nav-item .nav-link {
        width: auto;
        white-space: nowrap;
        color: var(--sys-color-surface-background-hint);
        font-size: 14px;
        font-weight: 500;
      }
      .nav-item .nav-link:hover, .nav-item .nav-link:focus {
        color: #E3E3E3;
      }
      .nav-item .nav-link.active {
        color: #E3E3E3;
        font-weight: 600;
      }
    }
    .header-nav-bar-con {
      padding:0;
      margin-bottom: -1px;
      .nav-item {
        flex: auto;
      }
    }
    .nav-item a.nav-link {
      width: auto;
      white-space: nowrap;
      color: inherit;
    }
    .nav-item .nav-link:hover, .nav-item .nav-link:focus {
      color: ${e.ref.palette.black};
    }
    .nav-item .nav-link.active {
      color: ${e.ref.palette.black};
      font-weight: 600;
    }
    button.app-list-new-app:hover{
      color: ${e.ref.palette.black} !important;
    }
    .app-list-new-app {
      font-size: ${t.polished.rem(16)};
      white-space: nowrap;
      .app-list-new-app-icon {
        margin-right: ${t.polished.rem(8)};
      }
    }
    .margin-4 {
      margin-right: ${t.polished.rem(4)};
    }
  `}w.scrollTop=0;const x=t=>(0,e.jsx)(y.TemplateList,Object.assign({},t,{allowImport:!0,showDraft:!0})),{useState:T,useEffect:L}=t.React,{useTranslation:j}=t.hooks;var I;!function(e){e.AppList="applist",e.TemplateList="templatelist"}(I||(I={}));const b=new Set,O=i=>{var a,o;const[r,n]=T(!1),l=j(s),p=(null===(a=i.queryObject)||void 0===a?void 0:a.views)===I.TemplateList?I.TemplateList:I.AppList,c=null===(o=i.config)||void 0===o?void 0:o.view;return b.add(p),L(()=>{setTimeout(()=>{n(!0)},2e3)},[]),(0,e.jsx)("div",{inert:p!==c,className:(0,t.classNames)("widget-builder-app-list bg-default w-100 h-100 d-flex justify-content-center",{"app-list":c===I.AppList,"template-list":c===I.TemplateList}),css:(h=i.theme,t.css`
    overflow: hidden;

    .list-container {
      min-height: 750px;
      width: 100%;
    }

    .search-con-btn {
      margin-top: 3px;
    }

    .large-search-con, .large-search-input {
      width: 100% !important;
    }

    .app-list-banner {
      overflow: visible;
      width: 100%;
      align-items: center;
      .list-title {
        color: var(--sys-color-surface-background-hint);
        font-size: 30px;
        line-height: 30px;
        font-weight: 500;
      }
    }

    .tab-content {
      height: calc(100% - 105px);
      overflow: hidden;
    }

    .app-list {
      .list-scroll-container {
        height: calc(100% - 65px);
        overflow-y: auto;
      }
    }

    .template-list {
      .list-scroll-container {
        height: 100%;
        overflow-y: auto;
      }
    }

    .w-responsive {
      width: 792px;
      margin: 0 auto;
      padding-left: 12px;
      padding-right: 12px;
    }

    @media (min-width: 1280px) {
      .w-responsive {
        width: 1056px;
      }
    }
    @media (min-width: 1400px) {
      .w-responsive {
          width: 1320px;
      }
    }
    @media (min-width: 1680px) {
      .w-responsive {
          width: 1585px;
      }
    }

    /** Utility css classes for components */
    .loading-con {
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: ${t.polished.rgba(h.ref.palette.white,.2)};
    }
    .modal-content {
      background: none;
    }
    .app-list-h1 {
      font-size: ${t.polished.rem(24)};
    }
    .app-list-h2 {
      font-size: ${t.polished.rem(16)};
    }
    .app-list-h3 {
      font-size: ${t.polished.rem(13)};
    }
  `),children:(r||c===p||b.has(c))&&(0,e.jsx)("div",{className:"list-container h-100 pt-8 pb-4 d-flex",children:c===I.AppList?(0,e.jsx)(w,{onlyFetchData:r&&!b.has(I.AppList),portalUrl:i.portalUrl,intl:i.intl,theme:i.theme,context:i.context,user:i.user,isExpressMode:i.isExpressMode}):i.isExpressMode?null:(0,e.jsx)(x,Object.assign({},i,{onlyFetchData:r&&!b.has(I.TemplateList),title:l("templates")}))})});var h};O.mapExtraStateProps=e=>{var t,s;return{queryObject:e.queryObject,isExpressMode:null===(s=null===(t=e.widgetsState)||void 0===t?void 0:t.header)||void 0===s?void 0:s.isExpressMode}};const M=O;function N(e){r.p=e}})(),n})())}}});